// SNet.js - Rowan Cockett - http://app.visiblegeology.com/


/**
* @preserve
* ┌────────────────────────────────────────────────────────────────────┐
* │ Raphaël 2.1.0 - JavaScript Vector Library                          │
* ├────────────────────────────────────────────────────────────────────┤
* │ Copyright © 2008-2012 Dmitry Baranovskiy (http://raphaeljs.com)    │
* │ Copyright © 2008-2012 Sencha Labs (http://sencha.com)              │
* ├────────────────────────────────────────────────────────────────────┤
* │ Licensed under the MIT (http://raphaeljs.com/license.html) license.│
* └────────────────────────────────────────────────────────────────────┘
*/

(function(a){var b="0.3.4",c="hasOwnProperty",d=/[\.\/]/,e="*",f=function(){},g=function(a,b){return a-b},h,i,j={n:{}},k=function(a,b){var c=j,d=i,e=Array.prototype.slice.call(arguments,2),f=k.listeners(a),l=0,m=!1,n,o=[],p={},q=[],r=h,s=[];h=a,i=0;for(var t=0,u=f.length;t<u;t++)"zIndex"in f[t]&&(o.push(f[t].zIndex),f[t].zIndex<0&&(p[f[t].zIndex]=f[t]));o.sort(g);while(o[l]<0){n=p[o[l++]],q.push(n.apply(b,e));if(i){i=d;return q}}for(t=0;t<u;t++){n=f[t];if("zIndex"in n)if(n.zIndex==o[l]){q.push(n.apply(b,e));if(i)break;do{l++,n=p[o[l]],n&&q.push(n.apply(b,e));if(i)break}while(n)}else p[n.zIndex]=n;else{q.push(n.apply(b,e));if(i)break}}i=d,h=r;return q.length?q:null};k.listeners=function(a){var b=a.split(d),c=j,f,g,h,i,k,l,m,n,o=[c],p=[];for(i=0,k=b.length;i<k;i++){n=[];for(l=0,m=o.length;l<m;l++){c=o[l].n,g=[c[b[i]],c[e]],h=2;while(h--)f=g[h],f&&(n.push(f),p=p.concat(f.f||[]))}o=n}return p},k.on=function(a,b){var c=a.split(d),e=j;for(var g=0,h=c.length;g<h;g++)e=e.n,!e[c[g]]&&(e[c[g]]={n:{}}),e=e[c[g]];e.f=e.f||[];for(g=0,h=e.f.length;g<h;g++)if(e.f[g]==b)return f;e.f.push(b);return function(a){+a==+a&&(b.zIndex=+a)}},k.stop=function(){i=1},k.nt=function(a){if(a)return(new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)")).test(h);return h},k.off=k.unbind=function(a,b){var f=a.split(d),g,h,i,k,l,m,n,o=[j];for(k=0,l=f.length;k<l;k++)for(m=0;m<o.length;m+=i.length-2){i=[m,1],g=o[m].n;if(f[k]!=e)g[f[k]]&&i.push(g[f[k]]);else for(h in g)g[c](h)&&i.push(g[h]);o.splice.apply(o,i)}for(k=0,l=o.length;k<l;k++){g=o[k];while(g.n){if(b){if(g.f){for(m=0,n=g.f.length;m<n;m++)if(g.f[m]==b){g.f.splice(m,1);break}!g.f.length&&delete g.f}for(h in g.n)if(g.n[c](h)&&g.n[h].f){var p=g.n[h].f;for(m=0,n=p.length;m<n;m++)if(p[m]==b){p.splice(m,1);break}!p.length&&delete g.n[h].f}}else{delete g.f;for(h in g.n)g.n[c](h)&&g.n[h].f&&delete g.n[h].f}g=g.n}}},k.once=function(a,b){var c=function(){var d=b.apply(this,arguments);k.unbind(a,c);return d};return k.on(a,c)},k.version=b,k.toString=function(){return"You are running Eve "+b},typeof module!="undefined"&&module.exports?module.exports=k:typeof define!="undefined"?define("eve",[],function(){return k}):a.eve=k})(this),function(){function cF(a){for(var b=0;b<cy.length;b++)cy[b].el.paper==a&&cy.splice(b--,1)}function cE(b,d,e,f,h,i){e=Q(e);var j,k,l,m=[],o,p,q,t=b.ms,u={},v={},w={};if(f)for(y=0,z=cy.length;y<z;y++){var x=cy[y];if(x.el.id==d.id&&x.anim==b){x.percent!=e?(cy.splice(y,1),l=1):k=x,d.attr(x.totalOrigin);break}}else f=+v;for(var y=0,z=b.percents.length;y<z;y++){if(b.percents[y]==e||b.percents[y]>f*b.top){e=b.percents[y],p=b.percents[y-1]||0,t=t/b.top*(e-p),o=b.percents[y+1],j=b.anim[e];break}f&&d.attr(b.anim[b.percents[y]])}if(!!j){if(!k){for(var A in j)if(j[g](A))if(U[g](A)||d.paper.customAttributes[g](A)){u[A]=d.attr(A),u[A]==null&&(u[A]=T[A]),v[A]=j[A];switch(U[A]){case C:w[A]=(v[A]-u[A])/t;break;case"colour":u[A]=a.getRGB(u[A]);var B=a.getRGB(v[A]);w[A]={r:(B.r-u[A].r)/t,g:(B.g-u[A].g)/t,b:(B.b-u[A].b)/t};break;case"path":var D=bR(u[A],v[A]),E=D[1];u[A]=D[0],w[A]=[];for(y=0,z=u[A].length;y<z;y++){w[A][y]=[0];for(var F=1,G=u[A][y].length;F<G;F++)w[A][y][F]=(E[y][F]-u[A][y][F])/t}break;case"transform":var H=d._,I=ca(H[A],v[A]);if(I){u[A]=I.from,v[A]=I.to,w[A]=[],w[A].real=!0;for(y=0,z=u[A].length;y<z;y++){w[A][y]=[u[A][y][0]];for(F=1,G=u[A][y].length;F<G;F++)w[A][y][F]=(v[A][y][F]-u[A][y][F])/t}}else{var J=d.matrix||new cb,K={_:{transform:H.transform},getBBox:function(){return d.getBBox(1)}};u[A]=[J.a,J.b,J.c,J.d,J.e,J.f],b$(K,v[A]),v[A]=K._.transform,w[A]=[(K.matrix.a-J.a)/t,(K.matrix.b-J.b)/t,(K.matrix.c-J.c)/t,(K.matrix.d-J.d)/t,(K.matrix.e-J.e)/t,(K.matrix.f-J.f)/t]}break;case"csv":var L=r(j[A])[s](c),M=r(u[A])[s](c);if(A=="clip-rect"){u[A]=M,w[A]=[],y=M.length;while(y--)w[A][y]=(L[y]-u[A][y])/t}v[A]=L;break;default:L=[][n](j[A]),M=[][n](u[A]),w[A]=[],y=d.paper.customAttributes[A].length;while(y--)w[A][y]=((L[y]||0)-(M[y]||0))/t}}var O=j.easing,P=a.easing_formulas[O];if(!P){P=r(O).match(N);if(P&&P.length==5){var R=P;P=function(a){return cC(a,+R[1],+R[2],+R[3],+R[4],t)}}else P=bf}q=j.start||b.start||+(new Date),x={anim:b,percent:e,timestamp:q,start:q+(b.del||0),status:0,initstatus:f||0,stop:!1,ms:t,easing:P,from:u,diff:w,to:v,el:d,callback:j.callback,prev:p,next:o,repeat:i||b.times,origin:d.attr(),totalOrigin:h},cy.push(x);if(f&&!k&&!l){x.stop=!0,x.start=new Date-t*f;if(cy.length==1)return cA()}l&&(x.start=new Date-x.ms*f),cy.length==1&&cz(cA)}else k.initstatus=f,k.start=new Date-k.ms*f;eve("raphael.anim.start."+d.id,d,b)}}function cD(a,b){var c=[],d={};this.ms=b,this.times=1;if(a){for(var e in a)a[g](e)&&(d[Q(e)]=a[e],c.push(Q(e)));c.sort(bd)}this.anim=d,this.top=c[c.length-1],this.percents=c}function cC(a,b,c,d,e,f){function o(a,b){var c,d,e,f,j,k;for(e=a,k=0;k<8;k++){f=m(e)-a;if(z(f)<b)return e;j=(3*i*e+2*h)*e+g;if(z(j)<1e-6)break;e=e-f/j}c=0,d=1,e=a;if(e<c)return c;if(e>d)return d;while(c<d){f=m(e);if(z(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}function n(a,b){var c=o(a,b);return((l*c+k)*c+j)*c}function m(a){return((i*a+h)*a+g)*a}var g=3*b,h=3*(d-b)-g,i=1-g-h,j=3*c,k=3*(e-c)-j,l=1-j-k;return n(a,1/(200*f))}function cq(){return this.x+q+this.y+q+this.width+" × "+this.height}function cp(){return this.x+q+this.y}function cb(a,b,c,d,e,f){a!=null?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function bH(b,c,d){b=a._path2curve(b),c=a._path2curve(c);var e,f,g,h,i,j,k,l,m,n,o=d?0:[];for(var p=0,q=b.length;p<q;p++){var r=b[p];if(r[0]=="M")e=i=r[1],f=j=r[2];else{r[0]=="C"?(m=[e,f].concat(r.slice(1)),e=m[6],f=m[7]):(m=[e,f,e,f,i,j,i,j],e=i,f=j);for(var s=0,t=c.length;s<t;s++){var u=c[s];if(u[0]=="M")g=k=u[1],h=l=u[2];else{u[0]=="C"?(n=[g,h].concat(u.slice(1)),g=n[6],h=n[7]):(n=[g,h,g,h,k,l,k,l],g=k,h=l);var v=bG(m,n,d);if(d)o+=v;else{for(var w=0,x=v.length;w<x;w++)v[w].segment1=p,v[w].segment2=s,v[w].bez1=m,v[w].bez2=n;o=o.concat(v)}}}}}return o}function bG(b,c,d){var e=a.bezierBBox(b),f=a.bezierBBox(c);if(!a.isBBoxIntersect(e,f))return d?0:[];var g=bB.apply(0,b),h=bB.apply(0,c),i=~~(g/5),j=~~(h/5),k=[],l=[],m={},n=d?0:[];for(var o=0;o<i+1;o++){var p=a.findDotsAtSegment.apply(a,b.concat(o/i));k.push({x:p.x,y:p.y,t:o/i})}for(o=0;o<j+1;o++)p=a.findDotsAtSegment.apply(a,c.concat(o/j)),l.push({x:p.x,y:p.y,t:o/j});for(o=0;o<i;o++)for(var q=0;q<j;q++){var r=k[o],s=k[o+1],t=l[q],u=l[q+1],v=z(s.x-r.x)<.001?"y":"x",w=z(u.x-t.x)<.001?"y":"x",x=bD(r.x,r.y,s.x,s.y,t.x,t.y,u.x,u.y);if(x){if(m[x.x.toFixed(4)]==x.y.toFixed(4))continue;m[x.x.toFixed(4)]=x.y.toFixed(4);var y=r.t+z((x[v]-r[v])/(s[v]-r[v]))*(s.t-r.t),A=t.t+z((x[w]-t[w])/(u[w]-t[w]))*(u.t-t.t);y>=0&&y<=1&&A>=0&&A<=1&&(d?n++:n.push({x:x.x,y:x.y,t1:y,t2:A}))}}return n}function bF(a,b){return bG(a,b,1)}function bE(a,b){return bG(a,b)}function bD(a,b,c,d,e,f,g,h){if(!(x(a,c)<y(e,g)||y(a,c)>x(e,g)||x(b,d)<y(f,h)||y(b,d)>x(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(!k)return;var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(n<+y(a,c).toFixed(2)||n>+x(a,c).toFixed(2)||n<+y(e,g).toFixed(2)||n>+x(e,g).toFixed(2)||o<+y(b,d).toFixed(2)||o>+x(b,d).toFixed(2)||o<+y(f,h).toFixed(2)||o>+x(f,h).toFixed(2))return;return{x:l,y:m}}}function bC(a,b,c,d,e,f,g,h,i){if(!(i<0||bB(a,b,c,d,e,f,g,h)<i)){var j=1,k=j/2,l=j-k,m,n=.01;m=bB(a,b,c,d,e,f,g,h,l);while(z(m-i)>n)k/=2,l+=(m<i?1:-1)*k,m=bB(a,b,c,d,e,f,g,h,l);return l}}function bB(a,b,c,d,e,f,g,h,i){i==null&&(i=1),i=i>1?1:i<0?0:i;var j=i/2,k=12,l=[-0.1252,.1252,-0.3678,.3678,-0.5873,.5873,-0.7699,.7699,-0.9041,.9041,-0.9816,.9816],m=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],n=0;for(var o=0;o<k;o++){var p=j*l[o]+j,q=bA(p,a,c,e,g),r=bA(p,b,d,f,h),s=q*q+r*r;n+=m[o]*w.sqrt(s)}return j*n}function bA(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function by(a,b){var c=[];for(var d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}function bx(){return this.hex}function bv(a,b,c){function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join("␀"),h=d.cache=d.cache||{},i=d.count=d.count||[];if(h[g](f)){bu(i,f);return c?c(h[f]):h[f]}i.length>=1e3&&delete h[i.shift()],i.push(f),h[f]=a[m](b,e);return c?c(h[f]):h[f]}return d}function bu(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function bm(a){if(Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[g](c)&&(b[c]=bm(a[c]));return b}function a(c){if(a.is(c,"function"))return b?c():eve.on("raphael.DOMload",c);if(a.is(c,E))return a._engine.create[m](a,c.splice(0,3+a.is(c[0],C))).add(c);var d=Array.prototype.slice.call(arguments,0);if(a.is(d[d.length-1],"function")){var e=d.pop();return b?e.call(a._engine.create[m](a,d)):eve.on("raphael.DOMload",function(){e.call(a._engine.create[m](a,d))})}return a._engine.create[m](a,arguments)}a.version="2.1.0",a.eve=eve;var b,c=/[, ]+/,d={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},e=/\{(\d+)\}/g,f="prototype",g="hasOwnProperty",h={doc:document,win:window},i={was:Object.prototype[g].call(h.win,"Raphael"),is:h.win.Raphael},j=function(){this.ca=this.customAttributes={}},k,l="appendChild",m="apply",n="concat",o="createTouch"in h.doc,p="",q=" ",r=String,s="split",t="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[s](q),u={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},v=r.prototype.toLowerCase,w=Math,x=w.max,y=w.min,z=w.abs,A=w.pow,B=w.PI,C="number",D="string",E="array",F="toString",G="fill",H=Object.prototype.toString,I={},J="push",K=a._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,L=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,M={NaN:1,Infinity:1,"-Infinity":1},N=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,O=w.round,P="setAttribute",Q=parseFloat,R=parseInt,S=r.prototype.toUpperCase,T=a._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},U=a._availableAnimAttrs={blur:C,"clip-rect":"csv",cx:C,cy:C,fill:"colour","fill-opacity":C,"font-size":C,height:C,opacity:C,path:"path",r:C,rx:C,ry:C,stroke:"colour","stroke-opacity":C,"stroke-width":C,transform:"transform",width:C,x:C,y:C},V=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,W=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,X={hs:1,rg:1},Y=/,?([achlmqrstvxz]),?/gi,Z=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,$=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,_=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,ba=a._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,bb={},bc=function(a,b){return a.key-b.key},bd=function(a,b){return Q(a)-Q(b)},be=function(){},bf=function(a){return a},bg=a._rectPath=function(a,b,c,d,e){if(e)return[["M",a+e,b],["l",c-e*2,0],["a",e,e,0,0,1,e,e],["l",0,d-e*2],["a",e,e,0,0,1,-e,e],["l",e*2-c,0],["a",e,e,0,0,1,-e,-e],["l",0,e*2-d],["a",e,e,0,0,1,e,-e],["z"]];return[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},bh=function(a,b,c,d){d==null&&(d=c);return[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},bi=a._getPath={path:function(a){return a.attr("path")},circle:function(a){var b=a.attrs;return bh(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return bh(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return bg(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return bg(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return bg(b.x,b.y,b.width,b.height)}},bj=a.mapPath=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;a=bR(a);for(e=0,g=a.length;e<g;e++){i=a[e];for(f=1,h=i.length;f<h;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d}return a};a._g=h,a.type=h.win.SVGAngle||h.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a.type=="VML"){var bk=h.doc.createElement("div"),bl;bk.innerHTML='<v:shape adj="1"/>',bl=bk.firstChild,bl.style.behavior="url(#default#VML)";if(!bl||typeof bl.adj!="object")return a.type=p;bk=null}a.svg=!(a.vml=a.type=="VML"),a._Paper=j,a.fn=k=j.prototype=a.prototype,a._id=0,a._oid=0,a.is=function(a,b){b=v.call(b);if(b=="finite")return!M[g](+a);if(b=="array")return a instanceof Array;return b=="null"&&a===null||b==typeof a&&a!==null||b=="object"&&a===Object(a)||b=="array"&&Array.isArray&&Array.isArray(a)||H.call(a).slice(8,-1).toLowerCase()==b},a.angle=function(b,c,d,e,f,g){if(f==null){var h=b-d,i=c-e;if(!h&&!i)return 0;return(180+w.atan2(-i,-h)*180/B+360)%360}return a.angle(b,c,f,g)-a.angle(d,e,f,g)},a.rad=function(a){return a%360*B/180},a.deg=function(a){return a*180/B%360},a.snapTo=function(b,c,d){d=a.is(d,"finite")?d:10;if(a.is(b,E)){var e=b.length;while(e--)if(z(b[e]-c)<=d)return b[e]}else{b=+b;var f=c%b;if(f<d)return c-f;if(f>b-d)return c-f+b}return c};var bn=a.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=w.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)});a.setWindow=function(b){eve("raphael.setWindow",a,h.win,b),h.win=b,h.doc=h.win.document,a._engine.initWin&&a._engine.initWin(h.win)};var bo=function(b){if(a.vml){var c=/^\s+|\s+$/g,d;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),d=e.body}catch(f){d=createPopup().document.body}var g=d.createTextRange();bo=bv(function(a){try{d.style.color=r(a).replace(c,p);var b=g.queryCommandValue("ForeColor");b=(b&255)<<16|b&65280|(b&16711680)>>>16;return"#"+("000000"+b.toString(16)).slice(-6)}catch(e){return"none"}})}else{var i=h.doc.createElement("i");i.title="Raphaël Colour Picker",i.style.display="none",h.doc.body.appendChild(i),bo=bv(function(a){i.style.color=a;return h.doc.defaultView.getComputedStyle(i,p).getPropertyValue("color")})}return bo(b)},bp=function(){return"hsb("+[this.h,this.s,this.b]+")"},bq=function(){return"hsl("+[this.h,this.s,this.l]+")"},br=function(){return this.hex},bs=function(b,c,d){c==null&&a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b&&(d=b.b,c=b.g,b=b.r);if(c==null&&a.is(b,D)){var e=a.getRGB(b);b=e.r,c=e.g,d=e.b}if(b>1||c>1||d>1)b/=255,c/=255,d/=255;return[b,c,d]},bt=function(b,c,d,e){b*=255,c*=255,d*=255;var f={r:b,g:c,b:d,hex:a.rgb(b,c,d),toString:br};a.is(e,"finite")&&(f.opacity=e);return f};a.color=function(b){var c;a.is(b,"object")&&"h"in b&&"s"in b&&"b"in b?(c=a.hsb2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):a.is(b,"object")&&"h"in b&&"s"in b&&"l"in b?(c=a.hsl2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):(a.is(b,"string")&&(b=a.getRGB(b)),a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b?(c=a.rgb2hsl(b),b.h=c.h,b.s=c.s,b.l=c.l,c=a.rgb2hsb(b),b.v=c.b):(b={hex:"none"},b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1)),b.toString=br;return b},a.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;a=a%360/60,i=c*b,h=i*(1-z(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a];return bt(e,f,g,d)},a.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h);if(a>1||b>1||c>1)a/=360,b/=100,c/=100;a*=360;var e,f,g,h,i;a=a%360/60,i=2*b*(c<.5?c:1-c),h=i*(1-z(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a];return bt(e,f,g,d)},a.rgb2hsb=function(a,b,c){c=bs(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;f=x(a,b,c),g=f-y(a,b,c),d=g==0?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=g==0?0:g/f;return{h:d,s:e,b:f,toString:bp}},a.rgb2hsl=function(a,b,c){c=bs(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;g=x(a,b,c),h=y(a,b,c),i=g-h,d=i==0?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=i==0?0:f<.5?i/(2*f):i/(2-2*f);return{h:d,s:e,l:f,toString:bq}},a._path2string=function(){return this.join(",").replace(Y,"$1")};var bw=a._preload=function(a,b){var c=h.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em",c.onload=function(){b.call(this),this.onload=null,h.doc.body.removeChild(this)},c.onerror=function(){h.doc.body.removeChild(this)},h.doc.body.appendChild(c),c.src=a};a.getRGB=bv(function(b){if(!b||!!((b=r(b)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bx};if(b=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:bx};!X[g](b.toLowerCase().substring(0,2))&&b.charAt()!="#"&&(b=bo(b));var c,d,e,f,h,i,j,k=b.match(L);if(k){k[2]&&(f=R(k[2].substring(5),16),e=R(k[2].substring(3,5),16),d=R(k[2].substring(1,3),16)),k[3]&&(f=R((i=k[3].charAt(3))+i,16),e=R((i=k[3].charAt(2))+i,16),d=R((i=k[3].charAt(1))+i,16)),k[4]&&(j=k[4][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),k[1].toLowerCase().slice(0,4)=="rgba"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100));if(k[5]){j=k[5][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),(j[0].slice(-3)=="deg"||j[0].slice(-1)=="°")&&(d/=360),k[1].toLowerCase().slice(0,4)=="hsba"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100);return a.hsb2rgb(d,e,f,h)}if(k[6]){j=k[6][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),(j[0].slice(-3)=="deg"||j[0].slice(-1)=="°")&&(d/=360),k[1].toLowerCase().slice(0,4)=="hsla"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100);return a.hsl2rgb(d,e,f,h)}k={r:d,g:e,b:f,toString:bx},k.hex="#"+(16777216|f|e<<8|d<<16).toString(16).slice(1),a.is(h,"finite")&&(k.opacity=h);return k}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bx}},a),a.hsb=bv(function(b,c,d){return a.hsb2rgb(b,c,d).hex}),a.hsl=bv(function(b,c,d){return a.hsl2rgb(b,c,d).hex}),a.rgb=bv(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),a.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||.75},c=this.hsb2rgb(b.h,b.s,b.b);b.h+=.075,b.h>1&&(b.h=0,b.s-=.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b}));return c.hex},a.getColor.reset=function(){delete this.start},a.parsePathString=function(b){if(!b)return null;var c=bz(b);if(c.arr)return bJ(c.arr);var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];a.is(b,E)&&a.is(b[0],E)&&(e=bJ(b)),e.length||r(b).replace(Z,function(a,b,c){var f=[],g=b.toLowerCase();c.replace(_,function(a,b){b&&f.push(+b)}),g=="m"&&f.length>2&&(e.push([b][n](f.splice(0,2))),g="l",b=b=="m"?"l":"L");if(g=="r")e.push([b][n](f));else while(f.length>=d[g]){e.push([b][n](f.splice(0,d[g])));if(!d[g])break}}),e.toString=a._path2string,c.arr=bJ(e);return e},a.parseTransformString=bv(function(b){if(!b)return null;var c={r:3,s:4,t:2,m:6},d=[];a.is(b,E)&&a.is(b[0],E)&&(d=bJ(b)),d.length||r(b).replace($,function(a,b,c){var e=[],f=v.call(b);c.replace(_,function(a,b){b&&e.push(+b)}),d.push([b][n](e))}),d.toString=a._path2string;return d});var bz=function(a){var b=bz.ps=bz.ps||{};b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[g](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])});return b[a]};a.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=A(j,3),l=A(j,2),m=i*i,n=m*i,o=k*a+l*3*i*c+j*3*i*i*e+n*g,p=k*b+l*3*i*d+j*3*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,x=j*e+i*g,y=j*f+i*h,z=90-w.atan2(q-s,r-t)*180/B;(q>s||r<t)&&(z+=180);return{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:x,y:y},alpha:z}},a.bezierBBox=function(b,c,d,e,f,g,h,i){a.is(b,"array")||(b=[b,c,d,e,f,g,h,i]);var j=bQ.apply(null,b);return{x:j.min.x,y:j.min.y,x2:j.max.x,y2:j.max.y,width:j.max.x-j.min.x,height:j.max.y-j.min.y}},a.isPointInsideBBox=function(a,b,c){return b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2},a.isBBoxIntersect=function(b,c){var d=a.isPointInsideBBox;return d(c,b.x,b.y)||d(c,b.x2,b.y)||d(c,b.x,b.y2)||d(c,b.x2,b.y2)||d(b,c.x,c.y)||d(b,c.x2,c.y)||d(b,c.x,c.y2)||d(b,c.x2,c.y2)||(b.x<c.x2&&b.x>c.x||c.x<b.x2&&c.x>b.x)&&(b.y<c.y2&&b.y>c.y||c.y<b.y2&&c.y>b.y)},a.pathIntersection=function(a,b){return bH(a,b)},a.pathIntersectionNumber=function(a,b){return bH(a,b,1)},a.isPointInsidePath=function(b,c,d){var e=a.pathBBox(b);return a.isPointInsideBBox(e,c,d)&&bH(b,[["M",c,d],["H",e.x2+10]],1)%2==1},a._removedFactory=function(a){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+a+"” of removed object",a)}};var bI=a.pathBBox=function(a){var b=bz(a);if(b.bbox)return b.bbox;if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};a=bR(a);var c=0,d=0,e=[],f=[],g;for(var h=0,i=a.length;h<i;h++){g=a[h];if(g[0]=="M")c=g[1],d=g[2],e.push(c),f.push(d);else{var j=bQ(c,d,g[1],g[2],g[3],g[4],g[5],g[6]);e=e[n](j.min.x,j.max.x),f=f[n](j.min.y,j.max.y),c=g[5],d=g[6]}}var k=y[m](0,e),l=y[m](0,f),o=x[m](0,e),p=x[m](0,f),q={x:k,y:l,x2:o,y2:p,width:o-k,height:p-l};b.bbox=bm(q);return q},bJ=function(b){var c=bm(b);c.toString=a._path2string;return c},bK=a._pathToRelative=function(b){var c=bz(b);if(c.rel)return bJ(c.rel);if(!a.is(b,E)||!a.is(b&&b[0],E))b=a.parsePathString(b);var d=[],e=0,f=0,g=0,h=0,i=0;b[0][0]=="M"&&(e=b[0][1],f=b[0][2],g=e,h=f,i++,d.push(["M",e,f]));for(var j=i,k=b.length;j<k;j++){var l=d[j]=[],m=b[j];if(m[0]!=v.call(m[0])){l[0]=v.call(m[0]);switch(l[0]){case"a":l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=+(m[6]-e).toFixed(3),l[7]=+(m[7]-f).toFixed(3);break;case"v":l[1]=+(m[1]-f).toFixed(3);break;case"m":g=m[1],h=m[2];default:for(var n=1,o=m.length;n<o;n++)l[n]=+(m[n]-(n%2?e:f)).toFixed(3)}}else{l=d[j]=[],m[0]=="m"&&(g=m[1]+e,h=m[2]+f);for(var p=0,q=m.length;p<q;p++)d[j][p]=m[p]}var r=d[j].length;switch(d[j][0]){case"z":e=g,f=h;break;case"h":e+=+d[j][r-1];break;case"v":f+=+d[j][r-1];break;default:e+=+d[j][r-2],f+=+d[j][r-1]}}d.toString=a._path2string,c.rel=bJ(d);return d},bL=a._pathToAbsolute=function(b){var c=bz(b);if(c.abs)return bJ(c.abs);if(!a.is(b,E)||!a.is(b&&b[0],E))b=a.parsePathString(b);if(!b||!b.length)return[["M",0,0]];var d=[],e=0,f=0,g=0,h=0,i=0;b[0][0]=="M"&&(e=+b[0][1],f=+b[0][2],g=e,h=f,i++,d[0]=["M",e,f]);var j=b.length==3&&b[0][0]=="M"&&b[1][0].toUpperCase()=="R"&&b[2][0].toUpperCase()=="Z";for(var k,l,m=i,o=b.length;m<o;m++){d.push(k=[]),l=b[m];if(l[0]!=S.call(l[0])){k[0]=S.call(l[0]);switch(k[0]){case"A":k[1]=l[1],k[2]=l[2],k[3]=l[3],k[4]=l[4],k[5]=l[5],k[6]=+(l[6]+e),k[7]=+(l[7]+f);break;case"V":k[1]=+l[1]+f;break;case"H":k[1]=+l[1]+e;break;case"R":var p=[e,f][n](l.slice(1));for(var q=2,r=p.length;q<r;q++)p[q]=+p[q]+e,p[++q]=+p[q]+f;d.pop(),d=d[n](by(p,j));break;case"M":g=+l[1]+e,h=+l[2]+f;default:for(q=1,r=l.length;q<r;q++)k[q]=+l[q]+(q%2?e:f)}}else if(l[0]=="R")p=[e,f][n](l.slice(1)),d.pop(),d=d[n](by(p,j)),k=["R"][n](l.slice(-2));else for(var s=0,t=l.length;s<t;s++)k[s]=l[s];switch(k[0]){case"Z":e=g,f=h;break;case"H":e=k[1];break;case"V":f=k[1];break;case"M":g=k[k.length-2],h=k[k.length-1];default:e=k[k.length-2],f=k[k.length-1]}}d.toString=a._path2string,c.abs=bJ(d);return d},bM=function(a,b,c,d){return[a,b,c,d,c,d]},bN=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},bO=function(a,b,c,d,e,f,g,h,i,j){var k=B*120/180,l=B/180*(+e||0),m=[],o,p=bv(function(a,b,c){var d=a*w.cos(c)-b*w.sin(c),e=a*w.sin(c)+b*w.cos(c);return{x:d,y:e}});if(!j){o=p(a,b,-l),a=o.x,b=o.y,o=p(h,i,-l),h=o.x,i=o.y;var q=w.cos(B/180*e),r=w.sin(B/180*e),t=(a-h)/2,u=(b-i)/2,v=t*t/(c*c)+u*u/(d*d);v>1&&(v=w.sqrt(v),c=v*c,d=v*d);var x=c*c,y=d*d,A=(f==g?-1:1)*w.sqrt(z((x*y-x*u*u-y*t*t)/(x*u*u+y*t*t))),C=A*c*u/d+(a+h)/2,D=A*-d*t/c+(b+i)/2,E=w.asin(((b-D)/d).toFixed(9)),F=w.asin(((i-D)/d).toFixed(9));E=a<C?B-E:E,F=h<C?B-F:F,E<0&&(E=B*2+E),F<0&&(F=B*2+F),g&&E>F&&(E=E-B*2),!g&&F>E&&(F=F-B*2)}else E=j[0],F=j[1],C=j[2],D=j[3];var G=F-E;if(z(G)>k){var H=F,I=h,J=i;F=E+k*(g&&F>E?1:-1),h=C+c*w.cos(F),i=D+d*w.sin(F),m=bO(h,i,c,d,e,0,g,I,J,[F,H,C,D])}G=F-E;var K=w.cos(E),L=w.sin(E),M=w.cos(F),N=w.sin(F),O=w.tan(G/4),P=4/3*c*O,Q=4/3*d*O,R=[a,b],S=[a+P*L,b-Q*K],T=[h+P*N,i-Q*M],U=[h,i];S[0]=2*R[0]-S[0],S[1]=2*R[1]-S[1];if(j)return[S,T,U][n](m);m=[S,T,U][n](m).join()[s](",");var V=[];for(var W=0,X=m.length;W<X;W++)V[W]=W%2?p(m[W-1],m[W],l).y:p(m[W],m[W+1],l).x;return V},bP=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:A(j,3)*a+A(j,2)*3*i*c+j*3*i*i*e+A(i,3)*g,y:A(j,3)*b+A(j,2)*3*i*d+j*3*i*i*f+A(i,3)*h}},bQ=bv(function(a,b,c,d,e,f,g,h){var i=e-2*c+a-(g-2*e+c),j=2*(c-a)-2*(e-c),k=a-c,l=(-j+w.sqrt(j*j-4*i*k))/2/i,n=(-j-w.sqrt(j*j-4*i*k))/2/i,o=[b,h],p=[a,g],q;z(l)>"1e12"&&(l=.5),z(n)>"1e12"&&(n=.5),l>0&&l<1&&(q=bP(a,b,c,d,e,f,g,h,l),p.push(q.x),o.push(q.y)),n>0&&n<1&&(q=bP(a,b,c,d,e,f,g,h,n),p.push(q.x),o.push(q.y)),i=f-2*d+b-(h-2*f+d),j=2*(d-b)-2*(f-d),k=b-d,l=(-j+w.sqrt(j*j-4*i*k))/2/i,n=(-j-w.sqrt(j*j-4*i*k))/2/i,z(l)>"1e12"&&(l=.5),z(n)>"1e12"&&(n=.5),l>0&&l<1&&(q=bP(a,b,c,d,e,f,g,h,l),p.push(q.x),o.push(q.y)),n>0&&n<1&&(q=bP(a,b,c,d,e,f,g,h,n),p.push(q.x),o.push(q.y));return{min:{x:y[m](0,p),y:y[m](0,o)},max:{x:x[m](0,p),y:x[m](0,o)}}}),bR=a._path2curve=bv(function(a,b){var c=!b&&bz(a);if(!b&&c.curve)return bJ(c.curve);var d=bL(a),e=b&&bL(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=function(a,b){var c,d;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null);switch(a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"][n](bO[m](0,[b.x,b.y][n](a.slice(1))));break;case"S":c=b.x+(b.x-(b.bx||b.x)),d=b.y+(b.y-(b.by||b.y)),a=["C",c,d][n](a.slice(1));break;case"T":b.qx=b.x+(b.x-(b.qx||b.x)),b.qy=b.y+(b.y-(b.qy||b.y)),a=["C"][n](bN(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"][n](bN(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][n](bM(b.x,b.y,a[1],a[2]));break;case"H":a=["C"][n](bM(b.x,b.y,a[1],b.y));break;case"V":a=["C"][n](bM(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"][n](bM(b.x,b.y,b.X,b.Y))}return a},i=function(a,b){if(a[b].length>7){a[b].shift();var c=a[b];while(c.length)a.splice(b++,0,["C"][n](c.splice(0,6)));a.splice(b,1),l=x(d.length,e&&e.length||0)}},j=function(a,b,c,f,g){a&&b&&a[g][0]=="M"&&b[g][0]!="M"&&(b.splice(g,0,["M",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=x(d.length,e&&e.length||0))};for(var k=0,l=x(d.length,e&&e.length||0);k<l;k++){d[k]=h(d[k],f),i(d,k),e&&(e[k]=h(e[k],g)),e&&i(e,k),j(d,e,f,g,k),j(e,d,g,f,k);var o=d[k],p=e&&e[k],q=o.length,r=e&&p.length;f.x=o[q-2],f.y=o[q-1],f.bx=Q(o[q-4])||f.x,f.by=Q(o[q-3])||f.y,g.bx=e&&(Q(p[r-4])||g.x),g.by=e&&(Q(p[r-3])||g.y),g.x=e&&p[r-2],g.y=e&&p[r-1]}e||(c.curve=bJ(d));return e?[d,e]:d},null,bJ),bS=a._parseDots=bv(function(b){var c=[];for(var d=0,e=b.length;d<e;d++){var f={},g=b[d].match(/^([^:]*):?([\d\.]*)/);f.color=a.getRGB(g[1]);if(f.color.error)return null;f.color=f.color.hex,g[2]&&(f.offset=g[2]+"%"),c.push(f)}for(d=1,e=c.length-1;d<e;d++)if(!c[d].offset){var h=Q(c[d-1].offset||0),i=0;for(var j=d+1;j<e;j++)if(c[j].offset){i=c[j].offset;break}i||(i=100,j=e),i=Q(i);var k=(i-h)/(j-d+1);for(;d<j;d++)h+=k,c[d].offset=h+"%"}return c}),bT=a._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)},bU=a._tofront=function(a,b){b.top!==a&&(bT(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},bV=a._toback=function(a,b){b.bottom!==a&&(bT(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},bW=a._insertafter=function(a,b,c){bT(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},bX=a._insertbefore=function(a,b,c){bT(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},bY=a.toMatrix=function(a,b){var c=bI(a),d={_:{transform:p},getBBox:function(){return c}};b$(d,b);return d.matrix},bZ=a.transformPath=function(a,b){return bj(a,bY(a,b))},b$=a._extractTransform=function(b,c){if(c==null)return b._.transform;c=r(c).replace(/\.{3}|\u2026/g,b._.transform||p);var d=a.parseTransformString(c),e=0,f=0,g=0,h=1,i=1,j=b._,k=new cb;j.transform=d||[];if(d)for(var l=0,m=d.length;l<m;l++){var n=d[l],o=n.length,q=r(n[0]).toLowerCase(),s=n[0]!=q,t=s?k.invert():0,u,v,w,x,y;q=="t"&&o==3?s?(u=t.x(0,0),v=t.y(0,0),w=t.x(n[1],n[2]),x=t.y(n[1],n[2]),k.translate(w-u,x-v)):k.translate(n[1],n[2]):q=="r"?o==2?(y=y||b.getBBox(1),k.rotate(n[1],y.x+y.width/2,y.y+y.height/2),e+=n[1]):o==4&&(s?(w=t.x(n[2],n[3]),x=t.y(n[2],n[3]),k.rotate(n[1],w,x)):k.rotate(n[1],n[2],n[3]),e+=n[1]):q=="s"?o==2||o==3?(y=y||b.getBBox(1),k.scale(n[1],n[o-1],y.x+y.width/2,y.y+y.height/2),h*=n[1],i*=n[o-1]):o==5&&(s?(w=t.x(n[3],n[4]),x=t.y(n[3],n[4]),k.scale(n[1],n[2],w,x)):k.scale(n[1],n[2],n[3],n[4]),h*=n[1],i*=n[2]):q=="m"&&o==7&&k.add(n[1],n[2],n[3],n[4],n[5],n[6]),j.dirtyT=1,b.matrix=k}b.matrix=k,j.sx=h,j.sy=i,j.deg=e,j.dx=f=k.e,j.dy=g=k.f,h==1&&i==1&&!e&&j.bbox?(j.bbox.x+=+f,j.bbox.y+=+g):j.dirtyT=1},b_=function(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return a.length==4?[b,0,a[2],a[3]]:[b,0];case"s":return a.length==5?[b,1,1,a[3],a[4]]:a.length==3?[b,1,1]:[b,1]}},ca=a._equaliseTransform=function(b,c){c=r(c).replace(/\.{3}|\u2026/g,b),b=a.parseTransformString(b)||[],c=a.parseTransformString(c)||[];var d=x(b.length,c.length),e=[],f=[],g=0,h,i,j,k;for(;g<d;g++){j=b[g]||b_(c[g]),k=c[g]||b_(j);if(j[0]!=k[0]||j[0].toLowerCase()=="r"&&(j[2]!=k[2]||j[3]!=k[3])||j[0].toLowerCase()=="s"&&(j[3]!=k[3]||j[4]!=k[4]))return;e[g]=[],f[g]=[];for(h=0,i=x(j.length,k.length);h<i;h++)h in j&&(e[g][h]=j[h]),h in k&&(f[g][h]=k[h])}return{from:e,to:f}};a._getContainer=function(b,c,d,e){var f;f=e==null&&!a.is(b,"object")?h.doc.getElementById(b):b;if(f!=null){if(f.tagName)return c==null?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:c,height:d};return{container:1,x:b,y:c,width:d,height:e}}},a.pathToRelative=bK,a._engine={},a.path2curve=bR,a.matrix=function(a,b,c,d,e,f){return new cb(a,b,c,d,e,f)},function(b){function d(a){var b=w.sqrt(c(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}function c(a){return a[0]*a[0]+a[1]*a[1]}b.add=function(a,b,c,d,e,f){var g=[[],[],[]],h=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],i=[[a,c,e],[b,d,f],[0,0,1]],j,k,l,m;a&&a instanceof cb&&(i=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]);for(j=0;j<3;j++)for(k=0;k<3;k++){m=0;for(l=0;l<3;l++)m+=h[j][l]*i[l][k];g[j][k]=m}this.a=g[0][0],this.b=g[1][0],this.c=g[0][1],this.d=g[1][1],this.e=g[0][2],this.f=g[1][2]},b.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new cb(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},b.clone=function(){return new cb(this.a,this.b,this.c,this.d,this.e,this.f)},b.translate=function(a,b){this.add(1,0,0,1,a,b)},b.scale=function(a,b,c,d){b==null&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},b.rotate=function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var e=+w.cos(b).toFixed(9),f=+w.sin(b).toFixed(9);this.add(e,f,-f,e,c,d),this.add(1,0,0,1,-c,-d)},b.x=function(a,b){return a*this.a+b*this.c+this.e},b.y=function(a,b){return a*this.b+b*this.d+this.f},b.get=function(a){return+this[r.fromCharCode(97+a)].toFixed(4)},b.toString=function(){return a.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},b.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},b.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},b.split=function(){var b={};b.dx=this.e,b.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];b.scalex=w.sqrt(c(e[0])),d(e[0]),b.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*b.shear,e[1][1]-e[0][1]*b.shear],b.scaley=w.sqrt(c(e[1])),d(e[1]),b.shear/=b.scaley;var f=-e[0][1],g=e[1][1];g<0?(b.rotate=a.deg(w.acos(g)),f<0&&(b.rotate=360-b.rotate)):b.rotate=a.deg(w.asin(f)),b.isSimple=!+b.shear.toFixed(9)&&(b.scalex.toFixed(9)==b.scaley.toFixed(9)||!b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate;return b},b.toTransformString=function(a){var b=a||this[s]();if(b.isSimple){b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4);return(b.dx||b.dy?"t"+[b.dx,b.dy]:p)+(b.scalex!=1||b.scaley!=1?"s"+[b.scalex,b.scaley,0,0]:p)+(b.rotate?"r"+[b.rotate,0,0]:p)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(cb.prototype);var cc=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(cc&&cc[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&cc&&cc[1]<8?k.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:k.safari=be;var cd=function(){this.returnValue=!1},ce=function(){return this.originalEvent.preventDefault()},cf=function(){this.cancelBubble=!0},cg=function(){return this.originalEvent.stopPropagation()},ch=function(){if(h.doc.addEventListener)return function(a,b,c,d){var e=o&&u[b]?u[b]:b,f=function(e){var f=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,i=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,j=e.clientX+i,k=e.clientY+f;if(o&&u[g](b))for(var l=0,m=e.targetTouches&&e.targetTouches.length;l<m;l++)if(e.targetTouches[l].target==a){var n=e;e=e.targetTouches[l],e.originalEvent=n,e.preventDefault=ce,e.stopPropagation=cg;break}return c.call(d,e,j,k)};a.addEventListener(e,f,!1);return function(){a.removeEventListener(e,f,!1);return!0}};if(h.doc.attachEvent)return function(a,b,c,d){var e=function(a){a=a||h.win.event;var b=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,e=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;a.preventDefault=a.preventDefault||cd,a.stopPropagation=a.stopPropagation||cf;return c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){a.detachEvent("on"+b,e);return!0};return f}}(),ci=[],cj=function(a){var b=a.clientX,c=a.clientY,d=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,e=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,f,g=ci.length;while(g--){f=ci[g];if(o){var i=a.touches.length,j;while(i--){j=a.touches[i];if(j.identifier==f.el._drag.id){b=j.clientX,c=j.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else a.preventDefault();var k=f.el.node,l,m=k.nextSibling,n=k.parentNode,p=k.style.display;h.win.opera&&n.removeChild(k),k.style.display="none",l=f.el.paper.getElementByPoint(b,c),k.style.display=p,h.win.opera&&(m?n.insertBefore(k,m):n.appendChild(k)),l&&eve("raphael.drag.over."+f.el.id,f.el,l),b+=e,c+=d,eve("raphael.drag.move."+f.el.id,f.move_scope||f.el,b-f.el._drag.x,c-f.el._drag.y,b,c,a)}},ck=function(b){a.unmousemove(cj).unmouseup(ck);var c=ci.length,d;while(c--)d=ci[c],d.el._drag={},eve("raphael.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,b);ci=[]},cl=a.el={};for(var cm=t.length;cm--;)(function(b){a[b]=cl[b]=function(c,d){a.is(c,"function")&&(this.events=this.events||[],this.events.push({name:b,f:c,unbind:ch(this.shape||this.node||h.doc,b,c,d||this)}));return this},a["un"+b]=cl["un"+b]=function(a){var c=this.events||[],d=c.length;while(d--)if(c[d].name==b&&c[d].f==a){c[d].unbind(),c.splice(d,1),!c.length&&delete this.events;return this}return this}})(t[cm]);cl.data=function(b,c){var d=bb[this.id]=bb[this.id]||{};if(arguments.length==1){if(a.is(b,"object")){for(var e in b)b[g](e)&&this.data(e,b[e]);return this}eve("raphael.data.get."+this.id,this,d[b],b);return d[b]}d[b]=c,eve("raphael.data.set."+this.id,this,c,b);return this},cl.removeData=function(a){a==null?bb[this.id]={}:bb[this.id]&&delete bb[this.id][a];return this},cl.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},cl.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var cn=[];cl.drag=function(b,c,d,e,f,g){function i(i){(i.originalEvent||i).preventDefault();var j=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,k=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft;this._drag.x=i.clientX+k,this._drag.y=i.clientY+j,this._drag.id=i.identifier,!ci.length&&a.mousemove(cj).mouseup(ck),ci.push({el:this,move_scope:e,start_scope:f,end_scope:g}),c&&eve.on("raphael.drag.start."+this.id,c),b&&eve.on("raphael.drag.move."+this.id,b),d&&eve.on("raphael.drag.end."+this.id,d),eve("raphael.drag.start."+this.id,f||e||this,i.clientX+k,i.clientY+j,i)}this._drag={},cn.push({el:this,start:i}),this.mousedown(i);return this},cl.onDragOver=function(a){a?eve.on("raphael.drag.over."+this.id,a):eve.unbind("raphael.drag.over."+this.id)},cl.undrag=function(){var b=cn.length;while(b--)cn[b].el==this&&(this.unmousedown(cn[b].start),cn.splice(b,1),eve.unbind("raphael.drag.*."+this.id));!cn.length&&a.unmousemove(cj).unmouseup(ck)},k.circle=function(b,c,d){var e=a._engine.circle(this,b||0,c||0,d||0);this.__set__&&this.__set__.push(e);return e},k.rect=function(b,c,d,e,f){var g=a._engine.rect(this,b||0,c||0,d||0,e||0,f||0);this.__set__&&this.__set__.push(g);return g},k.ellipse=function(b,c,d,e){var f=a._engine.ellipse(this,b||0,c||0,d||0,e||0);this.__set__&&this.__set__.push(f);return f},k.path=function(b){b&&!a.is(b,D)&&!a.is(b[0],E)&&(b+=p);var c=a._engine.path(a.format[m](a,arguments),this);this.__set__&&this.__set__.push(c);return c},k.image=function(b,c,d,e,f){var g=a._engine.image(this,b||"about:blank",c||0,d||0,e||0,f||0);this.__set__&&this.__set__.push(g);return g},k.text=function(b,c,d){var e=a._engine.text(this,b||0,c||0,r(d));this.__set__&&this.__set__.push(e);return e},k.set=function(b){!a.is(b,"array")&&(b=Array.prototype.splice.call(arguments,0,arguments.length));var c=new cG(b);this.__set__&&this.__set__.push(c);return c},k.setStart=function(a){this.__set__=a||this.set()},k.setFinish=function(a){var b=this.__set__;delete this.__set__;return b},k.setSize=function(b,c){return a._engine.setSize.call(this,b,c)},k.setViewBox=function(b,c,d,e,f){return a._engine.setViewBox.call(this,b,c,d,e,f)},k.top=k.bottom=null,k.raphael=a;var co=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,i=b.top+(h.win.pageYOffset||e.scrollTop||d.scrollTop)-f,j=b.left+(h.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:i,x:j}};k.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=h.doc.elementFromPoint(a,b);if(h.win.opera&&e.tagName=="svg"){var f=co(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var i=d.getIntersectionList(g,null);i.length&&(e=i[i.length-1])}if(!e)return null;while(e.parentNode&&e!=d.parentNode&&!e.raphael)e=e.parentNode;e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null;return e},k.getById=function(a){var b=this.bottom;while(b){if(b.id==a)return b;b=b.next}return null},k.forEach=function(a,b){var c=this.bottom;while(c){if(a.call(b,c)===!1)return this;c=c.next}return this},k.getElementsByPoint=function(a,b){var c=this.set();this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)});return c},cl.isPointInside=function(b,c){var d=this.realPath=this.realPath||bi[this.type](this);return a.isPointInsidePath(d,b,c)},cl.getBBox=function(a){if(this.removed)return{};var b=this._;if(a){if(b.dirty||!b.bboxwt)this.realPath=bi[this.type](this),b.bboxwt=bI(this.realPath),b.bboxwt.toString=cq,b.dirty=0;return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath)b.bboxwt=0,this.realPath=bi[this.type](this);b.bbox=bI(bj(this.realPath,this.matrix)),b.bbox.toString=cq,b.dirty=b.dirtyT=0}return b.bbox},cl.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(a);return a},cl.glow=function(a){if(this.type=="text")return null;a=a||{};var b={width:(a.width||10)+(+this.attr("stroke-width")||1),fill:a.fill||!1,opacity:a.opacity||.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||"#000"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||bi[this.type](this);f=this.matrix?bj(f,this.matrix):f;for(var g=1;g<c+1;g++)e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}));return e.insertBefore(this).translate(b.offsetx,b.offsety)};var cr={},cs=function(b,c,d,e,f,g,h,i,j){return j==null?bB(b,c,d,e,f,g,h,i):a.findDotsAtSegment(b,c,d,e,f,g,h,i,bC(b,c,d,e,f,g,h,i,j))},ct=function(b,c){return function(d,e,f){d=bR(d);var g,h,i,j,k="",l={},m,n=0;for(var o=0,p=d.length;o<p;o++){i=d[o];if(i[0]=="M")g=+i[1],h=+i[2];else{j=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6]);if(n+j>e){if(c&&!l.start){m=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),k+=["C"+m.start.x,m.start.y,m.m.x,m.m.y,m.x,m.y];if(f)return k;l.start=k,k=["M"+m.x,m.y+"C"+m.n.x,m.n.y,m.end.x,m.end.y,i[5],i[6]].join(),n+=j,g=+i[5],h=+i[6];continue}if(!b&&!c){m=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n);return{x:m.x,y:m.y,alpha:m.alpha}}}n+=j,g=+i[5],h=+i[6]}k+=i.shift()+i}l.end=k,m=b?n:c?l:a.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1),m.alpha&&(m={x:m.x,y:m.y,alpha:m.alpha});return m}},cu=ct(1),cv=ct(),cw=ct(0,1);a.getTotalLength=cu,a.getPointAtLength=cv,a.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return cw(a,b).end;var d=cw(a,c,1);return b?cw(d,b).end:d},cl.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return cu(this.attrs.path)}},cl.getPointAtLength=function(a){if(this.type=="path")return cv(this.attrs.path,a)},cl.getSubpath=function(b,c){if(this.type=="path")return a.getSubpath(this.attrs.path,b,c)};var cx=a.easing_formulas={linear:function(a){return a},"<":function(a){return A(a,1.7)},">":function(a){return A(a,.48)},"<>":function(a){var b=.48-a/1.04,c=w.sqrt(.1734+b*b),d=c-b,e=A(z(d),1/3)*(d<0?-1:1),f=-c-b,g=A(z(f),1/3)*(f<0?-1:1),h=e+g+.5;return(1-h)*3*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a=a-1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){if(a==!!a)return a;return A(2,-10*a)*w.sin((a-.075)*2*B/.3)+1},bounce:function(a){var b=7.5625,c=2.75,d;a<1/c?d=b*a*a:a<2/c?(a-=1.5/c,d=b*a*a+.75):a<2.5/c?(a-=2.25/c,d=b*a*a+.9375):(a-=2.625/c,d=b*a*a+.984375);return d}};cx.easeIn=cx["ease-in"]=cx["<"],cx.easeOut=cx["ease-out"]=cx[">"],cx.easeInOut=cx["ease-in-out"]=cx["<>"],cx["back-in"]=cx.backIn,cx["back-out"]=cx.backOut;var cy=[],cz=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,16)},cA=function(){var b=+(new Date),c=0;for(;c<cy.length;c++){var d=cy[c];if(d.el.removed||d.paused)continue;var e=b-d.start,f=d.ms,h=d.easing,i=d.from,j=d.diff,k=d.to,l=d.t,m=d.el,o={},p,r={},s;d.initstatus?(e=(d.initstatus*d.anim.top-d.prev)/(d.percent-d.prev)*f,d.status=d.initstatus,delete d.initstatus,d.stop&&cy.splice(c--,1)):d.status=(d.prev+(d.percent-d.prev)*(e/f))/d.anim.top;if(e<0)continue;if(e<f){var t=h(e/f);for(var u in i)if(i[g](u)){switch(U[u]){case C:p=+i[u]+t*f*j[u];break;case"colour":p="rgb("+[cB(O(i[u].r+t*f*j[u].r)),cB(O(i[u].g+t*f*j[u].g)),cB(O(i[u].b+t*f*j[u].b))].join(",")+")";break;case"path":p=[];for(var v=0,w=i[u].length;v<w;v++){p[v]=[i[u][v][0]];for(var x=1,y=i[u][v].length;x<y;x++)p[v][x]=+i[u][v][x]+t*f*j[u][v][x];p[v]=p[v].join(q)}p=p.join(q);break;case"transform":if(j[u].real){p=[];for(v=0,w=i[u].length;v<w;v++){p[v]=[i[u][v][0]];for(x=1,y=i[u][v].length;x<y;x++)p[v][x]=i[u][v][x]+t*f*j[u][v][x]}}else{var z=function(a){return+i[u][a]+t*f*j[u][a]};p=[["m",z(0),z(1),z(2),z(3),z(4),z(5)]]}break;case"csv":if(u=="clip-rect"){p=[],v=4;while(v--)p[v]=+i[u][v]+t*f*j[u][v]}break;default:var A=[][n](i[u]);p=[],v=m.paper.customAttributes[u].length;while(v--)p[v]=+A[v]+t*f*j[u][v]}o[u]=p}m.attr(o),function(a,b,c){setTimeout(function(){eve("raphael.anim.frame."+a,b,c)})}(m.id,m,d.anim)}else{(function(b,c,d){setTimeout(function(){eve("raphael.anim.frame."+c.id,c,d),eve("raphael.anim.finish."+c.id,c,d),a.is(b,"function")&&b.call(c)})})(d.callback,m,d.anim),m.attr(k),cy.splice(c--,1);if(d.repeat>1&&!d.next){for(s in k)k[g](s)&&(r[s]=d.totalOrigin[s]);d.el.attr(r),cE(d.anim,d.el,d.anim.percents[0],null,d.totalOrigin,d.repeat-1)}d.next&&!d.stop&&cE(d.anim,d.el,d.next,null,d.totalOrigin,d.repeat)}}a.svg&&m&&m.paper&&m.paper.safari(),cy.length&&cz(cA)},cB=function(a){return a>255?255:a<0?0:a};cl.animateWith=function(b,c,d,e,f,g){var h=this;if(h.removed){g&&g.call(h);return h}var i=d instanceof cD?d:a.animation(d,e,f,g),j,k;cE(i,h,i.percents[0],null,h.attr());for(var l=0,m=cy.length;l<m;l++)if(cy[l].anim==c&&cy[l].el==b){cy[m-1].start=cy[l].start;break}return h},cl.onAnimation=function(a){a?eve.on("raphael.anim.frame."+this.id,a):eve.unbind("raphael.anim.frame."+this.id);return this},cD.prototype.delay=function(a){var b=new cD(this.anim,this.ms);b.times=this.times,b.del=+a||0;return b},cD.prototype.repeat=function(a){var b=new cD(this.anim,this.ms);b.del=this.del,b.times=w.floor(x(a,0))||1;return b},a.animation=function(b,c,d,e){if(b instanceof cD)return b;if(a.is(d,"function")||!d)e=e||d||null,d=null;b=Object(b),c=+c||0;var f={},h,i;for(i in b)b[g](i)&&Q(i)!=i&&Q(i)+"%"!=i&&(h=!0,f[i]=b[i]);if(!h)return new cD(b,c);d&&(f.easing=d),e&&(f.callback=e);return new cD({100:f},c)},cl.animate=function(b,c,d,e){var f=this;if(f.removed){e&&e.call(f);return f}var g=b instanceof cD?b:a.animation(b,c,d,e);cE(g,f,g.percents[0],null,f.attr());return f},cl.setTime=function(a,b){a&&b!=null&&this.status(a,y(b,a.ms)/a.ms);return this},cl.status=function(a,b){var c=[],d=0,e,f;if(b!=null){cE(a,this,-1,y(b,1));return this}e=cy.length;for(;d<e;d++){f=cy[d];if(f.el.id==this.id&&(!a||f.anim==a)){if(a)return f.status;c.push({anim:f.anim,status:f.status})}}if(a)return 0;return c},cl.pause=function(a){for(var b=0;b<cy.length;b++)cy[b].el.id==this.id&&(!a||cy[b].anim==a)&&eve("raphael.anim.pause."+this.id,this,cy[b].anim)!==!1&&(cy[b].paused=!0);return this},cl.resume=function(a){for(var b=0;b<cy.length;b++)if(cy[b].el.id==this.id&&(!a||cy[b].anim==a)){var c=cy[b];eve("raphael.anim.resume."+this.id,this,c.anim)!==!1&&(delete c.paused,this.status(c.anim,c.status))}return this},cl.stop=function(a){for(var b=0;b<cy.length;b++)cy[b].el.id==this.id&&(!a||cy[b].anim==a)&&eve("raphael.anim.stop."+this.id,this,cy[b].anim)!==!1&&cy.splice(b--,1);return this},eve.on("raphael.remove",cF),eve.on("raphael.clear",cF),cl.toString=function(){return"Raphaël’s object"};var cG=function(a){this.items=[],this.length=0,this.type="set";if(a)for(var b=0,c=a.length;b<c;b++)a[b]&&(a[b].constructor==cl.constructor||a[b].constructor==cG)&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},cH=cG.prototype;cH.push=function(){var a,b;for(var c=0,d=arguments.length;c<d;c++)a=arguments[c],a&&(a.constructor==cl.constructor||a.constructor==cG)&&(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},cH.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},cH.forEach=function(a,b){for(var c=0,d=this.items.length;c<d;c++)if(a.call(b,this.items[c],c)===!1)return this;return this};for(var cI in cl)cl[g](cI)&&(cH[cI]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][m](c,b)})}}(cI));cH.attr=function(b,c){if(b&&a.is(b,E)&&a.is(b[0],"object"))for(var d=0,e=b.length;d<e;d++)this.items[d].attr(b[d]);else for(var f=0,g=this.items.length;f<g;f++)this.items[f].attr(b,c);return this},cH.clear=function(){while(this.length)this.pop()},cH.splice=function(a,b,c){a=a<0?x(this.length+a,0):a,b=x(0,y(this.length-a,b));var d=[],e=[],f=[],g;for(g=2;g<arguments.length;g++)f.push(arguments[g]);for(g=0;g<b;g++)e.push(this[a+g]);for(;g<this.length-a;g++)d.push(this[a+g]);var h=f.length;for(g=0;g<h+d.length;g++)this.items[a+g]=this[a+g]=g<h?f[g]:d[g-h];g=this.items.length=this.length-=b-h;while(this[g])delete this[g++];return new cG(e)},cH.exclude=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a){this.splice(b,1);return!0}},cH.animate=function(b,c,d,e){(a.is(d,"function")||!d)&&(e=d||null);var f=this.items.length,g=f,h,i=this,j;if(!f)return this;e&&(j=function(){!--f&&e.call(i)}),d=a.is(d,D)?d:j;var k=a.animation(b,c,d,j);h=this.items[--g].animate(k);while(g--)this.items[g]&&!this.items[g].removed&&this.items[g].animateWith(h,k,k);return this},cH.insertAfter=function(a){var b=this.items.length;while(b--)this.items[b].insertAfter(a);return this},cH.getBBox=function(){var a=[],b=[],c=[],d=[];for(var e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}a=y[m](0,a),b=y[m](0,b),c=x[m](0,c),d=x[m](0,d);return{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}},cH.clone=function(a){a=new cG;for(var b=0,c=this.items.length;b<c;b++)a.push(this.items[b].clone());return a},cH.toString=function(){return"Raphaël‘s set"},a.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"];for(var d in a.face)a.face[g](d)&&(b.face[d]=a.face[d]);this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b];if(!a.svg){b.face["units-per-em"]=R(a.face["units-per-em"],10);for(var e in a.glyphs)if(a.glyphs[g](e)){var f=a.glyphs[e];b.glyphs[e]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"};if(f.k)for(var h in f.k)f[g](h)&&(b.glyphs[e].k[h]=f.k[h])}}return a},k.getFont=function(b,c,d,e){e=e||"normal",d=d||"normal",c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(!!a.fonts){var f=a.fonts[b];if(!f){var h=new RegExp("(^|\\s)"+b.replace(/[^\w\d\s+!~.:_-]/g,p)+"(\\s|$)","i");for(var i in a.fonts)if(a.fonts[g](i)&&h.test(i)){f=a.fonts[i];break}}var j;if(f)for(var k=0,l=f.length;k<l;k++){j=f[k];if(j.face["font-weight"]==c&&(j.face["font-style"]==d||!j.face["font-style"])&&j.face["font-stretch"]==e)break}return j}},k.print=function(b,d,e,f,g,h,i){h=h||"middle",i=x(y(i||0,1),-1);var j=r(e)[s](p),k=0,l=0,m=p,n;a.is(f,e)&&(f=this.getFont(f));if(f){n=(g||16)/f.face["units-per-em"];var o=f.face.bbox[s](c),q=+o[0],t=o[3]-o[1],u=0,v=+o[1]+(h=="baseline"?t+ +f.face.descent:t/2);for(var w=0,z=j.length;w<z;w++){if(j[w]=="\n")k=0,B=0,l=0,u+=t;else{var A=l&&f.glyphs[j[w-1]]||{},B=f.glyphs[j[w]];k+=l?(A.w||f.w)+(A.k&&A.k[j[w]]||0)+f.w*i:0,l=1}B&&B.d&&(m+=a.transformPath(B.d,["t",k*n,u*n,"s",n,n,q,v,"t",(b-q)/n,(d-v)/n]))}}return this.path(m).attr({fill:"#000",stroke:"none"})},k.add=function(b){if(a.is(b,"array")){var c=this.set(),e=0,f=b.length,h;for(;e<f;e++)h=b[e]||{},d[g](h.type)&&c.push(this[h.type]().attr(h))}return c},a.format=function(b,c){var d=a.is(c,E)?[0][n](c):arguments;b&&a.is(b,D)&&d.length-1&&(b=b.replace(e,function(a,b){return d[++b]==null?p:d[b]}));return b||p},a.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),typeof e=="function"&&f&&(e=e()))}),e=(e==null||e==d?a:e)+"";return e};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),a.ninja=function(){i.was?h.win.Raphael=i.is:delete Raphael;return a},a.st=cH,function(b,c,d){function e(){/in/.test(b.readyState)?setTimeout(e,9):a.eve("raphael.DOMload")}b.readyState==null&&b.addEventListener&&(b.addEventListener(c,d=function(){b.removeEventListener(c,d,!1),b.readyState="complete"},!1),b.readyState="loading"),e()}(document,"DOMContentLoaded"),i.was?h.win.Raphael=a:Raphael=a,eve.on("raphael.DOMload",function(){b=!0})}(),window.Raphael.svg&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=a.eve,l="",m=" ",n="http://www.w3.org/1999/xlink",o={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},p={};a.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var q=function(d,e){if(e){typeof d=="string"&&(d=q(d));for(var f in e)e[b](f)&&(f.substring(0,6)=="xlink:"?d.setAttributeNS(n,f.substring(6),c(e[f])):d.setAttribute(f,c(e[f])))}else d=a._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)");return d},r=function(b,e){var j="linear",k=b.id+e,m=.5,n=.5,o=b.node,p=b.paper,r=o.style,s=a._g.doc.getElementById(k);if(!s){e=c(e).replace(a._radial_gradient,function(a,b,c){j="radial";if(b&&c){m=d(b),n=d(c);var e=(n>.5)*2-1;i(m-.5,2)+i(n-.5,2)>.25&&(n=f.sqrt(.25-i(m-.5,2))*e+.5)&&n!=.5&&(n=n.toFixed(5)-1e-5*e)}return l}),e=e.split(/\s*\-\s*/);if(j=="linear"){var t=e.shift();t=-d(t);if(isNaN(t))return null;var u=[0,0,f.cos(a.rad(t)),f.sin(a.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=a._parseDots(e);if(!w)return null;k=k.replace(/[\(\)\s,\xb0#]/g,"_"),b.gradient&&k!=b.gradient.id&&(p.defs.removeChild(b.gradient),delete b.gradient);if(!b.gradient){s=q(j+"Gradient",{id:k}),b.gradient=s,q(s,j=="radial"?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:b.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;x<y;x++)s.appendChild(q("stop",{offset:w[x].offset?w[x].offset:x?"100%":"0%","stop-color":w[x].color||"#fff"}))}}q(o,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1}),r.fill=l,r.opacity=1,r.fillOpacity=1;return 1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},t=function(d,e,f){if(d.type=="path"){var g=c(e).toLowerCase().split("-"),h=d.paper,i=f?"end":"start",j=d.node,k=d.attrs,m=k["stroke-width"],n=g.length,r="classic",s,t,u,v,w,x=3,y=3,z=5;while(n--)switch(g[n]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":r=g[n];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":x=5;break;case"short":x=2}r=="open"?(x+=2,y+=2,z+=2,u=1,v=f?4:1,w={fill:"none",stroke:k.stroke}):(v=u=x/2,w={fill:k.stroke,stroke:"none"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={};if(r!="none"){var A="raphael-marker-"+r,B="raphael-marker-"+i+r+x+y;a._g.doc.getElementById(A)?p[A]++:(h.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:o[r],id:A})),p[A]=1);var C=a._g.doc.getElementById(B),D;C?(p[B]++,D=C.getElementsByTagName("use")[0]):(C=q(q("marker"),{id:B,markerHeight:y,markerWidth:x,orient:"auto",refX:v,refY:y/2}),D=q(q("use"),{"xlink:href":"#"+A,transform:(f?"rotate(180 "+x/2+" "+y/2+") ":l)+"scale("+x/z+","+y/z+")","stroke-width":(1/((x/z+y/z)/2)).toFixed(4)}),C.appendChild(D),h.defs.appendChild(C),p[B]=1),q(D,w);var F=u*(r!="diamond"&&r!="oval");f?(s=d._.arrows.startdx*m||0,t=a.getTotalLength(k.path)-F*m):(s=F*m,t=a.getTotalLength(k.path)-(d._.arrows.enddx*m||0)),w={},w["marker-"+i]="url(#"+B+")";if(t||s)w.d=Raphael.getSubpath(k.path,s,t);q(j,w),d._.arrows[i+"Path"]=A,d._.arrows[i+"Marker"]=B,d._.arrows[i+"dx"]=F,d._.arrows[i+"Type"]=r,d._.arrows[i+"String"]=e}else f?(s=d._.arrows.startdx*m||0,t=a.getTotalLength(k.path)-s):(s=0,t=a.getTotalLength(k.path)-(d._.arrows.enddx*m||0)),d._.arrows[i+"Path"]&&q(j,{d:Raphael.getSubpath(k.path,s,t)}),delete d._.arrows[i+"Path"],delete d._.arrows[i+"Marker"],delete d._.arrows[i+"dx"],delete d._.arrows[i+"Type"],delete d._.arrows[i+"String"];for(w in p)if(p[b](w)&&!p[w]){var G=a._g.doc.getElementById(w);G&&G.parentNode.removeChild(G)}}},u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},v=function(a,b,d){b=u[c(b).toLowerCase()];if(b){var e=a.attrs["stroke-width"]||"1",f={round:e,square:e,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,g=[],h=b.length;while(h--)g[h]=b[h]*e+(h%2?1:-1)*f;q(a.node,{"stroke-dasharray":g.join(",")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility="hidden";for(var o in f)if(f[b](o)){if(!a._availableAttrs[b](o))continue;var p=f[o];k[o]=p;switch(o){case"blur":d.blur(p);break;case"href":case"title":case"target":var u=i.parentNode;if(u.tagName.toLowerCase()!="a"){var w=q("a");u.insertBefore(w,i),w.appendChild(i),u=w}o=="target"?u.setAttributeNS(n,"show",p=="blank"?"new":p):u.setAttributeNS(n,o,p);break;case"cursor":i.style.cursor=p;break;case"transform":d.transform(p);break;case"arrow-start":t(d,p);break;case"arrow-end":t(d,p,1);break;case"clip-rect":var x=c(p).split(j);if(x.length==4){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var z=q("clipPath"),A=q("rect");z.id=a.createUUID(),q(A,{x:x[0],y:x[1],width:x[2],height:x[3]}),z.appendChild(A),d.paper.defs.appendChild(z),q(i,{"clip-path":"url(#"+z.id+")"}),d.clip=A}if(!p){var B=i.getAttribute("clip-path");if(B){var C=a._g.doc.getElementById(B.replace(/(^url\(#|\)$)/g,l));C&&C.parentNode.removeChild(C),q(i,{"clip-path":l}),delete d.clip}}break;case"path":d.type=="path"&&(q(i,{d:p?k.path=a._pathToAbsolute(p):"M0,0"}),d._.dirty=1,d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1)));break;case"width":i.setAttribute(o,p),d._.dirty=1;if(k.fx)o="x",p=k.x;else break;case"x":k.fx&&(p=-k.x-(k.width||0));case"rx":if(o=="rx"&&d.type=="rect")break;case"cx":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"height":i.setAttribute(o,p),d._.dirty=1;if(k.fy)o="y",p=k.y;else break;case"y":k.fy&&(p=-k.y-(k.height||0));case"ry":if(o=="ry"&&d.type=="rect")break;case"cy":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"r":d.type=="rect"?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case"src":d.type=="image"&&i.setAttributeNS(n,"href",p);break;case"stroke-width":if(d._.sx!=1||d._.sy!=1)p/=g(h(d._.sx),h(d._.sy))||1;d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k["stroke-dasharray"]&&v(d,k["stroke-dasharray"],f),d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"stroke-dasharray":v(d,p,f);break;case"fill":var D=c(p).match(a._ISURL);if(D){z=q("pattern");var F=q("image");z.id=a.createUUID(),q(z,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(F,{x:0,y:0,"xlink:href":D[1]}),z.appendChild(F),function(b){a._preload(D[1],function(){var a=this.offsetWidth,c=this.offsetHeight;q(b,{width:a,height:c}),q(F,{width:a,height:c}),d.paper.safari()})}(z),d.paper.defs.appendChild(z),q(i,{fill:"url(#"+z.id+")"}),d.pattern=z,d.pattern&&s(d);break}var G=a.getRGB(p);if(!G.error)delete f.gradient,delete k.gradient,!a.is(k.opacity,"undefined")&&a.is(f.opacity,"undefined")&&q(i,{opacity:k.opacity}),!a.is(k["fill-opacity"],"undefined")&&a.is(f["fill-opacity"],"undefined")&&q(i,{"fill-opacity":k["fill-opacity"]});else if((d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p)){if("opacity"in k||"fill-opacity"in k){var H=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l));if(H){var I=H.getElementsByTagName("stop");q(I[I.length-1],{"stop-opacity":("opacity"in k?k.opacity:1)*("fill-opacity"in k?k["fill-opacity"]:1)})}}k.gradient=p,k.fill="none";break}G[b]("opacity")&&q(i,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case"stroke":G=a.getRGB(p),i.setAttribute(o,G.hex),o=="stroke"&&G[b]("opacity")&&q(i,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity}),o=="stroke"&&d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"gradient":(d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p);break;case"opacity":k.gradient&&!k[b]("stroke-opacity")&&q(i,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(k.gradient){H=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l)),H&&(I=H.getElementsByTagName("stop"),q(I[I.length-1],{"stop-opacity":p}));break};default:o=="font-size"&&(p=e(p,10)+"px");var J=o.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[J]=p,d._.dirty=1,i.setAttribute(o,p)}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if(d.type=="text"&&!!(f[b]("text")||f[b]("font")||f[b]("font-size")||f[b]("x")||f[b]("y"))){var g=d.attrs,h=d.node,i=h.firstChild?e(a._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue("font-size"),10):10;if(f[b]("text")){g.text=f.text;while(h.firstChild)h.removeChild(h.firstChild);var j=c(f.text).split("\n"),k=[],m;for(var n=0,o=j.length;n<o;n++)m=q("tspan"),n&&q(m,{dy:i*x,x:g.x}),m.appendChild(a._g.doc.createTextNode(j[n])),h.appendChild(m),k[n]=m}else{k=h.getElementsByTagName("tspan");for(n=0,o=k.length;n<o;n++)n?q(k[n],{dy:i*x,x:g.x}):q(k[0],{dy:0})}q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&a.is(r,"finite")&&q(k[0],{dy:r})}},z=function(b,c){var d=0,e=0;this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.matrix=a.matrix(),this.realPath=null,this.paper=c,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},A=a.el;z.prototype=A,A.constructor=z,a._engine.path=function(a,b){var c=q("path");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);d.type="path",w(d,{fill:"none",stroke:"#000",path:a});return d},A.rotate=function(a,b,e){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}this.transform(this._.transform.concat([["r",a,b,e]]));return this},A.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]]));return this},A.translate=function(a,b){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this.transform(this._.transform.concat([["t",a,b]]));return this},A.transform=function(c){var d=this._;if(c==null)return d.transform;a._extractTransform(this,c),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix});if(d.sx!=1||d.sy!=1){var e=this.attrs[b]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":e})}return this},A.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},A.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},A.remove=function(){if(!this.removed&&!!this.node.parentNode){var b=this.paper;b.__set__&&b.__set__.exclude(this),k.unbind("raphael.*.*."+this.id),this.gradient&&b.defs.removeChild(this.gradient),a._tear(this,b),this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var c in this)this[c]=typeof this[c]=="function"?a._removedFactory(c):null;this.removed=!0}},A._getBBox=function(){if(this.node.style.display=="none"){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}a&&this.hide();return b},A.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform;return e}if(d==null&&a.is(c,"string")){if(c=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(c=="transform")return this._.transform;var g=c.split(j),h={};for(var i=0,l=g.length;i<l;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return l-1?h:h[g[0]]}if(d==null&&a.is(c,"array")){h={};for(i=0,l=c.length;i<l;i++)h[c[i]]=this.attr(c[i]);return h}if(d!=null){var m={};m[c]=d}else c!=null&&a.is(c,"object")&&(m=c);for(var n in m)k("raphael.attr."+n+"."+this.id,this,m[n]);for(n in this.paper.customAttributes)if(this.paper.customAttributes[b](n)&&m[b](n)&&a.is(this.paper.customAttributes[n],"function")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o)o[b](p)&&(m[p]=o[p])}w(this,m);return this},A.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var b=this.paper;b.top!=this&&a._tofront(this,b);return this},A.toBack=function(){if(this.removed)return this;var b=this.node.parentNode;b.tagName.toLowerCase()=="a"?b.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):b.firstChild!=this.node&&b.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper);var c=this.paper;return this},A.insertAfter=function(b){if(this.removed)return this;var c=b.node||b[b.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper);return this},A.insertBefore=function(b){if(this.removed)return this;var c=b.node||b[0].node;c.parentNode.insertBefore(this.node,c),a._insertbefore(this,b,this.paper);return this},A.blur=function(b){var c=this;if(+b!==0){var d=q("filter"),e=q("feGaussianBlur");c.attrs.blur=b,d.id=a.createUUID(),q(e,{stdDeviation:+b||1.5}),d.appendChild(e),c.paper.defs.appendChild(d),c._blur=d,q(c.node,{filter:"url(#"+d.id+")"})}else c._blur&&(c._blur.parentNode.removeChild(c._blur),delete c._blur,delete c.attrs.blur),c.node.removeAttribute("filter")},a._engine.circle=function(a,b,c,d){var e=q("circle");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);f.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"},f.type="circle",q(e,f.attrs);return f},a._engine.rect=function(a,b,c,d,e,f){var g=q("rect");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",q(g,h.attrs);return h},a._engine.ellipse=function(a,b,c,d,e){var f=q("ellipse");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);g.attrs={cx:b,cy:c,rx:d,ry:e,fill:"none",stroke:"#000"},g.type="ellipse",q(f,g.attrs);return g},a._engine.image=function(a,b,c,d,e,f){var g=q("image");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:"none"}),g.setAttributeNS(n,"href",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);h.attrs={x:c,y:d,width:e,height:f,src:b},h.type="image";return h},a._engine.text=function(b,c,d,e){var f=q("text");b.canvas&&b.canvas.appendChild(f);var g=new z(f,b);g.attrs={x:c,y:d,"text-anchor":"middle",text:e,font:a._availableAttrs.font,stroke:"none",fill:"#000"},g.type="text",w(g,g.attrs);return g},a._engine.setSize=function(a,b){this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b&&b.container,d=b.x,e=b.y,f=b.width,g=b.height;if(!c)throw new Error("SVG container not found.");var h=q("svg"),i="overflow:hidden;",j;d=d||0,e=e||0,f=f||512,g=g||342,q(h,{height:g,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),c==1?(h.style.cssText=i+"position:absolute;left:"+d+"px;top:"+e+"px",a._g.doc.body.appendChild(h),j=1):(h.style.cssText=i+"position:relative",c.firstChild?c.insertBefore(h,c.firstChild):c.appendChild(h)),c=new a._Paper,c.width=f,c.height=g,c.canvas=h,c.clear(),c._left=c._top=0,j&&(c.renderfix=function(){}),c.renderfix();return c},a._engine.setViewBox=function(a,b,c,d,e){k("raphael.setViewBox",this,this._viewBox,[a,b,c,d,e]);var f=g(c/this.width,d/this.height),h=this.top,i=e?"meet":"xMinYMin",j,l;a==null?(this._vbSize&&(f=1),delete this._vbSize,j="0 0 "+this.width+m+this.height):(this._vbSize=f,j=a+m+b+m+c+m+d),q(this.canvas,{viewBox:j,preserveAspectRatio:i});while(f&&h)l="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":l}),h._.dirty=1,h._.dirtyT=1,h=h.prev;this._viewBox=[a,b,c,d,!!e];return this},a.prototype.renderfix=function(){var a=this.canvas,b=a.style,c;try{c=a.getScreenCTM()||a.createSVGMatrix()}catch(d){c=a.createSVGMatrix()}var e=-c.e%1,f=-c.f%1;if(e||f)e&&(this._left=(this._left+e)%1,b.left=this._left+"px"),f&&(this._top=(this._top+f)%1,b.top=this._top+"px")},a.prototype.clear=function(){a.eve("raphael.clear",this);var b=this.canvas;while(b.firstChild)b.removeChild(b.firstChild);this.bottom=this.top=null,(this.desc=q("desc")).appendChild(a._g.doc.createTextNode("Created with Raphaël "+a.version)),b.appendChild(this.desc),b.appendChild(this.defs=q("defs"))},a.prototype.remove=function(){k("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null};var B=a.st;for(var C in A)A[b](C)&&!B[b](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}(window.Raphael),window.Raphael.vml&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j="fill",k=/[, ]+/,l=a.eve,m=" progid:DXImageTransform.Microsoft",n=" ",o="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\S+Blur\([^\)]+\)/g,s=/-?[^,\s-]+/g,t="position:absolute;left:0;top:0;width:1px;height:1px",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(b){var d=/[ahqstv]/ig,e=a._pathToAbsolute;c(b).match(d)&&(e=a._path2curve),d=/[clmz]/g;if(e==a._pathToAbsolute&&!c(b).match(d)){var g=c(b).replace(q,function(a,b,c){var d=[],e=b.toLowerCase()=="m",g=p[b];c.replace(s,function(a){e&&d.length==2&&(g+=d+p[b=="m"?"l":"L"],d=[]),d.push(f(a*u))});return g+d});return g}var h=e(b),i,j;g=[];for(var k=0,l=h.length;k<l;k++){i=h[k],j=h[k][0].toLowerCase(),j=="z"&&(j="x");for(var m=1,r=i.length;m<r;m++)j+=f(i[m]*u)+(m!=r-1?",":o);g.push(j)}return g.join(n)},y=function(b,c,d){var e=a.matrix();e.rotate(-b,.5,.5);return{dx:e.x(c,d),dy:e.y(c,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p="",q,r=u/b,s=u/c;m.visibility="hidden";if(!!b&&!!c){l.coordsize=i(r)+n+i(s),m.rotation=f*(b*c<0?-1:1);if(f){var t=y(f,d,e);d=t.dx,e=t.dy}b<0&&(p+="x"),c<0&&(p+=" y")&&(o=-1),m.flip=p,l.coordorigin=d*-r+n+e*-s;if(k||g.fillsize){var v=l.getElementsByTagName(j);v=v&&v[0],l.removeChild(v),k&&(t=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),v.position=t.dx*o+n+t.dy*o),g.fillsize&&(v.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(v)}m.visibility="visible"}};a.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var A=function(a,b,d){var e=c(b).toLowerCase().split("-"),f=d?"end":"start",g=e.length,h="classic",i="medium",j="medium";while(g--)switch(e[g]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":h=e[g];break;case"wide":case"narrow":j=e[g];break;case"long":case"short":i=e[g]}var k=a.node.getElementsByTagName("stroke")[0];k[f+"arrow"]=h,k[f+"arrowlength"]=i,k[f+"arrowwidth"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q,r=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),s=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),t=e;for(var y in i)i[b](y)&&(m[y]=i[y]);r&&(m.path=a._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),"blur"in i&&e.blur(i.blur);if(i.path&&e.type=="path"||r)l.path=x(~c(m.path).toLowerCase().indexOf("r")?a._pathToAbsolute(m.path):m.path),e.type=="image"&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0));"transform"in i&&e.transform(i.transform);if(s){var B=+m.cx,D=+m.cy,E=+m.rx||+m.r||0,G=+m.ry||+m.r||0;l.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f((B-E)*u),f((D-G)*u),f((B+E)*u),f((D+G)*u),f(B*u))}if("clip-rect"in i){var H=c(i["clip-rect"]).split(k);if(H.length==4){H[2]=+H[2]+ +H[0],H[3]=+H[3]+ +H[1];var I=l.clipRect||a._g.doc.createElement("div"),J=I.style;J.clip=a.format("rect({1}px {2}px {3}px {0}px)",H),l.clipRect||(J.position="absolute",J.top=0,J.left=0,J.width=e.paper.width+"px",J.height=e.paper.height+"px",l.parentNode.insertBefore(I,l),I.appendChild(l),l.clipRect=I)}i["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto")}if(e.textpath){var K=e.textpath.style;i.font&&(K.font=i.font),i["font-family"]&&(K.fontFamily='"'+i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,o)+'"'),i["font-size"]&&(K.fontSize=i["font-size"]),i["font-weight"]&&(K.fontWeight=i["font-weight"]),i["font-style"]&&(K.fontStyle=i["font-style"])}"arrow-start"in i&&A(t,i["arrow-start"]),"arrow-end"in i&&A(t,i["arrow-end"],1);if(i.opacity!=null||i["stroke-width"]!=null||i.fill!=null||i.src!=null||i.stroke!=null||i["stroke-width"]!=null||i["stroke-opacity"]!=null||i["fill-opacity"]!=null||i["stroke-dasharray"]!=null||i["stroke-miterlimit"]!=null||i["stroke-linejoin"]!=null||i["stroke-linecap"]!=null){var L=l.getElementsByTagName(j),M=!1;L=L&&L[0],!L&&(M=L=F(j)),e.type=="image"&&i.src&&(L.src=i.src),i.fill&&(L.on=!0);if(L.on==null||i.fill=="none"||i.fill===null)L.on=!1;if(L.on&&i.fill){var N=c(i.fill).match(a._ISURL);if(N){L.parentNode==l&&l.removeChild(L),L.rotate=!0,L.src=N[1],L.type="tile";var O=e.getBBox(1);L.position=O.x+n+O.y,e._.fillpos=[O.x,O.y],a._preload(N[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else L.color=a.getRGB(i.fill).hex,L.src=o,L.type="solid",a.getRGB(i.fill).error&&(t.type in{circle:1,ellipse:1}||c(i.fill).charAt()!="r")&&C(t,i.fill,L)&&(m.fill="none",m.gradient=i.fill,L.rotate=!1)}if("fill-opacity"in i||"opacity"in i){var P=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+a.getRGB(i.fill).o+1||2)-1);P=h(g(P,0),1),L.opacity=P,L.src&&(L.color="none")}l.appendChild(L);var Q=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],T=!1;!Q&&(T=Q=F("stroke"));if(i.stroke&&i.stroke!="none"||i["stroke-width"]||i["stroke-opacity"]!=null||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])Q.on=!0;(i.stroke=="none"||i.stroke===null||Q.on==null||i.stroke==0||i["stroke-width"]==0)&&(Q.on=!1);var U=a.getRGB(i.stroke);Q.on&&i.stroke&&(Q.color=U.hex),P=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+U.o+1||2)-1);var V=(d(i["stroke-width"])||1)*.75;P=h(g(P,0),1),i["stroke-width"]==null&&(V=m["stroke-width"]),i["stroke-width"]&&(Q.weight=V),V&&V<1&&(P*=V)&&(Q.weight=1),Q.opacity=P,i["stroke-linejoin"]&&(Q.joinstyle=i["stroke-linejoin"]||"miter"),Q.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(Q.endcap=i["stroke-linecap"]=="butt"?"flat":i["stroke-linecap"]=="square"?"square":"round");if(i["stroke-dasharray"]){var W={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};Q.dashstyle=W[b](i["stroke-dasharray"])?W[i["stroke-dasharray"]]:o}T&&l.appendChild(Q)}if(t.type=="text"){t.paper.canvas.style.display=o;var X=t.paper.span,Y=100,Z=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);p=X.style,m.font&&(p.font=m.font),m["font-family"]&&(p.fontFamily=m["font-family"]),m["font-weight"]&&(p.fontWeight=m["font-weight"]),m["font-style"]&&(p.fontStyle=m["font-style"]),Z=d(m["font-size"]||Z&&Z[0])||10,p.fontSize=Z*Y+"px",t.textpath.string&&(X.innerHTML=c(t.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var $=X.getBoundingClientRect();t.W=m.w=($.right-$.left)/Y,t.H=m.h=($.bottom-$.top)/Y,t.X=m.x,t.Y=m.y+t.H/2,("x"in i||"y"in i)&&(t.path.v=a.format("m{0},{1}l{2},{1}",f(m.x*u),f(m.y*u),f(m.x*u)+1));var _=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var ba=0,bb=_.length;ba<bb;ba++)if(_[ba]in i){t._.dirty=1;break}switch(m["text-anchor"]){case"start":t.textpath.style["v-text-align"]="left",t.bbx=t.W/2;break;case"end":t.textpath.style["v-text-align"]="right",t.bbx=-t.W/2;break;default:t.textpath.style["v-text-align"]="center",t.bbx=0}t.textpath.style["v-text-kern"]=!0}},C=function(b,f,g){b.attrs=b.attrs||{};var h=b.attrs,i=Math.pow,j,k,l="linear",m=".5 .5";b.attrs.gradient=f,f=c(f).replace(a._radial_gradient,function(a,b,c){l="radial",b&&c&&(b=d(b),c=d(c),i(b-.5,2)+i(c-.5,2)>.25&&(c=e.sqrt(.25-i(b-.5,2))*((c>.5)*2-1)+.5),m=b+n+c);return o}),f=f.split(/\s*\-\s*/);if(l=="linear"){var p=f.shift();p=-d(p);if(isNaN(p))return null}var q=a._parseDots(f);if(!q)return null;b=b.shape||b.node;if(q.length){b.removeChild(g),g.on=!0,g.method="none",g.color=q[0].color,g.color2=q[q.length-1].color;var r=[];for(var s=0,t=q.length;s<t;s++)q[s].offset&&r.push(q[s].offset+n+q[s].color);g.colors=r.length?r.join():"0% "+g.color,l=="radial"?(g.type="gradientTitle",g.focus="100%",g.focussize="0 0",g.focusposition=m,g.angle=0):(g.type="gradient",g.angle=(270-p)%360),b.appendChild(g)}return 1},D=function(b,c){this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=c,this.matrix=a.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},E=a.el;D.prototype=E,E.constructor=D,E.transform=function(b){if(b==null)return this._.transform;var d=this.paper._viewBoxShift,e=d?"s"+[d.scale,d.scale]+"-1-1t"+[d.dx,d.dy]:o,f;d&&(f=b=c(b).replace(/\.{3}|\u2026/g,this._.transform||o)),a._extractTransform(this,e+b);var g=this.matrix.clone(),h=this.skew,i=this.node,j,k=~c(this.attrs.fill).indexOf("-"),l=!c(this.attrs.fill).indexOf("url(");g.translate(-0.5,-0.5);if(l||k||this.type=="image"){h.matrix="1 0 0 1",h.offset="0 0",j=g.split();if(k&&j.noRotation||!j.isSimple){i.style.filter=g.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;i.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else i.style.filter=o,z(this,j.scalex,j.scaley,j.dx,j.dy,j.rotate)}else i.style.filter=o,h.matrix=c(g),h.offset=g.offset();f&&(this._.transform=f);return this},E.rotate=function(a,b,e){if(this.removed)return this;if(a!=null){a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",a,b,e]]));return this}},E.translate=function(a,b){if(this.removed)return this;a=c(a).split(k),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=b),this.transform(this._.transform.concat([["t",a,b]]));return this},E.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]])),this._.dirtyT=1;return this},E.hide=function(){!this.removed&&(this.node.style.display="none");return this},E.show=function(){!this.removed&&(this.node.style.display=o);return this},E._getBBox=function(){if(this.removed)return{};return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&!!this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),a.eve.unbind("raphael.*.*."+this.id),a._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;this.removed=!0}},E.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform;return e}if(d==null&&a.is(c,"string")){if(c==j&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;var g=c.split(k),h={};for(var i=0,m=g.length;i<m;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return m-1?h:h[g[0]]}if(this.attrs&&d==null&&a.is(c,"array")){h={};for(i=0,m=c.length;i<m;i++)h[c[i]]=this.attr(c[i]);return h}var n;d!=null&&(n={},n[c]=d),d==null&&a.is(c,"object")&&(n=c);for(var o in n)l("raphael.attr."+o+"."+this.id,this,n[o]);if(n){for(o in this.paper.customAttributes)if(this.paper.customAttributes[b](o)&&n[b](o)&&a.is(this.paper.customAttributes[o],"function")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p)p[b](q)&&(n[q]=p[q])}n.text&&this.type=="text"&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&a._tofront(this,this.paper);return this},E.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper));return this},E.insertAfter=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[b.length-1]),b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper);return this},E.insertBefore=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[0]),b.node.parentNode.insertBefore(this.node,b.node),a._insertbefore(this,b,this.paper);return this},E.blur=function(b){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(r,o),+b!==0?(this.attrs.blur=b,c.filter=d+n+m+".Blur(pixelradius="+(+b||1.5)+")",c.margin=a.format("-{0}px 0 0 -{0}px",f(+b||1.5))):(c.filter=d,c.margin=0,delete this.attrs.blur)},a._engine.path=function(a,b){var c=F("shape");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:"none",stroke:"#000"};a&&(e.path=a),d.type="path",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F("skew");f.on=!0,c.appendChild(f),d.skew=f,d.transform(o);return d},a._engine.rect=function(b,c,d,e,f,g){var h=a._rectPath(c,d,e,f,g),i=b.path(h),j=i.attrs;i.X=j.x=c,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type="rect";return i},a._engine.ellipse=function(a,b,c,d,e){var f=a.path(),g=f.attrs;f.X=b-d,f.Y=c-e,f.W=d*2,f.H=e*2,f.type="ellipse",B(f,{cx:b,cy:c,rx:d,ry:e});return f},a._engine.circle=function(a,b,c,d){var e=a.path(),f=e.attrs;e.X=b-d,e.Y=c-d,e.W=e.H=d*2,e.type="circle",B(e,{cx:b,cy:c,r:d});return e},a._engine.image=function(b,c,d,e,f,g){var h=a._rectPath(d,e,f,g),i=b.path(h).attr({stroke:"none"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];k.src=c,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type="image",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=c,m.type="tile",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0);return i},a._engine.text=function(b,d,e,g){var h=F("shape"),i=F("path"),j=F("textpath");d=d||0,e=e||0,g=g||"",i.v=a.format("m{0},{1}l{2},{1}",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=c(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin="0 0";var k=new D(h,b),l={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type="text",k.attrs.text=c(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),b.canvas.appendChild(h);var m=F("skew");m.on=!0,h.appendChild(m),k.skew=m,k.transform(o);return k},a._engine.setSize=function(b,c){var d=this.canvas.style;this.width=b,this.height=c,b==+b&&(b+="px"),c==+c&&(c+="px"),d.width=b,d.height=c,d.clip="rect(0 "+b+" "+c+" 0)",this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox);return this},a._engine.setViewBox=function(b,c,d,e,f){a.eve("raphael.setViewBox",this,this._viewBox,[b,c,d,e,f]);var h=this.width,i=this.height,j=1/g(d/h,e/i),k,l;f&&(k=i/e,l=h/d,d*k<h&&(b-=(h-d*k)/2/k),e*l<i&&(c-=(i-e*l)/2/l)),this._viewBox=[b,c,d,e,!!f],this._viewBoxShift={dx:-b,dy:-c,scale:j},this.forEach(function(a){a.transform("...")});return this};var F;a._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),F=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){F=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},a._engine.initWin(a._g.win),a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b.container,d=b.height,e,f=b.width,g=b.x,h=b.y;if(!c)throw new Error("VML container not found.");var i=new a._Paper,j=i.canvas=a._g.doc.createElement("div"),k=j.style;g=g||0,h=h||0,f=f||512,d=d||342,i.width=f,i.height=d,f==+f&&(f+="px"),d==+d&&(d+="px"),i.coordsize=u*1e3+n+u*1e3,i.coordorigin="0 0",i.span=a._g.doc.createElement("span"),i.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",j.appendChild(i.span),k.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d),c==1?(a._g.doc.body.appendChild(j),k.left=g+"px",k.top=h+"px",k.position="absolute"):c.firstChild?c.insertBefore(j,c.firstChild):c.appendChild(j),i.renderfix=function(){};return i},a.prototype.clear=function(){a.eve("raphael.clear",this),this.canvas.innerHTML=o,this.span=a._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},a.prototype.remove=function(){a.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;return!0};var G=a.st;for(var H in E)E[b](H)&&!G[b](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}(window.Raphael)

Raphael.fn.arrow = function(x1, y1, x2, y2, size) {
  var angle = Raphael.angle(x1, y1, x2, y2);
  var a45   = Raphael.rad(angle-45);
  var a45m  = Raphael.rad(angle+45);
  var a135  = Raphael.rad(angle-135);
  var a135m = Raphael.rad(angle+135);
  var x1a = x1 + Math.cos(a135) * size;
  var y1a = y1 + Math.sin(a135) * size;
  var x1b = x1 + Math.cos(a135m) * size;
  var y1b = y1 + Math.sin(a135m) * size;
  var x2a = x2 + Math.cos(a45) * size;
  var y2a = y2 + Math.sin(a45) * size;
  var x2b = x2 + Math.cos(a45m) * size;
  var y2b = y2 + Math.sin(a45m) * size;
  return this.path(
    // "M"+x1+" "+y1+"L"+x1a+" "+y1a+
    // "M"+x1+" "+y1+"L"+x1b+" "+y1b+
    "M"+x1+" "+y1+"L"+x2+" "+y2+
    "M"+x2+" "+y2+"L"+x2a+" "+y2a+
    "M"+x2+" "+y2+"L"+x2b+" "+y2b
  );
};/*
 IntegraXor Web SCADA - JavaScript Number Formatter
 http://www.integraxor.com/
 author: KPL, KHL
 (c)2011 ecava
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
'use strict';(function(a,b){function c(a){var b=$a[a]={};return n.each(a.split(Fa),function(a,c){b[c]=!0}),b}function d(a,c,d){if(d===b&&1===a.nodeType)if(d="data-"+c.replace(Ra,"-$1").toLowerCase(),d=a.getAttribute(d),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:ja.test(d)?n.parseJSON(d):d}catch(e){}n.data(a,c,d)}else d=b;return d}function e(a){for(var b in a)if(!("data"===b&&n.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function f(){return!1}function g(){return!0}
function h(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function i(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function j(a,b,c){b=b||0;if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)===c});if(b.nodeType)return n.grep(a,function(a){return a===b===c});if("string"==typeof b){var d=n.grep(a,function(a){return 1===a.nodeType});if(xb.test(b))return n.filter(b,d,!c);b=n.filter(b,d)}return n.grep(a,function(a){return 0<=n.inArray(a,b)===c})}function k(a){var b=pc.split("|"),
a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function l(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e;d=n._data(a);var f=n._data(b,d),g=d.events;if(g)for(c in delete f.handle,f.events={},g){d=0;for(e=g[c].length;d<e;d++)n.event.add(b,c,g[c][d])}f.data&&(f.data=n.extend({},f.data))}}function p(a,b){var c;1===b.nodeType&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),"object"===c?(b.parentNode&&
(b.outerHTML=a.outerHTML),n.support.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&wd.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(n.expando))}function m(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?
a.querySelectorAll("*"):[]}function r(a){wd.test(a.type)&&(a.defaultChecked=a.checked)}function q(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=xd.length;e--;)if(b=xd[e]+c,b in a)return b;return d}function t(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)}function v(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)c=a[f],c.style&&(e[f]=n._data(c,"olddisplay"),b?(!e[f]&&"none"===c.style.display&&(c.style.display=""),""===c.style.display&&t(c)&&
(e[f]=n._data(c,"olddisplay",A(c.nodeName)))):(d=bb(c,"display"),!e[f]&&"none"!==d&&n._data(c,"olddisplay",d)));for(f=0;f<g;f++)if(c=a[f],c.style&&(!b||"none"===c.style.display||""===c.style.display))c.style.display=b?e[f]||"":"none";return a}function w(a,b,c){return(a=Od.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function z(a,b,c,d){for(var b=c===(d?"border":"content")?4:"width"===b?1:0,e=0;4>b;b+=2)"margin"===c&&(e+=n.css(a,c+qc[b],!0)),d?("content"===c&&(e-=parseFloat(bb(a,"padding"+qc[b]))||
0),"margin"!==c&&(e-=parseFloat(bb(a,"border"+qc[b]+"Width"))||0)):(e+=parseFloat(bb(a,"padding"+qc[b]))||0,"padding"!==c&&(e+=parseFloat(bb(a,"border"+qc[b]+"Width"))||0));return e}function x(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e=!0,f=n.support.boxSizing&&"border-box"===n.css(a,"boxSizing");if(0>=d){d=bb(a,b);if(0>d||null==d)d=a.style[b];if(Vc.test(d))return d;e=f&&(n.support.boxSizingReliable||d===a.style[b]);d=parseFloat(d)||0}return d+z(a,b,c||(f?"border":"content"),e)+"px"}
function A(a){if(jd[a])return jd[a];var b=n("<"+a+">").appendTo(P.body),c=b.css("display");b.remove();if("none"===c||""===c){zc=P.body.appendChild(zc||n.extend(P.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ac||!zc.createElement)Ac=(zc.contentWindow||zc.contentDocument).document,Ac.write("<!doctype html><html><body>"),Ac.close();b=Ac.body.appendChild(Ac.createElement(a));c=bb(b,"display");P.body.removeChild(zc)}return jd[a]=c,c}function F(a,b,c,d){var e;if(n.isArray(b))n.each(b,
function(b,e){c||Pd.test(a)?d(a,e):F(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(!c&&"object"===n.type(b))for(e in b)F(a+"["+e+"]",b[e],c,d);else d(a,b)}function C(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e,f=b.toLowerCase().split(Fa),g=0,h=f.length;if(n.isFunction(c))for(;g<h;g++)d=f[g],(e=/^\+/.test(d))&&(d=d.substr(1)||"*"),d=a[d]=a[d]||[],d[e?"unshift":"push"](c)}}function D(a,c,d,e,f,g){f=f||c.dataTypes[0];g=g||{};g[f]=!0;for(var h,f=a[f],i=0,j=f?f.length:0,k=a===
rc;i<j&&(k||!h);i++)h=f[i](c,d,e),"string"==typeof h&&(!k||g[h]?h=b:(c.dataTypes.unshift(h),h=D(a,c,d,e,h,g)));return(k||!h)&&!g["*"]&&(h=D(a,c,d,e,"*",g)),h}function y(a,c){var d,e,f=n.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&n.extend(!0,a,e)}function s(){try{return new a.XMLHttpRequest}catch(b){}}function E(){return setTimeout(function(){ib=b},0),ib=n.now()}function u(a,b){n.each(b,function(b,c){for(var d=(ka[b]||[]).concat(ka["*"]),e=0,f=d.length;e<f&&!d[e].call(a,
b,c);e++);})}function J(a,b,c){var d=0,e=V.length,f=n.Deferred().always(function(){delete g.elem}),g=function(){for(var b=ib||E(),b=Math.max(0,h.startTime+h.duration-b),c=1-(b/h.duration||0),d=0,e=h.tweens.length;d<e;d++)h.tweens[d].run(c);return f.notifyWith(a,[h,c,b]),1>c&&e?b:(f.resolveWith(a,[h]),!1)},h=f.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:ib||E(),duration:c.duration,tweens:[],createTween:function(b,c){var d=
n.Tween(a,h.opts,b,c,h.opts.specialEasing[b]||h.opts.easing);return h.tweens.push(d),d},stop:function(b){for(var c=0,d=b?h.tweens.length:0;c<d;c++)h.tweens[c].run(1);return b?f.resolveWith(a,[h,b]):f.rejectWith(a,[h,b]),this}}),c=h.props;for(N(c,h.opts.specialEasing);d<e;d++)if(b=V[d].call(h,a,c,h.opts))return b;return u(h,c),n.isFunction(h.opts.start)&&h.opts.start.call(a,h),n.fx.timer(n.extend(g,{anim:h,queue:h.opts.queue,elem:a})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}
function N(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=n.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=e);else b[d]=e}function B(a,b,c,d,e){return new B.prototype.init(a,b,c,d,e)}function M(a,b){for(var c,d={height:a},e=0;4>e;e+=2-b)c=qc[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function I(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||
a.parentWindow:!1}var o,Q,P=a.document,H=a.location,T=a.navigator,L=a.jQuery,W=a.$,ea=Array.prototype.push,da=Array.prototype.slice,aa=Array.prototype.indexOf,ba=Object.prototype.toString,Z=Object.prototype.hasOwnProperty,ca=String.prototype.trim,n=function(a,b){return new n.fn.init(a,b,o)},Ga=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,pa=/\S/,Fa=/\s+/,Na=pa.test("\u00a0")?/^[\s\xA0]+|[\s\xA0]+$/g:/^\s+|\s+$/g,Ua=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Oa=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Kb=/^[\],:{}\s]*$/,
vb=/(?:^|:|,)(?:\s*\[)+/g,nb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Lb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,yb=/^-ms-/,Vb=/-([\da-z])/gi,Sa=function(a,b){return(b+"").toUpperCase()},sa=function(){P.addEventListener?(P.removeEventListener("DOMContentLoaded",sa,!1),n.ready()):"complete"===P.readyState&&(P.detachEvent("onreadystatechange",sa),n.ready())},Aa={};n.fn=n.prototype={constructor:n,init:function(a,c,d){var e,f;if(!a)return this;if(a.nodeType)return this.context=
this[0]=a,this.length=1,this;if("string"==typeof a){"<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?e=[null,a,null]:e=Ua.exec(a);if(e&&(e[1]||!c)){if(e[1])return c=c instanceof n?c[0]:c,f=c&&c.nodeType?c.ownerDocument||c:P,a=n.parseHTML(e[1],f,!0),Oa.test(e[1])&&n.isPlainObject(c)&&this.attr.call(a,c,!0),n.merge(this,a);if((c=P.getElementById(e[2]))&&c.parentNode){if(c.id!==e[2])return d.find(a);this.length=1;this[0]=c}return this.context=P,this.selector=a,this}return!c||c.jquery?(c||d).find(a):
this.constructor(c).find(a)}return n.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))},selector:"",jquery:"1.8.0",length:0,size:function(){return this.length},toArray:function(){return da.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){a=n.merge(this.constructor(),a);return a.prevObject=this,a.context=this.context,"find"===b?a.selector=this.selector+(this.selector?" ":
"")+c:b&&(a.selector=this.selector+"."+b+"("+c+")"),a},each:function(a,b){return n.each(this,a,b)},ready:function(a){return n.ready.promise().done(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(da.apply(this,arguments),"slice",da.call(arguments).join(","))},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||
this.constructor(null)},push:ea,sort:[].sort,splice:[].splice};n.fn.init.prototype=n.fn;n.extend=n.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;"boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2);"object"!=typeof h&&!n.isFunction(h)&&(h={});for(j===i&&(h=this,--i);i<j;i++)if(null!=(a=arguments[i]))for(c in a)d=h[c],e=a[c],h!==e&&(k&&e&&(n.isPlainObject(e)||(f=n.isArray(e)))?(f?(f=!1,g=d&&n.isArray(d)?d:[]):g=d&&n.isPlainObject(d)?d:{},h[c]=n.extend(k,g,e)):e!==
b&&(h[c]=e));return h};n.extend({noConflict:function(b){return a.$===n&&(a.$=W),b&&a.jQuery===n&&(a.jQuery=L),n},isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(!(!0===a?--n.readyWait:n.isReady)){if(!P.body)return setTimeout(n.ready,1);n.isReady=!0;!0!==a&&0<--n.readyWait||(Q.resolveWith(P,[n]),n.fn.trigger&&n(P).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray||function(a){return"array"===n.type(a)},
isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?""+a:Aa[ba.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!Z.call(a,"constructor")&&!Z.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var d in a);return d===b||Z.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);
},parseHTML:function(a,b,c){var d;return!a||"string"!=typeof a?null:("boolean"==typeof b&&(c=b,b=0),b=b||P,(d=Oa.exec(a))?[b.createElement(d[1])]:(d=n.buildFragment([a],b,c?null:[]),n.merge([],(d.cacheable?n.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||"string"!=typeof b)return null;b=n.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(Kb.test(b.replace(nb,"@").replace(Lb,"]").replace(vb,"")))return(new Function("return "+b))();n.error("Invalid JSON: "+b)},parseXML:function(c){var d,
e;if(!c||"string"!=typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&pa.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(yb,"ms-").replace(Vb,Sa)},nodeName:function(a,b){return a.nodeName&&
a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||n.isFunction(a);if(d)if(h)for(e in a){if(!1===c.apply(a[e],d))break}else for(;f<g&&!1!==c.apply(a[f++],d););else if(h)for(e in a){if(!1===c.call(a[e],e,a[e]))break}else for(;f<g&&!1!==c.call(a[f],f,a[f++]););return a},trim:ca?function(a){return null==a?"":ca.call(a)}:function(a){return null==a?"":a.toString().replace(Na,"")},makeArray:function(a,b){var c,d=b||[];return null!=a&&(c=n.type(a),null==a.length||
"string"===c||"function"===c||"regexp"===c||n.isWindow(a)?ea.call(d,a):n.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(aa)return aa.call(b,a,c);d=b.length;for(c=c?0>c?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;f<d;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,c=!!c;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},
map:function(a,c,d){var e,f,g=[],h=0,i=a.length;if(a instanceof n||i!==b&&"number"==typeof i&&(0<i&&a[0]&&a[i-1]||0===i||n.isArray(a)))for(;h<i;h++)e=c(a[h],h,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(d=a[c],c=a,a=d),n.isFunction(a)?(e=da.call(arguments,2),f=function(){return a.apply(c,e.concat(da.call(arguments)))},f.guid=a.guid=a.guid||f.guid||n.guid++,f):b},access:function(a,
c,d,e,f,g,h){var i,j=null==d,k=0,s=a.length;if(d&&"object"==typeof d){for(k in d)n.access(a,c,k,d[k],1,g,e);f=1}else if(e!==b){i=h===b&&n.isFunction(e);j&&(i?(i=c,c=function(a,b,c){return i.call(n(a),c)}):(c.call(a,e),c=null));if(c)for(;k<s;k++)c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h);f=1}return f?a:j?c.call(a):s?c(a[0],d):g},now:function(){return(new Date).getTime()}});n.ready.promise=function(b){if(!Q)if(Q=n.Deferred(),"complete"===P.readyState||"loading"!==P.readyState&&P.addEventListener)setTimeout(n.ready,
1);else if(P.addEventListener)P.addEventListener("DOMContentLoaded",sa,!1),a.addEventListener("load",n.ready,!1);else{P.attachEvent("onreadystatechange",sa);a.attachEvent("onload",n.ready);var c=!1;try{c=null==a.frameElement&&P.documentElement}catch(d){}c&&c.doScroll&&function ub(){if(!n.isReady){try{c.doScroll("left")}catch(a){return setTimeout(ub,50)}n.ready()}}()}return Q.promise(b)};n.each("Boolean,Number,String,Function,Array,Date,RegExp,Object".split(","),function(a,b){Aa["[object "+b+"]"]=
b.toLowerCase()});o=n(P);var $a={};n.Callbacks=function(a){var a="string"==typeof a?$a[a]||c(a):n.extend({},a),d,e,f,g,h,i,j=[],k=!a.once&&[],s=function(b){d=a.memory&&b;e=!0;i=g||0;g=0;h=j.length;for(f=!0;j&&i<h;i++)if(!1===j[i].apply(b[0],b[1])&&a.stopOnFalse){d=!1;break}f=!1;j&&(k?k.length&&s(k.shift()):d?j=[]:u.disable())},u={add:function(){if(j){var b=j.length;(function wb(b){n.each(b,function(b,c){n.isFunction(c)&&(!a.unique||!u.has(c))?j.push(c):c&&c.length&&wb(c)})})(arguments);f?h=j.length:
d&&(g=b,s(d))}return this},remove:function(){return j&&n.each(arguments,function(a,b){for(var c;-1<(c=n.inArray(b,j,c));)j.splice(c,1),f&&(c<=h&&h--,c<=i&&i--)}),this},has:function(a){return-1<n.inArray(a,j)},empty:function(){return j=[],this},disable:function(){return j=k=d=b,this},disabled:function(){return!j},lock:function(){return k=b,d||u.disable(),this},locked:function(){return!k},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],j&&(!e||k)&&(f?k.push(b):s(b)),this},fire:function(){return u.fireWith(this,
arguments),this},fired:function(){return!!e}};return u};n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](n.isFunction(g)?function(){var a=
g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])});a=null}).promise()},promise:function(a){return"object"==typeof a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add;h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock);e[f[0]]=g.fire;e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=da.call(arguments),d=c.length,
e=1!==d||a&&n.isFunction(a.promise)?d:0,f=1===e?a:n.Deferred(),g=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?da.call(arguments):d;c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(1<d){h=Array(d);i=Array(d);for(j=Array(d);b<d;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}return e||f.resolveWith(j,c),f.promise()}});n.support=function(){var b,c,d,e,f,g,h,i,j=P.createElement("div");j.setAttribute("className",
"t");j.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";c=j.getElementsByTagName("*");d=j.getElementsByTagName("a")[0];d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length||!d)return{};e=P.createElement("select");f=e.appendChild(P.createElement("option"));c=j.getElementsByTagName("input")[0];b={leadingWhitespace:3===j.firstChild.nodeType,tbody:!j.getElementsByTagName("tbody").length,htmlSerialize:!!j.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),
hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===c.value,optSelected:f.selected,getSetAttribute:"t"!==j.className,enctype:!!P.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==P.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===P.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,
pixelPosition:!1};c.checked=!0;b.noCloneChecked=c.cloneNode(!0).checked;e.disabled=!0;b.optDisabled=!f.disabled;try{delete j.test}catch(k){b.deleteExpando=!1}!j.addEventListener&&j.attachEvent&&j.fireEvent&&(j.attachEvent("onclick",i=function(){b.noCloneEvent=!1}),j.cloneNode(!0).fireEvent("onclick"),j.detachEvent("onclick",i));c=P.createElement("input");c.value="t";c.setAttribute("type","radio");b.radioValue="t"===c.value;c.setAttribute("checked","checked");c.setAttribute("name","t");j.appendChild(c);
d=P.createDocumentFragment();d.appendChild(j.lastChild);b.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;b.appendChecked=c.checked;d.removeChild(c);d.appendChild(j);if(j.attachEvent)for(g in{submit:!0,change:!0,focusin:!0})c="on"+g,(h=c in j)||(j.setAttribute(c,"return;"),h="function"==typeof j[c]),b[g+"Bubbles"]=h;return n(function(){var c,d,e,f,g=P.getElementsByTagName("body")[0];g&&(c=P.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",
g.insertBefore(c,g.firstChild),d=P.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=d.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",b.reliableHiddenOffsets=h&&0===e[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",
b.boxSizing=4===d.offsetWidth,b.doesNotIncludeMarginInBodyOffset=1!==g.offsetTop,a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(d,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(d,null)||{width:"4px"}).width,f=P.createElement("div"),f.style.cssText=d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;",f.style.marginRight=f.style.width="0",d.style.width="1px",d.appendChild(f),b.reliableMarginRight=!parseFloat((a.getComputedStyle(f,null)||{}).marginRight)),
"undefined"!=typeof d.style.zoom&&(d.innerHTML="",d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==d.offsetWidth,c.style.zoom=1),g.removeChild(c))}),d.removeChild(j),c=d=e=f=c=d=j=null,b}();var ja=/^(?:\{.*\}|\[.*\])$/,Ra=/([A-Z])/g;n.extend({cache:{},deletedIds:[],
uuid:0,expando:"jQuery"+(n.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!e(a)},data:function(a,c,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i="string"==typeof c,j=a.nodeType,k=j?n.cache:a,s=j?a[h]:a[h]&&h;if(s&&k[s]&&(e||k[s].data)||!(i&&d===b)){s||(j?a[h]=s=n.deletedIds.pop()||++n.uuid:s=h);k[s]||(k[s]={},j||(k[s].toJSON=n.noop));if("object"==
typeof c||"function"==typeof c)e?k[s]=n.extend(k[s],c):k[s].data=n.extend(k[s].data,c);return f=k[s],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[n.camelCase(c)]=d),i?(g=f[c],null==g&&(g=f[n.camelCase(c)])):g=f,g}}},removeData:function(a,b,c){if(n.acceptData(a)){var d,f,g,h=a.nodeType,i=h?n.cache:a,j=h?a[n.expando]:n.expando;if(i[j]){if(b&&(d=c?i[j]:i[j].data)){n.isArray(b)||(b in d?b=[b]:(b=n.camelCase(b),b in d?b=[b]:b=b.split(" ")));f=0;for(g=b.length;f<g;f++)delete d[b[f]];if(!(c?e:n.isEmptyObject)(d))return}if(!c&&
(delete i[j].data,!e(i[j])))return;h?n.cleanData([a],!0):n.support.deleteExpando||i!=i.window?delete i[j]:i[j]=null}}},_data:function(a,b,c){return n.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&n.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}});n.fn.extend({data:function(a,c){var e,f,g,h,i,j=this[0],k=0,s=null;if(a===b){if(this.length&&(s=n.data(j),1===j.nodeType&&!n._data(j,"parsedAttrs"))){g=j.attributes;for(i=g.length;k<i;k++)h=g[k].name,0===h.indexOf("data-")&&
(h=n.camelCase(h.substring(5)),d(j,h,s[h]));n._data(j,"parsedAttrs",!0)}return s}return"object"==typeof a?this.each(function(){n.data(this,a)}):(e=a.split(".",2),e[1]=e[1]?"."+e[1]:"",f=e[1]+"!",n.access(this,function(c){if(c===b)return s=this.triggerHandler("getData"+f,[e[0]]),s===b&&j&&(s=n.data(j,a),s=d(j,a,s)),s===b&&e[1]?this.data(e[0]):s;e[1]=c;this.each(function(){var b=n(this);b.triggerHandler("setData"+f,e);n.data(this,a,c);b.triggerHandler("changeData"+f,e)})},null,c,1<arguments.length,
null,!1))},removeData:function(a){return this.each(function(){n.removeData(this,a)})}});n.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){var b=b||"fx",c=n.queue(a,b),d=c.shift(),e=n._queueHooks(a,b),f=function(){n.dequeue(a,b)};"inprogress"===d&&(d=c.shift());d&&("fx"===b&&c.unshift("inprogress"),delete e.stop,d.call(a,f,e));!c.length&&e&&e.empty.fire()},_queueHooks:function(a,
b){var c=b+"queueHooks";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks("once memory").add(function(){n.removeData(a,b+"queue",!0);n.removeData(a,c,!0)})})}});n.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?n.queue(this[0],a):c===b?this:this.each(function(){var b=n.queue(this,a,c);n._queueHooks(this,a);"fx"===a&&"inprogress"!==b[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},delay:function(a,
b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=n.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};"string"!=typeof a&&(c=a,a=b);for(a=a||"fx";h--;)(d=n._data(g[h],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var Pa,qa,jb,cb=/[\t\r\n]/g,la=/\r/g,Ya=/^(?:button|input)$/i,zb=
/^(?:button|input|object|select|textarea)$/i,Pb=/^a(?:rea|)$/i,kd=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Kc=n.support.getSetAttribute;n.fn.extend({attr:function(a,b){return n.access(this,n.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})},prop:function(a,b){return n.access(this,n.prop,a,b,1<arguments.length)},removeProp:function(a){return a=n.propFix[a]||a,
this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a){b=a.split(Fa);c=0;for(d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(!e.className&&1===b.length)e.className=a;else{f=" "+e.className+" ";g=0;for(h=b.length;g<h;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=n.trim(f)}}return this},removeClass:function(a){var c,
d,e,f,g,h,i;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(a&&"string"==typeof a||a===b){c=(a||"").split(Fa);h=0;for(i=this.length;h<i;h++)if(e=this[h],1===e.nodeType&&e.className){d=(" "+e.className+" ").replace(cb," ");f=0;for(g=c.length;f<g;f++)for(;-1<d.indexOf(" "+c[f]+" ");)d=d.replace(" "+c[f]+" "," ");e.className=a?n.trim(d):""}}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return n.isFunction(a)?this.each(function(c){n(this).toggleClass(a.call(this,
c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,g=n(this),h=b,i=a.split(Fa);e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&n._data(this,"__className__",this.className),this.className=this.className||!1===a?"":n._data(this,"__className__")||""})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&-1<(" "+this[b].className+" ").replace(cb," ").indexOf(a))return!0;
return!1},val:function(a){var c,d,e,f=this[0];if(arguments.length)return e=n.isFunction(a),this.each(function(d){var f,g=n(this);if(1===this.nodeType&&(e?f=a.call(this,d,g.val()):f=a,null==f?f="":"number"==typeof f?f+="":n.isArray(f)&&(f=n.map(f,function(a){return a==null?"":a+""})),c=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],!c||!("set"in c)||c.set(this,f,"value")===b))this.value=f});if(f)return c=n.valHooks[f.type]||n.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,
"value"))!==b?d:(d=f.value,"string"==typeof d?d.replace(la,""):null==d?"":d)}});n.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.selectedIndex,e=[],f=a.options,g="select-one"===a.type;if(0>d)return null;a=g?d:0;for(c=g?d+1:f.length;a<c;a++)if(b=f[a],b.selected&&(n.support.optDisabled?!b.disabled:null===b.getAttribute("disabled"))&&(!b.parentNode.disabled||!n.nodeName(b.parentNode,"optgroup"))){b=n(b).val();
if(g)return b;e.push(b)}return g&&!e.length&&f.length?n(f[d]).val():e},set:function(a,b){var c=n.makeArray(b);return n(a).find("option").each(function(){this.selected=0<=n.inArray(n(this).val(),c)}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h=a.nodeType;if(a&&!(3===h||8===h||2===h)){if(e&&n.isFunction(n.fn[c]))return n(a)[c](d);if("undefined"==typeof a.getAttribute)return n.prop(a,c,d);(e=1!==h||!n.isXMLDoc(a))&&(c=c.toLowerCase(),g=n.attrHooks[c]||(kd.test(c)?qa:
Pa));if(d!==b){if(null===d){n.removeAttr(a,c);return}return g&&"set"in g&&e&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d)}return g&&"get"in g&&e&&null!==(f=g.get(a,c))?f:(f=a.getAttribute(c),null===f?b:f)}},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&1===a.nodeType)for(d=b.split(Fa);g<d.length;g++)(e=d[g])&&(c=n.propFix[e]||e,f=kd.test(e),f||n.attr(a,e,""),a.removeAttribute(Kc?e:c),f&&c in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(Ya.test(a.nodeName)&&a.parentNode)n.error("type property can't be changed");
else if(!n.support.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return Pa&&n.nodeName(a,"button")?Pa.get(a,b):b in a?a.value:null},set:function(a,b,c){if(Pa&&n.nodeName(a,"button"))return Pa.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",
usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;return!a||3===h||8===h||2===h?void 0:(g=1!==h||!n.isXMLDoc(a),g&&(c=n.propFix[c]||c,f=n.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c])},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):zb.test(a.nodeName)||Pb.test(a.nodeName)&&a.href?0:b}}}});qa={get:function(a,
c){var d,e=n.prop(a,c);return!0===e||"boolean"!=typeof e&&(d=a.getAttributeNode(c))&&!1!==d.nodeValue?c.toLowerCase():b},set:function(a,b,c){var d;return!1===b?n.removeAttr(a,c):(d=n.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}};Kc||(jb={name:!0,id:!0,coords:!0},Pa=n.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(jb[c]?""!==d.value:d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=P.createAttribute(c),a.setAttributeNode(d)),
d.value=b+""}},n.each(["width","height"],function(a,b){n.attrHooks[b]=n.extend(n.attrHooks[b],{set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}})}),n.attrHooks.contenteditable={get:Pa.get,set:function(a,b,c){""===b&&(b="false");Pa.set(a,b,c)}});n.support.hrefNormalized||n.each(["href","src","width","height"],function(a,c){n.attrHooks[c]=n.extend(n.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return null===a?b:a}})});n.support.style||(n.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||
b},set:function(a,b){return a.style.cssText=""+b}});n.support.optSelected||(n.propHooks.selected=n.extend(n.propHooks.selected,{get:function(a){a=a.parentNode;return a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}}));n.support.enctype||(n.propFix.enctype="encoding");n.support.checkOn||n.each(["radio","checkbox"],function(){n.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});n.each(["radio","checkbox"],function(){n.valHooks[this]=n.extend(n.valHooks[this],
{set:function(a,b){if(n.isArray(b))return a.checked=0<=n.inArray(n(a).val(),b)}})});var sc=/^(?:textarea|input|select)$/i,Bc=/^([^\.]*|)(?:\.(.+)|)$/,Qd=/(?:^|\s)hover(\.\S+|)\b/,Rd=/^key/,Sd=/^(?:mouse|contextmenu)|click/,yd=/^(?:focusinfocus|focusoutblur)$/,zd=function(a){return n.event.special.hover?a:a.replace(Qd,"mouseenter$1 mouseleave$1")};n.event={add:function(a,c,d,e,f){var g,h,i,j,k,s,u,l,o;if(!(3===a.nodeType||8===a.nodeType||!c||!d||!(g=n._data(a)))){d.handler&&(u=d,d=u.handler,f=u.selector);
d.guid||(d.guid=n.guid++);(i=g.events)||(g.events=i={});(h=g.handle)||(g.handle=h=function(a){return"undefined"!=typeof n&&(!a||n.event.triggered!==a.type)?n.event.dispatch.apply(h.elem,arguments):b},h.elem=a);c=n.trim(zd(c)).split(" ");for(g=0;g<c.length;g++){j=Bc.exec(c[g])||[];k=j[1];s=(j[2]||"").split(".").sort();o=n.event.special[k]||{};k=(f?o.delegateType:o.bindType)||k;o=n.event.special[k]||{};j=n.extend({type:k,origType:j[1],data:e,handler:d,guid:d.guid,selector:f,namespace:s.join(".")},u);
l=i[k];if(!l&&(l=i[k]=[],l.delegateCount=0,!o.setup||!1===o.setup.call(a,e,s,h)))a.addEventListener?a.addEventListener(k,h,!1):a.attachEvent&&a.attachEvent("on"+k,h);o.add&&(o.add.call(a,j),j.handler.guid||(j.handler.guid=d.guid));f?l.splice(l.delegateCount++,0,j):l.push(j);n.event.global[k]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,s,u,l,o,p=n.hasData(a)&&n._data(a);if(p&&(s=p.events)){b=n.trim(zd(b||"")).split(" ");for(f=0;f<b.length;f++)if(g=Bc.exec(b[f])||[],h=i=g[1],g=
g[2],h){u=n.event.special[h]||{};h=(d?u.delegateType:u.bindType)||h;l=s[h]||[];j=l.length;g=g?RegExp("(^|\\.)"+g.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(k=0;k<l.length;k++)o=l[k],(e||i===o.origType)&&(!c||c.guid===o.guid)&&(!g||g.test(o.namespace))&&(!d||d===o.selector||"**"===d&&o.selector)&&(l.splice(k--,1),o.selector&&l.delegateCount--,u.remove&&u.remove.call(a,o));0===l.length&&j!==l.length&&((!u.teardown||!1===u.teardown.call(a,g,p.handle))&&n.removeEvent(a,h,p.handle),delete s[h])}else for(h in s)n.event.remove(a,
h+b[f],c,d,!0);n.isEmptyObject(s)&&(delete p.handle,n.removeData(a,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){if(!e||3!==e.nodeType&&8!==e.nodeType){var g,h,i,j,k,s,u,l=c.type||c;j=[];if(!yd.test(l+n.event.triggered)&&(0<=l.indexOf("!")&&(l=l.slice(0,-1),g=!0),0<=l.indexOf(".")&&(j=l.split("."),l=j.shift(),j.sort()),e&&!n.event.customEvent[l]||n.event.global[l]))if(c="object"==typeof c?c[n.expando]?c:new n.Event(l,c):new n.Event(l),c.type=l,c.isTrigger=
!0,c.exclusive=g,c.namespace=j.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+j.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,j=0>l.indexOf(":")?"on"+l:"",e){if(c.result=b,c.target||(c.target=e),d=null!=d?n.makeArray(d):[],d.unshift(c),k=n.event.special[l]||{},!(k.trigger&&!1===k.trigger.apply(e,d))){u=[[e,k.bindType||l]];if(!f&&!k.noBubble&&!n.isWindow(e)){h=k.delegateType||l;g=yd.test(h+l)?e:e.parentNode;for(i=e;g;g=g.parentNode)u.push([g,h]),i=g;i===(e.ownerDocument||P)&&u.push([i.defaultView||
i.parentWindow||a,h])}for(h=0;h<u.length&&!c.isPropagationStopped();h++)g=u[h][0],c.type=u[h][1],(s=(n._data(g,"events")||{})[c.type]&&n._data(g,"handle"))&&s.apply(g,d),(s=j&&g[j])&&n.acceptData(g)&&!1===s.apply(g,d)&&c.preventDefault();return c.type=l,!f&&!c.isDefaultPrevented()&&(!k._default||!1===k._default.apply(e.ownerDocument,d))&&("click"!==l||!n.nodeName(e,"a"))&&n.acceptData(e)&&j&&e[l]&&("focus"!==l&&"blur"!==l||0!==c.target.offsetWidth)&&!n.isWindow(e)&&(i=e[j],i&&(e[j]=null),n.event.triggered=
l,e[l](),n.event.triggered=b,i&&(e[j]=i)),c.result}}else for(h in e=n.cache,e)e[h].events&&e[h].events[l]&&n.event.trigger(c,d,e[h].handle.elem,!0)}},dispatch:function(c){var c=n.event.fix(c||a.event),d,e,f,g,h,i,j,k=(n._data(this,"events")||{})[c.type]||[],s=k.delegateCount,l=[].slice.call(arguments),u=!c.exclusive&&!c.namespace,o=n.event.special[c.type]||{},p=[];l[0]=c;c.delegateTarget=this;if(!(o.preDispatch&&!1===o.preDispatch.call(this,c))){if(s&&(!c.button||"click"!==c.type)){f=n(this);f.context=
this;for(e=c.target;e!=this;e=e.parentNode||this)if(!0!==e.disabled||"click"!==c.type){h={};i=[];f[0]=e;for(d=0;d<s;d++)g=k[d],j=g.selector,h[j]===b&&(h[j]=f.is(j)),h[j]&&i.push(g);i.length&&p.push({elem:e,matches:i})}}k.length>s&&p.push({elem:this,matches:k.slice(s)});for(d=0;d<p.length&&!c.isPropagationStopped();d++){f=p[d];c.currentTarget=f.elem;for(e=0;e<f.matches.length&&!c.isImmediatePropagationStopped();e++)if(g=f.matches[e],u||!c.namespace&&!g.namespace||c.namespace_re&&c.namespace_re.test(g.namespace))c.data=
g.data,c.handleObj=g,g=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,l),g!==b&&(c.result=g,!1===g&&(c.preventDefault(),c.stopPropagation()))}return o.postDispatch&&o.postDispatch.call(this,c),c.result}},props:"attrChange,attrName,relatedNode,srcElement,altKey,bubbles,cancelable,ctrlKey,currentTarget,eventPhase,metaKey,relatedTarget,shiftKey,target,timeStamp,view,which".split(","),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==
a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button,buttons,clientX,clientY,fromElement,offsetX,offsetY,pageX,pageY,screenX,screenY,toElement".split(","),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||P,e=d.documentElement,f=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||
f&&f.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),!a.which&&g!==b&&(a.which=g&1?1:g&2?3:g&4?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d=a,e=n.event.fixHooks[a.type]||{},f=e.props?this.props.concat(e.props):this.props,a=n.Event(d);for(b=f.length;b;)c=f[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||P),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,e.filter?e.filter(a,d):a},special:{ready:{setup:n.bindReady},load:{noBubble:!0},
focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){n.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){a=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(a,null,b):n.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};n.event.handle=n.event.dispatch;n.removeEvent=P.removeEventListener?function(a,b,c){a.removeEventListener&&
a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b;a.detachEvent&&("undefined"==typeof a[b]&&(a[b]=null),a.detachEvent(b,c))};n.Event=function(a,b){if(this instanceof n.Event)a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?g:f):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),this[n.expando]=!0;else return new n.Event(a,b)};n.Event.prototype={preventDefault:function(){this.isDefaultPrevented=
g;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=g;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g;this.stopPropagation()},isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f};n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){n.event.special[a]={delegateType:b,
bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!n.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});n.support.submitBubbles||(n.event.special.submit={setup:function(){if(n.nodeName(this,"form"))return!1;n.event.add(this,"click._submit keypress._submit",function(a){a=a.target;(a=n.nodeName(a,"input")||n.nodeName(a,"button")?a.form:b)&&!n._data(a,"_submit_attached")&&(n.event.add(a,"submit._submit",function(a){a._submit_bubble=
!0}),n._data(a,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(n.nodeName(this,"form"))return!1;n.event.remove(this,"._submit")}});n.support.changeBubbles||(n.event.special.change={setup:function(){if(sc.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)n.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&
(this._just_changed=!0)}),n.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);n.event.simulate("change",this,a,!0)});return!1}n.event.add(this,"beforeactivate._change",function(a){a=a.target;sc.test(a.nodeName)&&!n._data(a,"_change_attached")&&(n.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&n.event.simulate("change",this.parentNode,a,!0)}),n._data(a,"_change_attached",!0))})},handle:function(a){var b=a.target;
if(this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){return n.event.remove(this,"._change"),sc.test(this.nodeName)}});n.support.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){0===c++&&P.addEventListener(a,d,!0)},teardown:function(){0===--c&&P.removeEventListener(a,d,!0)}}});
n.fn.extend({on:function(a,c,d,e,g){var h,i;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b));if(!1===e)e=f;else if(!e)return this;return 1===g&&(h=e,e=function(a){return n().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=n.guid++)),this.each(function(){n.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,g;
if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,n(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(g in a)this.off(g,c,a[g]);return this}if(!1===c||"function"==typeof c)d=c,c=b;return!1===d&&(d=f),this.each(function(){n.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return n(this.context).on(a,this.selector,b,c),this},
die:function(a,b){return n(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1==arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return n.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||n.guid++,d=0,e=function(c){var e=(n._data(this,"lastToggle"+a.guid)||0)%d;return n._data(this,
"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});n.each("blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error,contextmenu".split(","),function(a,b){n.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>
0?this.on(b,null,a,c):this.trigger(b)};Rd.test(b)&&(n.event.fixHooks[b]=n.event.keyHooks);Sd.test(b)&&(n.event.fixHooks[b]=n.event.mouseHooks)});(function(a,b){function c(a,b,d,e){for(var f=0,g=b.length;f<g;f++)C(a,b[f],d,e)}function d(a,b,e,f,g,h){var i,j=la.setFilters[b.toLowerCase()];return j||C.error(b),(a||!(i=g))&&c(a||"*",f,i=[],g),0<i.length?j(i,e,h):[]}function e(a,f,g,h,i){for(var j,k,s,l,u,o,n,p=0,m=i.length,E=da.POS,r=RegExp("^"+E.source+"(?!"+B+")","i"),T=function(){for(var a=1,c=arguments.length-
2;a<c;a++)arguments[a]===b&&(j[a]=b)};p<m;p++){E.exec("");a=i[p];l=[];s=0;for(u=h;j=E.exec(a);)if(k=E.lastIndex=j.index+j[0].length,k>s){n=a.slice(s,j.index);s=k;o=[f];I.test(n)&&(u&&(o=u),u=h);if(k=v.test(n))n=n.slice(0,-5).replace(I,"$&*");1<j.length&&j[0].replace(r,T);u=d(n,j[1],j[2],o,u,k)}u?(l=l.concat(u),(n=a.slice(s))&&")"!==n?I.test(n)?c(n,l,g,h):C(n,f,g,h?h.concat(u):u):q.apply(g,l)):C(a,f,g,h)}return 1===m?g:C.uniqueSort(g)}function f(a,b,c){var d=b.dir,e=E++;return a||(a=function(a){return a===
c}),b.first?function(b,c){for(;b=b[d];)if(1===b.nodeType)return a(b,c)&&b}:function(b,c){for(var f,g=e+"."+j,h=g+"."+i;b=b[d];)if(1===b.nodeType){if((f=b[T])===h)return b.sizset;if("string"==typeof f&&0===f.indexOf(g)){if(b.sizset)return b}else{b[T]=h;if(a(b,c))return b.sizset=!0,b;b.sizset=!1}}}}function g(a,b){return a?function(c,d){var e=b(c,d);return e&&a(!0===e?c:e,d)}:b}function h(a){return function(b,c){for(var d,e=0;d=a[e];e++)if(d(b,c))return!0;return!1}}var i,j,k,s,l,u=a.document,o=u.documentElement,
p=!1,m=!0,E=0,r=[].slice,q=[].push,T=("sizcache"+Math.random()).replace(".",""),B="[\\x20\\t\\r\\n\\f]",J="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#"),J="\\["+B+"*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)"+B+"*(?:([*^$|!~]?=)"+B+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+J+")|)|)"+B+"*\\]",L=B+"*([\\x20\\t\\r\\n\\f>+~])"+B+"*",t="(?=[^\\x20\\t\\r\\n\\f])(?:\\\\.|"+J+"|"+":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|((?:[^,]|\\\\,|(?:,(?=[^\\[]*\\]))|(?:,(?=[^\\(]*\\))))*))\\)|)".replace(2,
7)+"|[^\\\\(),])+",Q=RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),I=RegExp("^"+L),N=RegExp(t+"?(?="+B+"*,|$)","g"),M=RegExp("^(?:(?!,)(?:(?:^|,)"+B+"*"+t+")*?|"+B+"*(.*?))(\\)|$)"),H=RegExp(t.slice(19,-6)+"\\x20\\t\\r\\n\\f>+~])+|"+L,"g"),x=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,W=/[\x20\t\r\n\f]*[+~]/,v=/:not\($/,cb=/h\d/i,P=/input|select|textarea|button/i,y=/\\(?!\\)/g,da={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,
TAG:RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("[-","[-\\*")+")"),ATTR:RegExp("^"+J),PSEUDO:RegExp("^:((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|((?:[^,]|\\\\,|(?:,(?=[^\\[]*\\]))|(?:,(?=[^\\(]*\\))))*))\\)|)"),CHILD:RegExp("^:(only|nth|last|first)-child(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\)|)(?=[^-]|$)/ig,needsContext:RegExp("^"+B+"*[>+~]|:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\)|)(?=[^-]|$)",
"i")},w={},aa=[],zb={},z=[],J=function(a){return a.sizzleFilter=!0,a},L=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},t=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},A=function(a){var b=!1,c=u.createElement("div");try{b=a(c)}catch(d){}return b},Ya=A(function(a){a.innerHTML="<select></select>";a=typeof a.lastChild.getAttribute("multiple");return"boolean"!==a&&"string"!==a}),ba=A(function(a){a.id=
T+0;a.innerHTML="<a name='"+T+"'></a><div name='"+T+"'></div>";o.insertBefore(a,o.firstChild);var b=u.getElementsByName&&u.getElementsByName(T).length===2+u.getElementsByName(T+0).length;return l=!u.getElementById(T),o.removeChild(a),b}),D=A(function(a){return a.appendChild(u.createComment("")),0===a.getElementsByTagName("*").length}),ea=A(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&"undefined"!==typeof a.firstChild.getAttribute&&"#"===a.firstChild.getAttribute("href")}),F=A(function(a){return a.innerHTML=
"<div class='hidden e'></div><div class='hidden'></div>",!a.getElementsByClassName||0===a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",1!==a.getElementsByClassName("e").length)}),C=function(a,b,c,d){var c=c||[],b=b||u,e,f,g,h,i=b.nodeType;if(1!==i&&9!==i)return[];if(!a||"string"!=typeof a)return c;g=sc(b);if(!g&&!d&&(e=x.exec(a)))if(h=e[1])if(9===i){f=b.getElementById(h);if(!f||!f.parentNode)return c;if(f.id===h)return c.push(f),c}else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(h))&&
Z(b,f)&&f.id===h)return c.push(f),c}else{if(e[2])return q.apply(c,r.call(b.getElementsByTagName(a),0)),c;if((h=e[3])&&F&&b.getElementsByClassName)return q.apply(c,r.call(b.getElementsByClassName(h),0)),c}return Bc(a,b,c,d,g)},la=C.selectors={cacheLength:50,match:da,order:["ID","TAG"],attrHandle:{},createPseudo:J,find:{ID:l?function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a))&&a.parentNode?[a]:[]}:function(a,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=
c.getElementById(a))?c.id===a||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").value===a?[c]:b:[]},TAG:D?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===d.nodeType&&e.push(d);return e}return c}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=
a[1].replace(y,""),a[3]=(a[4]||a[5]||"").replace(y,""),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1]?(a[2]||C.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&C.error(a[0]),a},PSEUDO:function(a){var b,c=a[4];return da.CHILD.test(a[0])?null:(c&&(b=M.exec(c))&&b.pop()&&(a[0]=a[0].slice(0,b[0].length-c.length-1),c=b[0].slice(0,-1)),a.splice(2,3,c||a[3]),a)}},filter:{ID:l?function(a){return a=
a.replace(y,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(y,""),function(b){return(b="undefined"!==typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===a}},TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(y,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=w[a];return b||(b=w[a]=RegExp("(^|"+B+")"+a+"("+B+"|$)"),aa.push(a),aa.length>la.cacheLength&&delete w[aa.shift()]),function(a){return b.test(a.className||
"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){var d=C.attr(d,a),e=d+"";if(null==d)return"!="===b;switch(b){case "=":return e===c;case "!=":return e!==c;case "^=":return c&&0===e.indexOf(c);case "*=":return c&&-1<e.indexOf(c);case "$=":return c&&e.substr(e.length-c.length)===c;case "~=":return-1<(" "+e+" ").indexOf(c);case "|=":return e===c||e.substr(0,c.length+1)===c+"-"}}:function(b){return null!=C.attr(b,a)}},CHILD:function(a,b,c,d){if("nth"===
a){var e=E++;return function(a){var b,f,g=0,h=a;if(1===c&&0===d)return!0;if((b=a.parentNode)&&(b[T]!==e||!a.sizset)){for(h=b.firstChild;h&&!(1===h.nodeType&&(h.sizset=++g,h===a));h=h.nextSibling);b[T]=e}return f=a.sizset-d,0===c?0===f:0===f%c&&0<=f/c}}return function(b){var c=b;switch(a){case "only":case "first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case "last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b,c,d){var e=la.pseudos[a]||
la.pseudos[a.toLowerCase()];return e||C.error("unsupported pseudo: "+a),e.sizzleFilter?e(b,c,d):e}},pseudos:{not:J(function(a,b,c){var d=Kc(a.replace(Q,"$1"),b,c);return function(a){return!d(a)}}),enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},parent:function(a){return!la.pseudos.empty(a)},
empty:function(a){for(var b,a=a.firstChild;a;){if("@"<a.nodeName||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},contains:J(function(a){return function(b){return-1<(b.textContent||b.innerText||Pb(b)).indexOf(a)}}),has:J(function(a){return function(b){return 0<C(a,b).length}}),header:function(a){return cb.test(a.nodeName)},text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:L("radio"),checkbox:L("checkbox"),
file:L("file"),password:L("password"),image:L("image"),submit:t("submit"),reset:t("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return P.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){b=
a.pop();return c?a:[b]},even:function(a,b,c){for(var b=[],c=c?1:0,d=a.length;c<d;c+=2)b.push(a[c]);return b},odd:function(a,b,c){for(var b=[],c=c?0:1,d=a.length;c<d;c+=2)b.push(a[c]);return b},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){b=a.splice(+b,1);return c?a:b}}};la.setFilters.nth=la.setFilters.eq;la.filters=la.pseudos;ea||(la.attrHandle={href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}});
ba&&(la.order.push("NAME"),la.find.NAME=function(a,b){if("undefined"!==typeof b.getElementsByName)return b.getElementsByName(a)});F&&(la.order.splice(1,0,"CLASS"),la.find.CLASS=function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a)});try{r.call(o.childNodes,0)[0].nodeType}catch(kd){r=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}var sc=C.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1},Z=C.contains=
o.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:o.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b.parentNode;return a===d||!(!d||!(1===d.nodeType&&c.contains&&c.contains(d)))}:function(a,b){for(;b=b.parentNode;)if(b===a)return!0;return!1},Pb=C.getText=function(a){var b,c="",d=0;if(b=a.nodeType)if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=Pb(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=
a[d];d++)c+=Pb(b);return c};C.attr=function(a,b){var c,d=sc(a);return d||(b=b.toLowerCase()),la.attrHandle[b]?la.attrHandle[b](a):Ya||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?"boolean"==typeof a[b]?a[b]?b:null:c.specified?c.value:null:null)};C.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};[0,0].sort(function(){return m=0});o.compareDocumentPosition?k=function(a,b){return a===b?(p=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:
a.compareDocumentPosition(b)&4)?-1:1}:(k=function(a,b){if(a===b)return p=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var g=c;if(c===d)return s(a,b);if(!c)return-1;if(!d)return 1;for(;g;)e.unshift(g),g=g.parentNode;for(g=d;g;)f.unshift(g),g=g.parentNode;c=e.length;d=f.length;for(g=0;g<c&&g<d;g++)if(e[g]!==f[g])return s(e[g],f[g]);return g===c?s(a,f[g],-1):s(e[g],b,1)},s=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===
b)return-1;a=a.nextSibling}return 1});C.uniqueSort=function(a){var b,c=1;if(k&&(p=m,a.sort(k),p))for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a};var Kc=C.compile=function(a,b,c){var d,e,i,j=zb[a];if(j&&j.context===b)return j;var k,s=[];d=0;for(var l=M.exec(a),o=!l.pop()&&!l.pop(),n=o&&a.match(N)||[""],p=la.preFilter,m=la.filter,E=!c&&b!==u;null!=(i=n[d])&&o;d++){s.push(e=[]);for(E&&(i=" "+i);i;){o=!1;if(l=I.exec(i))i=i.slice(l[0].length),o=e.push({part:l.pop().replace(Q," "),captures:l});for(k in m)(l=
da[k].exec(i))&&(!p[k]||(l=p[k](l,b,c)))&&(i=i.slice(l.shift().length),o=e.push({part:k,captures:l}));if(!o)break}}e=(o||C.error(a),s);for(i=0;d=e[i];i++){k=e;s=i;l=b;o=c;p=n=void 0;for(m=0;n=d[m];m++)la.relative[n.part]?p=f(p,la.relative[n.part],l):(n.captures.push(l,o),p=g(p,la.filter[n.part].apply(null,n.captures)));k[s]=p}return j=zb[a]=h(e),j.context=b,j.runs=j.dirruns=0,z.push(a),z.length>la.cacheLength&&delete zb[z.shift()],j};C.matches=function(a,b){return C(a,null,null,b)};C.matchesSelector=
function(a,b){return 0<C(b,null,null,[a]).length};var Bc=function(a,b,c,d,f){var a=a.replace(Q,"$1"),g,h,k,s,l,u,o=a.match(N);h=a.match(H);k=b.nodeType;if(da.POS.test(a))return e(a,b,c,d,o);if(d)g=r.call(d,0);else if(o&&1===o.length){if(1<h.length&&9===k&&!f&&(o=da.ID.exec(h[0]))){b=la.find.ID(o[1],b,f)[0];if(!b)return c;a=a.slice(h.shift().length)}d=(o=W.exec(h[0]))&&!o.index&&b.parentNode||b;u=h.pop();s=u.split(":not")[0];h=0;for(k=la.order.length;h<k;h++)if(l=la.order[h],o=da[l].exec(s))if(g=la.find[l]((o[1]||
"").replace(y,""),d,f),null!=g){s===u&&(a=a.slice(0,a.length-u.length)+s.replace(da[l],""),a||q.apply(c,r.call(g,0)));break}}if(a){f=Kc(a,b,f);j=f.dirruns++;null==g&&(g=la.find.TAG("*",W.test(a)&&b.parentNode||b));for(h=0;a=g[h];h++)i=f.runs++,f(a,b)&&c.push(a)}return c};u.querySelectorAll&&function(){var a,b=Bc,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[],f=[":active"],g=o.matchesSelector||o.mozMatchesSelector||o.webkitMatchesSelector||o.oMatchesSelector||o.msMatchesSelector;
A(function(a){a.innerHTML="<select><option selected></option></select>";a.querySelectorAll("[selected]").length||e.push("\\["+B+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)");a.querySelectorAll(":checked").length||e.push(":checked")});A(function(a){a.innerHTML="<p test=''></p>";a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+B+"*(?:\"\"|'')");a.innerHTML="<input type='hidden'>";a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")});e=e.length&&RegExp(e.join("|"));
Bc=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a)))if(9===d.nodeType)try{return q.apply(f,r.call(d.querySelectorAll(a),0)),f}catch(i){}else if(1===d.nodeType&&"object"!==d.nodeName.toLowerCase()){var j=d.getAttribute("id"),k=j||T,s=W.test(a)&&d.parentNode||d;j?k=k.replace(c,"\\$&"):d.setAttribute("id",k);try{return q.apply(f,r.call(s.querySelectorAll(a.replace(N,"[id='"+k+"'] $&")),0)),f}catch(l){}finally{j||d.removeAttribute("id")}}return b(a,d,f,g,h)};g&&(A(function(b){a=g.call(b,"div");try{g.call(b,
"[test!='']:sizzle"),f.push(la.match.PSEUDO)}catch(c){}}),f=RegExp(f.join("|")),C.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!sc(b)&&!f.test(c)&&(!e||!e.test(c)))try{var h=g.call(b,c);if(h||a||b.document&&11!==b.document.nodeType)return h}catch(i){}return 0<C(c,null,null,[b]).length})}();C.attr=n.attr;n.find=C;n.expr=C.selectors;n.expr[":"]=n.expr.pseudos;n.unique=C.uniqueSort;n.text=C.getText;n.isXMLDoc=C.isXML;n.contains=C.contains})(a);var Yd=/Until$/,Sb=/^(?:parents|prev(?:Until|All))/,
xb=/^.[^:#\[\.,]*$/,Oc=n.expr.match.needsContext,ic={children:!0,contents:!0,next:!0,prev:!0};n.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if("string"!=typeof a)return n(a).filter(function(){b=0;for(c=h.length;b<c;b++)if(n.contains(h[b],this))return!0});g=this.pushStack("","find",a);b=0;for(c=this.length;b<c;b++)if(d=g.length,n.find(a,this[b],g),0<b)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}return g},has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=
0;b<d;b++)if(n.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(j(this,a,!1),"not",a)},filter:function(a){return this.pushStack(j(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?Oc.test(a)?0<=n(a,this.context).index(this[0]):0<n.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Oc.test(a)||"string"!=typeof a?n(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?
-1<g.index(c):n.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}return f=1<f.length?n.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?"string"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?n(a,b):n.makeArray(a&&a.nodeType?[a]:a),d=n.merge(this.get(),c);return this.pushStack(h(c[0])||h(d[0])?d:n.unique(d))},addBack:function(a){return this.add(null==a?
this.prevObject:this.prevObject.filter(a))}});n.fn.andSelf=n.fn.addBack;n.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return i(a,"nextSibling")},prev:function(a){return i(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",
c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return Yd.test(a)||(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),e=1<this.length&&!ic[a]?n.unique(e):e,1<this.length&&Sb.test(a)&&
(e=e.reverse()),this.pushStack(e,a,da.call(arguments).join(","))}});n.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?n.find.matchesSelector(b[0],a)?[b[0]]:[]:n.find.matches(a,b)},dir:function(a,c,d){for(var e=[],a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!n(a).is(d));)1===a.nodeType&&e.push(a),a=a[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var pc="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
Zb=/ jQuery\d+="(?:null|\d+)"/g,Tb=/^\s+/,Ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,tc=/<([\w:]+)/,Yc=/<tbody/i,Ja=/<|&#?\w+;/,kb=/<(?:script|style|link)/i,Zd=/<(?:script|object|embed|option|style)/i,od=RegExp("<(?:"+pc+")[\\s/>]","i"),wd=/^(?:checkbox|radio)$/,Dd=/checked\s*(?:[^=]|=\s*.checked.)/i,$d=/\/(java|ecma)script/i,ae=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,qb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],
thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ed=k(P),pd=Ed.appendChild(P.createElement("div"));qb.optgroup=qb.option;qb.tbody=qb.tfoot=qb.colgroup=qb.caption=qb.thead;qb.th=qb.td;n.support.htmlSerialize||(qb._default=[1,"X<div>","</div>"]);n.fn.extend({text:function(a){return n.access(this,function(a){return a===
b?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||P).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return n.isFunction(a)?this.each(function(b){n(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,
!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!h(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=n.clean(arguments);return this.pushStack(n.merge(a,this),"before",this.selector)}},after:function(){if(!h(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=n.clean(arguments);return this.pushStack(n.merge(this,
a),"after",this.selector)}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)if(!a||n.filter(a,[c]).length)!b&&1===c.nodeType&&(n.cleanData(c.getElementsByTagName("*")),n.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&n.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,
a,b)})},html:function(a){return n.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(Zb,""):b;if("string"==typeof a&&!kb.test(a)&&(n.support.htmlSerialize||!od.test(a))&&(n.support.leadingWhitespace||!Tb.test(a))&&!qb[(tc.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ab,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},1===c.nodeType&&(n.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},
replaceWith:function(a){return h(this[0])?this.length?this.pushStack(n(n.isFunction(a)?a():a),"replaceWith",a):this:n.isFunction(a)?this.each(function(b){var c=n(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=n(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;n(this).remove();b?n(b).before(a):n(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var a=[].concat.apply([],a),e,f,g,h=0,i=a[0],j=[],k=this.length;
if(!n.support.checkClone&&1<k&&"string"==typeof i&&Dd.test(i))return this.each(function(){n(this).domManip(a,c,d)});if(n.isFunction(i))return this.each(function(e){var f=n(this);a[0]=i.call(this,e,c?f.html():b);f.domManip(a,c,d)});if(this[0]){e=n.buildFragment(a,this,j);g=e.fragment;f=g.firstChild;1===g.childNodes.length&&(g=f);if(f){c=c&&n.nodeName(f,"tr");for(e=e.cacheable||k-1;h<k;h++)d.call(c&&n.nodeName(this[h],"table")?this[h].getElementsByTagName("tbody")[0]||this[h].appendChild(this[h].ownerDocument.createElement("tbody")):
this[h],h===e?g:n.clone(g,!0,!0))}g=f=null;j.length&&n.each(j,function(a,b){b.src?n.ajax?n.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):n.error("no ajax"):n.globalEval((b.text||b.textContent||b.innerHTML||"").replace(ae,""));b.parentNode&&b.parentNode.removeChild(b)})}return this}});n.buildFragment=function(a,c,d){var e,f,g,h=a[0];return c=c||P,c=(c[0]||c).ownerDocument||c[0]||c,"undefined"==typeof c.createDocumentFragment&&(c=P),1===a.length&&"string"==typeof h&&
512>h.length&&c===P&&"<"===h.charAt(0)&&!Zd.test(h)&&(n.support.checkClone||!Dd.test(h))&&(n.support.html5Clone||!od.test(h))&&(f=!0,e=n.fragments[h],g=e!==b),e||(e=c.createDocumentFragment(),n.clean(a,c,e,d),f&&(n.fragments[h]=g&&e)),{fragment:e,cacheable:f}};n.fragments={};n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(c){var d,e=0,f=[],c=n(c),g=c.length;d=1===this.length&&this[0].parentNode;if((null==
d||d&&11===d.nodeType&&1===d.childNodes.length)&&1===g)return c[b](this[0]),this;for(;e<g;e++)d=(0<e?this.clone(!0):this).get(),n(c[e])[b](d),f=f.concat(d);return this.pushStack(f,a,c.selector)}});n.extend({clone:function(a,b,c){var d,e,f,g;n.support.html5Clone||n.isXMLDoc(a)||!od.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(pd.innerHTML=a.outerHTML,pd.removeChild(g=pd.firstChild));if((!n.support.noCloneEvent||!n.support.noCloneChecked)&&(1===a.nodeType||11===a.nodeType)&&!n.isXMLDoc(a)){p(a,g);d=
m(a);e=m(g);for(f=0;d[f];++f)e[f]&&p(d[f],e[f])}if(b&&(l(a,g),c)){d=m(a);e=m(g);for(f=0;d[f];++f)l(d[f],e[f])}return g},clean:function(a,b,c,d){var e,f,g,h,i,j,s,l=0,u=[];if(!b||"undefined"==typeof b.createDocumentFragment)b=P;for(f=b===P&&Ed;null!=(g=a[l]);l++)if("number"==typeof g&&(g+=""),g){if("string"==typeof g)if(Ja.test(g)){f=f||k(b);j=j||f.appendChild(b.createElement("div"));g=g.replace(Ab,"<$1></$2>");e=(tc.exec(g)||["",""])[1].toLowerCase();h=qb[e]||qb._default;i=h[0];for(j.innerHTML=h[1]+
g+h[2];i--;)j=j.lastChild;if(!n.support.tbody){i=Yc.test(g);h="table"===e&&!i?j.firstChild&&j.firstChild.childNodes:"<table>"===h[1]&&!i?j.childNodes:[];for(e=h.length-1;0<=e;--e)n.nodeName(h[e],"tbody")&&!h[e].childNodes.length&&h[e].parentNode.removeChild(h[e])}!n.support.leadingWhitespace&&Tb.test(g)&&j.insertBefore(b.createTextNode(Tb.exec(g)[0]),j.firstChild);g=j.childNodes;j=f.lastChild}else g=b.createTextNode(g);g.nodeType?u.push(g):u=n.merge(u,g)}j&&(f.removeChild(j),g=j=f=null);if(!n.support.appendChecked)for(l=
0;null!=(g=u[l]);l++)n.nodeName(g,"input")?r(g):"undefined"!=typeof g.getElementsByTagName&&n.grep(g.getElementsByTagName("input"),r);if(c){a=function(a){if(!a.type||$d.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(l=0;null!=(g=u[l]);l++)if(!n.nodeName(g,"script")||!a(g))c.appendChild(g),"undefined"!=typeof g.getElementsByTagName&&(s=n.grep(n.merge([],g.getElementsByTagName("script")),a),u.splice.apply(u,[l+1,0].concat(s)),l+=s.length)}return u},cleanData:function(a,
b){for(var c,d,e,f,g=0,h=n.expando,i=n.cache,j=n.support.deleteExpando,k=n.event.special;null!=(e=a[g]);g++)if(b||n.acceptData(e))if(c=(d=e[h])&&i[d]){if(c.events)for(f in c.events)k[f]?n.event.remove(e,f):n.removeEvent(e,f,c.handle);i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,n.deletedIds.push(d))}}});(function(){var a,b;n.uaMatch=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||
/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}};a=n.uaMatch(T.userAgent);b={};a.browser&&(b[a.browser]=!0,b.version=a.version);b.webkit&&(b.safari=!0);n.browser=b;n.sub=function(){function a(b,c){return new a.fn.init(b,c)}n.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){return d&&d instanceof n&&!(d instanceof a)&&(d=a(d)),n.fn.init.call(this,
c,d,b)};a.fn.init.prototype=a.fn;var b=a(P);return a}})();var bb,zc,Ac,qd=/alpha\([^)]*\)/i,be=/opacity=([^)]*)/,ce=/^(top|right|bottom|left)$/,Fd=/^margin/,Od=RegExp("^("+Ga+")(.*)$","i"),Vc=RegExp("^("+Ga+")(?!px)[a-z%]+$","i"),de=RegExp("^([-+])=("+Ga+")","i"),jd={},ee={position:"absolute",visibility:"hidden",display:"block"},Gd={letterSpacing:0,fontWeight:400,lineHeight:1},qc=["Top","Right","Bottom","Left"],xd=["Webkit","O","Moz","ms"],fb=n.fn.toggle;n.fn.extend({css:function(a,c){return n.access(this,
function(a,c,d){return d!==b?n.style(a,c,d):n.css(a,c)},a,c,1<arguments.length)},show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(a,b){var c="boolean"==typeof a;return n.isFunction(a)&&n.isFunction(b)?fb.apply(this,arguments):this.each(function(){(c?a:t(this))?n(this).show():n(this).hide()})}});n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bb(a,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,
widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":n.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&!(3===a.nodeType||8===a.nodeType||!a.style)){var f,g,h,i=n.camelCase(c),j=a.style,c=n.cssProps[i]||(n.cssProps[i]=q(j,i));h=n.cssHooks[c]||n.cssHooks[i];if(d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];g=typeof d;"string"===g&&(f=de.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(n.css(a,c)),g="number");if(!(null==d||"number"===g&&isNaN(d)))if("number"===g&&!n.cssNumber[i]&&(d+=
"px"),!h||!("set"in h)||(d=h.set(a,d,e))!==b)try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=n.camelCase(c);return c=n.cssProps[i]||(n.cssProps[i]=q(a.style,i)),h=n.cssHooks[c]||n.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,e)),f===b&&(f=bb(a,c)),"normal"===f&&c in Gd&&(f=Gd[c]),d||e!==b?(g=parseFloat(f),d||n.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e={};for(d in b)e[d]=a.style[d],a.style[d]=b[d];c=c.call(a);for(d in b)a.style[d]=e[d];return c}});a.getComputedStyle?bb=function(a,b){var c,
d,e,f,g=getComputedStyle(a,null),h=a.style;return g&&(c=g[b],""===c&&!n.contains(a.ownerDocument.documentElement,a)&&(c=n.style(a,b)),Vc.test(c)&&Fd.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=c,c=g.width,h.width=d,h.minWidth=e,h.maxWidth=f)),c}:P.documentElement.currentStyle&&(bb=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return null==e&&f&&f[b]&&(e=f[b]),Vc.test(e)&&!ce.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=
a.currentStyle.left),f.left="fontSize"===b?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),""===e?"auto":e});n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){if(c)return 0!==a.offsetWidth||"none"!==bb(a,"display")?x(a,b,d):n.swap(a,ee,function(){return x(a,b,d)})},set:function(a,c,d){return w(a,c,d?z(a,b,d,n.support.boxSizing&&"border-box"===n.css(a,"boxSizing")):0)}}});n.support.opacity||(n.cssHooks.opacity={get:function(a,b){return be.test((b&&a.currentStyle?
a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(1<=b&&""===n.trim(f.replace(qd,""))&&c.removeAttribute&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=qd.test(f)?f.replace(qd,e):f+" "+e}});n(function(){n.support.reliableMarginRight||(n.cssHooks.marginRight={get:function(a,b){return n.swap(a,{display:"inline-block"},function(){if(b)return bb(a,
"marginRight")})}});!n.support.pixelPosition&&n.fn.position&&n.each(["top","left"],function(a,b){n.cssHooks[b]={get:function(a,c){if(c){var d=bb(a,b);return Vc.test(d)?n(a).position()[b]+"px":d}}}})});n.expr&&n.expr.filters&&(n.expr.filters.hidden=function(a){return 0===a.offsetWidth&&0===a.offsetHeight||!n.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||bb(a,"display"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)});n.each({margin:"",padding:"",border:"Width"},
function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d="string"==typeof c?c.split(" "):[c],e={},c=0;4>c;c++)e[a+qc[c]+b]=d[c]||d[c-2]||d[0];return e}};Fd.test(a)||(n.cssHooks[a+b].set=w)});var fe=/%20/g,Pd=/\[\]$/,Hd=/\r?\n/g,rb=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ia=/^(?:select|textarea)/i;n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
n.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ia.test(this.nodeName)||rb.test(this.type))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Hd,"\r\n")}}):{name:b.name,value:c.replace(Hd,"\r\n")}}).get()}});n.param=function(a,c){var d,e=[],f=function(a,b){b=n.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=n.ajaxSettings&&
n.ajaxSettings.traditional);if(n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){f(this.name,this.value)});else for(d in a)F(d,a[d],c,f);return e.join("&").replace(fe,"+")};var sb,lb,Xa=/#.*$/,ge=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,he=/^(?:GET|HEAD)$/,ga=/^\/\//,Zc=/\?/,Za=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rd=/([?&])_=[^&]*/,Ub=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Pc=n.fn.load,rc={},Qc={},uc=["*/"]+["*"];try{sb=H.href}catch(O){sb=P.createElement("a"),sb.href=
"",sb=sb.href}lb=Ub.exec(sb.toLowerCase())||[];n.fn.load=function(a,c,d){if("string"!=typeof a&&Pc)return Pc.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,i=a.indexOf(" ");return 0<=i&&(e=a.slice(i,a.length),a=a.slice(0,i)),n.isFunction(c)?(d=c,c=b):"object"==typeof c&&(f="POST"),n.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments;h.html(e?n("<div>").append(a.replace(Za,"")).find(e):a)}),this};
n.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(a,b){n.fn[b]=function(a){return this.on(b,a)}});n.each(["get","post"],function(a,c){n[c]=function(a,d,e,f){return n.isFunction(d)&&(f=f||e,e=d,d=b),n.ajax({type:c,url:a,data:d,success:e,dataType:f})}});n.extend({getScript:function(a,c){return n.get(a,b,c,"script")},getJSON:function(a,b,c){return n.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?y(a,n.ajaxSettings):(b=a,a=n.ajaxSettings),y(a,b),a},ajaxSettings:{url:sb,
isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(lb[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":uc},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},
flatOptions:{context:!0,url:!0}},ajaxPrefilter:C(rc),ajaxTransport:C(Qc),ajax:function(a,c){function d(a,c,g,j){var s,r,q,B,L,t=c;if(2!==T){T=2;i&&clearTimeout(i);h=b;f=j||"";J.readyState=0<a?4:0;if(g){B=l;var j=J,Q,I,N,M,H=B.contents,W=B.dataTypes,x=B.responseFields;for(I in x)I in g&&(j[x[I]]=g[I]);for(;"*"===W[0];)W.shift(),Q===b&&(Q=B.mimeType||j.getResponseHeader("content-type"));if(Q)for(I in H)if(H[I]&&H[I].test(Q)){W.unshift(I);break}if(W[0]in g)N=W[0];else{for(I in g){if(!W[0]||B.converters[I+
" "+W[0]]){N=I;break}M||(M=I)}N=N||M}B=N?(N!==W[0]&&W.unshift(N),g[N]):void 0}if(200<=a&&300>a||304===a)if(l.ifModified&&(L=J.getResponseHeader("Last-Modified"),L&&(n.lastModified[e]=L),L=J.getResponseHeader("Etag"),L&&(n.etag[e]=L)),304===a)t="notmodified",s=!0;else{var v;a:{g=l;s=B;var cb;L=g.dataTypes.slice();t=L[0];Q={};I=0;g.dataFilter&&(s=g.dataFilter(s,g.dataType));if(L[1])for(v in g.converters)Q[v.toLowerCase()]=g.converters[v];for(;r=L[++I];)if("*"!==r){if("*"!==t&&t!==r){v=Q[t+" "+r]||Q["* "+
r];if(!v)for(cb in Q)if(q=cb.split(" "),q[1]===r&&(v=Q[t+" "+q[0]]||Q["* "+q[0]])){!0===v?v=Q[cb]:!0!==Q[cb]&&(r=q[0],L.splice(I--,0,r));break}if(!0!==v)if(v&&g["throws"])s=v(s);else try{s=v(s)}catch(y){v={state:"parsererror",error:v?y:"No conversion from "+t+" to "+r};break a}}t=r}v={state:"success",data:s}}s=v;t=s.state;r=s.data;q=s.error;s=!q}else if(q=t,!t||a)t="error",0>a&&(a=0);J.status=a;J.statusText=""+(c||t);s?p.resolveWith(u,[r,t,J]):p.rejectWith(u,[J,t,q]);J.statusCode(E);E=b;k&&o.trigger("ajax"+
(s?"Success":"Error"),[J,l,s?r:q]);m.fireWith(u,[J,t]);k&&(o.trigger("ajaxComplete",[J,l]),--n.active||n.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=b);var c=c||{},e,f,g,h,i,j,k,s,l=n.ajaxSetup({},c),u=l.context||l,o=u!==l&&(u.nodeType||u instanceof n)?n(u):n.event,p=n.Deferred(),m=n.Callbacks("once memory"),E=l.statusCode||{},r={},q={},T=0,B="canceled",J={readyState:0,setRequestHeader:function(a,b){if(!T){var c=a.toLowerCase(),a=q[c]=q[c]||a;r[a]=b}return this},getAllResponseHeaders:function(){return 2===
T?f:null},getResponseHeader:function(a){var c;if(2===T){if(!g)for(g={};c=ge.exec(f);)g[c[1].toLowerCase()]=c[2];c=g[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return T||(l.mimeType=a),this},abort:function(a){return a=a||B,h&&h.abort(a),d(0,a),this}};p.promise(J);J.success=J.done;J.error=J.fail;J.complete=m.add;J.statusCode=function(a){if(a){var b;if(2>T)for(b in a)E[b]=[E[b],a[b]];else b=a[J.status],J.always(b)}return this};l.url=((a||l.url)+"").replace(Xa,"").replace(ga,lb[1]+
"//");l.dataTypes=n.trim(l.dataType||"*").toLowerCase().split(Fa);null==l.crossDomain&&(j=Ub.exec(l.url.toLowerCase()),l.crossDomain=!(!j||j[1]==lb[1]&&j[2]==lb[2]&&(j[3]||("http:"===j[1]?80:443))==(lb[3]||("http:"===lb[1]?80:443))));l.data&&l.processData&&"string"!=typeof l.data&&(l.data=n.param(l.data,l.traditional));D(rc,l,c,J);if(2===T)return J;k=l.global;l.type=l.type.toUpperCase();l.hasContent=!he.test(l.type);k&&0===n.active++&&n.event.trigger("ajaxStart");if(!l.hasContent&&(l.data&&(l.url+=
(Zc.test(l.url)?"&":"?")+l.data,delete l.data),e=l.url,!1===l.cache)){j=n.now();var L=l.url.replace(rd,"$1_="+j);l.url=L+(L===l.url?(Zc.test(l.url)?"&":"?")+"_="+j:"")}(l.data&&l.hasContent&&!1!==l.contentType||c.contentType)&&J.setRequestHeader("Content-Type",l.contentType);l.ifModified&&(e=e||l.url,n.lastModified[e]&&J.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&J.setRequestHeader("If-None-Match",n.etag[e]));J.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?
l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+uc+"; q=0.01":""):l.accepts["*"]);for(s in l.headers)J.setRequestHeader(s,l.headers[s]);if(!l.beforeSend||!1!==l.beforeSend.call(u,J,l)&&2!==T){B="abort";for(s in{success:1,error:1,complete:1})J[s](l[s]);if(h=D(Qc,l,c,J)){J.readyState=1;k&&o.trigger("ajaxSend",[J,l]);l.async&&0<l.timeout&&(i=setTimeout(function(){J.abort("timeout")},l.timeout));try{T=1,h.send(r,d)}catch(t){if(2>T)d(-1,t);else throw t;}}else d(-1,"No Transport");return J}return J.abort()},
active:0,lastModified:{},etag:{}});var U=[],mb=/\?/,S=/(=)\?(?=&|$)|\?\?/,jc=n.now();n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=U.pop()||n.expando+"_"+jc++;return this[a]=!0,a}});n.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=!1!==c.jsonp,l=k&&S.test(j),s=k&&!l&&"string"==typeof i&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&S.test(i);if("jsonp"===c.dataTypes[0]||l||s)return f=c.jsonpCallback=n.isFunction(c.jsonpCallback)?c.jsonpCallback():
c.jsonpCallback,g=a[f],l?c.url=j.replace(S,"$1"+f):s?c.data=i.replace(S,"$1"+f):k&&(c.url+=(mb.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||n.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g;c[f]&&(c.jsonpCallback=d.jsonpCallback,U.push(f));h&&n.isFunction(g)&&g(h[0]);h=g=b}),"script"});n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return n.globalEval(a),a}}});n.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});n.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=P.head||P.getElementsByTagName("head")[0]||P.documentElement;return{send:function(e,f){c=P.createElement("script");c.async="async";a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var gb,hb=a.ActiveXObject?function(){for(var a in gb)gb[a](0,1)}:!1,Ec=0;n.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&s()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:s;(function(a){n.extend(n.support,{ajax:!!a,
cors:!!a&&"withCredentials"in a})})(n.ajaxSettings.xhr());n.support.ajax&&n.ajaxTransport(function(c){if(!c.crossDomain||n.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType);!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,
e[h])}catch(j){}i.send(c.hasContent&&c.data||null);d=function(a,e){var h,j,k,l,s;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=n.noop,hb&&delete gb[g]),e)4!==i.readyState&&i.abort();else{h=i.status;k=i.getAllResponseHeaders();l={};(s=i.responseXML)&&s.documentElement&&(l.xml=s);try{l.text=i.responseText}catch(u){}try{j=i.statusText}catch(o){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:1223===h&&(h=204)}}catch(p){e||f(-1,p)}l&&f(h,j,l,k)};c.async?4===i.readyState?setTimeout(d,
0):(g=++Ec,hb&&(gb||(gb={},n(a).unload(hb)),gb[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var ib,Bb,kc=/^(?:toggle|show|hide)$/,X=RegExp("^(?:([-+])=|)("+Ga+")([a-z%]*)$","i"),Y=/queueHooks$/,V=[function(a,b,c){var d,e,f,g,h,i,j=this,k=a.style,l={},s=[],u=a.nodeType&&t(a);c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,j.always(function(){j.always(function(){h.unqueued--;n.queue(a,"fx").length||
h.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[k.overflow,k.overflowX,k.overflowY],"inline"===n.css(a,"display")&&"none"===n.css(a,"float")&&(!n.support.inlineBlockNeedsLayout||"inline"===A(a.nodeName)?k.display="inline-block":k.zoom=1));c.overflow&&(k.overflow="hidden",n.support.shrinkWrapBlocks||j.done(function(){k.overflow=c.overflow[0];k.overflowX=c.overflow[1];k.overflowY=c.overflow[2]}));for(d in b)e=b[d],kc.exec(e)&&(delete b[d],e!==(u?"hide":"show")&&s.push(d));
if(e=s.length){f=n._data(a,"fxshow")||n._data(a,"fxshow",{});u?n(a).show():j.done(function(){n(a).hide()});j.done(function(){var b;n.removeData(a,"fxshow",!0);for(b in l)n.style(a,b,l[b])});for(d=0;d<e;d++)b=s[d],g=j.createTween(b,u?f[b]:0),l[b]=f[b]||n.style(a,b),b in f||(f[b]=g.start,u&&(g.end=g.start,g.start="width"===b||"height"===b?1:0))}}],ka={"*":[function(a,b){var c,d,e,f=this.createTween(a,b),g=X.exec(b),h=f.cur(),i=+h||0,j=1;if(g){c=+g[2];d=g[3]||(n.cssNumber[a]?"":"px");if("px"!==d&&i){i=
n.css(f.elem,a,!0)||c||1;do e=j=j||".5",i/=j,n.style(f.elem,a,i+d),j=f.cur()/h;while(1!==j&&j!==e)}f.unit=d;f.start=i;f.end=g[1]?i+(g[1]+1)*c:c}return f}]};n.Animation=n.extend(J,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],ka[c]=ka[c]||[],ka[c].unshift(b)},prefilter:function(a,b){b?V.unshift(a):V.push(a)}});n.Tween=B;B.prototype={constructor:B,init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=
this.now=this.cur();this.end=d;this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=B.propHooks[this.prop];return a&&a.get?a.get(this):B.propHooks._default.get(this)},run:function(a){var b,c=B.propHooks[this.prop];return this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration),this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):B.propHooks._default.set(this),this}};B.prototype.init.prototype=
B.prototype;B.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,!1,""),!b||"auto"===b?0:b):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};
n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(d,e,f){return null==d||"boolean"==typeof d||!a&&n.isFunction(d)&&n.isFunction(e)?c.apply(this,arguments):this.animate(M(b,!0),d,e,f)}});n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(t).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),b=function(){var b=J(this,n.extend({},a),f);e&&b.stop(!0)};return e||!1===f.queue?this.each(b):this.queue(f.queue,
b)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop;b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=n.timers,g=n._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&Y.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem===this&&(null==a||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&n.dequeue(this,a)})}});n.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";return d.old=d.complete,
d.complete=function(){n.isFunction(d.old)&&d.old.call(this);d.queue&&n.dequeue(this,d.queue)},d};n.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};n.timers=[];n.fx=B.prototype.init;n.fx.tick=function(){for(var a,b=n.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||n.fx.stop()};n.fx.timer=function(a){a()&&n.timers.push(a)&&!Bb&&(Bb=setInterval(n.fx.tick,n.fx.interval))};n.fx.interval=13;n.fx.stop=function(){clearInterval(Bb);Bb=null};
n.fx.speeds={slow:600,fast:200,_default:400};n.fx.step={};n.expr&&n.expr.filters&&(n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length});var tb=/^(?:body|html)$/i;n.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){n.offset.setOffset(this,a,b)});var c,d,e,f,g,h,i,j,k,l,s=this[0],u=s&&s.ownerDocument;return!u?void 0:(e=u.body)===s?n.offset.bodyOffset(s):(d=u.documentElement,n.contains(d,s)?(c=s.getBoundingClientRect(),f=
I(u),g=d.clientTop||e.clientTop||0,h=d.clientLeft||e.clientLeft||0,i=f.pageYOffset||d.scrollTop,j=f.pageXOffset||d.scrollLeft,k=c.top+i-g,l=c.left+j-h,{top:k,left:l}):{top:0,left:0})};n.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return n.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(n.css(a,"marginTop"))||0,c+=parseFloat(n.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=n.css(a,"position");"static"===d&&(a.style.position="relative");var e=n(a),
f=e.offset(),g=n.css(a,"top"),h=n.css(a,"left"),i={},j={},k,l;("absolute"===d||"fixed"===d)&&-1<n.inArray("auto",[g,h])?(j=e.position(),k=j.top,l=j.left):(k=parseFloat(g)||0,l=parseFloat(h)||0);n.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(i.top=b.top-f.top+k);null!=b.left&&(i.left=b.left-f.left+l);"using"in b?b.using.call(a,i):e.css(i)}};n.fn.extend({position:function(){if(this[0]){var a=this[0],b=this.offsetParent(),c=this.offset(),d=tb.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=
parseFloat(n.css(a,"marginTop"))||0,c.left-=parseFloat(n.css(a,"marginLeft"))||0,d.top+=parseFloat(n.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(n.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||P.body;a&&!tb.test(a.nodeName)&&"static"===n.css(a,"position");)a=a.offsetParent;return a||P.body})}});n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);n.fn[a]=
function(e){return n.access(this,function(a,e,f){var g=I(a);if(f===b)return g?c in g?g[c]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?n(g).scrollLeft():f,d?f:n(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}});n.each({Height:"height",Width:"width"},function(a,c){n.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){n.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(!0===e||!0===f?"margin":"border");return n.access(this,function(c,d,e){var f;return n.isWindow(c)?
c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?n.css(c,d,e,h):n.style(c,d,e,h)},c,g?e:b,g)}})});a.jQuery=a.$=n;"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return n})})(window);
(function(a,b,c){function d(a){return a}function e(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g,g=a.cookie=function(f,i,j){if(i!==c){j=a.extend({},g.defaults,j);null===i&&(j.expires=-1);if("number"===typeof j.expires){var k=j.expires,l=j.expires=new Date;l.setDate(l.getDate()+k)}i=g.json?JSON.stringify(i):""+i;return b.cookie=[encodeURIComponent(f),"=",g.raw?i:encodeURIComponent(i),j.expires?"; expires="+j.expires.toUTCString():"",j.path?"; path="+j.path:"",j.domain?"; domain="+j.domain:
"",j.secure?"; secure":""].join("")}i=g.raw?d:e;j=b.cookie.split("; ");for(k=0;l=j[k]&&j[k].split("=");k++)if(i(l.shift())===f)return f=i(l.join("=")),g.json?JSON.parse(f):f;return null};g.defaults={};a.removeCookie=function(b,c){return null!==a.cookie(b,c)?(a.cookie(b,null,c),!0):!1}})(jQuery,document);
(function(a){function b(b,d){this.$element=a(b);this.options=d;this.enabled=!0;this.fixTitle()}b.prototype={show:function(){var b=this.getTitle();if(b&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](b);d[0].className="tipsy";d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var b=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),e=d[0].offsetWidth,f=d[0].offsetHeight,
g="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity,h;switch(g.charAt(0)){case "n":h={top:b.top+b.height+this.options.offset,left:b.left+b.width/2-e/2};break;case "s":h={top:b.top-f-this.options.offset,left:b.left+b.width/2-e/2};break;case "e":h={top:b.top+b.height/2-f/2,left:b.left-e-this.options.offset};break;case "w":h={top:b.top+b.height/2-f/2,left:b.left+b.width+this.options.offset}}2==g.length&&(h.left="w"==g.charAt(1)?b.left+b.width/2-
15:b.left+b.width/2-e+15);d.css(h).addClass("tipsy-"+g);d.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+g.charAt(0);this.options.className&&d.addClass("function"==typeof this.options.className?this.options.className.call(this.$element[0]):this.options.className);this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):
this.tip().remove()},fixTitle:function(){var a=this.$element;if(a.attr("title")||"string"!=typeof a.attr("original-title"))a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,e=this.options;this.fixTitle();e=this.options;"string"==typeof e.title?a=b.attr("title"==e.title?"original-title":e.title):"function"==typeof e.title&&(a=e.title.call(b[0]));return(a=(""+a).replace(/(^\s*|\s*$)/,""))||e.fallback},tip:function(){this.$tip||(this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),
this.$tip.data("tipsy-pointee",this.$element[0]));return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(c){function d(d){var e=a.data(d,"tipsy");e||(e=new b(d,a.fn.tipsy.elementOptions(d,c)),a.data(d,"tipsy",e));return e}function e(){var a=d(this);a.hoverState="in";0==c.delayIn?a.show():(a.fixTitle(),
setTimeout(function(){"in"==a.hoverState&&a.show()},c.delayIn))}function f(){var a=d(this);a.hoverState="out";0==c.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&a.hide()},c.delayOut)}if(!0===c)return this.data("tipsy");if("string"==typeof c){var g=this.data("tipsy");if(g)g[c]();return this}c=a.extend({},a.fn.tipsy.defaults,c);c.live||this.each(function(){d(this)});if("manual"!=c.trigger){var g=c.live?"live":"bind",h="hover"==c.trigger?"mouseleave":"blur";this[g]("hover"==c.trigger?
"mouseenter":"focus",e)[g](h,f)}return this};a.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.revalidate=function(){a(".tipsy").each(function(){var b=a.data(this,"tipsy-pointee"),d;if(!(d=!b)){a:{for(;b=b.parentNode;)if(b==document){b=!0;break a}b=!1}d=!b}d&&a(this).remove()})};a.fn.tipsy.elementOptions=function(b,d){return a.metadata?a.extend({},d,a(b).metadata()):d};a.fn.tipsy.autoNS=
function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"};a.fn.tipsy.autoBounds=function(b,d){return function(){var e=d[0],f=1<d.length?d[1]:!1,g=a(document).scrollTop()+b,h=a(document).scrollLeft()+b,i=a(this);i.offset().top<g&&(e="n");i.offset().left<h&&(f="w");a(window).width()+a(document).scrollLeft()-i.offset().left<b&&(f="e");a(window).height()+a(document).scrollTop()-
i.offset().top<b&&(e="s");return e+(f?f:"")}}})(jQuery);
function Hammer(a,b,c){var d,e,f,g,h,i;function j(a){return a.touches?a.touches.length:1}function k(a){var b=document,c=b.body;return[{x:a.pageX||a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&b.clientLeft||0),y:a.pageY||a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&b.clientTop||0)}]}function l(a){for(var c=[],d,e=0,f=b.two_touch_max?Math.min(2,a.touches.length):a.touches.length;e<f;e++)d=a.touches[e],c.push({x:d.pageX,y:d.pageY});return c}function p(a){var d=
k,a=a||window.event;L?d=l:b.allow_touch_and_mouse&&a.touches!==c&&0<a.touches.length&&(d=l);return d(a)}function m(a,b){return 180*Math.atan2(b.y-a.y,b.x-a.x)/Math.PI}function r(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)}function q(a,b){if(2==a.length&&2==b.length){var c=r(a[0],a[1]);return r(b[0],b[1])/c}return 0}function t(a,b){if(2==a.length&&2==b.length){var c=m(a[1],a[0]);return m(b[1],b[0])-c}return 0}function v(a,b){b.touches=p(b.originalEvent);b.type=a;"[object Function]"==Object.prototype.toString.call(y["on"+
a])&&y["on"+a].call(y,b)}function w(a){a=a||window.event;a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0)}function z(){i=h=g=f=void 0;N=!1;u=E=0;B=null}function x(c){function k(){f=p(c);I=(new Date).getTime();j(c);N=!0;T=c;var b=a.getBoundingClientRect(),g=a.clientLeft||document.body.clientLeft||0,h=window.pageXOffset||a.scrollLeft||document.body.scrollLeft;d=b.top+(window.pageYOffset||a.scrollTop||document.body.scrollTop)-(a.clientTop||document.body.clientTop||
0);e=b.left+h-g;H=!0;ea.hold(c)}var l;switch(c.type){case "mousedown":case "touchstart":l=j(c);W=1===l;2===l&&"drag"===B&&v("dragend",{originalEvent:c,direction:J,distance:E,angle:u});k();b.prevent_default&&w(c);break;case "mousemove":case "touchmove":l=j(c);if(!H&&1===l)return!1;!H&&2===l&&(W=!1,z(),k());g=p(c);ea.transform(c)||ea.drag(c);break;case "mouseup":case "mouseout":case "touchcancel":case "touchend":l=!0;H=!1;ea.swipe(c);if("drag"==B)v("dragend",{originalEvent:c,direction:J,distance:E,
angle:u});else if("transform"==B){var s=h.x-i.x,o=h.y-i.y;v("transformend",{originalEvent:c,position:h,scale:q(f,g),rotation:t(f,g),distance:E,distanceX:s,distanceY:o});1===j(c)&&(z(),k(),l=!1)}else W&&"mouseout"!=c.type&&ea.tap(T);null!==B&&(M=B,v("release",{originalEvent:c,gesture:B,position:g||f}));l&&z()}}function A(b){var c;a:if(c=b.relatedTarget,!c&&window.event&&window.event.toElement&&(c=window.event.toElement),a===c)c=!0;else{if(c)for(c=c.parentNode;null!==c;){if(c===a){c=!0;break a}c=c.parentNode}c=
!1}c||x(b)}function F(a,b){var c={};if(!b)return a;for(var d in a)c[d]=d in b?b[d]:a[d];return c}function C(a,b,c){for(var b=b.split(" "),d=0,e=b.length;d<e;d++)a.addEventListener?a.addEventListener(b[d],c,!1):document.attachEvent&&a.attachEvent("on"+b[d],c)}function D(a,b,c){for(var b=b.split(" "),d=0,e=b.length;d<e;d++)a.removeEventListener?a.removeEventListener(b[d],c,!1):document.detachEvent&&a.detachEvent("on"+b[d],c)}var y=this,s=F({prevent_default:!1,css_hacks:!0,swipe:!0,swipe_time:500,swipe_min_distance:20,
drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:0.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_max_distance:10,tap_double_distance:20,hold:!0,hold_timeout:500,allow_touch_and_mouse:!1},Hammer.defaults||{}),b=F(s,b);(function(){if(!b.css_hacks)return!1;for(var c=["webkit","moz","ms","o",""],d={userSelect:"none",touchCallout:"none",touchAction:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},e="",f=0;f<c.length;f++)for(var g in d)e=
g,c[f]&&(e=c[f]+e.substring(0,1).toUpperCase()+e.substring(1)),a.style[e]=d[g]})();var E=0,u=0,J=0;i=h=g=f=void 0;var N=!1,B=null,M=null,I=null,o={x:0,y:0},Q=null,P=null;e=d=void 0;var H=!1,T,L="ontouchstart"in window,W=!1;this.option=function(a,d){d!==c&&(b[a]=d);return b[a]};this.getDirectionFromAngle=function(a){var a={down:45<=a&&135>a,left:135<=a||-135>=a,up:-45>a&&-135<a,right:-45<=a&&45>=a},b,c;for(c in a)if(a[c]){b=c;break}return b};this.destroy=function(){(L||b.allow_touch_and_mouse)&&D(a,
"touchstart touchmove touchend touchcancel",x);if(!L||b.allow_touch_and_mouse)D(a,"mouseup mousedown mousemove",x),D(a,"mouseout",A)};var ea={hold:function(a){b.hold&&(B="hold",clearTimeout(P),P=setTimeout(function(){"hold"==B&&v("hold",{originalEvent:a,position:f})},b.hold_timeout))},swipe:function(a){if(g&&"transform"!==B){var c=g[0].x-f[0].x,h=g[0].y-f[0].y;E=Math.sqrt(c*c+h*h);var i=(new Date).getTime()-I;b.swipe&&b.swipe_time>=i&&E>=b.swipe_min_distance&&(u=m(f[0],g[0]),J=y.getDirectionFromAngle(u),
B="swipe",v("swipe",{originalEvent:a,position:{x:g[0].x-e,y:g[0].y-d},direction:J,distance:E,distanceX:c,distanceY:h,angle:u}))}},drag:function(a){var c=g[0].x-f[0].x,h=g[0].y-f[0].y;E=Math.sqrt(c*c+h*h);if(b.drag&&E>b.drag_min_distance||"drag"==B){u=m(f[0],g[0]);J=y.getDirectionFromAngle(u);var i="up"==J||"down"==J;(i&&!b.drag_vertical||!i&&!b.drag_horizontal)&&E>b.drag_min_distance||(B="drag",c={originalEvent:a,position:{x:g[0].x-e,y:g[0].y-d},direction:J,distance:E,distanceX:c,distanceY:h,angle:u},
N&&(v("dragstart",c),N=!1),v("drag",c),w(a))}},transform:function(a){if(b.transform){if(2!==j(a))return!1;var c=t(f,g),k=q(f,g);if("transform"===B||Math.abs(1-k)>b.scale_treshold||Math.abs(c)>b.rotation_treshold){B="transform";h={x:(g[0].x+g[1].x)/2-e,y:(g[0].y+g[1].y)/2-d};N&&(i=h);var l=h.x-i.x,s=h.y-i.y;E=Math.sqrt(l*l+s*s);c={originalEvent:a,position:h,scale:k,rotation:c,distance:E,distanceX:l,distanceY:s};N&&(v("transformstart",c),N=!1);v("transform",c);w(a);return!0}}return!1},tap:function(a){var c=
(new Date).getTime(),d=c-I;if(!b.hold||b.hold&&b.hold_timeout>d){if(o&&b.tap_double&&"tap"==M&&f&&I-Q<b.tap_max_interval)var d=Math.abs(o[0].x-f[0].x),e=Math.abs(o[0].y-f[0].y),d=o&&f&&Math.max(d,e)<b.tap_double_distance;else d=!1;d?(B="double_tap",Q=null,v("doubletap",{originalEvent:a,position:f}),w(a)):(d=g?Math.abs(g[0].x-f[0].x):0,e=g?Math.abs(g[0].y-f[0].y):0,E=Math.max(d,e),E<b.tap_max_distance&&(B="tap",Q=c,o=f,b.tap&&(v("tap",{originalEvent:a,position:f}),w(a))))}}};(L||b.allow_touch_and_mouse)&&
C(a,"touchstart touchmove touchend touchcancel",x);if(!L||b.allow_touch_and_mouse)C(a,"mouseup mousedown mousemove",x),C(a,"mouseout",A)}
(function(a){function b(b,d){this._delegateGuids=[];this._fn=function(e){d.trigger(a.Event(b,e))};this._delegateFn=function(d){d=a.Event(b,d);a(d.originalEvent.target).trigger(d)}}b.prototype={addDelegate:function(a){this._delegateGuids.push(a);return this},removeDelegate:function(a){a=this._delegateGuids.indexOf(a);0<=a&&this._delegateGuids.splice(a);return this},getFn:function(){return 0<this._delegateGuids.length?this._delegateFn:this._fn},destroy:function(){this._delegateGuids=this._delegateFn=
this._fn=null;delete this._fn;delete this._delegateFn;delete this._delegateGuids}};a.each("hold,tap,doubletap,transformstart,transform,transformend,dragstart,drag,dragend,swipe,release".split(","),function(c,d){a.event.special[d]={setup:function(c){var f=a(this),g=f.data("hammerjs");if(!g){g=new Hammer(this,c);g.__Fns={};f.data("hammerjs",g)}g.__Fns[d]=new b(d,f)},add:function(b){var c=a(this).data("hammerjs");b.selector&&c.__Fns[d].addDelegate(b.guid);c["on"+d]=c.__Fns[d].getFn()},remove:function(b){var c=
a(this).data("hammerjs");b.selector&&c.__Fns[d].removeDelegate(b.guid);c["on"+d]=c.__Fns[d].getFn()},teardown:function(){var b=a(this).data("hammerjs");b.__Fns[d].destroy();delete b.__Fns[d]}}})})(jQuery);
jQuery.fn.hammer=function(a){return this.each(function(){var b=new Hammer(this,a),c=jQuery(this);c.data("hammer",b);for(var d="hold,tap,doubletap,transformstart,transform,transformend,dragstart,drag,dragend,swipe,release".split(","),e=0;e<d.length;e++)b["on"+d[e]]=function(a,b){return function(c){a.trigger(jQuery.Event(b,c))}}(c,d[e])})};"use strict";var THREE=THREE||{REVISION:"49"};self.Int32Array||(self.Int32Array=Array,self.Float32Array=Array);
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};THREE.Clock.prototype.start=function(){this.oldTime=this.startTime=Date.now();this.running=!0};THREE.Clock.prototype.stop=function(){this.getElapsedTime();this.running=!1};THREE.Clock.prototype.getElapsedTime=function(){return this.elapsedTime+=this.getDelta()};
THREE.Clock.prototype.getDelta=function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=Date.now(),a=0.0010*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a};THREE.Color=function(a){void 0!==a&&this.setHex(a);return this};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);
this.b=Math.sqrt(this.b);return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSV:function(a,b,c){var d,e,f;if(0===c)this.r=this.g=this.b=0;else switch(d=Math.floor(6*a),e=6*a-d,a=c*(1-b),f=c*(1-b*e),b=c*(1-b*(1-e)),d){case 1:this.r=f;this.g=c;this.b=a;break;case 2:this.r=a;this.g=c;this.b=b;break;case 3:this.r=a;this.g=f;this.b=c;break;case 4:this.r=b;this.g=a;this.b=c;break;case 5:this.r=c;this.g=a;this.b=f;break;case 6:case 0:this.r=c,this.g=b,this.b=a}return this},setHex:function(a){a=
Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},lerpSelf:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},getHex:function(){return Math.floor(255*this.r)<<16^Math.floor(255*this.g)<<8^Math.floor(255*this.b)},getContextStyle:function(){return"rgb("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+")"},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a):this.set(0,
0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,
b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},isZero:function(){return 1.0E-4>this.lengthSq()},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},
sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},multiply:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},multiplySelf:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},divideSelf:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a):
this.z=this.y=this.x=0;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){this.x+=
(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},crossSelf:function(a){var b=this.x,c=this.y,d=this.z;this.x=c*a.z-d*a.y;this.y=d*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){return(new THREE.Vector3).sub(this,a).lengthSq()},getPositionFromMatrix:function(a){this.x=a.elements[12];
this.y=a.elements[13];this.z=a.elements[14];return this},getRotationFromMatrix:function(a,b){var c=b?b.x:1,d=b?b.y:1,e=b?b.z:1,f=a.elements[0]/c,g=a.elements[4]/d,c=a.elements[1]/c,d=a.elements[5]/d,h=a.elements[9]/e,i=a.elements[10]/e;this.y=Math.asin(a.elements[8]/e);e=Math.cos(this.y);1.0E-5<Math.abs(e)?(this.x=Math.atan2(-h/e,i/e),this.z=Math.atan2(-g/e,f/e)):(this.x=0,this.z=Math.atan2(c,d));return this},getScaleFromMatrix:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),
c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},isZero:function(){return 1.0E-4>this.lengthSq()},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},subSelf:function(a){this.x-=
a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.z=this.y=this.x=0,this.w=1);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Frustum=function(){this.planes=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4]};
THREE.Frustum.prototype.setFromMatrix=function(a){var b,c=this.planes,d=a.elements,a=d[0];b=d[1];var e=d[2],f=d[3],g=d[4],h=d[5],i=d[6],j=d[7],k=d[8],l=d[9],p=d[10],m=d[11],r=d[12],q=d[13],t=d[14],d=d[15];c[0].set(f-a,j-g,m-k,d-r);c[1].set(f+a,j+g,m+k,d+r);c[2].set(f+b,j+h,m+l,d+q);c[3].set(f-b,j-h,m-l,d-q);c[4].set(f-e,j-i,m-p,d-t);c[5].set(f+e,j+i,m+p,d+t);for(a=0;6>a;a++)b=c[a],b.divideScalar(Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z))};
THREE.Frustum.prototype.contains=function(a){for(var b=this.planes,c=a.matrixWorld,d=c.elements,c=-a.geometry.boundingSphere.radius*c.getMaxScaleOnAxis(),e=0;6>e;e++)if(a=b[e].x*d[12]+b[e].y*d[13]+b[e].z*d[14]+b[e].w,a<=c)return!1;return!0};THREE.Frustum.__v1=new THREE.Vector3;
THREE.Ray=function(a,b){function c(a,b,c){r.sub(c,a);v=r.dot(b);w=q.add(a,t.copy(b).multiplyScalar(v));return c.distanceTo(w)}function d(a,b,c,d){r.sub(d,b);q.sub(c,b);t.sub(a,b);z=r.dot(r);x=r.dot(q);A=r.dot(t);F=q.dot(q);C=q.dot(t);D=1/(z*F-x*x);y=(F*A-x*C)*D;s=(z*C-x*A)*D;return 0<=y&&0<=s&&1>y+s}this.origin=a||new THREE.Vector3;this.direction=b||new THREE.Vector3;var e=1.0E-4;this.setPrecision=function(a){e=a};var f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3,
j=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3;this.intersectObject=function(a){var b,s=[];if(a instanceof THREE.Particle){var r=c(this.origin,this.direction,a.matrixWorld.getPosition());if(r>a.scale.x)return[];b={distance:r,point:a.position,face:null,object:a};s.push(b)}else if(a instanceof THREE.Mesh){var r=c(this.origin,this.direction,a.matrixWorld.getPosition()),q=THREE.Frustum.__v1.set(a.matrixWorld.getColumnX().length(),a.matrixWorld.getColumnY().length(),
a.matrixWorld.getColumnZ().length());if(r>a.geometry.boundingSphere.radius*Math.max(q.x,Math.max(q.y,q.z)))return s;var t,I,o=a.geometry,Q=o.vertices,v;a.matrixRotationWorld.extractRotation(a.matrixWorld);r=0;for(q=o.faces.length;r<q;r++)if(b=o.faces[r],j.copy(this.origin),k.copy(this.direction),v=a.matrixWorld,l=v.multiplyVector3(l.copy(b.centroid)).subSelf(j),p=a.matrixRotationWorld.multiplyVector3(p.copy(b.normal)),t=k.dot(p),!(Math.abs(t)<e)&&(I=p.dot(l)/t,!(0>I)&&(a.doubleSided||(a.flipSided?
0<t:0>t))))if(m.add(j,k.multiplyScalar(I)),b instanceof THREE.Face3)f=v.multiplyVector3(f.copy(Q[b.a])),g=v.multiplyVector3(g.copy(Q[b.b])),h=v.multiplyVector3(h.copy(Q[b.c])),d(m,f,g,h)&&(b={distance:j.distanceTo(m),point:m.clone(),face:b,object:a},s.push(b));else if(b instanceof THREE.Face4&&(f=v.multiplyVector3(f.copy(Q[b.a])),g=v.multiplyVector3(g.copy(Q[b.b])),h=v.multiplyVector3(h.copy(Q[b.c])),i=v.multiplyVector3(i.copy(Q[b.d])),d(m,f,g,i)||d(m,g,h,i)))b={distance:j.distanceTo(m),point:m.clone(),
face:b,object:a},s.push(b)}return s};this.intersectObjects=function(a){for(var b=[],c=0,d=a.length;c<d;c++)Array.prototype.push.apply(b,this.intersectObject(a[c]));b.sort(function(a,b){return a.distance-b.distance});return b};var r=new THREE.Vector3,q=new THREE.Vector3,t=new THREE.Vector3,v,w,z,x,A,F,C,D,y,s};
THREE.Rectangle=function(){function a(){f=d-b;g=e-c}var b,c,d,e,f,g,h=!0;this.getX=function(){return b};this.getY=function(){return c};this.getWidth=function(){return f};this.getHeight=function(){return g};this.getLeft=function(){return b};this.getTop=function(){return c};this.getRight=function(){return d};this.getBottom=function(){return e};this.set=function(f,g,k,l){h=!1;b=f;c=g;d=k;e=l;a()};this.addPoint=function(f,g){h?(h=!1,b=f,c=g,d=f,e=g):(b=b<f?b:f,c=c<g?c:g,d=d>f?d:f,e=e>g?e:g);a()};this.add3Points=
function(f,g,k,l,p,m){h?(h=!1,b=f<k?f<p?f:p:k<p?k:p,c=g<l?g<m?g:m:l<m?l:m,d=f>k?f>p?f:p:k>p?k:p,e=g>l?g>m?g:m:l>m?l:m):(b=f<k?f<p?f<b?f:b:p<b?p:b:k<p?k<b?k:b:p<b?p:b,c=g<l?g<m?g<c?g:c:m<c?m:c:l<m?l<c?l:c:m<c?m:c,d=f>k?f>p?f>d?f:d:p>d?p:d:k>p?k>d?k:d:p>d?p:d,e=g>l?g>m?g>e?g:e:m>e?m:e:l>m?l>e?l:e:m>e?m:e);a()};this.addRectangle=function(f){h?(h=!1,b=f.getLeft(),c=f.getTop(),d=f.getRight(),e=f.getBottom()):(b=b<f.getLeft()?b:f.getLeft(),c=c<f.getTop()?c:f.getTop(),d=d>f.getRight()?d:f.getRight(),e=e>
f.getBottom()?e:f.getBottom());a()};this.inflate=function(f){b-=f;c-=f;d+=f;e+=f;a()};this.minSelf=function(f){b=b>f.getLeft()?b:f.getLeft();c=c>f.getTop()?c:f.getTop();d=d<f.getRight()?d:f.getRight();e=e<f.getBottom()?e:f.getBottom();a()};this.intersects=function(a){return d<a.getLeft()||b>a.getRight()||e<a.getTop()||c>a.getBottom()?!1:!0};this.empty=function(){h=!0;e=d=c=b=0;a()};this.isEmpty=function(){return h}};
THREE.Math={clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0}};THREE.Matrix3=function(){this.elements=new Float32Array(9)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,getInverse:function(a){var b=a.elements,a=b[10]*b[5]-b[6]*b[9],c=-b[10]*b[1]+b[2]*b[9],d=b[6]*b[1]-b[2]*b[5],e=-b[10]*b[4]+b[6]*b[8],f=b[10]*b[0]-b[2]*b[8],g=-b[6]*b[0]+b[2]*b[4],h=b[9]*b[4]-b[5]*b[8],i=-b[9]*b[0]+b[1]*b[8],j=b[5]*b[0]-b[1]*b[4],b=b[0]*a+b[1]*e+b[2]*h;0===b&&console.warn("Matrix3.getInverse(): determinant == 0");var b=1/b,k=this.elements;k[0]=b*a;k[1]=b*c;k[2]=b*d;k[3]=b*e;k[4]=b*f;k[5]=b*g;k[6]=b*h;k[7]=b*i;k[8]=b*j;return this},
transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},transposeIntoArray:function(a){var b=this.m;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this}};THREE.Matrix4=function(a,b,c,d,e,f,g,h,i,j,k,l,p,m,r,q){this.elements=new Float32Array(16);this.set(void 0!==a?a:1,b||0,c||0,d||0,e||0,void 0!==f?f:1,g||0,h||0,i||0,j||0,void 0!==k?k:1,l||0,p||0,m||0,r||0,void 0!==q?q:1)};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,p,m,r,q){var t=this.elements;t[0]=a;t[4]=b;t[8]=c;t[12]=d;t[1]=e;t[5]=f;t[9]=g;t[13]=h;t[2]=i;t[6]=j;t[10]=k;t[14]=l;t[3]=p;t[7]=m;t[11]=r;t[15]=q;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},lookAt:function(a,b,c){var d=this.elements,
e=THREE.Matrix4.__v1,f=THREE.Matrix4.__v2,g=THREE.Matrix4.__v3;g.sub(a,b).normalize();0===g.length()&&(g.z=1);e.cross(c,g).normalize();0===e.length()&&(g.x+=1.0E-4,e.cross(c,g).normalize());f.cross(g,e);d[0]=e.x;d[4]=f.x;d[8]=g.x;d[1]=e.y;d[5]=f.y;d[9]=g.y;d[2]=e.z;d[6]=f.z;d[10]=g.z;return this},multiply:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],p=c[13],m=c[2],r=c[6],q=c[10],t=c[14],v=c[3],w=c[7],z=c[11],c=c[15],x=d[0],A=d[4],F=
d[8],C=d[12],D=d[1],y=d[5],s=d[9],E=d[13],u=d[2],J=d[6],N=d[10],B=d[14],M=d[3],I=d[7],o=d[11],d=d[15];e[0]=f*x+g*D+h*u+i*M;e[4]=f*A+g*y+h*J+i*I;e[8]=f*F+g*s+h*N+i*o;e[12]=f*C+g*E+h*B+i*d;e[1]=j*x+k*D+l*u+p*M;e[5]=j*A+k*y+l*J+p*I;e[9]=j*F+k*s+l*N+p*o;e[13]=j*C+k*E+l*B+p*d;e[2]=m*x+r*D+q*u+t*M;e[6]=m*A+r*y+q*J+t*I;e[10]=m*F+r*s+q*N+t*o;e[14]=m*C+r*E+q*B+t*d;e[3]=v*x+w*D+z*u+c*M;e[7]=v*A+w*y+z*J+c*I;e[11]=v*F+w*s+z*N+c*o;e[15]=v*C+w*E+z*B+c*d;return this},multiplySelf:function(a){return this.multiply(this,
a)},multiplyToArray:function(a,b,c){var d=this.elements;this.multiply(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){var b=this.elements,
c=a.x,d=a.y,e=a.z,f=1/(b[3]*c+b[7]*d+b[11]*e+b[15]);a.x=(b[0]*c+b[4]*d+b[8]*e+b[12])*f;a.y=(b[1]*c+b[5]*d+b[9]*e+b[13])*f;a.z=(b[2]*c+b[6]*d+b[10]*e+b[14])*f;return a},multiplyVector4:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w;a.x=b[0]*c+b[4]*d+b[8]*e+b[12]*f;a.y=b[1]*c+b[5]*d+b[9]*e+b[13]*f;a.z=b[2]*c+b[6]*d+b[10]*e+b[14]*f;a.w=b[3]*c+b[7]*d+b[11]*e+b[15]*f;return a},rotateAxis:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;a.x=c*b[0]+d*b[4]+e*b[8];a.y=c*b[1]+d*b[5]+e*b[9];a.z=c*
b[2]+d*b[6]+e*b[10];a.normalize();return a},crossVector:function(a){var b=this.elements,c=new THREE.Vector4;c.x=b[0]*a.x+b[4]*a.y+b[8]*a.z+b[12]*a.w;c.y=b[1]*a.x+b[5]*a.y+b[9]*a.z+b[13]*a.w;c.z=b[2]*a.x+b[6]*a.y+b[10]*a.z+b[14]*a.w;c.w=a.w?b[3]*a.x+b[7]*a.y+b[11]*a.z+b[15]*a.w:1;return c},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],p=a[14],m=a[3],r=a[7],q=a[11],a=a[15];return e*h*k*m-d*i*k*m-e*g*l*m+c*i*l*m+d*g*p*m-c*h*
p*m-e*h*j*r+d*i*j*r+e*f*l*r-b*i*l*r-d*f*p*r+b*h*p*r+e*g*j*q-c*i*j*q-e*f*k*q+b*i*k*q+c*f*p*q-b*g*p*q-d*g*j*a+c*h*j*a+d*f*k*a-b*h*k*a-c*f*l*a+b*g*l*a},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];
a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[12],a[13],a[14])},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=
a.y;b[14]=a.z;return this},getColumnX:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[0],a[1],a[2])},getColumnY:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[4],a[5],a[6])},getColumnZ:function(){var a=this.elements;return THREE.Matrix4.__v1.set(a[8],a[9],a[10])},getInverse:function(a){var b=this.elements,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[12],h=c[1],i=c[5],j=c[9],k=c[13],l=c[2],p=c[6],m=c[10],r=c[14],q=c[3],t=c[7],v=c[11],c=c[15];b[0]=j*r*t-k*m*t+k*p*v-i*r*v-j*p*
c+i*m*c;b[4]=g*m*t-f*r*t-g*p*v+e*r*v+f*p*c-e*m*c;b[8]=f*k*t-g*j*t+g*i*v-e*k*v-f*i*c+e*j*c;b[12]=g*j*p-f*k*p-g*i*m+e*k*m+f*i*r-e*j*r;b[1]=k*m*q-j*r*q-k*l*v+h*r*v+j*l*c-h*m*c;b[5]=f*r*q-g*m*q+g*l*v-d*r*v-f*l*c+d*m*c;b[9]=g*j*q-f*k*q-g*h*v+d*k*v+f*h*c-d*j*c;b[13]=f*k*l-g*j*l+g*h*m-d*k*m-f*h*r+d*j*r;b[2]=i*r*q-k*p*q+k*l*t-h*r*t-i*l*c+h*p*c;b[6]=g*p*q-e*r*q-g*l*t+d*r*t+e*l*c-d*p*c;b[10]=e*k*q-g*i*q+g*h*t-d*k*t-e*h*c+d*i*c;b[14]=g*i*l-e*k*l-g*h*p+d*k*p+e*h*r-d*i*r;b[3]=j*p*q-i*m*q-j*l*t+h*m*t+i*l*v-h*p*
v;b[7]=e*m*q-f*p*q+f*l*t-d*m*t-e*l*v+d*p*v;b[11]=f*i*q-e*j*q-f*h*t+d*j*t+e*h*v-d*i*v;b[15]=e*j*l-f*i*l+f*h*p-d*j*p-e*h*m+d*i*m;this.multiplyScalar(1/a.determinant());return this},setRotationFromEuler:function(a,b){var c=this.elements,d=a.x,e=a.y,f=a.z,g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e),i=Math.cos(f),f=Math.sin(f);switch(b){case "YXZ":var j=h*i,k=h*f,l=e*i,p=e*f;c[0]=j+p*d;c[4]=l*d-k;c[8]=g*e;c[1]=g*f;c[5]=g*i;c[9]=-d;c[2]=k*d-l;c[6]=p+j*d;c[10]=g*h;break;case "ZXY":j=h*i;k=h*
f;l=e*i;p=e*f;c[0]=j-p*d;c[4]=-g*f;c[8]=l+k*d;c[1]=k+l*d;c[5]=g*i;c[9]=p-j*d;c[2]=-g*e;c[6]=d;c[10]=g*h;break;case "ZYX":j=g*i;k=g*f;l=d*i;p=d*f;c[0]=h*i;c[4]=l*e-k;c[8]=j*e+p;c[1]=h*f;c[5]=p*e+j;c[9]=k*e-l;c[2]=-e;c[6]=d*h;c[10]=g*h;break;case "YZX":j=g*h;k=g*e;l=d*h;p=d*e;c[0]=h*i;c[4]=p-j*f;c[8]=l*f+k;c[1]=f;c[5]=g*i;c[9]=-d*i;c[2]=-e*i;c[6]=k*f+l;c[10]=j-p*f;break;case "XZY":j=g*h;k=g*e;l=d*h;p=d*e;c[0]=h*i;c[4]=-f;c[8]=e*i;c[1]=j*f+p;c[5]=g*i;c[9]=k*f-l;c[2]=l*f-k;c[6]=d*i;c[10]=p*f+j;break;
default:j=g*i,k=g*f,l=d*i,p=d*f,c[0]=h*i,c[4]=-h*f,c[8]=e,c[1]=k+l*e,c[5]=j-p*e,c[9]=-d*h,c[2]=p-j*e,c[6]=l+k*e,c[10]=g*h}return this},setRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,a=c*g,j=c*h,c=c*i,k=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;b[0]=1-(k+e);b[4]=j-f;b[8]=c+h;b[1]=j+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+k);return this},compose:function(a,b,c){var d=this.elements,e=THREE.Matrix4.__m1,f=THREE.Matrix4.__m2;e.identity();e.setRotationFromQuaternion(b);
f.makeScale(c.x,c.y,c.z);this.multiply(e,f);d[12]=a.x;d[13]=a.y;d[14]=a.z;return this},decompose:function(a,b,c){var d=this.elements,e=THREE.Matrix4.__v1,f=THREE.Matrix4.__v2,g=THREE.Matrix4.__v3;e.set(d[0],d[1],d[2]);f.set(d[4],d[5],d[6]);g.set(d[8],d[9],d[10]);a=a instanceof THREE.Vector3?a:new THREE.Vector3;b=b instanceof THREE.Quaternion?b:new THREE.Quaternion;c=c instanceof THREE.Vector3?c:new THREE.Vector3;c.x=e.length();c.y=f.length();c.z=g.length();a.x=d[12];a.y=d[13];a.z=d[14];d=THREE.Matrix4.__m1;
d.copy(this);d.elements[0]/=c.x;d.elements[1]/=c.x;d.elements[2]/=c.x;d.elements[4]/=c.y;d.elements[5]/=c.y;d.elements[6]/=c.y;d.elements[8]/=c.z;d.elements[9]/=c.z;d.elements[10]/=c.z;b.setFromRotationMatrix(d);return[a,b,c]},extractPosition:function(a){var b=this.elements,a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(a){var b=this.elements,a=a.elements,c=THREE.Matrix4.__v1,d=1/c.set(a[0],a[1],a[2]).length(),e=1/c.set(a[4],a[5],a[6]).length(),c=1/c.set(a[8],
a[9],a[10]).length();b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;b[4]=a[4]*e;b[5]=a[5]*e;b[6]=a[6]*e;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;return this},translate:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[12]=b[0]*c+b[4]*d+b[8]*a+b[12];b[13]=b[1]*c+b[5]*d+b[9]*a+b[13];b[14]=b[2]*c+b[6]*d+b[10]*a+b[14];b[15]=b[3]*c+b[7]*d+b[11]*a+b[15];return this},rotateX:function(a){var b=this.elements,c=b[4],d=b[5],e=b[6],f=b[7],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);b[4]=k*c+a*g;b[5]=k*d+a*
h;b[6]=k*e+a*i;b[7]=k*f+a*j;b[8]=k*g-a*c;b[9]=k*h-a*d;b[10]=k*i-a*e;b[11]=k*j-a*f;return this},rotateY:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);b[0]=k*c-a*g;b[1]=k*d-a*h;b[2]=k*e-a*i;b[3]=k*f-a*j;b[8]=k*g+a*c;b[9]=k*h+a*d;b[10]=k*i+a*e;b[11]=k*j+a*f;return this},rotateZ:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=Math.cos(a),a=Math.sin(a);b[0]=k*c+a*g;b[1]=k*d+a*h;b[2]=k*e+a*
i;b[3]=k*f+a*j;b[4]=k*g-a*c;b[5]=k*h-a*d;b[6]=k*i-a*e;b[7]=k*j-a*f;return this},rotateByAxis:function(a,b){var c=this.elements;if(1===a.x&&0===a.y&&0===a.z)return this.rotateX(b);if(0===a.x&&1===a.y&&0===a.z)return this.rotateY(b);if(0===a.x&&0===a.y&&1===a.z)return this.rotateZ(b);var d=a.x,e=a.y,f=a.z,g=Math.sqrt(d*d+e*e+f*f),d=d/g,e=e/g,f=f/g,g=d*d,h=e*e,i=f*f,j=Math.cos(b),k=Math.sin(b),l=1-j,p=d*e*l,m=d*f*l,l=e*f*l,d=d*k,r=e*k,k=f*k,f=g+(1-g)*j,g=p+k,e=m-r,p=p-k,h=h+(1-h)*j,k=l+d,m=m+r,l=l-d,
i=i+(1-i)*j,j=c[0],d=c[1],r=c[2],q=c[3],t=c[4],v=c[5],w=c[6],z=c[7],x=c[8],A=c[9],F=c[10],C=c[11];c[0]=f*j+g*t+e*x;c[1]=f*d+g*v+e*A;c[2]=f*r+g*w+e*F;c[3]=f*q+g*z+e*C;c[4]=p*j+h*t+k*x;c[5]=p*d+h*v+k*A;c[6]=p*r+h*w+k*F;c[7]=p*q+h*z+k*C;c[8]=m*j+l*t+i*x;c[9]=m*d+l*v+i*A;c[10]=m*r+l*w+i*F;c[11]=m*q+l*z+i*C;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=
this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a),
a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=
0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){var a=c*Math.tan(a*Math.PI/360),e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/i;g[9]=0;g[13]=-((c+d)/i);g[2]=0;g[6]=0;g[10]=-2/j;g[14]=-((f+e)/j);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],
a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};THREE.Matrix4.__v1=new THREE.Vector3;THREE.Matrix4.__v2=new THREE.Vector3;THREE.Matrix4.__v3=new THREE.Vector3;THREE.Matrix4.__m1=new THREE.Matrix4;THREE.Matrix4.__m2=new THREE.Matrix4;
THREE.Object3D=function(){this.id=THREE.Object3DCount++;this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder="XYZ";this.scale=new THREE.Vector3(1,1,1);this.flipSided=this.doubleSided=!1;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixRotationWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=
!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=!1;this.boundRadius=0;this.boundRadiusScale=1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this._vector=new THREE.Vector3};
THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(a){this.matrix.multiply(a,this.matrix);this.scale.getScaleFromMatrix(this.matrix);this.rotation.getRotationFromMatrix(this.matrix,this.scale);this.position.getPositionFromMatrix(this.matrix)},translate:function(a,b){this.matrix.rotateAxis(b);this.position.addSelf(b.multiplyScalar(a))},translateX:function(a){this.translate(a,this._vector.set(1,0,0))},translateY:function(a){this.translate(a,this._vector.set(0,1,0))},translateZ:function(a){this.translate(a,
this._vector.set(0,0,1))},lookAt:function(a){this.matrix.lookAt(a,this.position,this.up);this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)},add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=
this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},getChildByName:function(a,b){var c,d,e;c=0;for(d=this.children.length;c<d;c++)if(e=this.children[c],e.name===a||b&&(e=e.getChildByName(a,b),void 0!==e))return e},updateMatrix:function(){this.matrix.setPosition(this.position);this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,
this.eulerOrder);if(1!==this.scale.x||1!==this.scale.y||1!==this.scale.z)this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z));this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<
c;b++)this.children[b].updateMatrixWorld(a)}};THREE.Object3DCount=0;
THREE.Projector=function(){function a(){var a=g[f]=g[f]||new THREE.RenderableObject;f++;return a}function b(){var a=j[i]=j[i]||new THREE.RenderableVertex;i++;return a}function c(a,b){return b.z-a.z}function d(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;if(0<=e&&0<=f&&0<=g&&0<=h)return!0;if(0>e&&0>f||0>g&&0>h)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h)));if(d<c)return!1;a.lerpSelf(b,c);b.lerpSelf(a,1-d);return!0}
var e,f,g=[],h,i,j=[],k,l,p=[],m,r=[],q,t,v=[],w,z,x=[],A={objects:[],sprites:[],lights:[],elements:[]},F=new THREE.Vector3,C=new THREE.Vector4,D=new THREE.Matrix4,y=new THREE.Matrix4,s=new THREE.Frustum,E=new THREE.Vector4,u=new THREE.Vector4;this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);D.multiply(b.projectionMatrix,b.matrixWorldInverse);D.multiplyVector3(a);return a};this.unprojectVector=function(a,b){b.projectionMatrixInverse.getInverse(b.projectionMatrix);D.multiply(b.matrixWorld,
b.projectionMatrixInverse);D.multiplyVector3(a);return a};this.pickingRay=function(a,b){var c;a.z=-1;c=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(c,b);c.subSelf(a).normalize();return new THREE.Ray(a,c)};this.projectGraph=function(b,d){f=0;A.objects.length=0;A.sprites.length=0;A.lights.length=0;var g=function(b){if(!1!==b.visible){(b instanceof THREE.Mesh||b instanceof THREE.Line)&&(!1===b.frustumCulled||s.contains(b))?(F.copy(b.matrixWorld.getPosition()),D.multiplyVector3(F),
e=a(),e.object=b,e.z=F.z,A.objects.push(e)):b instanceof THREE.Sprite||b instanceof THREE.Particle?(F.copy(b.matrixWorld.getPosition()),D.multiplyVector3(F),e=a(),e.object=b,e.z=F.z,A.sprites.push(e)):b instanceof THREE.Light&&A.lights.push(b);for(var c=0,d=b.children.length;c<d;c++)g(b.children[c])}};g(b);d&&A.objects.sort(c);return A};this.projectScene=function(a,e,f){var g=e.near,I=e.far,o=!1,Q,P,H,T,L,W,ea,da,F,ba,Z,ca,n,Ga,pa;z=t=m=l=0;A.elements.length=0;void 0===e.parent&&(console.warn("DEPRECATED: Camera hasn't been added to a Scene. Adding it..."),
a.add(e));a.updateMatrixWorld();e.matrixWorldInverse.getInverse(e.matrixWorld);D.multiply(e.projectionMatrix,e.matrixWorldInverse);s.setFromMatrix(D);A=this.projectGraph(a,!1);a=0;for(Q=A.objects.length;a<Q;a++)if(F=A.objects[a].object,ba=F.matrixWorld,i=0,F instanceof THREE.Mesh){Z=F.geometry;ca=F.geometry.materials;T=Z.vertices;n=Z.faces;Ga=Z.faceVertexUvs;Z=F.matrixRotationWorld.extractRotation(ba);P=0;for(H=T.length;P<H;P++)h=b(),h.positionWorld.copy(T[P]),ba.multiplyVector3(h.positionWorld),
h.positionScreen.copy(h.positionWorld),D.multiplyVector4(h.positionScreen),h.positionScreen.x/=h.positionScreen.w,h.positionScreen.y/=h.positionScreen.w,h.visible=h.positionScreen.z>g&&h.positionScreen.z<I;T=0;for(P=n.length;T<P;T++){H=n[T];if(H instanceof THREE.Face3)if(L=j[H.a],W=j[H.b],ea=j[H.c],L.visible&&W.visible&&ea.visible)if(o=0>(ea.positionScreen.x-L.positionScreen.x)*(W.positionScreen.y-L.positionScreen.y)-(ea.positionScreen.y-L.positionScreen.y)*(W.positionScreen.x-L.positionScreen.x),
F.doubleSided||o!=F.flipSided)da=p[l]=p[l]||new THREE.RenderableFace3,l++,k=da,k.v1.copy(L),k.v2.copy(W),k.v3.copy(ea);else continue;else continue;else if(H instanceof THREE.Face4)if(L=j[H.a],W=j[H.b],ea=j[H.c],da=j[H.d],L.visible&&W.visible&&ea.visible&&da.visible)if(o=0>(da.positionScreen.x-L.positionScreen.x)*(W.positionScreen.y-L.positionScreen.y)-(da.positionScreen.y-L.positionScreen.y)*(W.positionScreen.x-L.positionScreen.x)||0>(W.positionScreen.x-ea.positionScreen.x)*(da.positionScreen.y-ea.positionScreen.y)-
(W.positionScreen.y-ea.positionScreen.y)*(da.positionScreen.x-ea.positionScreen.x),F.doubleSided||o!=F.flipSided)pa=r[m]=r[m]||new THREE.RenderableFace4,m++,k=pa,k.v1.copy(L),k.v2.copy(W),k.v3.copy(ea),k.v4.copy(da);else continue;else continue;k.normalWorld.copy(H.normal);!o&&(F.flipSided||F.doubleSided)&&k.normalWorld.negate();Z.multiplyVector3(k.normalWorld);k.centroidWorld.copy(H.centroid);ba.multiplyVector3(k.centroidWorld);k.centroidScreen.copy(k.centroidWorld);D.multiplyVector3(k.centroidScreen);
ea=H.vertexNormals;L=0;for(W=ea.length;L<W;L++)da=k.vertexNormalsWorld[L],da.copy(ea[L]),!o&&(F.flipSided||F.doubleSided)&&da.negate(),Z.multiplyVector3(da);L=0;for(W=Ga.length;L<W;L++)if(pa=Ga[L][T]){ea=0;for(da=pa.length;ea<da;ea++)k.uvs[L][ea]=pa[ea]}k.material=F.material;k.faceMaterial=null!==H.materialIndex?ca[H.materialIndex]:null;k.z=k.centroidScreen.z;A.elements.push(k)}}else if(F instanceof THREE.Line){y.multiply(D,ba);T=F.geometry.vertices;L=b();L.positionScreen.copy(T[0]);y.multiplyVector4(L.positionScreen);
ba=F.type===THREE.LinePieces?2:1;P=1;for(H=T.length;P<H;P++)L=b(),L.positionScreen.copy(T[P]),y.multiplyVector4(L.positionScreen),0<(P+1)%ba||(W=j[i-2],E.copy(L.positionScreen),u.copy(W.positionScreen),d(E,u)&&(E.multiplyScalar(1/E.w),u.multiplyScalar(1/u.w),ca=v[t]=v[t]||new THREE.RenderableLine,t++,q=ca,q.v1.positionScreen.copy(E),q.v2.positionScreen.copy(u),q.z=Math.max(E.z,u.z),q.material=F.material,A.elements.push(q)))}a=0;for(Q=A.sprites.length;a<Q;a++)F=A.sprites[a].object,ba=F.matrixWorld,
F instanceof THREE.Particle&&(C.set(ba.elements[12],ba.elements[13],ba.elements[14],1),D.multiplyVector4(C),C.z/=C.w,0<C.z&&1>C.z&&(g=x[z]=x[z]||new THREE.RenderableParticle,z++,w=g,w.x=C.x/C.w,w.y=C.y/C.w,w.z=C.z,w.rotation=F.rotation.z,w.scale.x=F.scale.x*Math.abs(w.x-(C.x+e.projectionMatrix.elements[0])/(C.w+e.projectionMatrix.elements[12])),w.scale.y=F.scale.y*Math.abs(w.y-(C.y+e.projectionMatrix.elements[5])/(C.w+e.projectionMatrix.elements[13])),w.material=F.material,A.elements.push(w)));f&&
A.elements.sort(c);return A}};THREE.Quaternion=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEuler:function(a){var b=Math.PI/360,c=a.x*b,d=a.y*b,e=a.z*b,a=Math.cos(d),d=Math.sin(d),b=Math.cos(-e),e=Math.sin(-e),f=Math.cos(c),c=Math.sin(c),g=a*b,h=d*e;this.w=g*f-h*c;this.x=g*c+h*f;this.y=d*b*f+a*e*c;this.z=a*e*f-d*b*c;return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);
this.x=a.x*d;this.y=a.y*d;this.z=a.z*d;this.w=Math.cos(c);return this},setFromRotationMatrix:function(a){var b=Math.pow(a.determinant(),1/3);this.w=Math.sqrt(Math.max(0,b+a.elements[0]+a.elements[5]+a.elements[10]))/2;this.x=Math.sqrt(Math.max(0,b+a.elements[0]-a.elements[5]-a.elements[10]))/2;this.y=Math.sqrt(Math.max(0,b-a.elements[0]+a.elements[5]-a.elements[10]))/2;this.z=Math.sqrt(Math.max(0,b-a.elements[0]-a.elements[5]+a.elements[10]))/2;this.x=0>a.elements[6]-a.elements[9]?-Math.abs(this.x):
Math.abs(this.x);this.y=0>a.elements[8]-a.elements[2]?-Math.abs(this.y):Math.abs(this.y);this.z=0>a.elements[1]-a.elements[4]?-Math.abs(this.z):Math.abs(this.z);this.normalize();return this},calculateW:function(){this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z));return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===a?this.w=this.z=this.y=this.x=0:(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a,b){this.x=a.x*b.w+a.y*b.z-a.z*b.y+a.w*b.x;this.y=-a.x*b.z+a.y*b.w+a.z*b.x+a.w*b.y;this.z=a.x*b.y-a.y*b.x+a.z*b.w+a.w*b.z;this.w=-a.x*b.x-a.y*b.y-a.z*b.z+a.w*b.w;return this},multiplySelf:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,f=a.x,g=a.y,h=a.z,a=a.w;this.x=b*a+e*f+c*h-d*g;this.y=c*a+e*g+d*f-b*h;this.z=d*a+e*h+b*g-c*f;this.w=
e*a-b*f-c*g-d*h;return this},multiplyVector3:function(a,b){b||(b=a);var c=a.x,d=a.y,e=a.z,f=this.x,g=this.y,h=this.z,i=this.w,j=i*c+g*e-h*d,k=i*d+h*c-f*e,l=i*e+f*d-g*c,c=-f*c-g*d-h*e;b.x=j*i+c*-f+k*-h-l*-g;b.y=k*i+c*-g+l*-f-j*-h;b.z=l*i+c*-h+j*-g-k*-f;return b},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}};
THREE.Quaternion.slerp=function(a,b,c,d){var e=a.w*b.w+a.x*b.x+a.y*b.y+a.z*b.z;0>e?(c.w=-b.w,c.x=-b.x,c.y=-b.y,c.z=-b.z,e=-e):c.copy(b);if(1<=Math.abs(e))return c.w=a.w,c.x=a.x,c.y=a.y,c.z=a.z,c;var f=Math.acos(e),e=Math.sqrt(1-e*e);if(0.0010>Math.abs(e))return c.w=0.5*(a.w+b.w),c.x=0.5*(a.x+b.x),c.y=0.5*(a.y+b.y),c.z=0.5*(a.z+b.z),c;b=Math.sin((1-d)*f)/e;d=Math.sin(d*f)/e;c.w=a.w*b+c.w*d;c.x=a.x*b+c.x*d;c.y=a.y*b+c.y*d;c.z=a.z*b+c.z*d;return c};THREE.Vertex=function(){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.")};
THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=f;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,d,e,f,g){this.a=a;this.b=b;this.c=c;this.d=d;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=g;this.centroid=new THREE.Vector3};
THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var a=new THREE.Face4(this.a,this.b,this.c,this.d);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.UV=function(a,b){this.u=a||0;this.v=b||0};THREE.UV.prototype={constructor:THREE.UV,set:function(a,b){this.u=a;this.v=b;return this},copy:function(a){this.u=a.u;this.v=a.v;return this},lerpSelf:function(a,b){this.u+=(a.u-this.u)*b;this.v+=(a.v-this.v)*b;return this},clone:function(){return new THREE.UV(this.u,this.v)}};
THREE.Geometry=function(){this.id=THREE.GeometryCount++;this.vertices=[];this.colors=[];this.materials=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.dynamic=this.hasTangents=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){var b=new THREE.Matrix4;b.extractRotation(a);for(var c=0,d=this.vertices.length;c<d;c++)a.multiplyVector3(this.vertices[c]);c=0;for(d=this.faces.length;c<d;c++){var e=this.faces[c];b.multiplyVector3(e.normal);for(var f=0,g=e.vertexNormals.length;f<g;f++)b.multiplyVector3(e.vertexNormals[f]);a.multiplyVector3(e.centroid)}},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,
0,0),c instanceof THREE.Face3?(c.centroid.addSelf(this.vertices[c.a]),c.centroid.addSelf(this.vertices[c.b]),c.centroid.addSelf(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.addSelf(this.vertices[c.a]),c.centroid.addSelf(this.vertices[c.b]),c.centroid.addSelf(this.vertices[c.c]),c.centroid.addSelf(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){var a,b,c,d,e,f,g=new THREE.Vector3,h=new THREE.Vector3;a=0;for(b=this.faces.length;a<
b;a++)c=this.faces[a],d=this.vertices[c.a],e=this.vertices[c.b],f=this.vertices[c.c],g.sub(f,e),h.sub(d,e),g.crossSelf(h),g.isZero()||g.normalize(),c.normal.copy(g)},computeVertexNormals:function(){var a,b,c,d;if(void 0===this.__tmpVertices){d=this.__tmpVertices=Array(this.vertices.length);a=0;for(b=this.vertices.length;a<b;a++)d[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c instanceof THREE.Face3?c.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:
c instanceof THREE.Face4&&(c.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{d=this.__tmpVertices;a=0;for(b=this.vertices.length;a<b;a++)d[a].set(0,0,0)}a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c instanceof THREE.Face3?(d[c.a].addSelf(c.normal),d[c.b].addSelf(c.normal),d[c.c].addSelf(c.normal)):c instanceof THREE.Face4&&(d[c.a].addSelf(c.normal),d[c.b].addSelf(c.normal),d[c.c].addSelf(c.normal),d[c.d].addSelf(c.normal));a=0;for(b=this.vertices.length;a<
b;a++)d[a].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c instanceof THREE.Face3?(c.vertexNormals[0].copy(d[c.a]),c.vertexNormals[1].copy(d[c.b]),c.vertexNormals[2].copy(d[c.c])):c instanceof THREE.Face4&&(c.vertexNormals[0].copy(d[c.a]),c.vertexNormals[1].copy(d[c.b]),c.vertexNormals[2].copy(d[c.c]),c.vertexNormals[3].copy(d[c.d]))},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++){e=this.faces[c];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):
e.__originalFaceNormal=e.normal.clone();e.__originalVertexNormals||(e.__originalVertexNormals=[]);a=0;for(b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone()}var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];var g=this.morphNormals[a].faceNormals,
h=this.morphNormals[a].vertexNormals,i,j;c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],i=new THREE.Vector3,j=e instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},g.push(i),h.push(j)}g=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],i=g.faceNormals[c],j=g.vertexNormals[c],
i.copy(e.normal),e instanceof THREE.Face3?(j.a.copy(e.vertexNormals[0]),j.b.copy(e.vertexNormals[1]),j.c.copy(e.vertexNormals[2])):(j.a.copy(e.vertexNormals[0]),j.b.copy(e.vertexNormals[1]),j.c.copy(e.vertexNormals[2]),j.d.copy(e.vertexNormals[3]))}c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function a(a,b,c,d,e,f,B){h=a.vertices[b];i=a.vertices[c];j=a.vertices[d];k=g[e];l=g[f];p=g[B];m=i.x-
h.x;r=j.x-h.x;q=i.y-h.y;t=j.y-h.y;v=i.z-h.z;w=j.z-h.z;z=l.u-k.u;x=p.u-k.u;A=l.v-k.v;F=p.v-k.v;C=1/(z*F-x*A);E.set((F*m-A*r)*C,(F*q-A*t)*C,(F*v-A*w)*C);u.set((z*r-x*m)*C,(z*t-x*q)*C,(z*w-x*v)*C);y[b].addSelf(E);y[c].addSelf(E);y[d].addSelf(E);s[b].addSelf(u);s[c].addSelf(u);s[d].addSelf(u)}var b,c,d,e,f,g,h,i,j,k,l,p,m,r,q,t,v,w,z,x,A,F,C,D,y=[],s=[],E=new THREE.Vector3,u=new THREE.Vector3,J=new THREE.Vector3,N=new THREE.Vector3,B=new THREE.Vector3;b=0;for(c=this.vertices.length;b<c;b++)y[b]=new THREE.Vector3,
s[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)f=this.faces[b],g=this.faceVertexUvs[0][b],f instanceof THREE.Face3?a(this,f.a,f.b,f.c,0,1,2):f instanceof THREE.Face4&&(a(this,f.a,f.b,f.d,0,1,3),a(this,f.b,f.c,f.d,1,2,3));var M=["a","b","c","d"];b=0;for(c=this.faces.length;b<c;b++){f=this.faces[b];for(d=0;d<f.vertexNormals.length;d++)B.copy(f.vertexNormals[d]),e=f[M[d]],D=y[e],J.copy(D),J.subSelf(B.multiplyScalar(B.dot(D))).normalize(),N.cross(f.vertexNormals[d],D),e=N.dot(s[e]),e=0>e?
-1:1,f.vertexTangents[d]=new THREE.Vector4(J.x,J.y,J.z,e)}this.hasTangents=!0},computeBoundingBox:function(){this.boundingBox||(this.boundingBox={min:new THREE.Vector3,max:new THREE.Vector3});if(0<this.vertices.length){var a;a=this.vertices[0];this.boundingBox.min.copy(a);this.boundingBox.max.copy(a);for(var b=this.boundingBox.min,c=this.boundingBox.max,d=1,e=this.vertices.length;d<e;d++)(a=this.vertices[d],a.x<b.x?b.x=a.x:a.x>c.x&&(c.x=a.x),a.y<b.y?b.y=a.y:a.y>c.y&&(c.y=a.y),a.z<b.z)?b.z=a.z:a.z>
c.z&&(c.z=a.z)}else this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){this.boundingSphere||(this.boundingSphere={radius:0});for(var a,b=0,c=0,d=this.vertices.length;c<d;c++)a=this.vertices[c].length(),a>b&&(b=a);this.boundingSphere.radius=b},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,g,h;f=0;for(g=this.vertices.length;f<g;f++)d=this.vertices[f],d=[Math.round(d.x*e),Math.round(d.y*e),Math.round(d.z*e)].join("_"),void 0===a[d]?(a[d]=
f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];f=0;for(g=this.faces.length;f<g;f++)if(e=this.faces[f],e instanceof THREE.Face3)e.a=c[e.a],e.b=c[e.b],e.c=c[e.c];else if(e instanceof THREE.Face4){e.a=c[e.a];e.b=c[e.b];e.c=c[e.c];e.d=c[e.d];d=[e.a,e.b,e.c,e.d];for(a=3;0<a;a--)if(d.indexOf(e["abcd"[a]])!=a){d.splice(a,1);this.faces[f]=new THREE.Face3(d[0],d[1],d[2]);e=0;for(d=this.faceVertexUvs.length;e<d;e++)(h=this.faceVertexUvs[e][f])&&h.splice(a,1);break}}c=this.vertices.length-b.length;
this.vertices=b;return c}};THREE.GeometryCount=0;
THREE.Spline=function(a){function b(a,b,c,d,e,f,g){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c=[],d={x:0,y:0,z:0},e,f,g,h,i,j,k,l,p;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){e=(this.points.length-1)*a;f=Math.floor(e);g=e-f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>this.points.length-2?this.points.length-1:f+1;c[3]=f>this.points.length-3?this.points.length-1:
f+2;j=this.points[c[0]];k=this.points[c[1]];l=this.points[c[2]];p=this.points[c[3]];h=g*g;i=g*h;d.x=b(j.x,k.x,l.x,p.x,g,h,i);d.y=b(j.y,k.y,l.y,p.y,g,h,i);d.z=b(j.z,k.z,l.z,p.z,g,h,i);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,e=0,f=new THREE.Vector3,g=new THREE.Vector3,h=[],i=0;h[0]=0;a||(a=100);c=this.points.length*a;f.copy(this.points[0]);for(a=1;a<c;a++)b=a/
c,d=this.getPoint(b),g.copy(d),i+=g.distanceTo(f),f.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=e&&(h[b]=i,e=b);h[h.length]=i;return{chunks:h,total:i}};this.reparametrizeByArcLength=function(a){var b,c,d,e,f,g,h=[],i=new THREE.Vector3,j=this.getLength();h.push(i.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=j.chunks[b]-j.chunks[b-1];g=Math.ceil(a*c/j.total);e=(b-1)/(this.points.length-1);f=b/(this.points.length-1);for(c=1;c<g-1;c++)d=e+c*(1/g)*(f-e),d=this.getPoint(d),h.push(i.copy(d).clone());
h.push(i.copy(this.points[b]).clone())}this.points=h}};THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=new THREE.Object3D;THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.lookAt=function(a){this.matrix.lookAt(this.position,a,this.up);this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)};
THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=new THREE.Camera;THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=new THREE.Camera;THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;THREE.PerspectiveCamera.prototype.setLens=function(a,b){this.fov=2*Math.atan((void 0!==b?b:24)/(2*a))*(180/Math.PI);this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(this.fov*Math.PI/360)*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=new THREE.Object3D;THREE.Light.prototype.constructor=THREE.Light;THREE.Light.prototype.supr=THREE.Object3D.prototype;THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=new THREE.Light;THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;
THREE.DirectionalLight=function(a,b,c){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=
!1;this.shadowCascadeOffset=new THREE.Vector3(0,0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=new THREE.Light;THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;
THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,0,0);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=new THREE.Light;THREE.PointLight.prototype.constructor=THREE.PointLight;
THREE.SpotLight=function(a,b,c,d,e){THREE.Light.call(this,a);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/2;this.exponent=void 0!==e?e:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=
this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=new THREE.Light;THREE.SpotLight.prototype.constructor=THREE.SpotLight;THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/
a.total).toFixed(0)+"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},initMaterials:function(a,b,c){a.materials=[];for(var d=0;d<b.length;++d)a.materials[d]=THREE.Loader.prototype.createMaterial(b[d],c)},hasNormals:function(a){var b,c,d=a.materials.length;for(c=0;c<d;c++)if(b=a.materials[c],b instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=
Math.log(a)/Math.LN2;return Math.floor(a)==a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function e(a,b){var e=new Image;e.onload=function(){if(!c(this.width)||!c(this.height)){var b=d(this.width),e=d(this.height);a.image.width=b;a.image.height=e;a.image.getContext("2d").drawImage(this,0,0,b,e)}else a.image=this;a.needsUpdate=!0};e.crossOrigin=h.crossOrigin;e.src=b}function f(a,c,d,f,g,h){var i=document.createElement("canvas");a[c]=new THREE.Texture(i);a[c].sourceFile=d;
if(f&&(a[c].repeat.set(f[0],f[1]),1!=f[0]&&(a[c].wrapS=THREE.RepeatWrapping),1!=f[1]))a[c].wrapT=THREE.RepeatWrapping;g&&a[c].offset.set(g[0],g[1]);if(h&&(f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==f[h[0]]&&(a[c].wrapS=f[h[0]]),void 0!==f[h[1]]))a[c].wrapT=f[h[1]];e(a[c],b+"/"+d)}function g(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var h=this,i="MeshLambertMaterial",j={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,wireframe:a.wireframe};if(a.shading){var k=
a.shading.toLowerCase();"phong"===k?i="MeshPhongMaterial":"basic"===k&&(i="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(j.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)j.transparent=a.transparent;void 0!==a.depthTest&&(j.depthTest=a.depthTest);void 0!==a.depthWrite&&(j.depthWrite=a.depthWrite);void 0!==a.vertexColors&&("face"==a.vertexColors?j.vertexColors=THREE.FaceColors:a.vertexColors&&(j.vertexColors=THREE.VertexColors));a.colorDiffuse?j.color=g(a.colorDiffuse):
a.DbgColor&&(j.color=a.DbgColor);a.colorSpecular&&(j.specular=g(a.colorSpecular));a.colorAmbient&&(j.ambient=g(a.colorAmbient));a.transparency&&(j.opacity=a.transparency);a.specularCoef&&(j.shininess=a.specularCoef);a.mapDiffuse&&b&&f(j,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap);a.mapLight&&b&&f(j,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap);a.mapNormal&&b&&f(j,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap);a.mapSpecular&&
b&&f(j,"specularMap",a.mapSpecular,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap);a.mapNormal?(i=THREE.ShaderUtils.lib.normal,k=THREE.UniformsUtils.clone(i.uniforms),k.tNormal.texture=j.normalMap,a.mapNormalFactor&&(k.uNormalScale.value=a.mapNormalFactor),j.map&&(k.tDiffuse.texture=j.map,k.enableDiffuse.value=!0),j.specularMap&&(k.tSpecular.texture=j.specularMap,k.enableSpecular.value=!0),j.lightMap&&(k.tAO.texture=j.lightMap,k.enableAO.value=!0),k.uDiffuseColor.value.setHex(j.color),
k.uSpecularColor.value.setHex(j.specular),k.uAmbientColor.value.setHex(j.ambient),k.uShininess.value=j.shininess,void 0!==j.opacity&&(k.uOpacity.value=j.opacity),j=new THREE.ShaderMaterial({fragmentShader:i.fragmentShader,vertexShader:i.vertexShader,uniforms:k,lights:!0,fog:!0})):j=new THREE[i](j);void 0!==a.DbgName&&(j.name=a.DbgName);return j}};THREE.BinaryLoader=function(a){THREE.Loader.call(this,a)};THREE.BinaryLoader.prototype=new THREE.Loader;THREE.BinaryLoader.prototype.constructor=THREE.BinaryLoader;
THREE.BinaryLoader.prototype.load=function(a,b,c,d){var c=c?c:this.extractUrlBase(a),d=d?d:this.extractUrlBase(a),e=this.showProgress?THREE.Loader.prototype.updateProgress:null;this.onLoadStart();this.loadAjaxJSON(this,a,b,c,d,e)};
THREE.BinaryLoader.prototype.loadAjaxJSON=function(a,b,c,d,e,f){var g=new XMLHttpRequest;g.onreadystatechange=function(){if(4==g.readyState)if(200==g.status||0==g.status){var h=JSON.parse(g.responseText);a.loadAjaxBuffers(h,c,e,d,f)}else console.error("THREE.BinaryLoader: Couldn't load ["+b+"] ["+g.status+"]")};g.open("GET",b,!0);g.overrideMimeType&&g.overrideMimeType("text/plain; charset=x-user-defined");g.setRequestHeader("Content-Type","text/plain");g.send(null)};
THREE.BinaryLoader.prototype.loadAjaxBuffers=function(a,b,c,d,e){var f=new XMLHttpRequest,g=c+"/"+a.buffers,h=0;f.onreadystatechange=function(){4==f.readyState?200==f.status||0==f.status?THREE.BinaryLoader.prototype.createBinModel(f.response,b,d,a.materials):console.error("THREE.BinaryLoader: Couldn't load ["+g+"] ["+f.status+"]"):3==f.readyState?e&&(0==h&&(h=f.getResponseHeader("Content-Length")),e({total:h,loaded:f.responseText.length})):2==f.readyState&&(h=f.getResponseHeader("Content-Length"))};
f.open("GET",g,!0);f.responseType="arraybuffer";f.send(null)};
THREE.BinaryLoader.prototype.createBinModel=function(a,b,c,d){var e=function(b){function c(a){return a%4?4-a%4:0}function e(a,b){return(new Uint8Array(a,b,1))[0]}function i(a,b){return(new Uint32Array(a,b,1))[0]}function j(b,c){var d,e,f,g,h,i,j,k,s=new Uint32Array(a,c,3*b);for(d=0;d<b;d++){e=s[3*d];f=s[3*d+1];g=s[3*d+2];h=I[2*e];e=I[2*e+1];i=I[2*f];j=I[2*f+1];f=I[2*g];k=I[2*g+1];g=N.faceVertexUvs[0];var l=[];l.push(new THREE.UV(h,e));l.push(new THREE.UV(i,j));l.push(new THREE.UV(f,k));g.push(l)}}
function k(b,c){var d,e,f,g,h,i,j,k,s,l,u=new Uint32Array(a,c,4*b);for(d=0;d<b;d++){e=u[4*d];f=u[4*d+1];g=u[4*d+2];h=u[4*d+3];i=I[2*e];e=I[2*e+1];j=I[2*f];s=I[2*f+1];k=I[2*g];l=I[2*g+1];g=I[2*h];f=I[2*h+1];h=N.faceVertexUvs[0];var o=[];o.push(new THREE.UV(i,e));o.push(new THREE.UV(j,s));o.push(new THREE.UV(k,l));o.push(new THREE.UV(g,f));h.push(o)}}function l(b,c,d){for(var e,f,g,h,c=new Uint32Array(a,c,3*b),i=new Uint16Array(a,d,b),d=0;d<b;d++)e=c[3*d],f=c[3*d+1],g=c[3*d+2],h=i[d],N.faces.push(new THREE.Face3(e,
f,g,null,null,h))}function p(b,c,d){for(var e,f,g,h,i,c=new Uint32Array(a,c,4*b),j=new Uint16Array(a,d,b),d=0;d<b;d++)e=c[4*d],f=c[4*d+1],g=c[4*d+2],h=c[4*d+3],i=j[d],N.faces.push(new THREE.Face4(e,f,g,h,null,null,i))}function m(b,c,d,e){for(var f,g,h,i,j,k,s,c=new Uint32Array(a,c,3*b),d=new Uint32Array(a,d,3*b),l=new Uint16Array(a,e,b),e=0;e<b;e++){f=c[3*e];g=c[3*e+1];h=c[3*e+2];j=d[3*e];k=d[3*e+1];s=d[3*e+2];i=l[e];var u=M[3*k],o=M[3*k+1];k=M[3*k+2];var p=M[3*s],m=M[3*s+1];s=M[3*s+2];N.faces.push(new THREE.Face3(f,
g,h,[new THREE.Vector3(M[3*j],M[3*j+1],M[3*j+2]),new THREE.Vector3(u,o,k),new THREE.Vector3(p,m,s)],null,i))}}function r(b,c,d,e){for(var f,g,h,i,j,k,s,l,u,c=new Uint32Array(a,c,4*b),d=new Uint32Array(a,d,4*b),o=new Uint16Array(a,e,b),e=0;e<b;e++){f=c[4*e];g=c[4*e+1];h=c[4*e+2];i=c[4*e+3];k=d[4*e];s=d[4*e+1];l=d[4*e+2];u=d[4*e+3];j=o[e];var p=M[3*s],m=M[3*s+1];s=M[3*s+2];var E=M[3*l],q=M[3*l+1];l=M[3*l+2];var r=M[3*u],B=M[3*u+1];u=M[3*u+2];N.faces.push(new THREE.Face4(f,g,h,i,[new THREE.Vector3(M[3*
k],M[3*k+1],M[3*k+2]),new THREE.Vector3(p,m,s),new THREE.Vector3(E,q,l),new THREE.Vector3(r,B,u)],null,j))}}var q,t,v,w,z,x,A,F,C,D,y,s,E,u,J,N=this,B=0,M=[],I=[],o,Q,P;THREE.Geometry.call(this);THREE.Loader.prototype.initMaterials(N,d,b);(function(a,b,c){for(var a=new Uint8Array(a,b,c),d="",e=0;e<c;e++)d+=String.fromCharCode(a[b+e]);return d})(a,B,12);q=e(a,B+12);e(a,B+13);e(a,B+14);e(a,B+15);t=e(a,B+16);v=e(a,B+17);w=e(a,B+18);z=e(a,B+19);x=i(a,B+20);A=i(a,B+20+4);F=i(a,B+20+8);b=i(a,B+20+12);C=
i(a,B+20+16);D=i(a,B+20+20);y=i(a,B+20+24);s=i(a,B+20+28);E=i(a,B+20+32);u=i(a,B+20+36);J=i(a,B+20+40);B+=q;q=3*t+z;P=4*t+z;o=b*q;Q=C*(q+3*v);t=D*(q+3*w);z=y*(q+3*v+3*w);q=s*P;v=E*(P+4*v);w=u*(P+4*w);B+=function(b){var b=new Float32Array(a,b,3*x),c,d,e,f;for(c=0;c<x;c++)d=b[3*c],e=b[3*c+1],f=b[3*c+2],N.vertices.push(new THREE.Vector3(d,e,f));return 3*x*Float32Array.BYTES_PER_ELEMENT}(B);B+=function(b){if(A){var b=new Int8Array(a,b,3*A),c,d,e,f;for(c=0;c<A;c++)d=b[3*c],e=b[3*c+1],f=b[3*c+2],M.push(d/
127,e/127,f/127)}return 3*A*Int8Array.BYTES_PER_ELEMENT}(B);B+=c(3*A);B+=function(b){if(F){var b=new Float32Array(a,b,2*F),c,d,e;for(c=0;c<F;c++)d=b[2*c],e=b[2*c+1],I.push(d,e)}return 2*F*Float32Array.BYTES_PER_ELEMENT}(B);o=B+o+c(2*b);Q=o+Q+c(2*C);t=Q+t+c(2*D);z=t+z+c(2*y);q=z+q+c(2*s);v=q+v+c(2*E);w=v+w+c(2*u);(function(a){if(D){var b=a+3*D*Uint32Array.BYTES_PER_ELEMENT;l(D,a,b+3*D*Uint32Array.BYTES_PER_ELEMENT);j(D,b)}})(Q);(function(a){if(y){var b=a+3*y*Uint32Array.BYTES_PER_ELEMENT,c=b+3*y*Uint32Array.BYTES_PER_ELEMENT;
m(y,a,b,c+3*y*Uint32Array.BYTES_PER_ELEMENT);j(y,c)}})(t);(function(a){if(u){var b=a+4*u*Uint32Array.BYTES_PER_ELEMENT;p(u,a,b+4*u*Uint32Array.BYTES_PER_ELEMENT);k(u,b)}})(v);(function(a){if(J){var b=a+4*J*Uint32Array.BYTES_PER_ELEMENT,c=b+4*J*Uint32Array.BYTES_PER_ELEMENT;r(J,a,b,c+4*J*Uint32Array.BYTES_PER_ELEMENT);k(J,c)}})(w);b&&l(b,B,B+3*b*Uint32Array.BYTES_PER_ELEMENT);(function(a){if(C){var b=a+3*C*Uint32Array.BYTES_PER_ELEMENT;m(C,a,b,b+3*C*Uint32Array.BYTES_PER_ELEMENT)}})(o);s&&p(s,z,z+
4*s*Uint32Array.BYTES_PER_ELEMENT);(function(a){if(E){var b=a+4*E*Uint32Array.BYTES_PER_ELEMENT;r(E,a,b,b+4*E*Uint32Array.BYTES_PER_ELEMENT)}})(q);this.computeCentroids();this.computeFaceNormals();THREE.Loader.prototype.hasNormals(this)&&this.computeTangents()};e.prototype=new THREE.Geometry;e.prototype.constructor=e;b(new e(c))};THREE.JSONLoader=function(a){THREE.Loader.call(this,a)};THREE.JSONLoader.prototype=new THREE.Loader;THREE.JSONLoader.prototype.constructor=THREE.JSONLoader;
THREE.JSONLoader.prototype.load=function(a,b,c){c=c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,g=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var h=JSON.parse(f.responseText);a.createModel(h,c,d)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");a.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING?e&&(0===g&&(g=f.getResponseHeader("Content-Length")),
e({total:g,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&(g=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.overrideMimeType&&f.overrideMimeType("text/plain; charset=x-user-defined");f.setRequestHeader("Content-Type","text/plain");f.send(null)};
THREE.JSONLoader.prototype.createModel=function(a,b,c){var d=new THREE.Geometry,e=void 0!==a.scale?1/a.scale:1;this.initMaterials(d,a.materials,c);(function(b){var c,e,i,j,k,l,p,m,r,q,t,v,w,z,x=a.faces;l=a.vertices;var A=a.normals,F=a.colors,C=0;for(c=0;c<a.uvs.length;c++)a.uvs[c].length&&C++;for(c=0;c<C;c++)d.faceUvs[c]=[],d.faceVertexUvs[c]=[];j=0;for(k=l.length;j<k;)p=new THREE.Vector3,p.x=l[j++]*b,p.y=l[j++]*b,p.z=l[j++]*b,d.vertices.push(p);j=0;for(k=x.length;j<k;){b=x[j++];l=b&1;i=b&2;c=b&4;
e=b&8;m=b&16;p=b&32;q=b&64;b&=128;l?(t=new THREE.Face4,t.a=x[j++],t.b=x[j++],t.c=x[j++],t.d=x[j++],l=4):(t=new THREE.Face3,t.a=x[j++],t.b=x[j++],t.c=x[j++],l=3);i&&(i=x[j++],t.materialIndex=i);i=d.faces.length;if(c)for(c=0;c<C;c++)v=a.uvs[c],r=x[j++],z=v[2*r],r=v[2*r+1],d.faceUvs[c][i]=new THREE.UV(z,r);if(e)for(c=0;c<C;c++){v=a.uvs[c];w=[];for(e=0;e<l;e++)r=x[j++],z=v[2*r],r=v[2*r+1],w[e]=new THREE.UV(z,r);d.faceVertexUvs[c][i]=w}m&&(m=3*x[j++],e=new THREE.Vector3,e.x=A[m++],e.y=A[m++],e.z=A[m],
t.normal=e);if(p)for(c=0;c<l;c++)m=3*x[j++],e=new THREE.Vector3,e.x=A[m++],e.y=A[m++],e.z=A[m],t.vertexNormals.push(e);q&&(p=x[j++],p=new THREE.Color(F[p]),t.color=p);if(b)for(c=0;c<l;c++)p=x[j++],p=new THREE.Color(F[p]),t.vertexColors.push(p);d.faces.push(t)}})(e);(function(){var b,c,e,i;if(a.skinWeights){b=0;for(c=a.skinWeights.length;b<c;b+=2)e=a.skinWeights[b],i=a.skinWeights[b+1],d.skinWeights.push(new THREE.Vector4(e,i,0,0))}if(a.skinIndices){b=0;for(c=a.skinIndices.length;b<c;b+=2)e=a.skinIndices[b],
i=a.skinIndices[b+1],d.skinIndices.push(new THREE.Vector4(e,i,0,0))}d.bones=a.bones;d.animation=a.animation})();(function(b){if(void 0!==a.morphTargets){var c,e,i,j,k,l;c=0;for(e=a.morphTargets.length;c<e;c++){d.morphTargets[c]={};d.morphTargets[c].name=a.morphTargets[c].name;d.morphTargets[c].vertices=[];k=d.morphTargets[c].vertices;l=a.morphTargets[c].vertices;i=0;for(j=l.length;i<j;i+=3){var p=new THREE.Vector3;p.x=l[i]*b;p.y=l[i+1]*b;p.z=l[i+2]*b;k.push(p)}}}if(void 0!==a.morphColors){c=0;for(e=
a.morphColors.length;c<e;c++){d.morphColors[c]={};d.morphColors[c].name=a.morphColors[c].name;d.morphColors[c].colors=[];j=d.morphColors[c].colors;k=a.morphColors[c].colors;b=0;for(i=k.length;b<i;b+=3)l=new THREE.Color(16755200),l.setRGB(k[b],k[b+1],k[b+2]),j.push(l)}}})(e);d.computeCentroids();d.computeFaceNormals();this.hasNormals(d)&&d.computeTangents();b(d)};
THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){}};THREE.SceneLoader.prototype.constructor=THREE.SceneLoader;
THREE.SceneLoader.prototype.load=function(a,b){var c=this,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status||0==d.status){var e=JSON.parse(d.responseText);c.createScene(e,b,a)}else console.error("THREE.SceneLoader: Couldn't load ["+a+"] ["+d.status+"]")};d.open("GET",a,!0);d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined");d.setRequestHeader("Content-Type","text/plain");d.send(null)};
THREE.SceneLoader.prototype.createScene=function(a,b,c){function d(a,b){return"relativeToHTML"==b?a:j+"/"+a}function e(){var a;for(p in B.objects)if(!H.objects[p])if(v=B.objects[p],void 0!==v.geometry){if(E=H.geometries[v.geometry])u=H.materials[v.materials[0]],u instanceof THREE.ShaderMaterial&&E.computeTangents(),A=v.position,F=v.rotation,C=v.quaternion,D=v.scale,w=v.matrix,C=0,0==v.materials.length&&(u=new THREE.MeshFaceMaterial),1<v.materials.length&&(u=new THREE.MeshFaceMaterial),a=new THREE.Mesh(E,
u),a.name=p,w?(a.matrixAutoUpdate=!1,a.matrix.set(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])):(a.position.set(A[0],A[1],A[2]),C?(a.quaternion.set(C[0],C[1],C[2],C[3]),a.useQuaternion=!0):a.rotation.set(F[0],F[1],F[2]),a.scale.set(D[0],D[1],D[2])),a.visible=v.visible,a.doubleSided=v.doubleSided,a.castShadow=v.castShadow,a.receiveShadow=v.receiveShadow,H.scene.add(a),H.objects[p]=a}else A=v.position,F=v.rotation,C=v.quaternion,D=v.scale,C=0,a=new THREE.Object3D,
a.name=p,a.position.set(A[0],A[1],A[2]),C?(a.quaternion.set(C[0],C[1],C[2],C[3]),a.useQuaternion=!0):a.rotation.set(F[0],F[1],F[2]),a.scale.set(D[0],D[1],D[2]),a.visible=void 0!==v.visible?v.visible:!1,H.scene.add(a),H.objects[p]=a,H.empties[p]=a}function f(a){return function(b){H.geometries[a]=b;e();I-=1;i.onLoadComplete();h()}}function g(a){return function(b){H.geometries[a]=b}}function h(){i.callbackProgress({totalModels:Q,totalTextures:P,loadedModels:Q-I,loadedTextures:P-o},H);i.onLoadProgress();
0==I&&0==o&&b(H)}var i=this,j=THREE.Loader.prototype.extractUrlBase(c),k,l,p,m,r,q,t,v,w,z,x,A,F,C,D,y,s,E,u,J,N,B,M,I,o,Q,P,H;B=a;c=new THREE.BinaryLoader;M=new THREE.JSONLoader;o=I=0;H={scene:new THREE.Scene,geometries:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{}};if(B.transform&&(a=B.transform.position,z=B.transform.rotation,y=B.transform.scale,a&&H.scene.position.set(a[0],a[1],a[2]),z&&H.scene.rotation.set(z[0],z[1],z[2]),y&&H.scene.scale.set(y[0],y[1],y[2]),
a||z||y))H.scene.updateMatrix(),H.scene.updateMatrixWorld();a=function(){o-=1;h();i.onLoadComplete()};for(r in B.cameras)y=B.cameras[r],"perspective"==y.type?J=new THREE.PerspectiveCamera(y.fov,y.aspect,y.near,y.far):"ortho"==y.type&&(J=new THREE.OrthographicCamera(y.left,y.right,y.top,y.bottom,y.near,y.far)),A=y.position,z=y.target,y=y.up,J.position.set(A[0],A[1],A[2]),J.target=new THREE.Vector3(z[0],z[1],z[2]),y&&J.up.set(y[0],y[1],y[2]),H.cameras[r]=J;for(m in B.lights)z=B.lights[m],r=void 0!==
z.color?z.color:16777215,J=void 0!==z.intensity?z.intensity:1,"directional"==z.type?(A=z.direction,x=new THREE.DirectionalLight(r,J),x.position.set(A[0],A[1],A[2]),x.position.normalize()):"point"==z.type?(A=z.position,x=z.distance,x=new THREE.PointLight(r,J,x),x.position.set(A[0],A[1],A[2])):"ambient"==z.type&&(x=new THREE.AmbientLight(r)),H.scene.add(x),H.lights[m]=x;for(q in B.fogs)m=B.fogs[q],"linear"==m.type?N=new THREE.Fog(0,m.near,m.far):"exp2"==m.type&&(N=new THREE.FogExp2(0,m.density)),y=
m.color,N.color.setRGB(y[0],y[1],y[2]),H.fogs[q]=N;H.cameras&&B.defaults.camera&&(H.currentCamera=H.cameras[B.defaults.camera]);H.fogs&&B.defaults.fog&&(H.scene.fog=H.fogs[B.defaults.fog]);y=B.defaults.bgcolor;H.bgColor=new THREE.Color;H.bgColor.setRGB(y[0],y[1],y[2]);H.bgColorAlpha=B.defaults.bgalpha;for(k in B.geometries)if(q=B.geometries[k],"bin_mesh"==q.type||"ascii_mesh"==q.type)I+=1,i.onLoadStart();Q=I;for(k in B.geometries)q=B.geometries[k],"cube"==q.type?(E=new THREE.CubeGeometry(q.width,
q.height,q.depth,q.segmentsWidth,q.segmentsHeight,q.segmentsDepth,null,q.flipped,q.sides),H.geometries[k]=E):"plane"==q.type?(E=new THREE.PlaneGeometry(q.width,q.height,q.segmentsWidth,q.segmentsHeight),H.geometries[k]=E):"sphere"==q.type?(E=new THREE.SphereGeometry(q.radius,q.segmentsWidth,q.segmentsHeight),H.geometries[k]=E):"cylinder"==q.type?(E=new THREE.CylinderGeometry(q.topRad,q.botRad,q.height,q.radSegs,q.heightSegs),H.geometries[k]=E):"torus"==q.type?(E=new THREE.TorusGeometry(q.radius,q.tube,
q.segmentsR,q.segmentsT),H.geometries[k]=E):"icosahedron"==q.type?(E=new THREE.IcosahedronGeometry(q.radius,q.subdivisions),H.geometries[k]=E):"bin_mesh"==q.type?c.load(d(q.url,B.urlBaseType),f(k)):"ascii_mesh"==q.type?M.load(d(q.url,B.urlBaseType),f(k)):"embedded_mesh"==q.type&&(q=B.embeds[q.id],q.metadata=B.metadata,q&&M.createModel(q,g(k),""));for(t in B.textures)if(k=B.textures[t],k.url instanceof Array){o+=k.url.length;for(q=0;q<k.url.length;q++)i.onLoadStart()}else o+=1,i.onLoadStart();P=o;
for(t in B.textures){k=B.textures[t];void 0!=k.mapping&&void 0!=THREE[k.mapping]&&(k.mapping=new THREE[k.mapping]);if(k.url instanceof Array){q=[];for(N=0;N<k.url.length;N++)q[N]=d(k.url[N],B.urlBaseType);q=THREE.ImageUtils.loadTextureCube(q,k.mapping,a)}else{q=THREE.ImageUtils.loadTexture(d(k.url,B.urlBaseType),k.mapping,a);void 0!=THREE[k.minFilter]&&(q.minFilter=THREE[k.minFilter]);void 0!=THREE[k.magFilter]&&(q.magFilter=THREE[k.magFilter]);if(k.repeat&&(q.repeat.set(k.repeat[0],k.repeat[1]),
1!=k.repeat[0]&&(q.wrapS=THREE.RepeatWrapping),1!=k.repeat[1]))q.wrapT=THREE.RepeatWrapping;k.offset&&q.offset.set(k.offset[0],k.offset[1]);if(k.wrap&&(N={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==N[k.wrap[0]]&&(q.wrapS=N[k.wrap[0]]),void 0!==N[k.wrap[1]]))q.wrapT=N[k.wrap[1]]}H.textures[t]=q}for(l in B.materials){w=B.materials[l];for(s in w.parameters)"envMap"==s||"map"==s||"lightMap"==s?w.parameters[s]=H.textures[w.parameters[s]]:"shading"==s?w.parameters[s]="flat"==
w.parameters[s]?THREE.FlatShading:THREE.SmoothShading:"blending"==s?w.parameters[s]=THREE[w.parameters[s]]?THREE[w.parameters[s]]:THREE.NormalBlending:"combine"==s?w.parameters[s]="MixOperation"==w.parameters[s]?THREE.MixOperation:THREE.MultiplyOperation:"vertexColors"==s&&("face"==w.parameters[s]?w.parameters[s]=THREE.FaceColors:w.parameters[s]&&(w.parameters[s]=THREE.VertexColors));void 0!==w.parameters.opacity&&1>w.parameters.opacity&&(w.parameters.transparent=!0);w.parameters.normalMap?(t=THREE.ShaderUtils.lib.normal,
a=THREE.UniformsUtils.clone(t.uniforms),k=w.parameters.color,q=w.parameters.specular,N=w.parameters.ambient,c=w.parameters.shininess,a.tNormal.texture=H.textures[w.parameters.normalMap],w.parameters.normalMapFactor&&(a.uNormalScale.value=w.parameters.normalMapFactor),w.parameters.map&&(a.tDiffuse.texture=w.parameters.map,a.enableDiffuse.value=!0),w.parameters.lightMap&&(a.tAO.texture=w.parameters.lightMap,a.enableAO.value=!0),w.parameters.specularMap&&(a.tSpecular.texture=H.textures[w.parameters.specularMap],
a.enableSpecular.value=!0),a.uDiffuseColor.value.setHex(k),a.uSpecularColor.value.setHex(q),a.uAmbientColor.value.setHex(N),a.uShininess.value=c,w.parameters.opacity&&(a.uOpacity.value=w.parameters.opacity),u=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:a,lights:!0,fog:!0})):u=new THREE[w.type](w.parameters);H.materials[l]=u}e();i.callbackSync(H);h()};
THREE.Material=function(a){a=a||{};this.id=THREE.MaterialCount++;this.name="";this.opacity=void 0!==a.opacity?a.opacity:1;this.transparent=void 0!==a.transparent?a.transparent:!1;this.blending=void 0!==a.blending?a.blending:THREE.NormalBlending;this.blendSrc=void 0!==a.blendSrc?a.blendSrc:THREE.SrcAlphaFactor;this.blendDst=void 0!==a.blendDst?a.blendDst:THREE.OneMinusSrcAlphaFactor;this.blendEquation=void 0!==a.blendEquation?a.blendEquation:THREE.AddEquation;this.depthTest=void 0!==a.depthTest?a.depthTest:
!0;this.depthWrite=void 0!==a.depthWrite?a.depthWrite:!0;this.polygonOffset=void 0!==a.polygonOffset?a.polygonOffset:!1;this.polygonOffsetFactor=void 0!==a.polygonOffsetFactor?a.polygonOffsetFactor:0;this.polygonOffsetUnits=void 0!==a.polygonOffsetUnits?a.polygonOffsetUnits:0;this.alphaTest=void 0!==a.alphaTest?a.alphaTest:0;this.overdraw=void 0!==a.overdraw?a.overdraw:!1;this.needsUpdate=this.visible=!0};THREE.MaterialCount=0;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;
THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.AdditiveAlphaBlending=5;THREE.CustomBlending=6;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;
THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;
THREE.LineBasicMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.linewidth=void 0!==a.linewidth?a.linewidth:1;this.linecap=void 0!==a.linecap?a.linecap:"round";this.linejoin=void 0!==a.linejoin?a.linejoin:"round";this.vertexColors=a.vertexColors?a.vertexColors:!1;this.fog=void 0!==a.fog?a.fog:!0};THREE.LineBasicMaterial.prototype=new THREE.Material;THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.map=void 0!==a.map?a.map:null;this.lightMap=void 0!==a.lightMap?a.lightMap:null;this.envMap=void 0!==a.envMap?a.envMap:null;this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1;this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:0.98;this.fog=void 0!==a.fog?a.fog:
!0;this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1;this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round";this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors;this.skinning=void 0!==a.skinning?a.skinning:!1;this.morphTargets=void 0!==a.morphTargets?
a.morphTargets:!1};THREE.MeshBasicMaterial.prototype=new THREE.Material;THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.ambient=void 0!==a.ambient?new THREE.Color(a.ambient):new THREE.Color(16777215);this.emissive=void 0!==a.emissive?new THREE.Color(a.emissive):new THREE.Color(0);this.wrapAround=void 0!==a.wrapAround?a.wrapAround:!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=void 0!==a.map?a.map:null;this.lightMap=void 0!==a.lightMap?a.lightMap:null;this.envMap=
void 0!==a.envMap?a.envMap:null;this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1;this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:0.98;this.fog=void 0!==a.fog?a.fog:!0;this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1;this.wireframeLinecap=void 0!==a.wireframeLinecap?
a.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round";this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors;this.skinning=void 0!==a.skinning?a.skinning:!1;this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1;this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1};THREE.MeshLambertMaterial.prototype=new THREE.Material;THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.ambient=void 0!==a.ambient?new THREE.Color(a.ambient):new THREE.Color(16777215);this.emissive=void 0!==a.emissive?new THREE.Color(a.emissive):new THREE.Color(0);this.specular=void 0!==a.specular?new THREE.Color(a.specular):new THREE.Color(1118481);this.shininess=void 0!==a.shininess?a.shininess:30;this.metal=void 0!==a.metal?a.metal:!1;this.perPixel=
void 0!==a.perPixel?a.perPixel:!1;this.wrapAround=void 0!==a.wrapAround?a.wrapAround:!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=void 0!==a.map?a.map:null;this.lightMap=void 0!==a.lightMap?a.lightMap:null;this.envMap=void 0!==a.envMap?a.envMap:null;this.combine=void 0!==a.combine?a.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==a.reflectivity?a.reflectivity:1;this.refractionRatio=void 0!==a.refractionRatio?a.refractionRatio:0.98;this.fog=void 0!==a.fog?a.fog:!0;this.shading=void 0!==
a.shading?a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1;this.wireframeLinecap=void 0!==a.wireframeLinecap?a.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==a.wireframeLinejoin?a.wireframeLinejoin:"round";this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors;this.skinning=void 0!==a.skinning?a.skinning:!1;this.morphTargets=void 0!==a.morphTargets?a.morphTargets:
!1;this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1};THREE.MeshPhongMaterial.prototype=new THREE.Material;THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;THREE.MeshDepthMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1};THREE.MeshDepthMaterial.prototype=new THREE.Material;
THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.shading=a.shading?a.shading:THREE.FlatShading;this.wireframe=a.wireframe?a.wireframe:!1;this.wireframeLinewidth=a.wireframeLinewidth?a.wireframeLinewidth:1};THREE.MeshNormalMaterial.prototype=new THREE.Material;THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;THREE.MeshFaceMaterial=function(){};
THREE.ParticleBasicMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.map=void 0!==a.map?a.map:null;this.size=void 0!==a.size?a.size:1;this.sizeAttenuation=void 0!==a.sizeAttenuation?a.sizeAttenuation:!0;this.vertexColors=void 0!==a.vertexColors?a.vertexColors:!1;this.fog=void 0!==a.fog?a.fog:!0};THREE.ParticleBasicMaterial.prototype=new THREE.Material;THREE.ParticleBasicMaterial.prototype.constructor=THREE.ParticleBasicMaterial;
THREE.ParticleCanvasMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.program=void 0!==a.program?a.program:function(){}};THREE.ParticleCanvasMaterial.prototype=new THREE.Material;THREE.ParticleCanvasMaterial.prototype.constructor=THREE.ParticleCanvasMaterial;THREE.ParticleDOMMaterial=function(a){THREE.Material.call(this);this.domElement=a};
THREE.ShaderMaterial=function(a){THREE.Material.call(this,a);a=a||{};this.fragmentShader=void 0!==a.fragmentShader?a.fragmentShader:"void main() {}";this.vertexShader=void 0!==a.vertexShader?a.vertexShader:"void main() {}";this.uniforms=void 0!==a.uniforms?a.uniforms:{};this.attributes=a.attributes;this.shading=void 0!==a.shading?a.shading:THREE.SmoothShading;this.wireframe=void 0!==a.wireframe?a.wireframe:!1;this.wireframeLinewidth=void 0!==a.wireframeLinewidth?a.wireframeLinewidth:1;this.fog=void 0!==
a.fog?a.fog:!1;this.lights=void 0!==a.lights?a.lights:!1;this.vertexColors=void 0!==a.vertexColors?a.vertexColors:THREE.NoColors;this.skinning=void 0!==a.skinning?a.skinning:!1;this.morphTargets=void 0!==a.morphTargets?a.morphTargets:!1;this.morphNormals=void 0!==a.morphNormals?a.morphNormals:!1};THREE.ShaderMaterial.prototype=new THREE.Material;THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;
THREE.Texture=function(a,b,c,d,e,f,g,h){this.id=THREE.TextureCount++;this.image=a;this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.format=void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=
!0;this.needsUpdate=this.premultiplyAlpha=!1;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(){var a=new THREE.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter,this.format,this.type);a.offset.copy(this.offset);a.repeat.copy(this.repeat);return a}};THREE.TextureCount=0;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};
THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=0;THREE.ClampToEdgeWrapping=1;THREE.MirroredRepeatWrapping=2;THREE.NearestFilter=3;THREE.NearestMipMapNearestFilter=4;THREE.NearestMipMapLinearFilter=5;THREE.LinearFilter=6;THREE.LinearMipMapNearestFilter=7;THREE.LinearMipMapLinearFilter=8;THREE.ByteType=9;THREE.UnsignedByteType=10;THREE.ShortType=11;THREE.UnsignedShortType=12;THREE.IntType=13;THREE.UnsignedIntType=14;THREE.FloatType=15;
THREE.AlphaFormat=16;THREE.RGBFormat=17;THREE.RGBAFormat=18;THREE.LuminanceFormat=19;THREE.LuminanceAlphaFormat=20;THREE.DataTexture=function(a,b,c,d,e,f,g,h,i,j){THREE.Texture.call(this,null,f,g,h,i,j,d,e);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=new THREE.Texture;THREE.DataTexture.prototype.constructor=THREE.DataTexture;
THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture(this.image.data,this.image.width,this.image.height,this.format,this.type,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);a.offset.copy(this.offset);a.repeat.copy(this.repeat);return a};THREE.Particle=function(a){THREE.Object3D.call(this);this.material=a};THREE.Particle.prototype=new THREE.Object3D;THREE.Particle.prototype.constructor=THREE.Particle;
THREE.ParticleSystem=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.sortParticles=!1;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=a.boundingSphere.radius);this.frustumCulled=!1};THREE.ParticleSystem.prototype=new THREE.Object3D;THREE.ParticleSystem.prototype.constructor=THREE.ParticleSystem;
THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=new THREE.Object3D;THREE.Line.prototype.constructor=THREE.Line;
THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0});if(this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=a.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var c=0;c<this.geometry.morphTargets.length;c++)this.morphTargetInfluences.push(0),
this.morphTargetDictionary[this.geometry.morphTargets[c].name]=c}};THREE.Mesh.prototype=new THREE.Object3D;THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.supr=THREE.Object3D.prototype;THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};
THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=new THREE.Object3D;THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.supr=THREE.Object3D.prototype;
THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiply(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.skinMatrix,b)};
THREE.SkinnedMesh=function(a,b){THREE.Mesh.call(this,a,b);this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var c,d,e,f,g,h;if(void 0!==this.geometry.bones){for(c=0;c<this.geometry.bones.length;c++)e=this.geometry.bones[c],f=e.pos,g=e.rotq,h=e.scl,d=this.addBone(),d.name=e.name,d.position.set(f[0],f[1],f[2]),d.quaternion.set(g[0],g[1],g[2],g[3]),d.useQuaternion=!0,void 0!==h?d.scale.set(h[0],h[1],h[2]):d.scale.set(1,1,1);for(c=0;c<this.bones.length;c++)e=this.geometry.bones[c],
d=this.bones[c],-1===e.parent?this.add(d):this.bones[e.parent].add(d);this.boneMatrices=new Float32Array(16*this.bones.length);this.pose()}};THREE.SkinnedMesh.prototype=new THREE.Mesh;THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.addBone=function(a){void 0===a&&(a=new THREE.Bone(this));this.bones.push(a);return a};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;for(var a=0,b=this.children.length;a<b;a++){var c=this.children[a];c instanceof THREE.Bone?c.update(this.identityMatrix,!1):c.updateMatrixWorld(!0)}for(var b=this.bones.length,c=this.bones,d=this.boneMatrices,a=0;a<b;a++)c[a].skinMatrix.flattenToArrayOffset(d,
16*a)};
THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var a,b=[],c=0;c<this.bones.length;c++){a=this.bones[c];var d=new THREE.Matrix4;d.getInverse(a.skinMatrix);b.push(d);a.skinMatrix.flattenToArrayOffset(this.boneMatrices,16*c)}if(void 0===this.geometry.skinVerticesA){this.geometry.skinVerticesA=[];this.geometry.skinVerticesB=[];for(a=0;a<this.geometry.skinIndices.length;a++){var c=this.geometry.vertices[a],e=this.geometry.skinIndices[a].x,f=this.geometry.skinIndices[a].y,d=
new THREE.Vector3(c.x,c.y,c.z);this.geometry.skinVerticesA.push(b[e].multiplyVector3(d));d=new THREE.Vector3(c.x,c.y,c.z);this.geometry.skinVerticesB.push(b[f].multiplyVector3(d));1!==this.geometry.skinWeights[a].x+this.geometry.skinWeights[a].y&&(c=0.5*(1-(this.geometry.skinWeights[a].x+this.geometry.skinWeights[a].y)),this.geometry.skinWeights[a].x+=c,this.geometry.skinWeights[a].y+=c)}}};
THREE.MorphAnimMesh=function(a,b){THREE.Mesh.call(this,a,b);this.duration=1E3;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=new THREE.Mesh;THREE.MorphAnimMesh.prototype.constructor=THREE.MorphAnimMesh;
THREE.MorphAnimMesh.prototype.setFrameRange=function(a,b){this.startKeyframe=a;this.endKeyframe=b;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};
THREE.MorphAnimMesh.prototype.parseAnimations=function(){var a=this.geometry;a.animations||(a.animations={});for(var b,c=a.animations,d=/([a-z]+)(\d+)/,e=0,f=a.morphTargets.length;e<f;e++){var g=a.morphTargets[e].name.match(d);if(g&&1<g.length){g=g[1];c[g]||(c[g]={start:Infinity,end:-Infinity});var h=c[g];e<h.start&&(h.start=e);e>h.end&&(h.end=e);b||(b=g)}}a.firstAnimation=b};
THREE.MorphAnimMesh.prototype.setAnimationLabel=function(a,b,c){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[a]={start:b,end:c}};THREE.MorphAnimMesh.prototype.playAnimation=function(a,b){var c=this.geometry.animations[a];c?(this.setFrameRange(c.start,c.end),this.duration=1E3*((c.end-c.start)/b),this.time=0):console.warn("animation["+a+"] undefined")};
THREE.MorphAnimMesh.prototype.updateAnimation=function(a){var b=this.duration/this.length;this.time+=this.direction*a;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)if(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time)this.time=0,this.directionBackwards=!1}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);a=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/b),0,this.length-1);a!==this.currentKeyframe&&
(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[a]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=a);b=this.time%b/b;this.directionBackwards&&(b=1-b);this.morphTargetInfluences[this.currentKeyframe]=b;this.morphTargetInfluences[this.lastKeyframe]=1-b};THREE.Ribbon=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=b};THREE.Ribbon.prototype=new THREE.Object3D;
THREE.Ribbon.prototype.constructor=THREE.Ribbon;THREE.LOD=function(){THREE.Object3D.call(this);this.LODs=[]};THREE.LOD.prototype=new THREE.Object3D;THREE.LOD.prototype.constructor=THREE.LOD;THREE.LOD.prototype.supr=THREE.Object3D.prototype;THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);for(var b=Math.abs(b),c=0;c<this.LODs.length&&!(b<this.LODs[c].visibleAtDistance);c++);this.LODs.splice(c,0,{visibleAtDistance:b,object3D:a});this.add(a)};
THREE.LOD.prototype.update=function(a){if(1<this.LODs.length){a.matrixWorldInverse.getInverse(a.matrixWorld);a=a.matrixWorldInverse;a=-(a.elements[2]*this.matrixWorld.elements[12]+a.elements[6]*this.matrixWorld.elements[13]+a.elements[10]*this.matrixWorld.elements[14]+a.elements[14]);this.LODs[0].object3D.visible=!0;for(var b=1;b<this.LODs.length;b++)if(a>=this.LODs[b].visibleAtDistance)this.LODs[b-1].object3D.visible=!1,this.LODs[b].object3D.visible=!0;else break;for(;b<this.LODs.length;b++)this.LODs[b].object3D.visible=
!1}};
THREE.Sprite=function(a){THREE.Object3D.call(this);this.color=void 0!==a.color?new THREE.Color(a.color):new THREE.Color(16777215);this.map=void 0!==a.map?a.map:new THREE.Texture;this.blending=void 0!==a.blending?a.blending:THREE.NormalBlending;this.blendSrc=void 0!==a.blendSrc?a.blendSrc:THREE.SrcAlphaFactor;this.blendDst=void 0!==a.blendDst?a.blendDst:THREE.OneMinusSrcAlphaFactor;this.blendEquation=void 0!==a.blendEquation?a.blendEquation:THREE.AddEquation;this.useScreenCoordinates=void 0!==a.useScreenCoordinates?
a.useScreenCoordinates:!0;this.mergeWith3D=void 0!==a.mergeWith3D?a.mergeWith3D:!this.useScreenCoordinates;this.affectedByDistance=void 0!==a.affectedByDistance?a.affectedByDistance:!this.useScreenCoordinates;this.scaleByViewport=void 0!==a.scaleByViewport?a.scaleByViewport:!this.affectedByDistance;this.alignment=a.alignment instanceof THREE.Vector2?a.alignment:THREE.SpriteAlignment.center;this.rotation3d=this.rotation;this.rotation=0;this.opacity=1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=
new THREE.Vector2(1,1)};THREE.Sprite.prototype=new THREE.Object3D;THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);if(1!==this.scale.x||1!==this.scale.y)this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y);this.matrixWorldNeedsUpdate=!0};THREE.SpriteAlignment={};
THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);
THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=new THREE.Object3D;THREE.Scene.prototype.constructor=THREE.Scene;
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)&&-1===this.__objects.indexOf(a)){this.__objects.push(a);this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1)}else a instanceof THREE.Camera||(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};
THREE.Fog=function(a,b,c){this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};THREE.FogExp2=function(a,b){this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};
THREE.DOMRenderer=function(){console.log("THREE.DOMRenderer",THREE.REVISION);var a,b,c,d,e,f,g,h=new THREE.Projector;g=function(a){for(var b=document.documentElement,c=0;c<a.length;c++)if("string"===typeof b.style[a[c]])return a[c];return null}(["transform","MozTransform","WebkitTransform","msTransform","OTransform"]);this.domElement=document.createElement("div");this.setSize=function(a,b){c=a;d=b;e=c/2;f=d/2};this.render=function(c,d){var k,l,p,m,r,q;a=h.projectScene(c,d);b=a.elements;k=0;for(l=
b.length;k<l;k++)p=b[k],p instanceof THREE.RenderableParticle&&p.material instanceof THREE.ParticleDOMMaterial&&(m=p.material.domElement,r=p.x*e+e-(m.offsetWidth>>1),q=p.y*f+f-(m.offsetHeight>>1),m.style.left=r+"px",m.style.top=q+"px",m.style.zIndex=Math.abs(Math.floor((1-p.z)*d.far/d.near)),g&&(m.style[g]="scale("+p.scale.x*e+","+p.scale.y*f+")"))}};
THREE.CanvasRenderer=function(a){function b(a){w!=a&&(q.globalAlpha=w=a)}function c(a){if(z!=a){switch(a){case THREE.NormalBlending:q.globalCompositeOperation="source-over";break;case THREE.AdditiveBlending:q.globalCompositeOperation="lighter"}z=a}}function d(a){x!=a&&(q.strokeStyle=x=a)}function e(a){A!=a&&(q.fillStyle=A=a)}console.log("THREE.CanvasRenderer",THREE.REVISION);var a=a||{},f=this,g,h,i,j=new THREE.Projector,k=void 0!==a.canvas?a.canvas:document.createElement("canvas"),l,p,m,r,q=k.getContext("2d"),
t=new THREE.Color(0),v=0,w=1,z=0,x=null,A=null,F=null,C=null,D=null,y,s,E,u,J=new THREE.RenderableVertex,N=new THREE.RenderableVertex,B,M,I,o,Q,P,H,T,L,W,ea,da,aa=new THREE.Color,ba=new THREE.Color,Z=new THREE.Color,ca=new THREE.Color,n=new THREE.Color,Ga=[],pa=[],Fa,Na,Ua,Oa,Kb,vb,nb,Lb,yb,Vb,Sa=new THREE.Rectangle,sa=new THREE.Rectangle,Aa=new THREE.Rectangle,$a=!1,ja=new THREE.Color,Ra=new THREE.Color,Pa=new THREE.Color,qa=new THREE.Vector3,jb,cb,la,Ya,zb,Pb,a=16;jb=document.createElement("canvas");
jb.width=jb.height=2;cb=jb.getContext("2d");cb.fillStyle="rgba(0,0,0,1)";cb.fillRect(0,0,2,2);la=cb.getImageData(0,0,2,2);Ya=la.data;zb=document.createElement("canvas");zb.width=zb.height=a;Pb=zb.getContext("2d");Pb.translate(-a/2,-a/2);Pb.scale(a,a);a--;this.domElement=k;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.setSize=function(a,b){l=a;p=b;m=Math.floor(l/2);r=Math.floor(p/2);k.width=l;k.height=p;Sa.set(-m,-r,m,r);sa.set(-m,-r,m,r);w=1;z=0;
D=C=F=A=x=null};this.setClearColor=function(a,b){t.copy(a);v=void 0!==b?b:1;sa.set(-m,-r,m,r)};this.setClearColorHex=function(a,b){t.setHex(a);v=void 0!==b?b:1;sa.set(-m,-r,m,r)};this.clear=function(){q.setTransform(1,0,0,-1,m,r);sa.isEmpty()||(sa.minSelf(Sa),sa.inflate(2),1>v&&q.clearRect(Math.floor(sa.getX()),Math.floor(sa.getY()),Math.floor(sa.getWidth()),Math.floor(sa.getHeight())),0<v&&(c(THREE.NormalBlending),b(1),e("rgba("+Math.floor(255*t.r)+","+Math.floor(255*t.g)+","+Math.floor(255*t.b)+
","+v+")"),q.fillRect(Math.floor(sa.getX()),Math.floor(sa.getY()),Math.floor(sa.getWidth()),Math.floor(sa.getHeight()))),sa.empty())};this.render=function(a,k){function l(a){var b,c,d,e;ja.setRGB(0,0,0);Ra.setRGB(0,0,0);Pa.setRGB(0,0,0);b=0;for(c=a.length;b<c;b++)d=a[b],e=d.color,d instanceof THREE.AmbientLight?(ja.r+=e.r,ja.g+=e.g,ja.b+=e.b):d instanceof THREE.DirectionalLight?(Ra.r+=e.r,Ra.g+=e.g,Ra.b+=e.b):d instanceof THREE.PointLight&&(Pa.r+=e.r,Pa.g+=e.g,Pa.b+=e.b)}function p(a,b,c,d){var e,
f,g,h,i,j;e=0;for(f=a.length;e<f;e++)g=a[e],h=g.color,g instanceof THREE.DirectionalLight?(i=g.matrixWorld.getPosition(),j=c.dot(i),0>=j||(j*=g.intensity,d.r+=h.r*j,d.g+=h.g*j,d.b+=h.b*j)):g instanceof THREE.PointLight&&(i=g.matrixWorld.getPosition(),j=c.dot(qa.sub(i,b).normalize()),0>=j||(j*=0==g.distance?1:1-Math.min(b.distanceTo(i)/g.distance,1),0!=j&&(j*=g.intensity,d.r+=h.r*j,d.g+=h.g*j,d.b+=h.b*j)))}function t(a,f,g){b(g.opacity);c(g.blending);var h,j,i,k,s,l;g instanceof THREE.ParticleBasicMaterial?
g.map&&(k=g.map.image,s=k.width>>1,l=k.height>>1,g=f.scale.x*m,i=f.scale.y*r,h=g*s,j=i*l,Aa.set(a.x-h,a.y-j,a.x+h,a.y+j),Sa.intersects(Aa)&&(q.save(),q.translate(a.x,a.y),q.rotate(-f.rotation),q.scale(g,-i),q.translate(-s,-l),q.drawImage(k,0,0),q.restore())):g instanceof THREE.ParticleCanvasMaterial&&(h=f.scale.x*m,j=f.scale.y*r,Aa.set(a.x-h,a.y-j,a.x+h,a.y+j),Sa.intersects(Aa)&&(d(g.color.getContextStyle()),e(g.color.getContextStyle()),q.save(),q.translate(a.x,a.y),q.rotate(-f.rotation),q.scale(h,
j),g.program(q),q.restore()))}function v(a,e,f,g){b(g.opacity);c(g.blending);q.beginPath();q.moveTo(a.positionScreen.x,a.positionScreen.y);q.lineTo(e.positionScreen.x,e.positionScreen.y);q.closePath();g instanceof THREE.LineBasicMaterial&&(a=g.linewidth,F!=a&&(q.lineWidth=F=a),a=g.linecap,C!=a&&(q.lineCap=C=a),a=g.linejoin,D!=a&&(q.lineJoin=D=a),d(g.color.getContextStyle()),q.stroke(),Aa.inflate(2*g.linewidth))}function x(a,d,e,g,h,j,s,l){f.info.render.vertices+=3;f.info.render.faces++;b(l.opacity);
c(l.blending);B=a.positionScreen.x;M=a.positionScreen.y;I=d.positionScreen.x;o=d.positionScreen.y;Q=e.positionScreen.x;P=e.positionScreen.y;z(B,M,I,o,Q,P);l instanceof THREE.MeshBasicMaterial?l.map?l.map.mapping instanceof THREE.UVMapping&&(Oa=s.uvs[0],Oc(B,M,I,o,Q,P,Oa[g].u,Oa[g].v,Oa[h].u,Oa[h].v,Oa[j].u,Oa[j].v,l.map)):l.envMap?l.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(a=k.matrixWorldInverse,qa.copy(s.vertexNormalsWorld[g]),Kb=0.5*(qa.x*a.elements[0]+qa.y*a.elements[4]+qa.z*
a.elements[8])+0.5,vb=0.5*-(qa.x*a.elements[1]+qa.y*a.elements[5]+qa.z*a.elements[9])+0.5,qa.copy(s.vertexNormalsWorld[h]),nb=0.5*(qa.x*a.elements[0]+qa.y*a.elements[4]+qa.z*a.elements[8])+0.5,Lb=0.5*-(qa.x*a.elements[1]+qa.y*a.elements[5]+qa.z*a.elements[9])+0.5,qa.copy(s.vertexNormalsWorld[j]),yb=0.5*(qa.x*a.elements[0]+qa.y*a.elements[4]+qa.z*a.elements[8])+0.5,Vb=0.5*-(qa.x*a.elements[1]+qa.y*a.elements[5]+qa.z*a.elements[9])+0.5,Oc(B,M,I,o,Q,P,Kb,vb,nb,Lb,yb,Vb,l.envMap)):l.wireframe?Sb(l.color,
l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):xb(l.color):l instanceof THREE.MeshLambertMaterial?$a?!l.wireframe&&l.shading==THREE.SmoothShading&&3==s.vertexNormalsWorld.length?(ba.r=Z.r=ca.r=ja.r,ba.g=Z.g=ca.g=ja.g,ba.b=Z.b=ca.b=ja.b,p(i,s.v1.positionWorld,s.vertexNormalsWorld[0],ba),p(i,s.v2.positionWorld,s.vertexNormalsWorld[1],Z),p(i,s.v3.positionWorld,s.vertexNormalsWorld[2],ca),ba.r=Math.max(0,Math.min(l.color.r*ba.r,1)),ba.g=Math.max(0,Math.min(l.color.g*ba.g,1)),ba.b=Math.max(0,
Math.min(l.color.b*ba.b,1)),Z.r=Math.max(0,Math.min(l.color.r*Z.r,1)),Z.g=Math.max(0,Math.min(l.color.g*Z.g,1)),Z.b=Math.max(0,Math.min(l.color.b*Z.b,1)),ca.r=Math.max(0,Math.min(l.color.r*ca.r,1)),ca.g=Math.max(0,Math.min(l.color.g*ca.g,1)),ca.b=Math.max(0,Math.min(l.color.b*ca.b,1)),n.r=0.5*(Z.r+ca.r),n.g=0.5*(Z.g+ca.g),n.b=0.5*(Z.b+ca.b),Ua=pc(ba,Z,ca,n),ic(B,M,I,o,Q,P,0,0,1,0,0,1,Ua)):(aa.r=ja.r,aa.g=ja.g,aa.b=ja.b,p(i,s.centroidWorld,s.normalWorld,aa),aa.r=Math.max(0,Math.min(l.color.r*aa.r,
1)),aa.g=Math.max(0,Math.min(l.color.g*aa.g,1)),aa.b=Math.max(0,Math.min(l.color.b*aa.b,1)),l.wireframe?Sb(aa,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):xb(aa)):l.wireframe?Sb(l.color,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):xb(l.color):l instanceof THREE.MeshDepthMaterial?(Fa=k.near,Na=k.far,ba.r=ba.g=ba.b=1-Zb(a.positionScreen.z,Fa,Na),Z.r=Z.g=Z.b=1-Zb(d.positionScreen.z,Fa,Na),ca.r=ca.g=ca.b=1-Zb(e.positionScreen.z,Fa,Na),n.r=0.5*(Z.r+ca.r),n.g=0.5*(Z.g+ca.g),
n.b=0.5*(Z.b+ca.b),Ua=pc(ba,Z,ca,n),ic(B,M,I,o,Q,P,0,0,1,0,0,1,Ua)):l instanceof THREE.MeshNormalMaterial&&(aa.r=Tb(s.normalWorld.x),aa.g=Tb(s.normalWorld.y),aa.b=Tb(s.normalWorld.z),l.wireframe?Sb(aa,l.wireframeLinewidth,l.wireframeLinecap,l.wireframeLinejoin):xb(aa))}function w(a,d,e,g,h,j,l,s,u){f.info.render.vertices+=4;f.info.render.faces++;b(s.opacity);c(s.blending);s.map||s.envMap?(x(a,d,g,0,1,3,l,s,u),x(h,e,j,1,2,3,l,s,u)):(B=a.positionScreen.x,M=a.positionScreen.y,I=d.positionScreen.x,o=
d.positionScreen.y,Q=e.positionScreen.x,P=e.positionScreen.y,H=g.positionScreen.x,T=g.positionScreen.y,L=h.positionScreen.x,W=h.positionScreen.y,ea=j.positionScreen.x,da=j.positionScreen.y,s instanceof THREE.MeshBasicMaterial?(A(B,M,I,o,Q,P,H,T),s.wireframe?Sb(s.color,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):xb(s.color)):s instanceof THREE.MeshLambertMaterial?$a?!s.wireframe&&s.shading==THREE.SmoothShading&&4==l.vertexNormalsWorld.length?(ba.r=Z.r=ca.r=n.r=ja.r,ba.g=Z.g=ca.g=n.g=
ja.g,ba.b=Z.b=ca.b=n.b=ja.b,p(i,l.v1.positionWorld,l.vertexNormalsWorld[0],ba),p(i,l.v2.positionWorld,l.vertexNormalsWorld[1],Z),p(i,l.v4.positionWorld,l.vertexNormalsWorld[3],ca),p(i,l.v3.positionWorld,l.vertexNormalsWorld[2],n),ba.r=Math.max(0,Math.min(s.color.r*ba.r,1)),ba.g=Math.max(0,Math.min(s.color.g*ba.g,1)),ba.b=Math.max(0,Math.min(s.color.b*ba.b,1)),Z.r=Math.max(0,Math.min(s.color.r*Z.r,1)),Z.g=Math.max(0,Math.min(s.color.g*Z.g,1)),Z.b=Math.max(0,Math.min(s.color.b*Z.b,1)),ca.r=Math.max(0,
Math.min(s.color.r*ca.r,1)),ca.g=Math.max(0,Math.min(s.color.g*ca.g,1)),ca.b=Math.max(0,Math.min(s.color.b*ca.b,1)),n.r=Math.max(0,Math.min(s.color.r*n.r,1)),n.g=Math.max(0,Math.min(s.color.g*n.g,1)),n.b=Math.max(0,Math.min(s.color.b*n.b,1)),Ua=pc(ba,Z,ca,n),z(B,M,I,o,H,T),ic(B,M,I,o,H,T,0,0,1,0,0,1,Ua),z(L,W,Q,P,ea,da),ic(L,W,Q,P,ea,da,1,0,1,1,0,1,Ua)):(aa.r=ja.r,aa.g=ja.g,aa.b=ja.b,p(i,l.centroidWorld,l.normalWorld,aa),aa.r=Math.max(0,Math.min(s.color.r*aa.r,1)),aa.g=Math.max(0,Math.min(s.color.g*
aa.g,1)),aa.b=Math.max(0,Math.min(s.color.b*aa.b,1)),A(B,M,I,o,Q,P,H,T),s.wireframe?Sb(aa,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):xb(aa)):(A(B,M,I,o,Q,P,H,T),s.wireframe?Sb(s.color,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):xb(s.color)):s instanceof THREE.MeshNormalMaterial?(aa.r=Tb(l.normalWorld.x),aa.g=Tb(l.normalWorld.y),aa.b=Tb(l.normalWorld.z),A(B,M,I,o,Q,P,H,T),s.wireframe?Sb(aa,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):xb(aa)):s instanceof
THREE.MeshDepthMaterial&&(Fa=k.near,Na=k.far,ba.r=ba.g=ba.b=1-Zb(a.positionScreen.z,Fa,Na),Z.r=Z.g=Z.b=1-Zb(d.positionScreen.z,Fa,Na),ca.r=ca.g=ca.b=1-Zb(g.positionScreen.z,Fa,Na),n.r=n.g=n.b=1-Zb(e.positionScreen.z,Fa,Na),Ua=pc(ba,Z,ca,n),z(B,M,I,o,H,T),ic(B,M,I,o,H,T,0,0,1,0,0,1,Ua),z(L,W,Q,P,ea,da),ic(L,W,Q,P,ea,da,1,0,1,1,0,1,Ua)))}function z(a,b,c,d,e,f){q.beginPath();q.moveTo(a,b);q.lineTo(c,d);q.lineTo(e,f);q.lineTo(a,b);q.closePath()}function A(a,b,c,d,e,f,g,h){q.beginPath();q.moveTo(a,b);
q.lineTo(c,d);q.lineTo(e,f);q.lineTo(g,h);q.lineTo(a,b);q.closePath()}function Sb(a,b,c,e){F!=b&&(q.lineWidth=F=b);C!=c&&(q.lineCap=C=c);D!=e&&(q.lineJoin=D=e);d(a.getContextStyle());q.stroke();Aa.inflate(2*b)}function xb(a){e(a.getContextStyle());q.fill()}function Oc(a,b,c,d,f,g,h,j,i,k,s,l,u){if(0!=u.image.width){if(!0==u.needsUpdate||void 0==Ga[u.id]){var o=u.wrapS==THREE.RepeatWrapping,p=u.wrapT==THREE.RepeatWrapping;Ga[u.id]=q.createPattern(u.image,o&&p?"repeat":o&&!p?"repeat-x":!o&&p?"repeat-y":
"no-repeat");u.needsUpdate=!1}e(Ga[u.id]);var o=u.offset.x/u.repeat.x,p=u.offset.y/u.repeat.y,n=u.image.width*u.repeat.x,m=u.image.height*u.repeat.y,h=(h+o)*n,j=(j+p)*m,c=c-a,d=d-b,f=f-a,g=g-b,i=(i+o)*n-h,k=(k+p)*m-j,s=(s+o)*n-h,l=(l+p)*m-j,o=i*l-s*k;0==o?(void 0===pa[u.id]&&(b=document.createElement("canvas"),b.width=u.image.width,b.height=u.image.height,b=b.getContext("2d"),b.drawImage(u.image,0,0),pa[u.id]=b.getImageData(0,0,u.image.width,u.image.height).data),b=pa[u.id],h=4*(Math.floor(h)+Math.floor(j)*
u.image.width),aa.setRGB(b[h]/255,b[h+1]/255,b[h+2]/255),xb(aa)):(o=1/o,u=(l*c-k*f)*o,k=(l*d-k*g)*o,c=(i*f-s*c)*o,d=(i*g-s*d)*o,a=a-u*h-c*j,h=b-k*h-d*j,q.save(),q.transform(u,k,c,d,a,h),q.fill(),q.restore())}}function ic(a,b,c,d,e,f,g,h,j,i,k,s,l){var u,o;u=l.width-1;o=l.height-1;g*=u;h*=o;c-=a;d-=b;e-=a;f-=b;j=j*u-g;i=i*o-h;k=k*u-g;s=s*o-h;o=1/(j*s-k*i);u=(s*c-i*e)*o;i=(s*d-i*f)*o;c=(j*e-k*c)*o;d=(j*f-k*d)*o;a=a-u*g-c*h;b=b-i*g-d*h;q.save();q.transform(u,i,c,d,a,b);q.clip();q.drawImage(l,0,0);q.restore()}
function pc(a,b,c,d){var e=~~(255*a.r),f=~~(255*a.g),a=~~(255*a.b),g=~~(255*b.r),h=~~(255*b.g),b=~~(255*b.b),j=~~(255*c.r),i=~~(255*c.g),c=~~(255*c.b),k=~~(255*d.r),s=~~(255*d.g),d=~~(255*d.b);Ya[0]=0>e?0:255<e?255:e;Ya[1]=0>f?0:255<f?255:f;Ya[2]=0>a?0:255<a?255:a;Ya[4]=0>g?0:255<g?255:g;Ya[5]=0>h?0:255<h?255:h;Ya[6]=0>b?0:255<b?255:b;Ya[8]=0>j?0:255<j?255:j;Ya[9]=0>i?0:255<i?255:i;Ya[10]=0>c?0:255<c?255:c;Ya[12]=0>k?0:255<k?255:k;Ya[13]=0>s?0:255<s?255:s;Ya[14]=0>d?0:255<d?255:d;cb.putImageData(la,
0,0);Pb.drawImage(jb,0,0);return zb}function Zb(a,b,c){a=(a-b)/(c-b);return a*a*(3-2*a)}function Tb(a){a=0.5*(a+1);return 0>a?0:1<a?1:a}function Ab(a,b){var c=b.x-a.x,d=b.y-a.y,e=c*c+d*d;0!=e&&(e=1/Math.sqrt(e),c*=e,d*=e,b.x+=c,b.y+=d,a.x-=c,a.y-=d)}var tc,Yc,Ja,kb;this.autoClear?this.clear():q.setTransform(1,0,0,-1,m,r);f.info.render.vertices=0;f.info.render.faces=0;g=j.projectScene(a,k,this.sortElements);h=g.elements;i=g.lights;($a=0<i.length)&&l(i);tc=0;for(Yc=h.length;tc<Yc;tc++)Ja=h[tc],kb=Ja.material,
kb=kb instanceof THREE.MeshFaceMaterial?Ja.faceMaterial:kb,void 0===kb||!1===kb.visible||(Aa.empty(),Ja instanceof THREE.RenderableParticle?(y=Ja,y.x*=m,y.y*=r,t(y,Ja,kb,a)):Ja instanceof THREE.RenderableLine?(y=Ja.v1,s=Ja.v2,y.positionScreen.x*=m,y.positionScreen.y*=r,s.positionScreen.x*=m,s.positionScreen.y*=r,Aa.addPoint(y.positionScreen.x,y.positionScreen.y),Aa.addPoint(s.positionScreen.x,s.positionScreen.y),Sa.intersects(Aa)&&v(y,s,Ja,kb,a)):Ja instanceof THREE.RenderableFace3?(y=Ja.v1,s=Ja.v2,
E=Ja.v3,y.positionScreen.x*=m,y.positionScreen.y*=r,s.positionScreen.x*=m,s.positionScreen.y*=r,E.positionScreen.x*=m,E.positionScreen.y*=r,kb.overdraw&&(Ab(y.positionScreen,s.positionScreen),Ab(s.positionScreen,E.positionScreen),Ab(E.positionScreen,y.positionScreen)),Aa.add3Points(y.positionScreen.x,y.positionScreen.y,s.positionScreen.x,s.positionScreen.y,E.positionScreen.x,E.positionScreen.y),Sa.intersects(Aa)&&x(y,s,E,0,1,2,Ja,kb,a)):Ja instanceof THREE.RenderableFace4&&(y=Ja.v1,s=Ja.v2,E=Ja.v3,
u=Ja.v4,y.positionScreen.x*=m,y.positionScreen.y*=r,s.positionScreen.x*=m,s.positionScreen.y*=r,E.positionScreen.x*=m,E.positionScreen.y*=r,u.positionScreen.x*=m,u.positionScreen.y*=r,J.positionScreen.copy(s.positionScreen),N.positionScreen.copy(u.positionScreen),kb.overdraw&&(Ab(y.positionScreen,s.positionScreen),Ab(s.positionScreen,u.positionScreen),Ab(u.positionScreen,y.positionScreen),Ab(E.positionScreen,J.positionScreen),Ab(E.positionScreen,N.positionScreen)),Aa.addPoint(y.positionScreen.x,y.positionScreen.y),
Aa.addPoint(s.positionScreen.x,s.positionScreen.y),Aa.addPoint(E.positionScreen.x,E.positionScreen.y),Aa.addPoint(u.positionScreen.x,u.positionScreen.y),Sa.intersects(Aa)&&w(y,s,E,u,J,N,Ja,kb,a)),sa.addRectangle(Aa));q.setTransform(1,0,0,1,0,0)}};
THREE.SVGRenderer=function(){function a(a,b,c,d){var e,f,g,h,j,i;e=0;for(f=a.length;e<f;e++)g=a[e],h=g.color,g instanceof THREE.DirectionalLight?(j=g.matrixWorld.getPosition(),i=c.dot(j),0>=i||(i*=g.intensity,d.r+=h.r*i,d.g+=h.g*i,d.b+=h.b*i)):g instanceof THREE.PointLight&&(j=g.matrixWorld.getPosition(),i=c.dot(y.sub(j,b).normalize()),0>=i||(i*=0==g.distance?1:1-Math.min(b.distanceTo(j)/g.distance,1),0!=i&&(i*=g.intensity,d.r+=h.r*i,d.g+=h.g*i,d.b+=h.b*i)))}function b(a){null==s[a]&&(s[a]=document.createElementNS("http://www.w3.org/2000/svg",
"path"),0==B&&s[a].setAttribute("shape-rendering","crispEdges"));return s[a]}function c(a){a=0.5*(a+1);return 0>a?0:1<a?1:a}console.log("THREE.SVGRenderer",THREE.REVISION);var d=this,e,f,g,h=new THREE.Projector,i=document.createElementNS("http://www.w3.org/2000/svg","svg"),j,k,l,p,m,r,q,t,v=new THREE.Rectangle,w=new THREE.Rectangle,z=!1,x=new THREE.Color,A=new THREE.Color,F=new THREE.Color,C=new THREE.Color,D,y=new THREE.Vector3,s=[],E=[],u,J,N,B=1;this.domElement=i;this.sortElements=this.sortObjects=
this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.setQuality=function(a){switch(a){case "high":B=1;break;case "low":B=0}};this.setSize=function(a,b){j=a;k=b;l=j/2;p=k/2;i.setAttribute("viewBox",-l+" "+-p+" "+j+" "+k);i.setAttribute("width",j);i.setAttribute("height",k);v.set(-l,-p,l,p)};this.clear=function(){for(;0<i.childNodes.length;)i.removeChild(i.childNodes[0])};this.render=function(j,k){var s,Q,y,H;this.autoClear&&this.clear();d.info.render.vertices=0;d.info.render.faces=0;e=h.projectScene(j,
k,this.sortElements);f=e.elements;g=e.lights;N=J=0;if(z=0<g.length){A.setRGB(0,0,0);F.setRGB(0,0,0);C.setRGB(0,0,0);s=0;for(Q=g.length;s<Q;s++)H=g[s],y=H.color,H instanceof THREE.AmbientLight?(A.r+=y.r,A.g+=y.g,A.b+=y.b):H instanceof THREE.DirectionalLight?(F.r+=y.r,F.g+=y.g,F.b+=y.b):H instanceof THREE.PointLight&&(C.r+=y.r,C.g+=y.g,C.b+=y.b)}s=0;for(Q=f.length;s<Q;s++)if(y=f[s],H=y.material,H=H instanceof THREE.MeshFaceMaterial?y.faceMaterial:H,!(void 0===H||!1===H.visible))if(w.empty(),y instanceof
THREE.RenderableParticle)m=y,m.x*=l,m.y*=-p;else if(y instanceof THREE.RenderableLine){if(m=y.v1,r=y.v2,m.positionScreen.x*=l,m.positionScreen.y*=-p,r.positionScreen.x*=l,r.positionScreen.y*=-p,w.addPoint(m.positionScreen.x,m.positionScreen.y),w.addPoint(r.positionScreen.x,r.positionScreen.y),v.intersects(w)){y=m;var T=r,L=N++;null==E[L]&&(E[L]=document.createElementNS("http://www.w3.org/2000/svg","line"),0==B&&E[L].setAttribute("shape-rendering","crispEdges"));u=E[L];u.setAttribute("x1",y.positionScreen.x);
u.setAttribute("y1",y.positionScreen.y);u.setAttribute("x2",T.positionScreen.x);u.setAttribute("y2",T.positionScreen.y);H instanceof THREE.LineBasicMaterial&&(u.setAttribute("style","fill: none; stroke: "+H.color.getContextStyle()+"; stroke-width: "+H.linewidth+"; stroke-opacity: "+H.opacity+"; stroke-linecap: "+H.linecap+"; stroke-linejoin: "+H.linejoin),i.appendChild(u))}}else if(y instanceof THREE.RenderableFace3){if(m=y.v1,r=y.v2,q=y.v3,m.positionScreen.x*=l,m.positionScreen.y*=-p,r.positionScreen.x*=
l,r.positionScreen.y*=-p,q.positionScreen.x*=l,q.positionScreen.y*=-p,w.addPoint(m.positionScreen.x,m.positionScreen.y),w.addPoint(r.positionScreen.x,r.positionScreen.y),w.addPoint(q.positionScreen.x,q.positionScreen.y),v.intersects(w)){var T=m,L=r,W=q;d.info.render.vertices+=3;d.info.render.faces++;u=b(J++);u.setAttribute("d","M "+T.positionScreen.x+" "+T.positionScreen.y+" L "+L.positionScreen.x+" "+L.positionScreen.y+" L "+W.positionScreen.x+","+W.positionScreen.y+"z");H instanceof THREE.MeshBasicMaterial?
x.copy(H.color):H instanceof THREE.MeshLambertMaterial?z?(x.r=A.r,x.g=A.g,x.b=A.b,a(g,y.centroidWorld,y.normalWorld,x),x.r=Math.max(0,Math.min(H.color.r*x.r,1)),x.g=Math.max(0,Math.min(H.color.g*x.g,1)),x.b=Math.max(0,Math.min(H.color.b*x.b,1))):x.copy(H.color):H instanceof THREE.MeshDepthMaterial?(D=1-H.__2near/(H.__farPlusNear-y.z*H.__farMinusNear),x.setRGB(D,D,D)):H instanceof THREE.MeshNormalMaterial&&x.setRGB(c(y.normalWorld.x),c(y.normalWorld.y),c(y.normalWorld.z));H.wireframe?u.setAttribute("style",
"fill: none; stroke: "+x.getContextStyle()+"; stroke-width: "+H.wireframeLinewidth+"; stroke-opacity: "+H.opacity+"; stroke-linecap: "+H.wireframeLinecap+"; stroke-linejoin: "+H.wireframeLinejoin):u.setAttribute("style","fill: "+x.getContextStyle()+"; fill-opacity: "+H.opacity);i.appendChild(u)}}else if(y instanceof THREE.RenderableFace4&&(m=y.v1,r=y.v2,q=y.v3,t=y.v4,m.positionScreen.x*=l,m.positionScreen.y*=-p,r.positionScreen.x*=l,r.positionScreen.y*=-p,q.positionScreen.x*=l,q.positionScreen.y*=
-p,t.positionScreen.x*=l,t.positionScreen.y*=-p,w.addPoint(m.positionScreen.x,m.positionScreen.y),w.addPoint(r.positionScreen.x,r.positionScreen.y),w.addPoint(q.positionScreen.x,q.positionScreen.y),w.addPoint(t.positionScreen.x,t.positionScreen.y),v.intersects(w))){var T=m,L=r,W=q,ea=t;d.info.render.vertices+=4;d.info.render.faces++;u=b(J++);u.setAttribute("d","M "+T.positionScreen.x+" "+T.positionScreen.y+" L "+L.positionScreen.x+" "+L.positionScreen.y+" L "+W.positionScreen.x+","+W.positionScreen.y+
" L "+ea.positionScreen.x+","+ea.positionScreen.y+"z");H instanceof THREE.MeshBasicMaterial?x.copy(H.color):H instanceof THREE.MeshLambertMaterial?z?(x.r=A.r,x.g=A.g,x.b=A.b,a(g,y.centroidWorld,y.normalWorld,x),x.r=Math.max(0,Math.min(H.color.r*x.r,1)),x.g=Math.max(0,Math.min(H.color.g*x.g,1)),x.b=Math.max(0,Math.min(H.color.b*x.b,1))):x.copy(H.color):H instanceof THREE.MeshDepthMaterial?(D=1-H.__2near/(H.__farPlusNear-y.z*H.__farMinusNear),x.setRGB(D,D,D)):H instanceof THREE.MeshNormalMaterial&&
x.setRGB(c(y.normalWorld.x),c(y.normalWorld.y),c(y.normalWorld.z));H.wireframe?u.setAttribute("style","fill: none; stroke: "+x.getContextStyle()+"; stroke-width: "+H.wireframeLinewidth+"; stroke-opacity: "+H.opacity+"; stroke-linecap: "+H.wireframeLinecap+"; stroke-linejoin: "+H.wireframeLinejoin):u.setAttribute("style","fill: "+x.getContextStyle()+"; fill-opacity: "+H.opacity);i.appendChild(u)}}};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
envmap_pars_fragment:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, reflectivity );\n} else {\ngl_FragColor.xyz = gl_FragColor.xyz * cubeColor.xyz;\n}\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nif ( useRefract ) {\nvReflect = refract( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ), refractionRatio );\n} else {\nvReflect = reflect( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ) );\n}\n#endif",
map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, gl_PointCoord );\n#endif",map_pars_vertex:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif",map_vertex:"#ifdef USE_MAP\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( map, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( map, vUv );\n#endif\n#endif",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - mPosition.xyz ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvWorldPosition = mPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n#endif",skinning_vertex:"#ifdef USE_SKINNING\ngl_Position  = ( boneGlobalMatrices[ int( skinIndex.x ) ] * skinVertexA ) * skinWeight.x;\ngl_Position += ( boneGlobalMatrices[ int( skinIndex.y ) ] * skinVertexB ) * skinWeight.y;\ngl_Position  = projectionMatrix * modelViewMatrix * gl_Position;\n#endif",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( morphed, 1.0 );\n#endif",
default_vertex:"#ifndef USE_MORPHTARGETS\n#ifndef USE_SKINNING\ngl_Position = projectionMatrix * mvPosition;\n#endif\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\nvec3 transformedNormal = normalMatrix * morphedNormal;\n#else\nvec3 transformedNormal = normalMatrix * normal;\n#endif",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#ifdef SHADOWMAP_SOFT\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n#ifdef USE_MORPHTARGETS\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( morphed, 1.0 );\n#else\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( position, 1.0 );\n#endif\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",
linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};
THREE.UniformsUtils={merge:function(a){var b,c,d,e={};for(b=0;b<a.length;b++)for(c in d=this.clone(a[b]),d)e[c]=d[c];return e},clone:function(a){var b,c,d,e={};for(b in a)for(c in e[b]={},a[b])d=a[b][c],e[b][c]=d instanceof THREE.Color||d instanceof THREE.Vector2||d instanceof THREE.Vector3||d instanceof THREE.Vector4||d instanceof THREE.Matrix4||d instanceof THREE.Texture?d.clone():d instanceof Array?d.slice():d;return e}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:0,texture:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:2,texture:null},envMap:{type:"t",value:1,texture:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},fog:{fogDensity:{type:"f",
value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",
value:[]},spotLightAngle:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:0,texture:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:6,texture:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",
value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",
value:1}},vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalMatrix * normal;\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,
THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,
THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,
THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,
1,1)}}]),vertexShader:["varying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,
THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif",THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",
THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},
shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",
THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif\nvViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.morphnormal_vertex,"vNormal = transformedNormal;",THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",
THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",
THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,
THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderer=function(a){function b(a,b){var c=a.vertices.length,d=b.material;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var e in d.attributes){var f=d.attributes[e];if(!f.__webglInitialized||f.createUniqueBuffers){f.__webglInitialized=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?g=4:"c"===f.type&&(g=3);f.size=g;f.array=new Float32Array(c*g);f.buffer=o.createBuffer();f.buffer.belongsToAttribute=e;f.needsUpdate=!0}a.__webglCustomAttributesList.push(f)}}}
function c(a,b){if(a.material&&!(a.material instanceof THREE.MeshFaceMaterial))return a.material;if(0<=b.materialIndex)return a.geometry.materials[b.materialIndex]}function d(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function e(a){return a.map||a.lightMap||a instanceof THREE.ShaderMaterial?!0:!1}function f(a,b,c){var d,e,f,g,h=a.vertices;g=h.length;
var j=a.colors,i=j.length,k=a.__vertexArray,s=a.__colorArray,l=a.__sortArray,u=a.verticesNeedUpdate,p=a.colorsNeedUpdate,n=a.__webglCustomAttributesList;if(c.sortParticles){Aa.copy(sa);Aa.multiplySelf(c.matrixWorld);for(d=0;d<g;d++)e=h[d],$a.copy(e),Aa.multiplyVector3($a),l[d]=[$a.z,d];l.sort(function(a,b){return b[0]-a[0]});for(d=0;d<g;d++)e=h[l[d][1]],f=3*d,k[f]=e.x,k[f+1]=e.y,k[f+2]=e.z;for(d=0;d<i;d++)f=3*d,e=j[l[d][1]],s[f]=e.r,s[f+1]=e.g,s[f+2]=e.b;if(n){j=0;for(i=n.length;j<i;j++)if(h=n[j],
void 0===h.boundTo||"vertices"===h.boundTo)if(f=0,e=h.value.length,1===h.size)for(d=0;d<e;d++)g=l[d][1],h.array[d]=h.value[g];else if(2===h.size)for(d=0;d<e;d++)g=l[d][1],g=h.value[g],h.array[f]=g.x,h.array[f+1]=g.y,f+=2;else if(3===h.size)if("c"===h.type)for(d=0;d<e;d++)g=l[d][1],g=h.value[g],h.array[f]=g.r,h.array[f+1]=g.g,h.array[f+2]=g.b,f+=3;else for(d=0;d<e;d++)g=l[d][1],g=h.value[g],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,f+=3;else if(4===h.size)for(d=0;d<e;d++)g=l[d][1],g=h.value[g],
h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,h.array[f+3]=g.w,f+=4}}else{if(u)for(d=0;d<g;d++)e=h[d],f=3*d,k[f]=e.x,k[f+1]=e.y,k[f+2]=e.z;if(p)for(d=0;d<i;d++)e=j[d],f=3*d,s[f]=e.r,s[f+1]=e.g,s[f+2]=e.b;if(n){j=0;for(i=n.length;j<i;j++)if(h=n[j],h.needsUpdate&&(void 0===h.boundTo||"vertices"===h.boundTo))if(e=h.value.length,f=0,1===h.size)for(d=0;d<e;d++)h.array[d]=h.value[d];else if(2===h.size)for(d=0;d<e;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,f+=2;else if(3===h.size)if("c"===h.type)for(d=
0;d<e;d++)g=h.value[d],h.array[f]=g.r,h.array[f+1]=g.g,h.array[f+2]=g.b,f+=3;else for(d=0;d<e;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,f+=3;else if(4===h.size)for(d=0;d<e;d++)g=h.value[d],h.array[f]=g.x,h.array[f+1]=g.y,h.array[f+2]=g.z,h.array[f+3]=g.w,f+=4}}if(u||c.sortParticles)o.bindBuffer(o.ARRAY_BUFFER,a.__webglVertexBuffer),o.bufferData(o.ARRAY_BUFFER,k,b);if(p||c.sortParticles)o.bindBuffer(o.ARRAY_BUFFER,a.__webglColorBuffer),o.bufferData(o.ARRAY_BUFFER,s,b);if(n){j=
0;for(i=n.length;j<i;j++)if(h=n[j],h.needsUpdate||c.sortParticles)o.bindBuffer(o.ARRAY_BUFFER,h.buffer),o.bufferData(o.ARRAY_BUFFER,h.array,b)}}function g(a,b){return b.z-a.z}function h(a,b,c){if(a.length)for(var d=0,e=a.length;d<e;d++)W=P=null,T=L=aa=da=pa=Ga=ba=-1,Ra=!0,a[d].render(b,c,yb,Vb),W=P=null,T=L=aa=da=pa=Ga=ba=-1,Ra=!0}function i(a,b,c,d,e,f,g,h){var j,i,k,s;b?(i=a.length-1,s=b=-1):(i=0,b=a.length,s=1);for(var l=i;l!==b;l+=s)if(j=a[l],j.render){i=j.object;k=j.buffer;if(h)j=h;else{j=j[c];
if(!j)continue;g&&I.setBlending(j.blending,j.blendEquation,j.blendSrc,j.blendDst);I.setDepthTest(j.depthTest);I.setDepthWrite(j.depthWrite);v(j.polygonOffset,j.polygonOffsetFactor,j.polygonOffsetUnits)}I.setObjectFaces(i);k instanceof THREE.BufferGeometry?I.renderBufferDirect(d,e,f,j,k,i):I.renderBuffer(d,e,f,j,k,i)}}function j(a,b,c,d,e,f,g){for(var h,j,i=0,k=a.length;i<k;i++)if(h=a[i],j=h.object,j.visible){if(g)h=g;else{h=h[b];if(!h)continue;f&&I.setBlending(h.blending,h.blendEquation,h.blendSrc,
h.blendDst);I.setDepthTest(h.depthTest);I.setDepthWrite(h.depthWrite);v(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}I.renderImmediateObject(c,d,e,h,j)}}function k(a,b,c){a.push({buffer:b,object:c,opaque:null,transparent:null})}function l(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function p(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function m(a,b){for(var c=a.length-1;0<=c;c--)a[c].object===b&&a.splice(c,1)}function r(a,b){for(var c=
a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)}function q(a,b,c,d,e){if(!d.program||d.needsUpdate)I.initMaterial(d,b,c,e),d.needsUpdate=!1;if(d.morphTargets&&!e.__webglMorphTargetInfluences){e.__webglMorphTargetInfluences=new Float32Array(I.maxMorphTargets);for(var f=0,g=I.maxMorphTargets;f<g;f++)e.__webglMorphTargetInfluences[f]=0}var h=!1,f=d.program,g=f.uniforms,j=d.uniforms;f!==P&&(o.useProgram(f),P=f,h=!0);d.id!==T&&(T=d.id,h=!0);if(h||a!==W)o.uniformMatrix4fv(g.projectionMatrix,!1,a._projectionMatrixArray),
a!==W&&(W=a);if(h){c&&d.fog&&(j.fogColor.value=c.color,c instanceof THREE.Fog?(j.fogNear.value=c.near,j.fogFar.value=c.far):c instanceof THREE.FogExp2&&(j.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Ra){for(var i,k=0,s=0,l=0,u,p,n,m=Pa,E=m.directional.colors,q=m.directional.positions,r=m.point.colors,B=m.point.positions,t=m.point.distances,J=m.spot.colors,Q=m.spot.positions,L=m.spot.distances,N=m.spot.directions,v=m.spot.angles,
y=m.spot.exponents,x=0,M=0,w=0,H=0,c=0,h=b.length;c<h;c++)i=b[c],i.onlyShadow||(u=i.color,p=i.intensity,n=i.distance,i instanceof THREE.AmbientLight?I.gammaInput?(k+=u.r*u.r,s+=u.g*u.g,l+=u.b*u.b):(k+=u.r,s+=u.g,l+=u.b):i instanceof THREE.DirectionalLight?(n=3*x,I.gammaInput?(E[n]=u.r*u.r*p*p,E[n+1]=u.g*u.g*p*p,E[n+2]=u.b*u.b*p*p):(E[n]=u.r*p,E[n+1]=u.g*p,E[n+2]=u.b*p),ja.copy(i.matrixWorld.getPosition()),ja.subSelf(i.target.matrixWorld.getPosition()),ja.normalize(),q[n]=ja.x,q[n+1]=ja.y,q[n+2]=ja.z,
x+=1):i instanceof THREE.PointLight?(H=3*M,I.gammaInput?(r[H]=u.r*u.r*p*p,r[H+1]=u.g*u.g*p*p,r[H+2]=u.b*u.b*p*p):(r[H]=u.r*p,r[H+1]=u.g*p,r[H+2]=u.b*p),u=i.matrixWorld.getPosition(),B[H]=u.x,B[H+1]=u.y,B[H+2]=u.z,t[M]=n,M+=1):i instanceof THREE.SpotLight&&(H=3*w,I.gammaInput?(J[H]=u.r*u.r*p*p,J[H+1]=u.g*u.g*p*p,J[H+2]=u.b*u.b*p*p):(J[H]=u.r*p,J[H+1]=u.g*p,J[H+2]=u.b*p),u=i.matrixWorld.getPosition(),Q[H]=u.x,Q[H+1]=u.y,Q[H+2]=u.z,L[w]=n,ja.copy(u),ja.subSelf(i.target.matrixWorld.getPosition()),ja.normalize(),
N[H]=ja.x,N[H+1]=ja.y,N[H+2]=ja.z,v[w]=Math.cos(i.angle),y[w]=i.exponent,w+=1));c=3*x;for(h=E.length;c<h;c++)E[c]=0;c=3*M;for(h=r.length;c<h;c++)r[c]=0;c=3*w;for(h=J.length;c<h;c++)J[c]=0;m.directional.length=x;m.point.length=M;m.spot.length=w;m.ambient[0]=k;m.ambient[1]=s;m.ambient[2]=l;Ra=!1}c=Pa;j.ambientLightColor.value=c.ambient;j.directionalLightColor.value=c.directional.colors;j.directionalLightDirection.value=c.directional.positions;j.pointLightColor.value=c.point.colors;j.pointLightPosition.value=
c.point.positions;j.pointLightDistance.value=c.point.distances;j.spotLightColor.value=c.spot.colors;j.spotLightPosition.value=c.spot.positions;j.spotLightDistance.value=c.spot.distances;j.spotLightDirection.value=c.spot.directions;j.spotLightAngle.value=c.spot.angles;j.spotLightExponent.value=c.spot.exponents}if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial)j.opacity.value=d.opacity,I.gammaInput?j.diffuse.value.copyGammaToLinear(d.color):
j.diffuse.value=d.color,(j.map.texture=d.map)&&j.offsetRepeat.value.set(d.map.offset.x,d.map.offset.y,d.map.repeat.x,d.map.repeat.y),j.lightMap.texture=d.lightMap,j.envMap.texture=d.envMap,j.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,j.reflectivity.value=d.reflectivity,j.refractionRatio.value=d.refractionRatio,j.combine.value=d.combine,j.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping;d instanceof THREE.LineBasicMaterial?(j.diffuse.value=
d.color,j.opacity.value=d.opacity):d instanceof THREE.ParticleBasicMaterial?(j.psColor.value=d.color,j.opacity.value=d.opacity,j.size.value=d.size,j.scale.value=C.height/2,j.map.texture=d.map):d instanceof THREE.MeshPhongMaterial?(j.shininess.value=d.shininess,I.gammaInput?(j.ambient.value.copyGammaToLinear(d.ambient),j.emissive.value.copyGammaToLinear(d.emissive),j.specular.value.copyGammaToLinear(d.specular)):(j.ambient.value=d.ambient,j.emissive.value=d.emissive,j.specular.value=d.specular),d.wrapAround&&
j.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(I.gammaInput?(j.ambient.value.copyGammaToLinear(d.ambient),j.emissive.value.copyGammaToLinear(d.emissive)):(j.ambient.value=d.ambient,j.emissive.value=d.emissive),d.wrapAround&&j.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(j.mNear.value=a.near,j.mFar.value=a.far,j.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(j.opacity.value=d.opacity);if(e.receiveShadow&&!d._shadowPass&&j.shadowMatrix){h=
c=0;for(i=b.length;h<i;h++)if(k=b[h],k.castShadow&&(k instanceof THREE.SpotLight||k instanceof THREE.DirectionalLight&&!k.shadowCascade))j.shadowMap.texture[c]=k.shadowMap,j.shadowMapSize.value[c]=k.shadowMapSize,j.shadowMatrix.value[c]=k.shadowMatrix,j.shadowDarkness.value[c]=k.shadowDarkness,j.shadowBias.value[c]=k.shadowBias,c++}b=d.uniformsList;j=0;for(c=b.length;j<c;j++)if(k=f.uniforms[b[j][1]])switch(h=b[j][0],s=h.type,i=h.value,s){case "i":o.uniform1i(k,i);break;case "f":o.uniform1f(k,i);break;
case "v2":o.uniform2f(k,i.x,i.y);break;case "v3":o.uniform3f(k,i.x,i.y,i.z);break;case "v4":o.uniform4f(k,i.x,i.y,i.z,i.w);break;case "c":o.uniform3f(k,i.r,i.g,i.b);break;case "fv1":o.uniform1fv(k,i);break;case "fv":o.uniform3fv(k,i);break;case "v2v":h._array||(h._array=new Float32Array(2*i.length));s=0;for(l=i.length;s<l;s++)m=2*s,h._array[m]=i[s].x,h._array[m+1]=i[s].y;o.uniform2fv(k,h._array);break;case "v3v":h._array||(h._array=new Float32Array(3*i.length));s=0;for(l=i.length;s<l;s++)m=3*s,h._array[m]=
i[s].x,h._array[m+1]=i[s].y,h._array[m+2]=i[s].z;o.uniform3fv(k,h._array);break;case "v4v":h._array||(h._array=new Float32Array(4*i.length));s=0;for(l=i.length;s<l;s++)m=4*s,h._array[m]=i[s].x,h._array[m+1]=i[s].y,h._array[m+2]=i[s].z,h._array[m+3]=i[s].w;o.uniform4fv(k,h._array);break;case "m4":h._array||(h._array=new Float32Array(16));i.flattenToArray(h._array);o.uniformMatrix4fv(k,!1,h._array);break;case "m4v":h._array||(h._array=new Float32Array(16*i.length));s=0;for(l=i.length;s<l;s++)i[s].flattenToArrayOffset(h._array,
16*s);o.uniformMatrix4fv(k,!1,h._array);break;case "t":o.uniform1i(k,i);k=h.texture;if(!k)continue;if(k.image instanceof Array&&6===k.image.length){if(h=k,6===h.image.length)if(h.needsUpdate){h.image.__webglTextureCube||(h.image.__webglTextureCube=o.createTexture());o.activeTexture(o.TEXTURE0+i);o.bindTexture(o.TEXTURE_CUBE_MAP,h.image.__webglTextureCube);i=[];for(k=0;6>k;k++)s=i,l=k,I.autoScaleCubemaps?(m=h.image[k],q=jb,m.width<=q&&m.height<=q||(r=Math.max(m.width,m.height),E=Math.floor(m.width*
q/r),q=Math.floor(m.height*q/r),r=document.createElement("canvas"),r.width=E,r.height=q,r.getContext("2d").drawImage(m,0,0,m.width,m.height,0,0,E,q),m=r)):m=h.image[k],s[l]=m;k=i[0];s=0===(k.width&k.width-1)&&0===(k.height&k.height-1);l=F(h.format);m=F(h.type);z(o.TEXTURE_CUBE_MAP,h,s);for(k=0;6>k;k++)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+k,0,l,l,m,i[k]);h.generateMipmaps&&s&&o.generateMipmap(o.TEXTURE_CUBE_MAP);h.needsUpdate=!1;if(h.onUpdate)h.onUpdate()}else o.activeTexture(o.TEXTURE0+i),o.bindTexture(o.TEXTURE_CUBE_MAP,
h.image.__webglTextureCube)}else k instanceof THREE.WebGLRenderTargetCube?(h=k,o.activeTexture(o.TEXTURE0+i),o.bindTexture(o.TEXTURE_CUBE_MAP,h.__webglTexture)):I.setTexture(k,i);break;case "tv":if(!h._array){h._array=[];s=0;for(l=h.texture.length;s<l;s++)h._array[s]=i+s}o.uniform1iv(k,h._array);s=0;for(l=h.texture.length;s<l;s++)(k=h.texture[s])&&I.setTexture(k,h._array[s])}if((d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==g.cameraPosition)b=a.matrixWorld.getPosition(),
o.uniform3f(g.cameraPosition,b.x,b.y,b.z);(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==g.viewMatrix&&o.uniformMatrix4fv(g.viewMatrix,!1,a._viewMatrixArray);d.skinning&&o.uniformMatrix4fv(g.boneGlobalMatrices,!1,e.boneMatrices)}o.uniformMatrix4fv(g.modelViewMatrix,!1,e._modelViewMatrix.elements);g.normalMatrix&&o.uniformMatrix3fv(g.normalMatrix,!1,e._normalMatrix.elements);null!==g.objectMatrix&&o.uniformMatrix4fv(g.objectMatrix,
!1,e.matrixWorld.elements);return f}function t(a,b){a._modelViewMatrix.multiply(b.matrixWorldInverse,a.matrixWorld);a._normalMatrix.getInverse(a._modelViewMatrix);a._normalMatrix.transpose()}function v(a,b,c){Fa!==a&&(a?o.enable(o.POLYGON_OFFSET_FILL):o.disable(o.POLYGON_OFFSET_FILL),Fa=a);if(a&&(Na!==b||Ua!==c))o.polygonOffset(b,c),Na=b,Ua=c}function w(a,b){var c;"fragment"===a?c=o.createShader(o.FRAGMENT_SHADER):"vertex"===a&&(c=o.createShader(o.VERTEX_SHADER));o.shaderSource(c,b);o.compileShader(c);
return!o.getShaderParameter(c,o.COMPILE_STATUS)?(console.error(o.getShaderInfoLog(c)),console.error(b),null):c}function z(a,b,c){c?(o.texParameteri(a,o.TEXTURE_WRAP_S,F(b.wrapS)),o.texParameteri(a,o.TEXTURE_WRAP_T,F(b.wrapT)),o.texParameteri(a,o.TEXTURE_MAG_FILTER,F(b.magFilter)),o.texParameteri(a,o.TEXTURE_MIN_FILTER,F(b.minFilter))):(o.texParameteri(a,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(a,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(a,o.TEXTURE_MAG_FILTER,A(b.magFilter)),o.texParameteri(a,
o.TEXTURE_MIN_FILTER,A(b.minFilter)))}function x(a,b){o.bindRenderbuffer(o.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?(o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,b.width,b.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,b.width,b.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,a)):o.renderbufferStorage(o.RENDERBUFFER,
o.RGBA4,b.width,b.height)}function A(a){switch(a){case THREE.NearestFilter:case THREE.NearestMipMapNearestFilter:case THREE.NearestMipMapLinearFilter:return o.NEAREST;default:return o.LINEAR}}function F(a){switch(a){case THREE.RepeatWrapping:return o.REPEAT;case THREE.ClampToEdgeWrapping:return o.CLAMP_TO_EDGE;case THREE.MirroredRepeatWrapping:return o.MIRRORED_REPEAT;case THREE.NearestFilter:return o.NEAREST;case THREE.NearestMipMapNearestFilter:return o.NEAREST_MIPMAP_NEAREST;case THREE.NearestMipMapLinearFilter:return o.NEAREST_MIPMAP_LINEAR;
case THREE.LinearFilter:return o.LINEAR;case THREE.LinearMipMapNearestFilter:return o.LINEAR_MIPMAP_NEAREST;case THREE.LinearMipMapLinearFilter:return o.LINEAR_MIPMAP_LINEAR;case THREE.ByteType:return o.BYTE;case THREE.UnsignedByteType:return o.UNSIGNED_BYTE;case THREE.ShortType:return o.SHORT;case THREE.UnsignedShortType:return o.UNSIGNED_SHORT;case THREE.IntType:return o.INT;case THREE.UnsignedIntType:return o.UNSIGNED_INT;case THREE.FloatType:return o.FLOAT;case THREE.AlphaFormat:return o.ALPHA;
case THREE.RGBFormat:return o.RGB;case THREE.RGBAFormat:return o.RGBA;case THREE.LuminanceFormat:return o.LUMINANCE;case THREE.LuminanceAlphaFormat:return o.LUMINANCE_ALPHA;case THREE.AddEquation:return o.FUNC_ADD;case THREE.SubtractEquation:return o.FUNC_SUBTRACT;case THREE.ReverseSubtractEquation:return o.FUNC_REVERSE_SUBTRACT;case THREE.ZeroFactor:return o.ZERO;case THREE.OneFactor:return o.ONE;case THREE.SrcColorFactor:return o.SRC_COLOR;case THREE.OneMinusSrcColorFactor:return o.ONE_MINUS_SRC_COLOR;
case THREE.SrcAlphaFactor:return o.SRC_ALPHA;case THREE.OneMinusSrcAlphaFactor:return o.ONE_MINUS_SRC_ALPHA;case THREE.DstAlphaFactor:return o.DST_ALPHA;case THREE.OneMinusDstAlphaFactor:return o.ONE_MINUS_DST_ALPHA;case THREE.DstColorFactor:return o.DST_COLOR;case THREE.OneMinusDstColorFactor:return o.ONE_MINUS_DST_COLOR;case THREE.SrcAlphaSaturateFactor:return o.SRC_ALPHA_SATURATE}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);var a=a||{},C=void 0!==a.canvas?a.canvas:document.createElement("canvas"),
D=void 0!==a.precision?a.precision:"highp",y=void 0!==a.alpha?a.alpha:!0,s=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,E=void 0!==a.antialias?a.antialias:!1,u=void 0!==a.stencil?a.stencil:!0,J=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,N=void 0!==a.clearColor?new THREE.Color(a.clearColor):new THREE.Color(0),B=void 0!==a.clearAlpha?a.clearAlpha:0,M=void 0!==a.maxLights?a.maxLights:4;this.domElement=C;this.context=null;this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=
this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapCullFrontFaces=this.shadowMapSoft=this.shadowMapAutoUpdate=!0;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};
var I=this,o,Q=[],P=null,H=null,T=-1,L=null,W=null,ea=0,da=-1,aa=-1,ba=-1,Z=-1,ca=-1,n=-1,Ga=-1,pa=-1,Fa=null,Na=null,Ua=null,Oa=null,Kb=0,vb=0,nb=0,Lb=0,yb=0,Vb=0,Sa=new THREE.Frustum,sa=new THREE.Matrix4,Aa=new THREE.Matrix4,$a=new THREE.Vector4,ja=new THREE.Vector3,Ra=!0,Pa={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],angles:[],exponents:[]}};o=function(){var a;
try{if(!(a=C.getContext("experimental-webgl",{alpha:y,premultipliedAlpha:s,antialias:E,stencil:u,preserveDrawingBuffer:J})))throw"Error creating WebGL context.";}catch(b){console.error(b)}a.getExtension("OES_texture_float")||console.log("THREE.WebGLRenderer: Float textures not supported.");return a}();o.clearColor(0,0,0,1);o.clearDepth(1);o.clearStencil(0);o.enable(o.DEPTH_TEST);o.depthFunc(o.LEQUAL);o.frontFace(o.CCW);o.cullFace(o.BACK);o.enable(o.CULL_FACE);o.enable(o.BLEND);o.blendEquation(o.FUNC_ADD);
o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);o.clearColor(N.r,N.g,N.b,B);this.context=o;var qa=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS);o.getParameter(o.MAX_TEXTURE_SIZE);var jb=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE);this.getContext=function(){return o};this.supportsVertexTextures=function(){return 0<qa};this.setSize=function(a,b){C.width=a;C.height=b;this.setViewport(0,0,C.width,C.height)};this.setViewport=function(a,b,c,d){Kb=a;vb=b;nb=c;Lb=d;o.viewport(Kb,vb,nb,Lb)};this.setScissor=
function(a,b,c,d){o.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?o.enable(o.SCISSOR_TEST):o.disable(o.SCISSOR_TEST)};this.setClearColorHex=function(a,b){N.setHex(a);B=b;o.clearColor(N.r,N.g,N.b,B)};this.setClearColor=function(a,b){N.copy(a);B=b;o.clearColor(N.r,N.g,N.b,B)};this.getClearColor=function(){return N};this.getClearAlpha=function(){return B};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=o.COLOR_BUFFER_BIT;if(void 0===b||b)d|=o.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=o.STENCIL_BUFFER_BIT;
o.clear(d)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this);this.renderPluginsPre.push(a)};this.deallocateObject=function(a){if(a.__webglInit)if(a.__webglInit=!1,delete a._modelViewMatrix,delete a._normalMatrix,delete a._normalMatrixArray,delete a._modelViewMatrixArray,delete a._objectMatrixArray,a instanceof THREE.Mesh)for(var b in a.geometry.geometryGroups){var c=
a.geometry.geometryGroups[b];o.deleteBuffer(c.__webglVertexBuffer);o.deleteBuffer(c.__webglNormalBuffer);o.deleteBuffer(c.__webglTangentBuffer);o.deleteBuffer(c.__webglColorBuffer);o.deleteBuffer(c.__webglUVBuffer);o.deleteBuffer(c.__webglUV2Buffer);o.deleteBuffer(c.__webglSkinVertexABuffer);o.deleteBuffer(c.__webglSkinVertexBBuffer);o.deleteBuffer(c.__webglSkinIndicesBuffer);o.deleteBuffer(c.__webglSkinWeightsBuffer);o.deleteBuffer(c.__webglFaceBuffer);o.deleteBuffer(c.__webglLineBuffer);var d=void 0,
e=void 0;if(c.numMorphTargets){d=0;for(e=c.numMorphTargets;d<e;d++)o.deleteBuffer(c.__webglMorphTargetsBuffers[d])}if(c.numMorphNormals){d=0;for(e=c.numMorphNormals;d<e;d++)o.deleteBuffer(c.__webglMorphNormalsBuffers[d])}if(c.__webglCustomAttributesList)for(d in d=void 0,c.__webglCustomAttributesList)o.deleteBuffer(c.__webglCustomAttributesList[d].buffer);I.info.memory.geometries--}else a instanceof THREE.Ribbon?(a=a.geometry,o.deleteBuffer(a.__webglVertexBuffer),o.deleteBuffer(a.__webglColorBuffer),
I.info.memory.geometries--):a instanceof THREE.Line?(a=a.geometry,o.deleteBuffer(a.__webglVertexBuffer),o.deleteBuffer(a.__webglColorBuffer),I.info.memory.geometries--):a instanceof THREE.ParticleSystem&&(a=a.geometry,o.deleteBuffer(a.__webglVertexBuffer),o.deleteBuffer(a.__webglColorBuffer),I.info.memory.geometries--)};this.deallocateTexture=function(a){a.__webglInit&&(a.__webglInit=!1,o.deleteTexture(a.__webglTexture),I.info.memory.textures--)};this.deallocateRenderTarget=function(a){if(a&&a.__webglTexture)if(o.deleteTexture(a.__webglTexture),
a instanceof THREE.WebGLRenderTargetCube)for(var b=0;6>b;b++)o.deleteFramebuffer(a.__webglFramebuffer[b]),o.deleteRenderbuffer(a.__webglRenderbuffer[b]);else o.deleteFramebuffer(a.__webglFramebuffer),o.deleteRenderbuffer(a.__webglRenderbuffer)};this.updateShadowMap=function(a,b){P=null;T=L=pa=Ga=ba=-1;Ra=!0;aa=da=-1;this.shadowMapPlugin.update(a,b)};this.renderBufferImmediate=function(a,b,c){a.__webglVertexBuffer||(a.__webglVertexBuffer=o.createBuffer());a.__webglNormalBuffer||(a.__webglNormalBuffer=
o.createBuffer());a.hasPos&&(o.bindBuffer(o.ARRAY_BUFFER,a.__webglVertexBuffer),o.bufferData(o.ARRAY_BUFFER,a.positionArray,o.DYNAMIC_DRAW),o.enableVertexAttribArray(b.attributes.position),o.vertexAttribPointer(b.attributes.position,3,o.FLOAT,!1,0,0));if(a.hasNormal){o.bindBuffer(o.ARRAY_BUFFER,a.__webglNormalBuffer);if(c===THREE.FlatShading){var d,e,f,g,h,j,i,k,s,l,u=3*a.count;for(l=0;l<u;l+=9)c=a.normalArray,d=c[l],e=c[l+1],f=c[l+2],g=c[l+3],j=c[l+4],k=c[l+5],h=c[l+6],i=c[l+7],s=c[l+8],d=(d+g+h)/
3,e=(e+j+i)/3,f=(f+k+s)/3,c[l]=d,c[l+1]=e,c[l+2]=f,c[l+3]=d,c[l+4]=e,c[l+5]=f,c[l+6]=d,c[l+7]=e,c[l+8]=f}o.bufferData(o.ARRAY_BUFFER,a.normalArray,o.DYNAMIC_DRAW);o.enableVertexAttribArray(b.attributes.normal);o.vertexAttribPointer(b.attributes.normal,3,o.FLOAT,!1,0,0)}o.drawArrays(o.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,b,c,d,e,f){if(!1!==d.visible&&(c=q(a,b,c,d,f),a=c.attributes,b=!1,d=16777215*e.id+2*c.id+(d.wireframe?1:0),d!==L&&(L=d,b=!0),f instanceof THREE.Mesh)){f=
e.offsets;d=0;for(c=f.length;d<c;++d)b&&(o.bindBuffer(o.ARRAY_BUFFER,e.vertexPositionBuffer),o.vertexAttribPointer(a.position,e.vertexPositionBuffer.itemSize,o.FLOAT,!1,0,12*f[d].index),0<=a.normal&&e.vertexNormalBuffer&&(o.bindBuffer(o.ARRAY_BUFFER,e.vertexNormalBuffer),o.vertexAttribPointer(a.normal,e.vertexNormalBuffer.itemSize,o.FLOAT,!1,0,12*f[d].index)),0<=a.uv&&e.vertexUvBuffer&&(e.vertexUvBuffer?(o.bindBuffer(o.ARRAY_BUFFER,e.vertexUvBuffer),o.vertexAttribPointer(a.uv,e.vertexUvBuffer.itemSize,
o.FLOAT,!1,0,8*f[d].index),o.enableVertexAttribArray(a.uv)):o.disableVertexAttribArray(a.uv)),0<=a.color&&e.vertexColorBuffer&&(o.bindBuffer(o.ARRAY_BUFFER,e.vertexColorBuffer),o.vertexAttribPointer(a.color,e.vertexColorBuffer.itemSize,o.FLOAT,!1,0,16*f[d].index)),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)),o.drawElements(o.TRIANGLES,f[d].count,o.UNSIGNED_SHORT,2*f[d].start),I.info.render.calls++,I.info.render.vertices+=f[d].count,I.info.render.faces+=f[d].count/3}};this.renderBuffer=
function(a,b,c,d,e,f){if(!1!==d.visible){var g,h,c=q(a,b,c,d,f),b=c.attributes,a=!1,c=16777215*e.id+2*c.id+(d.wireframe?1:0);c!==L&&(L=c,a=!0);if(!d.morphTargets&&0<=b.position)a&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglVertexBuffer),o.vertexAttribPointer(b.position,3,o.FLOAT,!1,0,0));else if(f.morphTargetBase){c=d.program.attributes;-1!==f.morphTargetBase?(o.bindBuffer(o.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[f.morphTargetBase]),o.vertexAttribPointer(c.position,3,o.FLOAT,!1,0,0)):0<=c.position&&
(o.bindBuffer(o.ARRAY_BUFFER,e.__webglVertexBuffer),o.vertexAttribPointer(c.position,3,o.FLOAT,!1,0,0));if(f.morphTargetForcedOrder.length){g=0;var j=f.morphTargetForcedOrder;for(h=f.morphTargetInfluences;g<d.numSupportedMorphTargets&&g<j.length;)o.bindBuffer(o.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[j[g]]),o.vertexAttribPointer(c["morphTarget"+g],3,o.FLOAT,!1,0,0),d.morphNormals&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[j[g]]),o.vertexAttribPointer(c["morphNormal"+g],3,o.FLOAT,
!1,0,0)),f.__webglMorphTargetInfluences[g]=h[j[g]],g++}else{var j=[],i=-1,k=0;h=f.morphTargetInfluences;var s,l=h.length;g=0;for(-1!==f.morphTargetBase&&(j[f.morphTargetBase]=!0);g<d.numSupportedMorphTargets;){for(s=0;s<l;s++)!j[s]&&h[s]>i&&(k=s,i=h[k]);o.bindBuffer(o.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[k]);o.vertexAttribPointer(c["morphTarget"+g],3,o.FLOAT,!1,0,0);d.morphNormals&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[k]),o.vertexAttribPointer(c["morphNormal"+g],3,o.FLOAT,
!1,0,0));f.__webglMorphTargetInfluences[g]=i;j[k]=1;i=-1;g++}}null!==d.program.uniforms.morphTargetInfluences&&o.uniform1fv(d.program.uniforms.morphTargetInfluences,f.__webglMorphTargetInfluences)}if(a){if(e.__webglCustomAttributesList){g=0;for(h=e.__webglCustomAttributesList.length;g<h;g++)c=e.__webglCustomAttributesList[g],0<=b[c.buffer.belongsToAttribute]&&(o.bindBuffer(o.ARRAY_BUFFER,c.buffer),o.vertexAttribPointer(b[c.buffer.belongsToAttribute],c.size,o.FLOAT,!1,0,0))}0<=b.color&&(o.bindBuffer(o.ARRAY_BUFFER,
e.__webglColorBuffer),o.vertexAttribPointer(b.color,3,o.FLOAT,!1,0,0));0<=b.normal&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglNormalBuffer),o.vertexAttribPointer(b.normal,3,o.FLOAT,!1,0,0));0<=b.tangent&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglTangentBuffer),o.vertexAttribPointer(b.tangent,4,o.FLOAT,!1,0,0));0<=b.uv&&(e.__webglUVBuffer?(o.bindBuffer(o.ARRAY_BUFFER,e.__webglUVBuffer),o.vertexAttribPointer(b.uv,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(b.uv)):o.disableVertexAttribArray(b.uv));0<=b.uv2&&
(e.__webglUV2Buffer?(o.bindBuffer(o.ARRAY_BUFFER,e.__webglUV2Buffer),o.vertexAttribPointer(b.uv2,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(b.uv2)):o.disableVertexAttribArray(b.uv2));d.skinning&&0<=b.skinVertexA&&0<=b.skinVertexB&&0<=b.skinIndex&&0<=b.skinWeight&&(o.bindBuffer(o.ARRAY_BUFFER,e.__webglSkinVertexABuffer),o.vertexAttribPointer(b.skinVertexA,4,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,e.__webglSkinVertexBBuffer),o.vertexAttribPointer(b.skinVertexB,4,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,
e.__webglSkinIndicesBuffer),o.vertexAttribPointer(b.skinIndex,4,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),o.vertexAttribPointer(b.skinWeight,4,o.FLOAT,!1,0,0))}f instanceof THREE.Mesh?(d.wireframe?(d=d.wireframeLinewidth,d!==Oa&&(o.lineWidth(d),Oa=d),a&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),o.drawElements(o.LINES,e.__webglLineCount,o.UNSIGNED_SHORT,0)):(a&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),o.drawElements(o.TRIANGLES,e.__webglFaceCount,
o.UNSIGNED_SHORT,0)),I.info.render.calls++,I.info.render.vertices+=e.__webglFaceCount,I.info.render.faces+=e.__webglFaceCount/3):f instanceof THREE.Line?(f=f.type===THREE.LineStrip?o.LINE_STRIP:o.LINES,d=d.linewidth,d!==Oa&&(o.lineWidth(d),Oa=d),o.drawArrays(f,0,e.__webglLineCount),I.info.render.calls++):f instanceof THREE.ParticleSystem?(o.drawArrays(o.POINTS,0,e.__webglParticleCount),I.info.render.calls++,I.info.render.points+=e.__webglParticleCount):f instanceof THREE.Ribbon&&(o.drawArrays(o.TRIANGLE_STRIP,
0,e.__webglVertexCount),I.info.render.calls++)}};this.render=function(a,b,c,d){var e,f,k,s,l=a.__lights,u=a.fog;T=-1;Ra=!0;void 0===b.parent&&(console.warn("DEPRECATED: Camera hasn't been added to a Scene. Adding it..."),a.add(b));this.autoUpdateScene&&a.updateMatrixWorld();b._viewMatrixArray||(b._viewMatrixArray=new Float32Array(16));b._projectionMatrixArray||(b._projectionMatrixArray=new Float32Array(16));b.matrixWorldInverse.getInverse(b.matrixWorld);b.matrixWorldInverse.flattenToArray(b._viewMatrixArray);
b.projectionMatrix.flattenToArray(b._projectionMatrixArray);sa.multiply(b.projectionMatrix,b.matrixWorldInverse);Sa.setFromMatrix(sa);this.autoUpdateObjects&&this.initWebGLObjects(a);h(this.renderPluginsPre,a,b);I.info.render.calls=0;I.info.render.vertices=0;I.info.render.faces=0;I.info.render.points=0;this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);s=a.__webglObjects;d=0;for(e=s.length;d<e;d++)if(f=s[d],k=f.object,f.render=!1,
k.visible&&(!(k instanceof THREE.Mesh||k instanceof THREE.ParticleSystem)||!k.frustumCulled||Sa.contains(k))){t(k,b);var p=f,n=p.object,m=p.buffer,E=void 0,E=n.material;E instanceof THREE.MeshFaceMaterial?(E=m.materialIndex,0<=E&&(E=n.geometry.materials[E],E.transparent?(p.transparent=E,p.opaque=null):(p.opaque=E,p.transparent=null))):E&&(E.transparent?(p.transparent=E,p.opaque=null):(p.opaque=E,p.transparent=null));f.render=!0;this.sortObjects&&(k.renderDepth?f.z=k.renderDepth:($a.copy(k.matrixWorld.getPosition()),
sa.multiplyVector3($a),f.z=$a.z))}this.sortObjects&&s.sort(g);s=a.__webglObjectsImmediate;d=0;for(e=s.length;d<e;d++)f=s[d],k=f.object,k.visible&&(t(k,b),k=f.object.material,k.transparent?(f.transparent=k,f.opaque=null):(f.opaque=k,f.transparent=null));a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),v(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),i(a.__webglObjects,
!1,"",b,l,u,!0,d),j(a.__webglObjectsImmediate,"",b,l,u,!1,d)):(this.setBlending(THREE.NormalBlending),i(a.__webglObjects,!0,"opaque",b,l,u,!1),j(a.__webglObjectsImmediate,"opaque",b,l,u,!1),i(a.__webglObjects,!1,"transparent",b,l,u,!0),j(a.__webglObjectsImmediate,"transparent",b,l,u,!0));h(this.renderPluginsPost,a,b);c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&(c instanceof THREE.WebGLRenderTargetCube?(o.bindTexture(o.TEXTURE_CUBE_MAP,c.__webglTexture),
o.generateMipmap(o.TEXTURE_CUBE_MAP),o.bindTexture(o.TEXTURE_CUBE_MAP,null)):(o.bindTexture(o.TEXTURE_2D,c.__webglTexture),o.generateMipmap(o.TEXTURE_2D),o.bindTexture(o.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)};this.renderImmediateObject=function(a,b,c,d,e){var f=q(a,b,c,d,e);L=-1;I.setObjectFaces(e);e.immediateRenderCallback?e.immediateRenderCallback(f,o,Sa):e.render(function(a){I.renderBufferImmediate(a,f,d.shading)})};this.initWebGLObjects=function(a){a.__webglObjects||
(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);for(;a.__objectsAdded.length;){var g=a.__objectsAdded[0],h=a,j=void 0,i=void 0,s=void 0;if(!g.__webglInit)if(g.__webglInit=!0,g._modelViewMatrix=new THREE.Matrix4,g._normalMatrix=new THREE.Matrix3,g instanceof THREE.Mesh){if(i=g.geometry,i instanceof THREE.Geometry){if(void 0===i.geometryGroups){var u=i,n=void 0,E=void 0,q=void 0,B=void 0,T=void 0,t=void 0,J=void 0,Q={},L=u.morphTargets.length,N=u.morphNormals.length;
u.geometryGroups={};n=0;for(E=u.faces.length;n<E;n++)q=u.faces[n],B=q.materialIndex,t=void 0!==B?B:-1,void 0===Q[t]&&(Q[t]={hash:t,counter:0}),J=Q[t].hash+"_"+Q[t].counter,void 0===u.geometryGroups[J]&&(u.geometryGroups[J]={faces3:[],faces4:[],materialIndex:B,vertices:0,numMorphTargets:L,numMorphNormals:N}),T=q instanceof THREE.Face3?3:4,65535<u.geometryGroups[J].vertices+T&&(Q[t].counter+=1,J=Q[t].hash+"_"+Q[t].counter,void 0===u.geometryGroups[J]&&(u.geometryGroups[J]={faces3:[],faces4:[],materialIndex:B,
vertices:0,numMorphTargets:L,numMorphNormals:N})),q instanceof THREE.Face3?u.geometryGroups[J].faces3.push(n):u.geometryGroups[J].faces4.push(n),u.geometryGroups[J].vertices+=T;u.geometryGroupsList=[];var v=void 0;for(v in u.geometryGroups)u.geometryGroups[v].id=ea++,u.geometryGroupsList.push(u.geometryGroups[v])}for(j in i.geometryGroups)if(s=i.geometryGroups[j],!s.__webglVertexBuffer){var y=s;y.__webglVertexBuffer=o.createBuffer();y.__webglNormalBuffer=o.createBuffer();y.__webglTangentBuffer=o.createBuffer();
y.__webglColorBuffer=o.createBuffer();y.__webglUVBuffer=o.createBuffer();y.__webglUV2Buffer=o.createBuffer();y.__webglSkinVertexABuffer=o.createBuffer();y.__webglSkinVertexBBuffer=o.createBuffer();y.__webglSkinIndicesBuffer=o.createBuffer();y.__webglSkinWeightsBuffer=o.createBuffer();y.__webglFaceBuffer=o.createBuffer();y.__webglLineBuffer=o.createBuffer();var x=void 0,M=void 0;if(y.numMorphTargets){y.__webglMorphTargetsBuffers=[];x=0;for(M=y.numMorphTargets;x<M;x++)y.__webglMorphTargetsBuffers.push(o.createBuffer())}if(y.numMorphNormals){y.__webglMorphNormalsBuffers=
[];x=0;for(M=y.numMorphNormals;x<M;x++)y.__webglMorphNormalsBuffers.push(o.createBuffer())}I.info.memory.geometries++;var w=s,H=g,W=H.geometry,z=w.faces3,A=w.faces4,P=3*z.length+4*A.length,C=1*z.length+2*A.length,F=3*z.length+4*A.length,D=c(H,w),da=e(D),aa=d(D),ba=D.vertexColors?D.vertexColors:!1;w.__vertexArray=new Float32Array(3*P);aa&&(w.__normalArray=new Float32Array(3*P));W.hasTangents&&(w.__tangentArray=new Float32Array(4*P));ba&&(w.__colorArray=new Float32Array(3*P));if(da){if(0<W.faceUvs.length||
0<W.faceVertexUvs.length)w.__uvArray=new Float32Array(2*P);if(1<W.faceUvs.length||1<W.faceVertexUvs.length)w.__uv2Array=new Float32Array(2*P)}H.geometry.skinWeights.length&&H.geometry.skinIndices.length&&(w.__skinVertexAArray=new Float32Array(4*P),w.__skinVertexBArray=new Float32Array(4*P),w.__skinIndexArray=new Float32Array(4*P),w.__skinWeightArray=new Float32Array(4*P));w.__faceArray=new Uint16Array(3*C);w.__lineArray=new Uint16Array(2*F);var Z=void 0,ca=void 0;if(w.numMorphTargets){w.__morphTargetsArrays=
[];Z=0;for(ca=w.numMorphTargets;Z<ca;Z++)w.__morphTargetsArrays.push(new Float32Array(3*P))}if(w.numMorphNormals){w.__morphNormalsArrays=[];Z=0;for(ca=w.numMorphNormals;Z<ca;Z++)w.__morphNormalsArrays.push(new Float32Array(3*P))}w.__webglFaceCount=3*C;w.__webglLineCount=2*F;if(D.attributes){void 0===w.__webglCustomAttributesList&&(w.__webglCustomAttributesList=[]);var Fa=void 0;for(Fa in D.attributes){var Ga=D.attributes[Fa],pa={},ja;for(ja in Ga)pa[ja]=Ga[ja];if(!pa.__webglInitialized||pa.createUniqueBuffers){pa.__webglInitialized=
!0;var Na=1;"v2"===pa.type?Na=2:"v3"===pa.type?Na=3:"v4"===pa.type?Na=4:"c"===pa.type&&(Na=3);pa.size=Na;pa.array=new Float32Array(P*Na);pa.buffer=o.createBuffer();pa.buffer.belongsToAttribute=Fa;Ga.needsUpdate=!0;pa.__original=Ga}w.__webglCustomAttributesList.push(pa)}}w.__inittedArrays=!0;i.verticesNeedUpdate=!0;i.morphTargetsNeedUpdate=!0;i.elementsNeedUpdate=!0;i.uvsNeedUpdate=!0;i.normalsNeedUpdate=!0;i.tangetsNeedUpdate=!0;i.colorsNeedUpdate=!0}}}else if(g instanceof THREE.Ribbon){if(i=g.geometry,
!i.__webglVertexBuffer){var Ua=i;Ua.__webglVertexBuffer=o.createBuffer();Ua.__webglColorBuffer=o.createBuffer();I.info.memory.geometries++;var qa=i,sa=qa.vertices.length;qa.__vertexArray=new Float32Array(3*sa);qa.__colorArray=new Float32Array(3*sa);qa.__webglVertexCount=sa;i.verticesNeedUpdate=!0;i.colorsNeedUpdate=!0}}else if(g instanceof THREE.Line){if(i=g.geometry,!i.__webglVertexBuffer){var Aa=i;Aa.__webglVertexBuffer=o.createBuffer();Aa.__webglColorBuffer=o.createBuffer();I.info.memory.geometries++;
var Oa=i,Pa=g,Ra=Oa.vertices.length;Oa.__vertexArray=new Float32Array(3*Ra);Oa.__colorArray=new Float32Array(3*Ra);Oa.__webglLineCount=Ra;b(Oa,Pa);i.verticesNeedUpdate=!0;i.colorsNeedUpdate=!0}}else if(g instanceof THREE.ParticleSystem&&(i=g.geometry,!i.__webglVertexBuffer)){var $a=i;$a.__webglVertexBuffer=o.createBuffer();$a.__webglColorBuffer=o.createBuffer();I.info.geometries++;var Sa=i,Kb=g,vb=Sa.vertices.length;Sa.__vertexArray=new Float32Array(3*vb);Sa.__colorArray=new Float32Array(3*vb);Sa.__sortArray=
[];Sa.__webglParticleCount=vb;b(Sa,Kb);i.verticesNeedUpdate=!0;i.colorsNeedUpdate=!0}if(!g.__webglActive){if(g instanceof THREE.Mesh)if(i=g.geometry,i instanceof THREE.BufferGeometry)k(h.__webglObjects,i,g);else for(j in i.geometryGroups)s=i.geometryGroups[j],k(h.__webglObjects,s,g);else g instanceof THREE.Ribbon||g instanceof THREE.Line||g instanceof THREE.ParticleSystem?(i=g.geometry,k(h.__webglObjects,i,g)):g instanceof THREE.ImmediateRenderObject||g.immediateRenderCallback?h.__webglObjectsImmediate.push({object:g,
opaque:null,transparent:null}):g instanceof THREE.Sprite?h.__webglSprites.push(g):g instanceof THREE.LensFlare&&h.__webglFlares.push(g);g.__webglActive=!0}a.__objectsAdded.splice(0,1)}for(;a.__objectsRemoved.length;){var fb=a.__objectsRemoved[0],nb=a;fb instanceof THREE.Mesh||fb instanceof THREE.ParticleSystem||fb instanceof THREE.Ribbon||fb instanceof THREE.Line?m(nb.__webglObjects,fb):fb instanceof THREE.Sprite?r(nb.__webglSprites,fb):fb instanceof THREE.LensFlare?r(nb.__webglFlares,fb):(fb instanceof
THREE.ImmediateRenderObject||fb.immediateRenderCallback)&&m(nb.__webglObjectsImmediate,fb);fb.__webglActive=!1;a.__objectsRemoved.splice(0,1)}for(var jb=0,Lb=a.__webglObjects.length;jb<Lb;jb++){var rb=a.__webglObjects[jb].object,ia=rb.geometry,sb=void 0,lb=void 0,Xa=void 0;if(rb instanceof THREE.Mesh)if(ia instanceof THREE.BufferGeometry)ia.verticesNeedUpdate=!1,ia.elementsNeedUpdate=!1,ia.uvsNeedUpdate=!1,ia.normalsNeedUpdate=!1,ia.colorsNeedUpdate=!1;else{for(var yb=0,Vb=ia.geometryGroupsList.length;yb<
Vb;yb++)if(sb=ia.geometryGroupsList[yb],Xa=c(rb,sb),lb=Xa.attributes&&l(Xa),ia.verticesNeedUpdate||ia.morphTargetsNeedUpdate||ia.elementsNeedUpdate||ia.uvsNeedUpdate||ia.normalsNeedUpdate||ia.colorsNeedUpdate||ia.tangetsNeedUpdate||lb){var ga=sb,Zc=rb,Za=o.DYNAMIC_DRAW,rd=!ia.dynamic,Ub=Xa;if(ga.__inittedArrays){var Pc=d(Ub),rc=Ub.vertexColors?Ub.vertexColors:!1,Qc=e(Ub),uc=Pc===THREE.SmoothShading,O=void 0,U=void 0,mb=void 0,S=void 0,jc=void 0,gb=void 0,hb=void 0,Ec=void 0,ib=void 0,Bb=void 0,kc=
void 0,X=void 0,Y=void 0,V=void 0,ka=void 0,tb=void 0,Cb=void 0,Db=void 0,Gc=void 0,Eb=void 0,ub=void 0,Fb=void 0,Hc=void 0,Gb=void 0,Hb=void 0,Ib=void 0,Ic=void 0,Jb=void 0,Mb=void 0,wb=void 0,Jc=void 0,Nb=void 0,Ob=void 0,Rb=void 0,Lc=void 0,cc=void 0,dc=void 0,bc=void 0,Xc=void 0,ec=void 0,fc=void 0,gc=void 0,Wc=void 0,ma=void 0,Bd=void 0,hc=void 0,Cc=void 0,Dc=void 0,La=void 0,Cd=void 0,Ha=void 0,Ia=void 0,ac=void 0,Wb=void 0,Ba=0,Ea=0,Xb=0,Yb=0,ob=0,Ta=0,ra=0,Wa=0,Ca=0,R=0,fa=0,K=0,eb=void 0,
Ma=ga.__vertexArray,Nc=ga.__uvArray,Mc=ga.__uv2Array,pb=ga.__normalArray,ua=ga.__tangentArray,Ka=ga.__colorArray,va=ga.__skinVertexAArray,wa=ga.__skinVertexBArray,xa=ga.__skinIndexArray,ya=ga.__skinWeightArray,ld=ga.__morphTargetsArrays,md=ga.__morphNormalsArrays,nd=ga.__webglCustomAttributesList,G=void 0,Qb=ga.__faceArray,db=ga.__lineArray,Va=Zc.geometry,Td=Va.elementsNeedUpdate,Ad=Va.uvsNeedUpdate,Ud=Va.normalsNeedUpdate,Xd=Va.tangetsNeedUpdate,Vd=Va.colorsNeedUpdate,Wd=Va.morphTargetsNeedUpdate,
vc=Va.vertices,na=ga.faces3,oa=ga.faces4,Da=Va.faces,sd=Va.faceVertexUvs[0],td=Va.faceVertexUvs[1],wc=Va.skinVerticesA,xc=Va.skinVerticesB,yc=Va.skinIndices,lc=Va.skinWeights,mc=Va.morphTargets,$c=Va.morphNormals;if(Va.verticesNeedUpdate){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],X=vc[S.a],Y=vc[S.b],V=vc[S.c],Ma[Ea]=X.x,Ma[Ea+1]=X.y,Ma[Ea+2]=X.z,Ma[Ea+3]=Y.x,Ma[Ea+4]=Y.y,Ma[Ea+5]=Y.z,Ma[Ea+6]=V.x,Ma[Ea+7]=V.y,Ma[Ea+8]=V.z,Ea+=9;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],X=vc[S.a],Y=vc[S.b],V=vc[S.c],ka=
vc[S.d],Ma[Ea]=X.x,Ma[Ea+1]=X.y,Ma[Ea+2]=X.z,Ma[Ea+3]=Y.x,Ma[Ea+4]=Y.y,Ma[Ea+5]=Y.z,Ma[Ea+6]=V.x,Ma[Ea+7]=V.y,Ma[Ea+8]=V.z,Ma[Ea+9]=ka.x,Ma[Ea+10]=ka.y,Ma[Ea+11]=ka.z,Ea+=12;o.bindBuffer(o.ARRAY_BUFFER,ga.__webglVertexBuffer);o.bufferData(o.ARRAY_BUFFER,Ma,Za)}if(Wd){La=0;for(Cd=mc.length;La<Cd;La++){O=fa=0;for(U=na.length;O<U;O++)ac=na[O],S=Da[ac],X=mc[La].vertices[S.a],Y=mc[La].vertices[S.b],V=mc[La].vertices[S.c],Ha=ld[La],Ha[fa]=X.x,Ha[fa+1]=X.y,Ha[fa+2]=X.z,Ha[fa+3]=Y.x,Ha[fa+4]=Y.y,Ha[fa+5]=
Y.z,Ha[fa+6]=V.x,Ha[fa+7]=V.y,Ha[fa+8]=V.z,Ub.morphNormals&&(uc?(Wb=$c[La].vertexNormals[ac],Eb=Wb.a,ub=Wb.b,Fb=Wb.c):Fb=ub=Eb=$c[La].faceNormals[ac],Ia=md[La],Ia[fa]=Eb.x,Ia[fa+1]=Eb.y,Ia[fa+2]=Eb.z,Ia[fa+3]=ub.x,Ia[fa+4]=ub.y,Ia[fa+5]=ub.z,Ia[fa+6]=Fb.x,Ia[fa+7]=Fb.y,Ia[fa+8]=Fb.z),fa+=9;O=0;for(U=oa.length;O<U;O++)ac=oa[O],S=Da[ac],X=mc[La].vertices[S.a],Y=mc[La].vertices[S.b],V=mc[La].vertices[S.c],ka=mc[La].vertices[S.d],Ha=ld[La],Ha[fa]=X.x,Ha[fa+1]=X.y,Ha[fa+2]=X.z,Ha[fa+3]=Y.x,Ha[fa+4]=Y.y,
Ha[fa+5]=Y.z,Ha[fa+6]=V.x,Ha[fa+7]=V.y,Ha[fa+8]=V.z,Ha[fa+9]=ka.x,Ha[fa+10]=ka.y,Ha[fa+11]=ka.z,Ub.morphNormals&&(uc?(Wb=$c[La].vertexNormals[ac],Eb=Wb.a,ub=Wb.b,Fb=Wb.c,Hc=Wb.d):Hc=Fb=ub=Eb=$c[La].faceNormals[ac],Ia=md[La],Ia[fa]=Eb.x,Ia[fa+1]=Eb.y,Ia[fa+2]=Eb.z,Ia[fa+3]=ub.x,Ia[fa+4]=ub.y,Ia[fa+5]=ub.z,Ia[fa+6]=Fb.x,Ia[fa+7]=Fb.y,Ia[fa+8]=Fb.z,Ia[fa+9]=Hc.x,Ia[fa+10]=Hc.y,Ia[fa+11]=Hc.z),fa+=12;o.bindBuffer(o.ARRAY_BUFFER,ga.__webglMorphTargetsBuffers[La]);o.bufferData(o.ARRAY_BUFFER,ld[La],Za);
Ub.morphNormals&&(o.bindBuffer(o.ARRAY_BUFFER,ga.__webglMorphNormalsBuffers[La]),o.bufferData(o.ARRAY_BUFFER,md[La],Za))}}if(lc.length){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],Jb=lc[S.a],Mb=lc[S.b],wb=lc[S.c],ya[R]=Jb.x,ya[R+1]=Jb.y,ya[R+2]=Jb.z,ya[R+3]=Jb.w,ya[R+4]=Mb.x,ya[R+5]=Mb.y,ya[R+6]=Mb.z,ya[R+7]=Mb.w,ya[R+8]=wb.x,ya[R+9]=wb.y,ya[R+10]=wb.z,ya[R+11]=wb.w,Nb=yc[S.a],Ob=yc[S.b],Rb=yc[S.c],xa[R]=Nb.x,xa[R+1]=Nb.y,xa[R+2]=Nb.z,xa[R+3]=Nb.w,xa[R+4]=Ob.x,xa[R+5]=Ob.y,xa[R+6]=Ob.z,xa[R+7]=Ob.w,xa[R+
8]=Rb.x,xa[R+9]=Rb.y,xa[R+10]=Rb.z,xa[R+11]=Rb.w,cc=wc[S.a],dc=wc[S.b],bc=wc[S.c],va[R]=cc.x,va[R+1]=cc.y,va[R+2]=cc.z,va[R+3]=1,va[R+4]=dc.x,va[R+5]=dc.y,va[R+6]=dc.z,va[R+7]=1,va[R+8]=bc.x,va[R+9]=bc.y,va[R+10]=bc.z,va[R+11]=1,ec=xc[S.a],fc=xc[S.b],gc=xc[S.c],wa[R]=ec.x,wa[R+1]=ec.y,wa[R+2]=ec.z,wa[R+3]=1,wa[R+4]=fc.x,wa[R+5]=fc.y,wa[R+6]=fc.z,wa[R+7]=1,wa[R+8]=gc.x,wa[R+9]=gc.y,wa[R+10]=gc.z,wa[R+11]=1,R+=12;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],Jb=lc[S.a],Mb=lc[S.b],wb=lc[S.c],Jc=lc[S.d],ya[R]=
Jb.x,ya[R+1]=Jb.y,ya[R+2]=Jb.z,ya[R+3]=Jb.w,ya[R+4]=Mb.x,ya[R+5]=Mb.y,ya[R+6]=Mb.z,ya[R+7]=Mb.w,ya[R+8]=wb.x,ya[R+9]=wb.y,ya[R+10]=wb.z,ya[R+11]=wb.w,ya[R+12]=Jc.x,ya[R+13]=Jc.y,ya[R+14]=Jc.z,ya[R+15]=Jc.w,Nb=yc[S.a],Ob=yc[S.b],Rb=yc[S.c],Lc=yc[S.d],xa[R]=Nb.x,xa[R+1]=Nb.y,xa[R+2]=Nb.z,xa[R+3]=Nb.w,xa[R+4]=Ob.x,xa[R+5]=Ob.y,xa[R+6]=Ob.z,xa[R+7]=Ob.w,xa[R+8]=Rb.x,xa[R+9]=Rb.y,xa[R+10]=Rb.z,xa[R+11]=Rb.w,xa[R+12]=Lc.x,xa[R+13]=Lc.y,xa[R+14]=Lc.z,xa[R+15]=Lc.w,cc=wc[S.a],dc=wc[S.b],bc=wc[S.c],Xc=wc[S.d],
va[R]=cc.x,va[R+1]=cc.y,va[R+2]=cc.z,va[R+3]=1,va[R+4]=dc.x,va[R+5]=dc.y,va[R+6]=dc.z,va[R+7]=1,va[R+8]=bc.x,va[R+9]=bc.y,va[R+10]=bc.z,va[R+11]=1,va[R+12]=Xc.x,va[R+13]=Xc.y,va[R+14]=Xc.z,va[R+15]=1,ec=xc[S.a],fc=xc[S.b],gc=xc[S.c],Wc=xc[S.d],wa[R]=ec.x,wa[R+1]=ec.y,wa[R+2]=ec.z,wa[R+3]=1,wa[R+4]=fc.x,wa[R+5]=fc.y,wa[R+6]=fc.z,wa[R+7]=1,wa[R+8]=gc.x,wa[R+9]=gc.y,wa[R+10]=gc.z,wa[R+11]=1,wa[R+12]=Wc.x,wa[R+13]=Wc.y,wa[R+14]=Wc.z,wa[R+15]=1,R+=16;0<R&&(o.bindBuffer(o.ARRAY_BUFFER,ga.__webglSkinVertexABuffer),
o.bufferData(o.ARRAY_BUFFER,va,Za),o.bindBuffer(o.ARRAY_BUFFER,ga.__webglSkinVertexBBuffer),o.bufferData(o.ARRAY_BUFFER,wa,Za),o.bindBuffer(o.ARRAY_BUFFER,ga.__webglSkinIndicesBuffer),o.bufferData(o.ARRAY_BUFFER,xa,Za),o.bindBuffer(o.ARRAY_BUFFER,ga.__webglSkinWeightsBuffer),o.bufferData(o.ARRAY_BUFFER,ya,Za))}if(Vd&&rc){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],hb=S.vertexColors,Ec=S.color,3===hb.length&&rc===THREE.VertexColors?(Gb=hb[0],Hb=hb[1],Ib=hb[2]):Ib=Hb=Gb=Ec,Ka[Ca]=Gb.r,Ka[Ca+1]=Gb.g,Ka[Ca+
2]=Gb.b,Ka[Ca+3]=Hb.r,Ka[Ca+4]=Hb.g,Ka[Ca+5]=Hb.b,Ka[Ca+6]=Ib.r,Ka[Ca+7]=Ib.g,Ka[Ca+8]=Ib.b,Ca+=9;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],hb=S.vertexColors,Ec=S.color,4===hb.length&&rc===THREE.VertexColors?(Gb=hb[0],Hb=hb[1],Ib=hb[2],Ic=hb[3]):Ic=Ib=Hb=Gb=Ec,Ka[Ca]=Gb.r,Ka[Ca+1]=Gb.g,Ka[Ca+2]=Gb.b,Ka[Ca+3]=Hb.r,Ka[Ca+4]=Hb.g,Ka[Ca+5]=Hb.b,Ka[Ca+6]=Ib.r,Ka[Ca+7]=Ib.g,Ka[Ca+8]=Ib.b,Ka[Ca+9]=Ic.r,Ka[Ca+10]=Ic.g,Ka[Ca+11]=Ic.b,Ca+=12;0<Ca&&(o.bindBuffer(o.ARRAY_BUFFER,ga.__webglColorBuffer),o.bufferData(o.ARRAY_BUFFER,
Ka,Za))}if(Xd&&Va.hasTangents){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],ib=S.vertexTangents,tb=ib[0],Cb=ib[1],Db=ib[2],ua[ra]=tb.x,ua[ra+1]=tb.y,ua[ra+2]=tb.z,ua[ra+3]=tb.w,ua[ra+4]=Cb.x,ua[ra+5]=Cb.y,ua[ra+6]=Cb.z,ua[ra+7]=Cb.w,ua[ra+8]=Db.x,ua[ra+9]=Db.y,ua[ra+10]=Db.z,ua[ra+11]=Db.w,ra+=12;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],ib=S.vertexTangents,tb=ib[0],Cb=ib[1],Db=ib[2],Gc=ib[3],ua[ra]=tb.x,ua[ra+1]=tb.y,ua[ra+2]=tb.z,ua[ra+3]=tb.w,ua[ra+4]=Cb.x,ua[ra+5]=Cb.y,ua[ra+6]=Cb.z,ua[ra+7]=Cb.w,ua[ra+
8]=Db.x,ua[ra+9]=Db.y,ua[ra+10]=Db.z,ua[ra+11]=Db.w,ua[ra+12]=Gc.x,ua[ra+13]=Gc.y,ua[ra+14]=Gc.z,ua[ra+15]=Gc.w,ra+=16;o.bindBuffer(o.ARRAY_BUFFER,ga.__webglTangentBuffer);o.bufferData(o.ARRAY_BUFFER,ua,Za)}if(Ud&&Pc){O=0;for(U=na.length;O<U;O++)if(S=Da[na[O]],jc=S.vertexNormals,gb=S.normal,3===jc.length&&uc)for(ma=0;3>ma;ma++)hc=jc[ma],pb[Ta]=hc.x,pb[Ta+1]=hc.y,pb[Ta+2]=hc.z,Ta+=3;else for(ma=0;3>ma;ma++)pb[Ta]=gb.x,pb[Ta+1]=gb.y,pb[Ta+2]=gb.z,Ta+=3;O=0;for(U=oa.length;O<U;O++)if(S=Da[oa[O]],jc=
S.vertexNormals,gb=S.normal,4===jc.length&&uc)for(ma=0;4>ma;ma++)hc=jc[ma],pb[Ta]=hc.x,pb[Ta+1]=hc.y,pb[Ta+2]=hc.z,Ta+=3;else for(ma=0;4>ma;ma++)pb[Ta]=gb.x,pb[Ta+1]=gb.y,pb[Ta+2]=gb.z,Ta+=3;o.bindBuffer(o.ARRAY_BUFFER,ga.__webglNormalBuffer);o.bufferData(o.ARRAY_BUFFER,pb,Za)}if(Ad&&sd&&Qc){O=0;for(U=na.length;O<U;O++)if(mb=na[O],S=Da[mb],Bb=sd[mb],void 0!==Bb)for(ma=0;3>ma;ma++)Cc=Bb[ma],Nc[Xb]=Cc.u,Nc[Xb+1]=Cc.v,Xb+=2;O=0;for(U=oa.length;O<U;O++)if(mb=oa[O],S=Da[mb],Bb=sd[mb],void 0!==Bb)for(ma=
0;4>ma;ma++)Cc=Bb[ma],Nc[Xb]=Cc.u,Nc[Xb+1]=Cc.v,Xb+=2;0<Xb&&(o.bindBuffer(o.ARRAY_BUFFER,ga.__webglUVBuffer),o.bufferData(o.ARRAY_BUFFER,Nc,Za))}if(Ad&&td&&Qc){O=0;for(U=na.length;O<U;O++)if(mb=na[O],S=Da[mb],kc=td[mb],void 0!==kc)for(ma=0;3>ma;ma++)Dc=kc[ma],Mc[Yb]=Dc.u,Mc[Yb+1]=Dc.v,Yb+=2;O=0;for(U=oa.length;O<U;O++)if(mb=oa[O],S=Da[mb],kc=td[mb],void 0!==kc)for(ma=0;4>ma;ma++)Dc=kc[ma],Mc[Yb]=Dc.u,Mc[Yb+1]=Dc.v,Yb+=2;0<Yb&&(o.bindBuffer(o.ARRAY_BUFFER,ga.__webglUV2Buffer),o.bufferData(o.ARRAY_BUFFER,
Mc,Za))}if(Td){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],Qb[ob]=Ba,Qb[ob+1]=Ba+1,Qb[ob+2]=Ba+2,ob+=3,db[Wa]=Ba,db[Wa+1]=Ba+1,db[Wa+2]=Ba,db[Wa+3]=Ba+2,db[Wa+4]=Ba+1,db[Wa+5]=Ba+2,Wa+=6,Ba+=3;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],Qb[ob]=Ba,Qb[ob+1]=Ba+1,Qb[ob+2]=Ba+3,Qb[ob+3]=Ba+1,Qb[ob+4]=Ba+2,Qb[ob+5]=Ba+3,ob+=6,db[Wa]=Ba,db[Wa+1]=Ba+1,db[Wa+2]=Ba,db[Wa+3]=Ba+3,db[Wa+4]=Ba+1,db[Wa+5]=Ba+2,db[Wa+6]=Ba+2,db[Wa+7]=Ba+3,Wa+=8,Ba+=4;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,ga.__webglFaceBuffer);o.bufferData(o.ELEMENT_ARRAY_BUFFER,
Qb,Za);o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,ga.__webglLineBuffer);o.bufferData(o.ELEMENT_ARRAY_BUFFER,db,Za)}if(nd){ma=0;for(Bd=nd.length;ma<Bd;ma++)if(G=nd[ma],G.__original.needsUpdate){K=0;if(1===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],G.array[K]=G.value[S.a],G.array[K+1]=G.value[S.b],G.array[K+2]=G.value[S.c],K+=3;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],G.array[K]=G.value[S.a],G.array[K+1]=G.value[S.b],G.array[K+2]=G.value[S.c],G.array[K+3]=
G.value[S.d],K+=4}else{if("faces"===G.boundTo){O=0;for(U=na.length;O<U;O++)eb=G.value[na[O]],G.array[K]=eb,G.array[K+1]=eb,G.array[K+2]=eb,K+=3;O=0;for(U=oa.length;O<U;O++)eb=G.value[oa[O]],G.array[K]=eb,G.array[K+1]=eb,G.array[K+2]=eb,G.array[K+3]=eb,K+=4}}else if(2===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=Y.x,G.array[K+3]=Y.y,G.array[K+4]=V.x,G.array[K+
5]=V.y,K+=6;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],ka=G.value[S.d],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=Y.x,G.array[K+3]=Y.y,G.array[K+4]=V.x,G.array[K+5]=V.y,G.array[K+6]=ka.x,G.array[K+7]=ka.y,K+=8}else{if("faces"===G.boundTo){O=0;for(U=na.length;O<U;O++)V=Y=X=eb=G.value[na[O]],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=Y.x,G.array[K+3]=Y.y,G.array[K+4]=V.x,G.array[K+5]=V.y,K+=6;O=0;for(U=oa.length;O<U;O++)ka=V=Y=X=eb=G.value[oa[O]],G.array[K]=
X.x,G.array[K+1]=X.y,G.array[K+2]=Y.x,G.array[K+3]=Y.y,G.array[K+4]=V.x,G.array[K+5]=V.y,G.array[K+6]=ka.x,G.array[K+7]=ka.y,K+=8}}else if(3===G.size){var ha;ha="c"===G.type?["r","g","b"]:["x","y","z"];if(void 0===G.boundTo||"vertices"===G.boundTo){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],G.array[K]=X[ha[0]],G.array[K+1]=X[ha[1]],G.array[K+2]=X[ha[2]],G.array[K+3]=Y[ha[0]],G.array[K+4]=Y[ha[1]],G.array[K+5]=Y[ha[2]],G.array[K+6]=V[ha[0]],G.array[K+7]=V[ha[1]],
G.array[K+8]=V[ha[2]],K+=9;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],ka=G.value[S.d],G.array[K]=X[ha[0]],G.array[K+1]=X[ha[1]],G.array[K+2]=X[ha[2]],G.array[K+3]=Y[ha[0]],G.array[K+4]=Y[ha[1]],G.array[K+5]=Y[ha[2]],G.array[K+6]=V[ha[0]],G.array[K+7]=V[ha[1]],G.array[K+8]=V[ha[2]],G.array[K+9]=ka[ha[0]],G.array[K+10]=ka[ha[1]],G.array[K+11]=ka[ha[2]],K+=12}else if("faces"===G.boundTo){O=0;for(U=na.length;O<U;O++)V=Y=X=eb=G.value[na[O]],G.array[K]=X[ha[0]],
G.array[K+1]=X[ha[1]],G.array[K+2]=X[ha[2]],G.array[K+3]=Y[ha[0]],G.array[K+4]=Y[ha[1]],G.array[K+5]=Y[ha[2]],G.array[K+6]=V[ha[0]],G.array[K+7]=V[ha[1]],G.array[K+8]=V[ha[2]],K+=9;O=0;for(U=oa.length;O<U;O++)ka=V=Y=X=eb=G.value[oa[O]],G.array[K]=X[ha[0]],G.array[K+1]=X[ha[1]],G.array[K+2]=X[ha[2]],G.array[K+3]=Y[ha[0]],G.array[K+4]=Y[ha[1]],G.array[K+5]=Y[ha[2]],G.array[K+6]=V[ha[0]],G.array[K+7]=V[ha[1]],G.array[K+8]=V[ha[2]],G.array[K+9]=ka[ha[0]],G.array[K+10]=ka[ha[1]],G.array[K+11]=ka[ha[2]],
K+=12}}else if(4===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo){O=0;for(U=na.length;O<U;O++)S=Da[na[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=X.z,G.array[K+3]=X.w,G.array[K+4]=Y.x,G.array[K+5]=Y.y,G.array[K+6]=Y.z,G.array[K+7]=Y.w,G.array[K+8]=V.x,G.array[K+9]=V.y,G.array[K+10]=V.z,G.array[K+11]=V.w,K+=12;O=0;for(U=oa.length;O<U;O++)S=Da[oa[O]],X=G.value[S.a],Y=G.value[S.b],V=G.value[S.c],ka=G.value[S.d],G.array[K]=X.x,G.array[K+1]=X.y,
G.array[K+2]=X.z,G.array[K+3]=X.w,G.array[K+4]=Y.x,G.array[K+5]=Y.y,G.array[K+6]=Y.z,G.array[K+7]=Y.w,G.array[K+8]=V.x,G.array[K+9]=V.y,G.array[K+10]=V.z,G.array[K+11]=V.w,G.array[K+12]=ka.x,G.array[K+13]=ka.y,G.array[K+14]=ka.z,G.array[K+15]=ka.w,K+=16}else if("faces"===G.boundTo){O=0;for(U=na.length;O<U;O++)V=Y=X=eb=G.value[na[O]],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=X.z,G.array[K+3]=X.w,G.array[K+4]=Y.x,G.array[K+5]=Y.y,G.array[K+6]=Y.z,G.array[K+7]=Y.w,G.array[K+8]=V.x,G.array[K+9]=V.y,
G.array[K+10]=V.z,G.array[K+11]=V.w,K+=12;O=0;for(U=oa.length;O<U;O++)ka=V=Y=X=eb=G.value[oa[O]],G.array[K]=X.x,G.array[K+1]=X.y,G.array[K+2]=X.z,G.array[K+3]=X.w,G.array[K+4]=Y.x,G.array[K+5]=Y.y,G.array[K+6]=Y.z,G.array[K+7]=Y.w,G.array[K+8]=V.x,G.array[K+9]=V.y,G.array[K+10]=V.z,G.array[K+11]=V.w,G.array[K+12]=ka.x,G.array[K+13]=ka.y,G.array[K+14]=ka.z,G.array[K+15]=ka.w,K+=16}o.bindBuffer(o.ARRAY_BUFFER,G.buffer);o.bufferData(o.ARRAY_BUFFER,G.array,Za)}}rd&&(delete ga.__inittedArrays,delete ga.__colorArray,
delete ga.__normalArray,delete ga.__tangentArray,delete ga.__uvArray,delete ga.__uv2Array,delete ga.__faceArray,delete ga.__vertexArray,delete ga.__lineArray,delete ga.__skinVertexAArray,delete ga.__skinVertexBArray,delete ga.__skinIndexArray,delete ga.__skinWeightArray)}}ia.verticesNeedUpdate=!1;ia.morphTargetsNeedUpdate=!1;ia.elementsNeedUpdate=!1;ia.uvsNeedUpdate=!1;ia.normalsNeedUpdate=!1;ia.colorsNeedUpdate=!1;ia.tangetsNeedUpdate=!1;Xa.attributes&&p(Xa)}else if(rb instanceof THREE.Ribbon){if(ia.verticesNeedUpdate||
ia.colorsNeedUpdate){var nc=ia,Id=o.DYNAMIC_DRAW,Rc=void 0,Sc=void 0,ad=void 0,oc=void 0,bd=void 0,Jd=nc.vertices,Kd=nc.colors,ie=Jd.length,je=Kd.length,cd=nc.__vertexArray,dd=nc.__colorArray,ke=nc.colorsNeedUpdate;if(nc.verticesNeedUpdate){for(Rc=0;Rc<ie;Rc++)ad=Jd[Rc],oc=3*Rc,cd[oc]=ad.x,cd[oc+1]=ad.y,cd[oc+2]=ad.z;o.bindBuffer(o.ARRAY_BUFFER,nc.__webglVertexBuffer);o.bufferData(o.ARRAY_BUFFER,cd,Id)}if(ke){for(Sc=0;Sc<je;Sc++)bd=Kd[Sc],oc=3*Sc,dd[oc]=bd.r,dd[oc+1]=bd.g,dd[oc+2]=bd.b;o.bindBuffer(o.ARRAY_BUFFER,
nc.__webglColorBuffer);o.bufferData(o.ARRAY_BUFFER,dd,Id)}}ia.verticesNeedUpdate=!1;ia.colorsNeedUpdate=!1}else if(rb instanceof THREE.Line){Xa=c(rb,sb);lb=Xa.attributes&&l(Xa);if(ia.verticesNeedUpdate||ia.colorsNeedUpdate||lb){var $b=ia,ud=o.DYNAMIC_DRAW,Tc=void 0,Uc=void 0,ed=void 0,za=void 0,fd=void 0,Ld=$b.vertices,Md=$b.colors,le=Ld.length,me=Md.length,gd=$b.__vertexArray,hd=$b.__colorArray,ne=$b.colorsNeedUpdate,vd=$b.__webglCustomAttributesList,id=void 0,Nd=void 0,Qa=void 0,Fc=void 0,ab=void 0,
ta=void 0;if($b.verticesNeedUpdate){for(Tc=0;Tc<le;Tc++)ed=Ld[Tc],za=3*Tc,gd[za]=ed.x,gd[za+1]=ed.y,gd[za+2]=ed.z;o.bindBuffer(o.ARRAY_BUFFER,$b.__webglVertexBuffer);o.bufferData(o.ARRAY_BUFFER,gd,ud)}if(ne){for(Uc=0;Uc<me;Uc++)fd=Md[Uc],za=3*Uc,hd[za]=fd.r,hd[za+1]=fd.g,hd[za+2]=fd.b;o.bindBuffer(o.ARRAY_BUFFER,$b.__webglColorBuffer);o.bufferData(o.ARRAY_BUFFER,hd,ud)}if(vd){id=0;for(Nd=vd.length;id<Nd;id++)if(ta=vd[id],ta.needsUpdate&&(void 0===ta.boundTo||"vertices"===ta.boundTo)){za=0;Fc=ta.value.length;
if(1===ta.size)for(Qa=0;Qa<Fc;Qa++)ta.array[Qa]=ta.value[Qa];else if(2===ta.size)for(Qa=0;Qa<Fc;Qa++)ab=ta.value[Qa],ta.array[za]=ab.x,ta.array[za+1]=ab.y,za+=2;else if(3===ta.size)if("c"===ta.type)for(Qa=0;Qa<Fc;Qa++)ab=ta.value[Qa],ta.array[za]=ab.r,ta.array[za+1]=ab.g,ta.array[za+2]=ab.b,za+=3;else for(Qa=0;Qa<Fc;Qa++)ab=ta.value[Qa],ta.array[za]=ab.x,ta.array[za+1]=ab.y,ta.array[za+2]=ab.z,za+=3;else if(4===ta.size)for(Qa=0;Qa<Fc;Qa++)ab=ta.value[Qa],ta.array[za]=ab.x,ta.array[za+1]=ab.y,ta.array[za+
2]=ab.z,ta.array[za+3]=ab.w,za+=4;o.bindBuffer(o.ARRAY_BUFFER,ta.buffer);o.bufferData(o.ARRAY_BUFFER,ta.array,ud)}}}ia.verticesNeedUpdate=!1;ia.colorsNeedUpdate=!1;Xa.attributes&&p(Xa)}else rb instanceof THREE.ParticleSystem&&(Xa=c(rb,sb),lb=Xa.attributes&&l(Xa),(ia.verticesNeedUpdate||ia.colorsNeedUpdate||rb.sortParticles||lb)&&f(ia,o.DYNAMIC_DRAW,rb),ia.verticesNeedUpdate=!1,ia.colorsNeedUpdate=!1,Xa.attributes&&p(Xa))}};this.initMaterial=function(a,b,c,d){var e,f,g;a instanceof THREE.MeshDepthMaterial?
g="depth":a instanceof THREE.MeshNormalMaterial?g="normal":a instanceof THREE.MeshBasicMaterial?g="basic":a instanceof THREE.MeshLambertMaterial?g="lambert":a instanceof THREE.MeshPhongMaterial?g="phong":a instanceof THREE.LineBasicMaterial?g="basic":a instanceof THREE.ParticleBasicMaterial&&(g="particle_basic");if(g){var h=THREE.ShaderLib[g];a.uniforms=THREE.UniformsUtils.clone(h.uniforms);a.vertexShader=h.vertexShader;a.fragmentShader=h.fragmentShader}var i,j,k,s,l;i=s=l=h=0;for(j=b.length;i<j;i++)k=
b[i],k.onlyShadow||(k instanceof THREE.DirectionalLight&&s++,k instanceof THREE.PointLight&&l++,k instanceof THREE.SpotLight&&h++);l+h+s<=M?(j=s,k=l,s=h):(j=Math.ceil(M*s/(l+s)),s=k=M-j);var u=0,h=0;for(l=b.length;h<l;h++)i=b[h],i.castShadow&&(i instanceof THREE.SpotLight&&u++,i instanceof THREE.DirectionalLight&&!i.shadowCascade&&u++);var p=50;void 0!==d&&d instanceof THREE.SkinnedMesh&&(p=d.bones.length);var n;a:{l=a.fragmentShader;i=a.vertexShader;var h=a.uniforms,b=a.attributes,c={map:!!a.map,
envMap:!!a.envMap,lightMap:!!a.lightMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,sizeAttenuation:a.sizeAttenuation,skinning:a.skinning,maxBones:p,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:j,maxPointLights:k,maxSpotLights:s,maxShadows:u,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapSoft:this.shadowMapSoft,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,
alphaTest:a.alphaTest,metal:a.metal,perPixel:a.perPixel,wrapAround:a.wrapAround,doubleSided:d&&d.doubleSided},m,d=[];g?d.push(g):(d.push(l),d.push(i));for(m in c)d.push(m),d.push(c[m]);g=d.join();m=0;for(d=Q.length;m<d;m++)if(Q[m].code===g){n=Q[m].program;break a}m=o.createProgram();d=["precision "+D+" float;",0<qa?"#define VERTEX_TEXTURES":"",I.gammaInput?"#define GAMMA_INPUT":"",I.gammaOutput?"#define GAMMA_OUTPUT":"",I.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+
c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_SHADOWS "+c.maxShadows,"#define MAX_BONES "+c.maxBones,c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.vertexColors?"#define USE_COLOR":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals?"#define USE_MORPHNORMALS":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":
"",c.doubleSided?"#define DOUBLE_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapSoft?"#define SHADOWMAP_SOFT":"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 objectMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinVertexA;\nattribute vec4 skinVertexB;\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");
j=["precision "+D+" float;","#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_SHADOWS "+c.maxShadows,c.alphaTest?"#define ALPHATEST "+c.alphaTest:"",I.gammaInput?"#define GAMMA_INPUT":"",I.gammaOutput?"#define GAMMA_OUTPUT":"",I.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fog instanceof THREE.FogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":
"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.vertexColors?"#define USE_COLOR":"",c.metal?"#define METAL":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapSoft?"#define SHADOWMAP_SOFT":"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");
o.attachShader(m,w("fragment",j+l));o.attachShader(m,w("vertex",d+i));o.linkProgram(m);o.getProgramParameter(m,o.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+o.getProgramParameter(m,o.VALIDATE_STATUS)+", gl error ["+o.getError()+"]");m.uniforms={};m.attributes={};var E,d="viewMatrix,modelViewMatrix,projectionMatrix,normalMatrix,objectMatrix,cameraPosition,boneGlobalMatrices,morphTargetInfluences".split(",");for(E in h)d.push(E);E=d;d=0;for(h=E.length;d<h;d++)l=E[d],
m.uniforms[l]=o.getUniformLocation(m,l);d="position,normal,uv,uv2,tangent,color,skinVertexA,skinVertexB,skinIndex,skinWeight".split(",");for(E=0;E<c.maxMorphTargets;E++)d.push("morphTarget"+E);for(E=0;E<c.maxMorphNormals;E++)d.push("morphNormal"+E);for(n in b)d.push(n);n=d;E=0;for(b=n.length;E<b;E++)c=n[E],m.attributes[c]=o.getAttribLocation(m,c);m.id=Q.length;Q.push({program:m,code:g});I.info.memory.programs=Q.length;n=m}a.program=n;n=a.program.attributes;0<=n.position&&o.enableVertexAttribArray(n.position);
0<=n.color&&o.enableVertexAttribArray(n.color);0<=n.normal&&o.enableVertexAttribArray(n.normal);0<=n.tangent&&o.enableVertexAttribArray(n.tangent);a.skinning&&0<=n.skinVertexA&&0<=n.skinVertexB&&0<=n.skinIndex&&0<=n.skinWeight&&(o.enableVertexAttribArray(n.skinVertexA),o.enableVertexAttribArray(n.skinVertexB),o.enableVertexAttribArray(n.skinIndex),o.enableVertexAttribArray(n.skinWeight));if(a.attributes)for(f in a.attributes)void 0!==n[f]&&0<=n[f]&&o.enableVertexAttribArray(n[f]);if(a.morphTargets){a.numSupportedMorphTargets=
0;m="morphTarget";for(f=0;f<this.maxMorphTargets;f++)E=m+f,0<=n[E]&&(o.enableVertexAttribArray(n[E]),a.numSupportedMorphTargets++)}if(a.morphNormals){a.numSupportedMorphNormals=0;m="morphNormal";for(f=0;f<this.maxMorphNormals;f++)E=m+f,0<=n[E]&&(o.enableVertexAttribArray(n[E]),a.numSupportedMorphNormals++)}a.uniformsList=[];for(e in a.uniforms)a.uniformsList.push([a.uniforms[e],e])};this.setFaceCulling=function(a,b){a?(!b||"ccw"===b?o.frontFace(o.CCW):o.frontFace(o.CW),"back"===a?o.cullFace(o.BACK):
"front"===a?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK),o.enable(o.CULL_FACE)):o.disable(o.CULL_FACE)};this.setObjectFaces=function(a){da!==a.doubleSided&&(a.doubleSided?o.disable(o.CULL_FACE):o.enable(o.CULL_FACE),da=a.doubleSided);aa!==a.flipSided&&(a.flipSided?o.frontFace(o.CW):o.frontFace(o.CCW),aa=a.flipSided)};this.setDepthTest=function(a){Ga!==a&&(a?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),Ga=a)};this.setDepthWrite=function(a){pa!==a&&(o.depthMask(a),pa=a)};this.setBlending=function(a,
b,c,d){if(a!==ba){switch(a){case THREE.NoBlending:o.disable(o.BLEND);break;case THREE.AdditiveBlending:o.enable(o.BLEND);o.blendEquation(o.FUNC_ADD);o.blendFunc(o.SRC_ALPHA,o.ONE);break;case THREE.SubtractiveBlending:o.enable(o.BLEND);o.blendEquation(o.FUNC_ADD);o.blendFunc(o.ZERO,o.ONE_MINUS_SRC_COLOR);break;case THREE.MultiplyBlending:o.enable(o.BLEND);o.blendEquation(o.FUNC_ADD);o.blendFunc(o.ZERO,o.SRC_COLOR);break;case THREE.CustomBlending:o.enable(o.BLEND);break;default:o.enable(o.BLEND),o.blendEquationSeparate(o.FUNC_ADD,
o.FUNC_ADD),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA)}ba=a}if(a===THREE.CustomBlending){if(b!==Z&&(o.blendEquation(F(b)),Z=b),c!==ca||d!==n)o.blendFunc(F(c),F(d)),ca=c,n=d}else n=ca=Z=null};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.__webglTexture=o.createTexture(),I.info.memory.textures++);o.activeTexture(o.TEXTURE0+b);o.bindTexture(o.TEXTURE_2D,a.__webglTexture);o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);
var c=a.image,d=0===(c.width&c.width-1)&&0===(c.height&c.height-1),e=F(a.format),f=F(a.type);z(o.TEXTURE_2D,a,d);a instanceof THREE.DataTexture?o.texImage2D(o.TEXTURE_2D,0,e,c.width,c.height,0,e,f,c.data):o.texImage2D(o.TEXTURE_2D,0,e,e,f,a.image);a.generateMipmaps&&d&&o.generateMipmap(o.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else o.activeTexture(o.TEXTURE0+b),o.bindTexture(o.TEXTURE_2D,a.__webglTexture)};this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;
if(a&&!a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.__webglTexture=o.createTexture();var c=0===(a.width&a.width-1)&&0===(a.height&a.height-1),d=F(a.format),e=F(a.type);if(b){a.__webglFramebuffer=[];a.__webglRenderbuffer=[];o.bindTexture(o.TEXTURE_CUBE_MAP,a.__webglTexture);z(o.TEXTURE_CUBE_MAP,a,c);for(var f=0;6>f;f++){a.__webglFramebuffer[f]=o.createFramebuffer();a.__webglRenderbuffer[f]=o.createRenderbuffer();o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+
f,0,d,a.width,a.height,0,d,e,null);var g=a,h=o.TEXTURE_CUBE_MAP_POSITIVE_X+f;o.bindFramebuffer(o.FRAMEBUFFER,a.__webglFramebuffer[f]);o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,h,g.__webglTexture,0);x(a.__webglRenderbuffer[f],a)}c&&o.generateMipmap(o.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=o.createFramebuffer(),a.__webglRenderbuffer=o.createRenderbuffer(),o.bindTexture(o.TEXTURE_2D,a.__webglTexture),z(o.TEXTURE_2D,a,c),o.texImage2D(o.TEXTURE_2D,0,d,a.width,a.height,0,d,e,null),d=
o.TEXTURE_2D,o.bindFramebuffer(o.FRAMEBUFFER,a.__webglFramebuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,a.__webglTexture,0),x(a.__webglRenderbuffer,a),c&&o.generateMipmap(o.TEXTURE_2D);b?o.bindTexture(o.TEXTURE_CUBE_MAP,null):o.bindTexture(o.TEXTURE_2D,null);o.bindRenderbuffer(o.RENDERBUFFER,null);o.bindFramebuffer(o.FRAMEBUFFER,null)}a?(b=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,c=a.width,a=a.height,e=d=0):(b=null,c=nb,a=Lb,d=Kb,e=vb);b!==H&&(o.bindFramebuffer(o.FRAMEBUFFER,
b),o.viewport(d,e,c,a),H=b);yb=c;Vb=a};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:THREE.RGBAFormat;this.type=void 0!==c.type?c.type:
THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0};
THREE.WebGLRenderTarget.prototype.clone=function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;return a};THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};
THREE.WebGLRenderTargetCube.prototype=new THREE.WebGLRenderTarget;THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};
THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterial=this.material=null;this.uvs=[[]];this.z=null};
THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterial=this.material=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};
THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.material=null};
THREE.ColorUtils={adjustHSV:function(a,b,c,d){var e=THREE.ColorUtils.__hsv;THREE.ColorUtils.rgbToHsv(a,e);e.h=THREE.Math.clamp(e.h+b,0,1);e.s=THREE.Math.clamp(e.s+c,0,1);e.v=THREE.Math.clamp(e.v+d,0,1);a.setHSV(e.h,e.s,e.v)},rgbToHsv:function(a,b){var c=a.r,d=a.g,e=a.b,f=Math.max(Math.max(c,d),e),g=Math.min(Math.min(c,d),e);if(g===f)g=c=0;else{var h=f-g,g=h/f,c=(c===f?(d-e)/h:d===f?2+(e-c)/h:4+(c-d)/h)/6;0>c&&(c+=1);1<c&&(c-=1)}void 0===b&&(b={h:0,s:0,v:0});b.h=c;b.s=g;b.v=f;return b}};
THREE.ColorUtils.__hsv={h:0,s:0,v:0};
THREE.GeometryUtils={merge:function(a,b){for(var c,d,e=a.vertices.length,f=b instanceof THREE.Mesh?b.geometry:b,g=a.vertices,h=f.vertices,i=a.faces,j=f.faces,k=a.faceVertexUvs[0],l=f.faceVertexUvs[0],p={},m=0;m<a.materials.length;m++)p[a.materials[m].id]=m;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),c=b.matrix,d=new THREE.Matrix4,d.extractRotation(c,b.scale));for(var m=0,r=h.length;m<r;m++){var q=h[m].clone();c&&c.multiplyVector3(q);g.push(q)}m=0;for(r=j.length;m<r;m++){var g=j[m],
t,v,w=g.vertexNormals,z=g.vertexColors;g instanceof THREE.Face3?t=new THREE.Face3(g.a+e,g.b+e,g.c+e):g instanceof THREE.Face4&&(t=new THREE.Face4(g.a+e,g.b+e,g.c+e,g.d+e));t.normal.copy(g.normal);d&&d.multiplyVector3(t.normal);h=0;for(q=w.length;h<q;h++)v=w[h].clone(),d&&d.multiplyVector3(v),t.vertexNormals.push(v);t.color.copy(g.color);h=0;for(q=z.length;h<q;h++)v=z[h],t.vertexColors.push(v.clone());void 0!==g.materialIndex&&(h=f.materials[g.materialIndex],q=h.id,z=p[q],void 0===z&&(z=a.materials.length,
p[q]=z,a.materials.push(h)),t.materialIndex=z);t.centroid.copy(g.centroid);c&&c.multiplyVector3(t.centroid);i.push(t)}m=0;for(r=l.length;m<r;m++){c=l[m];d=[];h=0;for(q=c.length;h<q;h++)d.push(new THREE.UV(c[h].u,c[h].v));k.push(d)}},clone:function(a){var b=new THREE.Geometry,c,d=a.vertices,e=a.faces,f=a.faceVertexUvs[0];a.materials&&(b.materials=a.materials.slice());a=0;for(c=d.length;a<c;a++)b.vertices.push(d[a].clone());a=0;for(c=e.length;a<c;a++)b.faces.push(e[a].clone());a=0;for(c=f.length;a<
c;a++){for(var d=f[a],e=[],g=0,h=d.length;g<h;g++)e.push(new THREE.UV(d[g].u,d[g].v));b.faceVertexUvs[0].push(e)}return b},randomPointInTriangle:function(a,b,c){var d,e,f,g=new THREE.Vector3,h=THREE.GeometryUtils.__v1;d=THREE.GeometryUtils.random();e=THREE.GeometryUtils.random();1<d+e&&(d=1-d,e=1-e);f=1-d-e;g.copy(a);g.multiplyScalar(d);h.copy(b);h.multiplyScalar(e);g.addSelf(h);h.copy(c);h.multiplyScalar(f);g.addSelf(h);return g},randomPointInFace:function(a,b,c){var d,e,f;if(a instanceof THREE.Face3)return d=
b.vertices[a.a],e=b.vertices[a.b],f=b.vertices[a.c],THREE.GeometryUtils.randomPointInTriangle(d,e,f);if(a instanceof THREE.Face4){d=b.vertices[a.a];e=b.vertices[a.b];f=b.vertices[a.c];var b=b.vertices[a.d],g;c?a._area1&&a._area2?(c=a._area1,g=a._area2):(c=THREE.GeometryUtils.triangleArea(d,e,b),g=THREE.GeometryUtils.triangleArea(e,f,b),a._area1=c,a._area2=g):(c=THREE.GeometryUtils.triangleArea(d,e,b),g=THREE.GeometryUtils.triangleArea(e,f,b));return THREE.GeometryUtils.random()*(c+g)<c?THREE.GeometryUtils.randomPointInTriangle(d,
e,b):THREE.GeometryUtils.randomPointInTriangle(e,f,b)}},randomPointsInGeometry:function(a,b){function c(a){function b(c,d){if(d<c)return c;var e=c+Math.floor((d-c)/2);return j[e]>a?b(c,e-1):j[e]<a?b(e+1,d):e}return b(0,j.length-1)}var d,e,f=a.faces,g=a.vertices,h=f.length,i=0,j=[],k,l,p,m;for(e=0;e<h;e++)d=f[e],d instanceof THREE.Face3?(k=g[d.a],l=g[d.b],p=g[d.c],d._area=THREE.GeometryUtils.triangleArea(k,l,p)):d instanceof THREE.Face4&&(k=g[d.a],l=g[d.b],p=g[d.c],m=g[d.d],d._area1=THREE.GeometryUtils.triangleArea(k,
l,m),d._area2=THREE.GeometryUtils.triangleArea(l,p,m),d._area=d._area1+d._area2),i+=d._area,j[e]=i;d=[];for(e=0;e<b;e++)g=THREE.GeometryUtils.random()*i,g=c(g),d[e]=THREE.GeometryUtils.randomPointInFace(f[g],a,!0);return d},triangleArea:function(a,b,c){var d,e=THREE.GeometryUtils.__v1;e.sub(a,b);d=e.length();e.sub(a,c);a=e.length();e.sub(b,c);c=e.length();b=0.5*(d+a+c);return Math.sqrt(b*(b-d)*(b-a)*(b-c))},center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.add(b.min,
b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},normalizeUVs:function(a){for(var a=a.faceVertexUvs[0],b=0,c=a.length;b<c;b++)for(var d=a[b],e=0,f=d.length;e<f;e++)if(1!==d[e].u&&(d[e].u-=Math.floor(d[e].u)),1!==d[e].v)d[e].v-=Math.floor(d[e].v)},triangulateQuads:function(a){var b,c,d,e,f=[],g=[],h=[];b=0;for(c=a.faceUvs.length;b<c;b++)g[b]=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)h[b]=[];b=0;for(c=a.faces.length;b<c;b++)if(d=
a.faces[b],d instanceof THREE.Face4){e=d.a;var i=d.b,j=d.c,k=d.d,l=new THREE.Face3,p=new THREE.Face3;l.color.copy(d.color);p.color.copy(d.color);l.materialIndex=d.materialIndex;p.materialIndex=d.materialIndex;l.a=e;l.b=i;l.c=k;p.a=i;p.b=j;p.c=k;4===d.vertexColors.length&&(l.vertexColors[0]=d.vertexColors[0].clone(),l.vertexColors[1]=d.vertexColors[1].clone(),l.vertexColors[2]=d.vertexColors[3].clone(),p.vertexColors[0]=d.vertexColors[1].clone(),p.vertexColors[1]=d.vertexColors[2].clone(),p.vertexColors[2]=
d.vertexColors[3].clone());f.push(l,p);d=0;for(e=a.faceVertexUvs.length;d<e;d++)a.faceVertexUvs[d].length&&(l=a.faceVertexUvs[d][b],i=l[1],j=l[2],k=l[3],l=[l[0].clone(),i.clone(),k.clone()],i=[i.clone(),j.clone(),k.clone()],h[d].push(l,i));d=0;for(e=a.faceUvs.length;d<e;d++)a.faceUvs[d].length&&(i=a.faceUvs[d][b],g[d].push(i,i))}else{f.push(d);d=0;for(e=a.faceUvs.length;d<e;d++)g[d].push(a.faceUvs[d]);d=0;for(e=a.faceVertexUvs.length;d<e;d++)h[d].push(a.faceVertexUvs[d])}a.faces=f;a.faceUvs=g;a.faceVertexUvs=
h;a.computeCentroids();a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()},explode:function(a){for(var b=[],c=0,d=a.faces.length;c<d;c++){var e=b.length,f=a.faces[c];if(f instanceof THREE.Face4){var g=f.a,h=f.b,i=f.c,g=a.vertices[g],h=a.vertices[h],i=a.vertices[i],j=a.vertices[f.d];b.push(g.clone());b.push(h.clone());b.push(i.clone());b.push(j.clone());f.a=e;f.b=e+1;f.c=e+2;f.d=e+3}else g=f.a,h=f.b,i=f.c,g=a.vertices[g],h=a.vertices[h],i=a.vertices[i],b.push(g.clone()),
b.push(h.clone()),b.push(i.clone()),f.a=e,f.b=e+1,f.c=e+2}a.vertices=b;delete a.__tmpVertices},tessellate:function(a,b){var c,d,e,f,g,h,i,j,k,l,p,m,r,q,t,v,w,z,x,A=[],F=[];c=0;for(d=a.faceVertexUvs.length;c<d;c++)F[c]=[];c=0;for(d=a.faces.length;c<d;c++)if(e=a.faces[c],e instanceof THREE.Face3)if(f=e.a,g=e.b,h=e.c,j=a.vertices[f],k=a.vertices[g],l=a.vertices[h],m=j.distanceTo(k),r=k.distanceTo(l),p=j.distanceTo(l),m>b||r>b||p>b){i=a.vertices.length;z=e.clone();x=e.clone();m>=r&&m>=p?(j=j.clone(),
j.lerpSelf(k,0.5),z.a=f,z.b=i,z.c=h,x.a=i,x.b=g,x.c=h,3===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),f.lerpSelf(e.vertexNormals[1],0.5),z.vertexNormals[1].copy(f),x.vertexNormals[0].copy(f)),3===e.vertexColors.length&&(f=e.vertexColors[0].clone(),f.lerpSelf(e.vertexColors[1],0.5),z.vertexColors[1].copy(f),x.vertexColors[0].copy(f)),e=0):r>=m&&r>=p?(j=k.clone(),j.lerpSelf(l,0.5),z.a=f,z.b=g,z.c=i,x.a=i,x.b=h,x.c=f,3===e.vertexNormals.length&&(f=e.vertexNormals[1].clone(),f.lerpSelf(e.vertexNormals[2],
0.5),z.vertexNormals[2].copy(f),x.vertexNormals[0].copy(f),x.vertexNormals[1].copy(e.vertexNormals[2]),x.vertexNormals[2].copy(e.vertexNormals[0])),3===e.vertexColors.length&&(f=e.vertexColors[1].clone(),f.lerpSelf(e.vertexColors[2],0.5),z.vertexColors[2].copy(f),x.vertexColors[0].copy(f),x.vertexColors[1].copy(e.vertexColors[2]),x.vertexColors[2].copy(e.vertexColors[0])),e=1):(j=j.clone(),j.lerpSelf(l,0.5),z.a=f,z.b=g,z.c=i,x.a=i,x.b=g,x.c=h,3===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),
f.lerpSelf(e.vertexNormals[2],0.5),z.vertexNormals[2].copy(f),x.vertexNormals[0].copy(f)),3===e.vertexColors.length&&(f=e.vertexColors[0].clone(),f.lerpSelf(e.vertexColors[2],0.5),z.vertexColors[2].copy(f),x.vertexColors[0].copy(f)),e=2);A.push(z,x);a.vertices.push(j);f=0;for(g=a.faceVertexUvs.length;f<g;f++)a.faceVertexUvs[f].length&&(j=a.faceVertexUvs[f][c],x=j[0],h=j[1],z=j[2],0===e?(k=x.clone(),k.lerpSelf(h,0.5),j=[x.clone(),k.clone(),z.clone()],h=[k.clone(),h.clone(),z.clone()]):1===e?(k=h.clone(),
k.lerpSelf(z,0.5),j=[x.clone(),h.clone(),k.clone()],h=[k.clone(),z.clone(),x.clone()]):(k=x.clone(),k.lerpSelf(z,0.5),j=[x.clone(),h.clone(),k.clone()],h=[k.clone(),h.clone(),z.clone()]),F[f].push(j,h))}else{A.push(e);f=0;for(g=a.faceVertexUvs.length;f<g;f++)F[f].push(a.faceVertexUvs[f][c])}else if(f=e.a,g=e.b,h=e.c,i=e.d,j=a.vertices[f],k=a.vertices[g],l=a.vertices[h],p=a.vertices[i],m=j.distanceTo(k),r=k.distanceTo(l),q=l.distanceTo(p),t=j.distanceTo(p),m>b||r>b||q>b||t>b){v=a.vertices.length;w=
a.vertices.length+1;z=e.clone();x=e.clone();m>=r&&m>=q&&m>=t||q>=r&&q>=m&&q>=t?(m=j.clone(),m.lerpSelf(k,0.5),k=l.clone(),k.lerpSelf(p,0.5),z.a=f,z.b=v,z.c=w,z.d=i,x.a=v,x.b=g,x.c=h,x.d=w,4===e.vertexNormals.length&&(f=e.vertexNormals[0].clone(),f.lerpSelf(e.vertexNormals[1],0.5),g=e.vertexNormals[2].clone(),g.lerpSelf(e.vertexNormals[3],0.5),z.vertexNormals[1].copy(f),z.vertexNormals[2].copy(g),x.vertexNormals[0].copy(f),x.vertexNormals[3].copy(g)),4===e.vertexColors.length&&(f=e.vertexColors[0].clone(),
f.lerpSelf(e.vertexColors[1],0.5),g=e.vertexColors[2].clone(),g.lerpSelf(e.vertexColors[3],0.5),z.vertexColors[1].copy(f),z.vertexColors[2].copy(g),x.vertexColors[0].copy(f),x.vertexColors[3].copy(g)),e=0):(m=k.clone(),m.lerpSelf(l,0.5),k=p.clone(),k.lerpSelf(j,0.5),z.a=f,z.b=g,z.c=v,z.d=w,x.a=w,x.b=v,x.c=h,x.d=i,4===e.vertexNormals.length&&(f=e.vertexNormals[1].clone(),f.lerpSelf(e.vertexNormals[2],0.5),g=e.vertexNormals[3].clone(),g.lerpSelf(e.vertexNormals[0],0.5),z.vertexNormals[2].copy(f),z.vertexNormals[3].copy(g),
x.vertexNormals[0].copy(g),x.vertexNormals[1].copy(f)),4===e.vertexColors.length&&(f=e.vertexColors[1].clone(),f.lerpSelf(e.vertexColors[2],0.5),g=e.vertexColors[3].clone(),g.lerpSelf(e.vertexColors[0],0.5),z.vertexColors[2].copy(f),z.vertexColors[3].copy(g),x.vertexColors[0].copy(g),x.vertexColors[1].copy(f)),e=1);A.push(z,x);a.vertices.push(m,k);f=0;for(g=a.faceVertexUvs.length;f<g;f++)a.faceVertexUvs[f].length&&(j=a.faceVertexUvs[f][c],x=j[0],h=j[1],z=j[2],j=j[3],0===e?(k=x.clone(),k.lerpSelf(h,
0.5),l=z.clone(),l.lerpSelf(j,0.5),x=[x.clone(),k.clone(),l.clone(),j.clone()],h=[k.clone(),h.clone(),z.clone(),l.clone()]):(k=h.clone(),k.lerpSelf(z,0.5),l=j.clone(),l.lerpSelf(x,0.5),x=[x.clone(),h.clone(),k.clone(),l.clone()],h=[l.clone(),k.clone(),z.clone(),j.clone()]),F[f].push(x,h))}else{A.push(e);f=0;for(g=a.faceVertexUvs.length;f<g;f++)F[f].push(a.faceVertexUvs[f][c])}a.faces=A;a.faceVertexUvs=F}};THREE.GeometryUtils.random=THREE.Math.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;
THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(a,b,c){var d=new Image,e=new THREE.Texture(d,b);d.onload=function(){e.needsUpdate=!0;c&&c(this)};d.crossOrigin=this.crossOrigin;d.src=a;return e},loadTextureCube:function(a,b,c){var d,e=[],f=new THREE.Texture(e,b),b=e.loadCount=0;for(d=a.length;b<d;++b)e[b]=new Image,e[b].onload=function(){e.loadCount+=1;6===e.loadCount&&(f.needsUpdate=!0);c&&c(this)},e[b].crossOrigin=this.crossOrigin,e[b].src=a[b];return f},getNormalMap:function(a,b){var c=
function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]},b=b|1,d=a.width,e=a.height,f=document.createElement("canvas");f.width=d;f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,d,e).data,i=g.createImageData(d,e),j=i.data,k=0;k<d;k++)for(var l=0;l<e;l++){var p=0>l-1?0:l-1,m=l+1>e-1?e-1:l+1,r=0>k-1?0:k-1,q=k+1>d-1?d-1:k+1,t=[],v=[0,0,h[4*(l*d+k)]/255*b];t.push([-1,0,h[4*(l*d+r)]/255*b]);t.push([-1,-1,h[4*(p*d+r)]/255*b]);t.push([0,
-1,h[4*(p*d+k)]/255*b]);t.push([1,-1,h[4*(p*d+q)]/255*b]);t.push([1,0,h[4*(l*d+q)]/255*b]);t.push([1,1,h[4*(m*d+q)]/255*b]);t.push([0,1,h[4*(m*d+k)]/255*b]);t.push([-1,1,h[4*(m*d+r)]/255*b]);p=[];r=t.length;for(m=0;m<r;m++){var q=t[m],w=t[(m+1)%r],q=[q[0]-v[0],q[1]-v[1],q[2]-v[2]],w=[w[0]-v[0],w[1]-v[1],w[2]-v[2]];p.push(c([q[1]*w[2]-q[2]*w[1],q[2]*w[0]-q[0]*w[2],q[0]*w[1]-q[1]*w[0]]))}t=[0,0,0];for(m=0;m<p.length;m++)t[0]+=p[m][0],t[1]+=p[m][1],t[2]+=p[m][2];t[0]/=p.length;t[1]/=p.length;t[2]/=p.length;
v=4*(l*d+k);j[v]=255*((t[0]+1)/2)|0;j[v+1]=255*(t[1]+0.5)|0;j[v+2]=255*t[2]|0;j[v+3]=255}g.putImageData(i,0,0);return f},generateDataTexture:function(a,b,c){for(var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),g=Math.floor(255*c.g),c=Math.floor(255*c.b),h=0;h<d;h++)e[3*h]=f,e[3*h+1]=g,e[3*h+2]=c;a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};
THREE.SceneUtils={showHierarchy:function(a,b){THREE.SceneUtils.traverseHierarchy(a,function(a){a.visible=b})},traverseHierarchy:function(a,b){var c,d,e=a.children.length;for(d=0;d<e;d++)c=a.children[d],b(c),THREE.SceneUtils.traverseHierarchy(c,b)},createMultiMaterialObject:function(a,b){var c,d=b.length,e=new THREE.Object3D;for(c=0;c<d;c++){var f=new THREE.Mesh(a,b[c]);e.add(f)}return e},cloneObject:function(a){var b;a instanceof THREE.MorphAnimMesh?(b=new THREE.MorphAnimMesh(a.geometry,a.material),
b.duration=a.duration,b.mirroredLoop=a.mirroredLoop,b.time=a.time,b.lastKeyframe=a.lastKeyframe,b.currentKeyframe=a.currentKeyframe,b.direction=a.direction,b.directionBackwards=a.directionBackwards):a instanceof THREE.SkinnedMesh?b=new THREE.SkinnedMesh(a.geometry,a.material):a instanceof THREE.Mesh?b=new THREE.Mesh(a.geometry,a.material):a instanceof THREE.Line?b=new THREE.Line(a.geometry,a.material,a.type):a instanceof THREE.Ribbon?b=new THREE.Ribbon(a.geometry,a.material):a instanceof THREE.ParticleSystem?
(b=new THREE.ParticleSystem(a.geometry,a.material),b.sortParticles=a.sortParticles):a instanceof THREE.Particle?b=new THREE.Particle(a.material):a instanceof THREE.Sprite?(b=new THREE.Sprite({}),b.color.copy(a.color),b.map=a.map,b.blending=a.blending,b.useScreenCoordinates=a.useScreenCoordinates,b.mergeWith3D=a.mergeWith3D,b.affectedByDistance=a.affectedByDistance,b.scaleByViewport=a.scaleByViewport,b.alignment=a.alignment,b.rotation3d.copy(a.rotation3d),b.rotation=a.rotation,b.opacity=a.opacity,
b.uvOffset.copy(a.uvOffset),b.uvScale.copy(a.uvScale)):a instanceof THREE.LOD?b=new THREE.LOD:a instanceof THREE.Object3D&&(b=new THREE.Object3D);b.name=a.name;b.parent=a.parent;b.up.copy(a.up);b.position.copy(a.position);b.rotation instanceof THREE.Vector3&&b.rotation.copy(a.rotation);b.eulerOrder=a.eulerOrder;b.scale.copy(a.scale);b.dynamic=a.dynamic;b.doubleSided=a.doubleSided;b.flipSided=a.flipSided;b.renderDepth=a.renderDepth;b.rotationAutoUpdate=a.rotationAutoUpdate;b.matrix.copy(a.matrix);
b.matrixWorld.copy(a.matrixWorld);b.matrixRotationWorld.copy(a.matrixRotationWorld);b.matrixAutoUpdate=a.matrixAutoUpdate;b.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;b.quaternion.copy(a.quaternion);b.useQuaternion=a.useQuaternion;b.boundRadius=a.boundRadius;b.boundRadiusScale=a.boundRadiusScale;b.visible=a.visible;b.castShadow=a.castShadow;b.receiveShadow=a.receiveShadow;b.frustumCulled=a.frustumCulled;for(var c=0;c<a.children.length;c++){var d=THREE.SceneUtils.cloneObject(a.children[c]);b.children[c]=
d;d.parent=b}if(a instanceof THREE.LOD)for(c=0;c<a.LODs.length;c++)b.LODs[c]={visibleAtDistance:a.LODs[c].visibleAtDistance,object3D:b.children[c]};return b},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.WebGLRenderer&&(THREE.ShaderUtils={lib:{fresnel:{uniforms:{mRefractionRatio:{type:"f",value:1.02},mFresnelBias:{type:"f",value:0.1},mFresnelPower:{type:"f",value:2},mFresnelScale:{type:"f",value:1},tCube:{type:"t",value:1,texture:null}},fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\nvec4 refractedColor = vec4( 1.0, 1.0, 1.0, 1.0 );\nrefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;\nrefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;\nrefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;\nrefractedColor.a = 1.0;\ngl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\n}",
vertexShader:"uniform float mRefractionRatio;\nuniform float mFresnelBias;\nuniform float mFresnelScale;\nuniform float mFresnelPower;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = normalize ( mat3( objectMatrix[0].xyz, objectMatrix[1].xyz, objectMatrix[2].xyz ) * normal );\nvec3 I = mPosition.xyz - cameraPosition;\nvReflect = reflect( I, nWorld );\nvRefract[0] = refract( normalize( I ), nWorld, mRefractionRatio );\nvRefract[1] = refract( normalize( I ), nWorld, mRefractionRatio * 0.99 );\nvRefract[2] = refract( normalize( I ), nWorld, mRefractionRatio * 0.98 );\nvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), nWorld ), mFresnelPower );\ngl_Position = projectionMatrix * mvPosition;\n}"},
normal:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},tDiffuse:{type:"t",value:0,texture:null},tCube:{type:"t",value:1,texture:null},tNormal:{type:"t",value:2,texture:null},tSpecular:{type:"t",value:3,texture:null},tAO:{type:"t",value:4,texture:null},tDisplacement:{type:"t",value:5,texture:null},uNormalScale:{type:"f",
value:1},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),
fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform float uNormalScale;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nfloat pointDistance = vPointLight[ i ].w;\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor) + totalSpecular;\nif ( enableReflection ) {\nvec3 wPos = cameraPosition - vViewPosition;\nvec3 vReflect = reflect( normalize( wPos ), normal );\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvViewPosition = -mvPosition.xyz;\nvNormal = normalMatrix * normal;\nvTangent = normalMatrix * tangent.xyz;\nvBinormal = cross( vNormal, vTangent ) * tangent.w;\nvUv = uv * uRepeat + uOffset;\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#ifdef VERTEX_TEXTURES\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\nvec4 displacedPosition = vec4( normalize( vNormal.xyz ) * df, 0.0 ) + mvPosition;\ngl_Position = projectionMatrix * displacedPosition;\n#else\ngl_Position = projectionMatrix * mvPosition;\n#endif",
THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:1,texture:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 wPos = cameraPosition - vViewPosition;\ngl_FragColor = textureCube( tCube, vec3( tFlip * wPos.x, wPos.yz ) );\n}"}}});
THREE.BufferGeometry=function(){this.id=THREE.GeometryCount++;this.vertexColorArray=this.vertexUvArray=this.vertexNormalArray=this.vertexPositionArray=this.vertexIndexArray=this.vertexColorBuffer=this.vertexUvBuffer=this.vertexNormalBuffer=this.vertexPositionBuffer=this.vertexIndexBuffer=null;this.dynamic=!1;this.boundingSphere=this.boundingBox=null;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,computeBoundingBox:function(){},computeBoundingSphere:function(){}};
THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){return this.getPoint(this.getUtoTmapping(a))};THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};
THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,f=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),f+=c.distanceTo(d),b.push(f),d=c;return this.cacheArcLengths=b};
THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,e=c.length,f;f=b?b:a*c[e-1];for(var g=0,h=e-1,i;g<=h;)if(d=Math.floor(g+(h-g)/2),i=c[d]-f,0>i)g=d+1;else if(0<i)h=d-1;else{h=d;break}d=h;if(c[d]==f)return d/(e-1);g=c[d];return(d+(f-g)/(c[d+1]-g))/(e-1)};THREE.Curve.prototype.getNormalVector=function(a){a=this.getTangent(a);return new THREE.Vector2(-a.y,a.x)};
THREE.Curve.prototype.getTangent=function(a){var b=a-1.0E-4,a=a+1.0E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().subSelf(b).normalize()};THREE.Curve.prototype.getTangentAt=function(a){return this.getTangent(this.getUtoTmapping(a))};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=new THREE.Curve;THREE.LineCurve.prototype.constructor=THREE.LineCurve;
THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().subSelf(this.v1);b.multiplyScalar(a).addSelf(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().subSelf(this.v1).normalize()};THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=new THREE.Curve;THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;
THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(b,a)};THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);b=new THREE.Vector2(b,a);b.normalize();return b};
THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=new THREE.Curve;THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};
THREE.CubicBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=new THREE.Vector2(b,a);b.normalize();return b};THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=new THREE.Curve;THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;
THREE.SplineCurve.prototype.getPoint=function(a){var b=new THREE.Vector2,c=[],d=this.points,e;e=(d.length-1)*a;a=Math.floor(e);e-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>d.length-2?d.length-1:a+1;c[3]=a>d.length-3?d.length-1:a+2;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);return b};
THREE.ArcCurve=function(a,b,c,d,e,f){this.aX=a;this.aY=b;this.aRadius=c;this.aStartAngle=d;this.aEndAngle=e;this.aClockwise=f};THREE.ArcCurve.prototype=new THREE.Curve;THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.ArcCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;this.aClockwise||(a=1-a);b=this.aStartAngle+a*b;a=this.aX+this.aRadius*Math.cos(b);b=this.aY+this.aRadius*Math.sin(b);return new THREE.Vector2(a,b)};
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){var a=0.5*(c-a),d=0.5*(d-b),f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}};
THREE.Curve.create=function(a,b){a.prototype=new THREE.Curve;a.prototype.constructor=a;a.prototype.getPoint=b;return a};THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.sub(this.v2,this.v1);b.multiplyScalar(a);b.addSelf(this.v1);return b});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b,c;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);a=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(b,c,a)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b,c;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);a=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(b,c,a)});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e,a=(d.length-1)*a;e=Math.floor(a);a-=e;c[0]=0==e?e:e-1;c[1]=e;c[2]=e>d.length-2?d.length-1:e+1;c[3]=e>d.length-3?d.length-1:e+2;e=d[c[0]];var f=d[c[1]],g=d[c[2]],c=d[c[3]];b.x=THREE.Curve.Utils.interpolate(e.x,f.x,g.x,c.x,a);b.y=THREE.Curve.Utils.interpolate(e.y,f.y,g.y,c.y,a);b.z=THREE.Curve.Utils.interpolate(e.z,f.z,g.z,c.z,a);return b});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e;e=(d.length-0)*a;a=Math.floor(e);e-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;c[0]=(a-1)%d.length;c[1]=a%d.length;c[2]=(a+1)%d.length;c[3]=(a+2)%d.length;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);b.z=THREE.Curve.Utils.interpolate(d[c[0]].z,
d[c[1]].z,d[c[2]].z,d[c[3]].z,e);return b});THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=new THREE.Curve;THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};THREE.CurvePath.prototype.getPoint=function(a){for(var b=a*this.getLength(),c=this.getCurveLengths(),a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,e;b=c=Number.NEGATIVE_INFINITY;d=e=Number.POSITIVE_INFINITY;var f,g,h,i;i=new THREE.Vector2;g=0;for(h=a.length;g<h;g++)f=a[g],f.x>b?b=f.x:f.x<d&&(d=f.x),f.y>c?c=f.y:f.y<c&&(e=f.y),i.addSelf(f.x,f.y);return{minX:d,minY:e,maxX:b,maxY:c,centroid:i.divideScalar(h)}};THREE.CurvePath.prototype.createPointsGeometry=function(a){return this.createGeometry(this.getPoints(a,!0))};
THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){return this.createGeometry(this.getSpacedPoints(a,!0))};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,e,f,g,h,i;d=0;for(e=a.length;d<e;d++)f=a[d],g=f.x,h=f.y,i=g/c.maxX,i=b.getUtoTmapping(i,g),g=b.getPoint(i),h=b.getNormalVector(i).multiplyScalar(h),f.x=g.x+h.x,f.y=g.y+h.y;return a};
THREE.EventTarget=function(){var a={};this.addEventListener=function(b,c){void 0==a[b]&&(a[b]=[]);-1===a[b].indexOf(c)&&a[b].push(c)};this.dispatchEvent=function(b){for(var c in a[b.type])a[b.type][c](b)};this.removeEventListener=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)}};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=new THREE.Object3D;THREE.Gyroscope.prototype.constructor=THREE.Gyroscope;
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=
!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=new THREE.CurvePath;THREE.Path.prototype.constructor=THREE.Path;THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc"};THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};
THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args;this.curves.push(new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b)));this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args;this.curves.push(new THREE.QuadraticBezierCurve(new THREE.Vector2(f[f.length-2],f[f.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d)));this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:e})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args;this.curves.push(new THREE.CubicBezierCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,f)));this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:g})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);this.curves.push(new THREE.SplineCurve(c));this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};
THREE.Path.prototype.arc=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1],h=new THREE.ArcCurve(h.x+a,h.y+b,c,d,e,f);this.curves.push(h);h=h.getPoint(f?1:0);g.push(h.x);g.push(h.y);this.actions.push({action:THREE.PathActions.ARC,args:g})};
THREE.Path.prototype.absarc=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=new THREE.ArcCurve(a,b,c,d,e,f);this.curves.push(h);h=h.getPoint(f?1:0);g.push(h.x);g.push(h.y);this.actions.push({action:THREE.PathActions.ARC,args:g})};THREE.Path.prototype.getSpacedPoints=function(a){a||(a=40);for(var b=[],c=0;c<a;c++)b.push(this.getPoint(c/a));return b};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);var a=a||12,c=[],d,e,f,g,h,i,j,k,l,p,m,r,q;d=0;for(e=this.actions.length;d<e;d++)switch(f=this.actions[d],g=f.action,f=f.args,g){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:h=f[2];i=f[3];l=f[0];p=f[1];0<c.length?(g=c[c.length-1],m=g.x,
r=g.y):(g=this.actions[d-1].args,m=g[g.length-2],r=g[g.length-1]);for(f=1;f<=a;f++)q=f/a,g=THREE.Shape.Utils.b2(q,m,l,h),q=THREE.Shape.Utils.b2(q,r,p,i),c.push(new THREE.Vector2(g,q));break;case THREE.PathActions.BEZIER_CURVE_TO:h=f[4];i=f[5];l=f[0];p=f[1];j=f[2];k=f[3];0<c.length?(g=c[c.length-1],m=g.x,r=g.y):(g=this.actions[d-1].args,m=g[g.length-2],r=g[g.length-1]);for(f=1;f<=a;f++)q=f/a,g=THREE.Shape.Utils.b3(q,m,l,j,h),q=THREE.Shape.Utils.b3(q,r,p,k,i),c.push(new THREE.Vector2(g,q));break;case THREE.PathActions.CSPLINE_THRU:g=
this.actions[d-1].args;q=[new THREE.Vector2(g[g.length-2],g[g.length-1])];g=a*f[0].length;q=q.concat(f[0]);q=new THREE.SplineCurve(q);for(f=1;f<=g;f++)c.push(q.getPointAt(f/g));break;case THREE.PathActions.ARC:h=f[0];i=f[1];j=f[2];l=f[3];p=!!f[5];k=f[4]-l;m=2*a;for(f=1;f<=m;f++)q=f/m,p||(q=1-q),q=l+q*k,g=h+j*Math.cos(q),q=i+j*Math.sin(q),c.push(new THREE.Vector2(g,q))}d=c[c.length-1];1.0E-10>Math.abs(d.x-c[0].x)&&1.0E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.transform=function(a,b){this.getBoundingBox();return this.getWrapPoints(this.getPoints(b),a)};THREE.Path.prototype.nltransform=function(a,b,c,d,e,f){var g=this.getPoints(),h,i,j,k,l;h=0;for(i=g.length;h<i;h++)j=g[h],k=j.x,l=j.y,j.x=a*k+b*l+c,j.y=d*l+e*k+f;return g};
THREE.Path.prototype.debug=function(a){var b=this.getBoundingBox();a||(a=document.createElement("canvas"),a.setAttribute("width",b.maxX+100),a.setAttribute("height",b.maxY+100),document.body.appendChild(a));b=a.getContext("2d");b.fillStyle="white";b.fillRect(0,0,a.width,a.height);b.strokeStyle="black";b.beginPath();var c,d,e,a=0;for(c=this.actions.length;a<c;a++)d=this.actions[a],e=d.args,d=d.action,d!=THREE.PathActions.CSPLINE_THRU&&b[d].apply(b,e);b.stroke();b.closePath();b.strokeStyle="red";d=
this.getPoints();a=0;for(c=d.length;a<c;a++)e=d[a],b.beginPath(),b.arc(e.x,e.y,1.5,0,2*Math.PI,!1),b.stroke(),b.closePath()};
THREE.Path.prototype.toShapes=function(){var a,b,c,d,e=[],f=new THREE.Path;a=0;for(b=this.actions.length;a<b;a++)c=this.actions[a],d=c.args,c=c.action,c==THREE.PathActions.MOVE_TO&&0!=f.actions.length&&(e.push(f),f=new THREE.Path),f[c].apply(f,d);0!=f.actions.length&&e.push(f);if(0==e.length)return[];var g;d=[];a=!THREE.Shape.Utils.isClockWise(e[0].getPoints());if(1==e.length)return f=e[0],g=new THREE.Shape,g.actions=f.actions,g.curves=f.curves,d.push(g),d;if(a){g=new THREE.Shape;a=0;for(b=e.length;a<
b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(g.actions=f.actions,g.curves=f.curves,d.push(g),g=new THREE.Shape):g.holes.push(f)}else{a=0;for(b=e.length;a<b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(g&&d.push(g),g=new THREE.Shape,g.actions=f.actions,g.curves=f.curves):g.holes.push(f);d.push(g)}return d};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=new THREE.Path;THREE.Shape.prototype.constructor=THREE.Path;
THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};
THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={removeHoles:function(a,b){var c=a.concat(),d=c.concat(),e,f,g,h,i,j,k,l,p,m,r=[];for(i=0;i<b.length;i++){j=b[i];Array.prototype.push.apply(d,j);f=Number.POSITIVE_INFINITY;for(e=0;e<j.length;e++){p=j[e];m=[];for(l=0;l<c.length;l++)k=c[l],k=p.distanceToSquared(k),m.push(k),k<f&&(f=k,g=e,h=l)}e=0<=h-1?h-1:c.length-1;f=0<=g-1?g-1:j.length-1;var q=[j[g],c[h],c[e]];l=THREE.FontUtils.Triangulate.area(q);var t=[j[g],j[f],c[h]];p=THREE.FontUtils.Triangulate.area(t);m=h;k=g;h+=1;g+=-1;0>
h&&(h+=c.length);h%=c.length;0>g&&(g+=j.length);g%=j.length;e=0<=h-1?h-1:c.length-1;f=0<=g-1?g-1:j.length-1;q=[j[g],c[h],c[e]];q=THREE.FontUtils.Triangulate.area(q);t=[j[g],j[f],c[h]];t=THREE.FontUtils.Triangulate.area(t);l+p>q+t&&(h=m,g=k,0>h&&(h+=c.length),h%=c.length,0>g&&(g+=j.length),g%=j.length,e=0<=h-1?h-1:c.length-1,f=0<=g-1?g-1:j.length-1);l=c.slice(0,h);p=c.slice(h);m=j.slice(g);k=j.slice(0,g);f=[j[g],j[f],c[h]];r.push([j[g],c[h],c[e]]);r.push(f);c=l.concat(m).concat(k).concat(p)}return{shape:c,
isolatedPts:r,allpoints:d}},triangulateShape:function(a,b){var c=THREE.Shape.Utils.removeHoles(a,b),d=c.allpoints,e=c.isolatedPts,c=THREE.FontUtils.Triangulate(c.shape,!1),f,g,h,i,j={};f=0;for(g=d.length;f<g;f++)i=d[f].x+":"+d[f].y,void 0!==j[i]&&console.log("Duplicate point",i),j[i]=f;f=0;for(g=c.length;f<g;f++){h=c[f];for(d=0;3>d;d++)i=h[d].x+":"+h[d].y,i=j[i],void 0!==i&&(h[d]=i)}f=0;for(g=e.length;f<g;f++){h=e[f];for(d=0;3>d;d++)i=h[d].x+":"+h[d].y,i=j[i],void 0!==i&&(h[d]=i)}return c.concat(e)},
isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+
this.b3p3(a,e)}};THREE.TextPath=function(a,b){THREE.Path.call(this);this.parameters=b||{};this.set(a)};THREE.TextPath.prototype.set=function(a,b){b=b||this.parameters;this.text=a;var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",e=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=e;THREE.FontUtils.style=f};
THREE.TextPath.prototype.toShapes=function(){for(var a=THREE.FontUtils.drawText(this.text).paths,b=[],c=0,d=a.length;c<d;c++)Array.prototype.push.apply(b,a[c].toShapes());return b};
THREE.AnimationHandler=function(){var a=[],b={},c={update:function(b){for(var c=0;c<a.length;c++)a[c].update(b)},addToUpdate:function(b){-1===a.indexOf(b)&&a.push(b)},removeFromUpdate:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},add:function(a){void 0!==b[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");b[a.name]=a;if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var d=0;d<a.hierarchy[c].keys.length;d++)if(0>a.hierarchy[c].keys[d].time&&
(a.hierarchy[c].keys[d].time=0),void 0!==a.hierarchy[c].keys[d].rot&&!(a.hierarchy[c].keys[d].rot instanceof THREE.Quaternion)){var h=a.hierarchy[c].keys[d].rot;a.hierarchy[c].keys[d].rot=new THREE.Quaternion(h[0],h[1],h[2],h[3])}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){h={};for(d=0;d<a.hierarchy[c].keys.length;d++)for(var i=0;i<a.hierarchy[c].keys[d].morphTargets.length;i++){var j=a.hierarchy[c].keys[d].morphTargets[i];h[j]=-1}a.hierarchy[c].usedMorphTargets=h;
for(d=0;d<a.hierarchy[c].keys.length;d++){var k={};for(j in h){for(i=0;i<a.hierarchy[c].keys[d].morphTargets.length;i++)if(a.hierarchy[c].keys[d].morphTargets[i]===j){k[j]=a.hierarchy[c].keys[d].morphTargetsInfluences[i];break}i===a.hierarchy[c].keys[d].morphTargets.length&&(k[j]=0)}a.hierarchy[c].keys[d].morphTargetsInfluences=k}}for(d=1;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].time===a.hierarchy[c].keys[d-1].time&&(a.hierarchy[c].keys.splice(d,1),d--);for(d=0;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].index=
d}d=parseInt(a.length*a.fps,10);a.JIT={};a.JIT.hierarchy=[];for(c=0;c<a.hierarchy.length;c++)a.JIT.hierarchy.push(Array(d));a.initialized=!0}},get:function(a){if("string"===typeof a){if(b[a])return b[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(a){var b=[];if(a instanceof THREE.SkinnedMesh)for(var c=0;c<a.bones.length;c++)b.push(a.bones[c]);else d(a,b);return b}},d=function(a,b){b.push(a);for(var c=0;c<a.children.length;c++)d(a.children[c],
b)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();THREE.Animation=function(a,b,c,d){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==c?c:THREE.AnimationHandler.LINEAR;this.JITCompile=void 0!==d?d:!0;this.points=[];this.target=new THREE.Vector3};
THREE.Animation.prototype.play=function(a,b){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;var c,d=this.hierarchy.length,e;for(c=0;c<d;c++){e=this.hierarchy[c];this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(e.useQuaternion=!0);e.matrixAutoUpdate=!0;void 0===e.animationCache&&(e.animationCache={},e.animationCache.prevKey={pos:0,rot:0,scl:0},e.animationCache.nextKey={pos:0,rot:0,scl:0},e.animationCache.originalMatrix=e instanceof
THREE.Bone?e.skinMatrix:e.matrix);var f=e.animationCache.prevKey;e=e.animationCache.nextKey;f.pos=this.data.hierarchy[c].keys[0];f.rot=this.data.hierarchy[c].keys[0];f.scl=this.data.hierarchy[c].keys[0];e.pos=this.getNextKeyWith("pos",c,1);e.rot=this.getNextKeyWith("rot",c,1);e.scl=this.getNextKeyWith("scl",c,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.hierarchy.length;a++)void 0!==this.hierarchy[a].animationCache&&(this.hierarchy[a]instanceof THREE.Bone?this.hierarchy[a].skinMatrix=this.hierarchy[a].animationCache.originalMatrix:this.hierarchy[a].matrix=this.hierarchy[a].animationCache.originalMatrix,delete this.hierarchy[a].animationCache)};
THREE.Animation.prototype.update=function(a){if(this.isPlaying){var b=["pos","rot","scl"],c,d,e,f,g,h,i,j,k=this.data.JIT.hierarchy,l,p;p=this.currentTime+=a*this.timeScale;l=this.currentTime%=this.data.length;j=parseInt(Math.min(l*this.data.fps,this.data.length*this.data.fps),10);for(var m=0,r=this.hierarchy.length;m<r;m++)if(a=this.hierarchy[m],i=a.animationCache,this.JITCompile&&void 0!==k[m][j])a instanceof THREE.Bone?(a.skinMatrix=k[m][j],a.matrixAutoUpdate=!1,a.matrixWorldNeedsUpdate=!1):(a.matrix=
k[m][j],a.matrixAutoUpdate=!1,a.matrixWorldNeedsUpdate=!0);else{this.JITCompile&&(a instanceof THREE.Bone?a.skinMatrix=a.animationCache.originalMatrix:a.matrix=a.animationCache.originalMatrix);for(var q=0;3>q;q++){c=b[q];g=i.prevKey[c];h=i.nextKey[c];if(h.time<=p){if(l<p)if(this.loop){g=this.data.hierarchy[m].keys[0];for(h=this.getNextKeyWith(c,m,1);h.time<l;)g=h,h=this.getNextKeyWith(c,m,h.index+1)}else{this.stop();return}else{do g=h,h=this.getNextKeyWith(c,m,h.index+1);while(h.time<l)}i.prevKey[c]=
g;i.nextKey[c]=h}a.matrixAutoUpdate=!0;a.matrixWorldNeedsUpdate=!0;d=(l-g.time)/(h.time-g.time);e=g[c];f=h[c];if(0>d||1<d)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+d+" on bone "+m),d=0>d?0:1;if("pos"===c)if(c=a.position,this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+(f[2]-e[2])*d;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=
this.getPrevKeyWith("pos",m,g.index-1).pos,this.points[1]=e,this.points[2]=f,this.points[3]=this.getNextKeyWith("pos",m,h.index+1).pos,d=0.33*d+0.33,e=this.interpolateCatmullRom(this.points,d),c.x=e[0],c.y=e[1],c.z=e[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(d=this.interpolateCatmullRom(this.points,1.01*d),this.target.set(d[0],d[1],d[2]),this.target.subSelf(c),this.target.y=0,this.target.normalize(),d=Math.atan2(this.target.x,this.target.z),a.rotation.set(0,d,0))}else"rot"===
c?THREE.Quaternion.slerp(e,f,a.quaternion,d):"scl"===c&&(c=a.scale,c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+(f[2]-e[2])*d)}}if(this.JITCompile&&void 0===k[0][j]){this.hierarchy[0].updateMatrixWorld(!0);for(m=0;m<this.hierarchy.length;m++)k[m][j]=this.hierarchy[m]instanceof THREE.Bone?this.hierarchy[m].skinMatrix.clone():this.hierarchy[m].matrix.clone()}}};
THREE.Animation.prototype.interpolateCatmullRom=function(a,b){var c=[],d=[],e,f,g,h,i,j;e=(a.length-1)*b;f=Math.floor(e);e-=f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>a.length-2?f:f+1;c[3]=f>a.length-3?f:f+2;f=a[c[0]];h=a[c[1]];i=a[c[2]];j=a[c[3]];c=e*e;g=e*c;d[0]=this.interpolate(f[0],h[0],i[0],j[0],e,c,g);d[1]=this.interpolate(f[1],h[1],i[1],j[1],e,c,g);d[2]=this.interpolate(f[2],h[2],i[2],j[2],e,c,g);return d};
THREE.Animation.prototype.interpolate=function(a,b,c,d,e,f,g){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b};THREE.Animation.prototype.getNextKeyWith=function(a,b,c){for(var d=this.data.hierarchy[b].keys,c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){for(var d=this.data.hierarchy[b].keys,c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]};
THREE.KeyFrameAnimation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=0.0010;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==c?c:!0;a=0;for(b=this.hierarchy.length;a<b;a++){var c=this.data.hierarchy[a].sids,d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var e=0;e<c.length;e++){var f=c[e],g=this.getNextKeyWith(f,a,0);g&&g.apply(f)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a,b){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;this.startTimeMs=b;this.startTime=1E7;this.endTime=-this.startTime;var c,d=this.hierarchy.length,e,f;for(c=0;c<d;c++)if(e=this.hierarchy[c],f=this.data.hierarchy[c],e.useQuaternion=!0,void 0===f.animationCache&&(f.animationCache={},f.animationCache.prevKey=null,f.animationCache.nextKey=null,f.animationCache.originalMatrix=e instanceof THREE.Bone?e.skinMatrix:
e.matrix),e=this.data.hierarchy[c].keys,e.length)f.animationCache.prevKey=e[0],f.animationCache.nextKey=e[1],this.startTime=Math.min(e[0].time,this.startTime),this.endTime=Math.max(e[e.length-1].time,this.endTime);this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;b instanceof THREE.Bone?(d.copy(b.skinMatrix),b.skinMatrix=d):(d.copy(b.matrix),b.matrix=d);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(this.isPlaying){var b,c,d,e,f=this.data.JIT.hierarchy,g,h,i;h=this.currentTime+=a*this.timeScale;g=this.currentTime%=this.data.length;g<this.startTimeMs&&(g=this.currentTime=this.startTimeMs+g);e=parseInt(Math.min(g*this.data.fps,this.data.length*this.data.fps),10);if((i=g<h)&&!this.loop){for(var a=0,j=this.hierarchy.length;a<j;a++){var k=this.data.hierarchy[a].keys,f=this.data.hierarchy[a].sids;d=k.length-1;e=this.hierarchy[a];if(k.length){for(k=
0;k<f.length;k++)g=f[k],(h=this.getPrevKeyWith(g,a,d))&&h.apply(g);this.data.hierarchy[a].node.updateMatrix();e.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(g<this.startTime)){a=0;for(j=this.hierarchy.length;a<j;a++){d=this.hierarchy[a];b=this.data.hierarchy[a];var k=b.keys,l=b.animationCache;if(this.JITCompile&&void 0!==f[a][e])d instanceof THREE.Bone?(d.skinMatrix=f[a][e],d.matrixWorldNeedsUpdate=!1):(d.matrix=f[a][e],d.matrixWorldNeedsUpdate=!0);else if(k.length){this.JITCompile&&l&&(d instanceof
THREE.Bone?d.skinMatrix=l.originalMatrix:d.matrix=l.originalMatrix);b=l.prevKey;c=l.nextKey;if(b&&c){if(c.time<=h){if(i&&this.loop){b=k[0];for(c=k[1];c.time<g;)b=c,c=k[b.index+1]}else if(!i)for(var p=k.length-1;c.time<g&&c.index!==p;)b=c,c=k[b.index+1];l.prevKey=b;l.nextKey=c}c.time>=g?b.interpolate(c,g):b.interpolate(c,c.time)}this.data.hierarchy[a].node.updateMatrix();d.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===f[0][e]){this.hierarchy[0].updateMatrixWorld(!0);for(a=0;a<this.hierarchy.length;a++)f[a][e]=
this.hierarchy[a]instanceof THREE.Bone?this.hierarchy[a].skinMatrix.clone():this.hierarchy[a].matrix.clone()}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(-1,0,0));this.add(e);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1);f.lookAt(new THREE.Vector3(0,1,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new THREE.Vector3(0,-1,0));this.add(g);var h=new THREE.PerspectiveCamera(90,
1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var i=new THREE.PerspectiveCamera(90,1,a,b);i.up.set(0,-1,0);i.lookAt(new THREE.Vector3(0,0,-1));this.add(i);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,p=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=
2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.generateMipmaps=p;c.activeCubeFace=5;a.render(b,i,c)}};THREE.CubeCamera.prototype=new THREE.Object3D;THREE.CubeCamera.prototype.constructor=THREE.CubeCamera;
THREE.CombinedCamera=function(a,b,c,d,e,f,g){THREE.Camera.call(this);this.fov=c;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.cameraO=new THREE.OrthographicCamera(a/-2,a/2,b/2,b/-2,f,g);this.cameraP=new THREE.PerspectiveCamera(c,a/b,d,e);this.zoom=1;this.toPerspective()};THREE.CombinedCamera.prototype=new THREE.Camera;THREE.CombinedCamera.prototype.constructor=THREE.CombinedCamera;
THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPersepectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var a=this.cameraP.aspect,b=(this.cameraP.near+this.cameraP.far)/2,b=Math.tan(this.fov/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.cameraO.left=-a;this.cameraO.right=a;this.cameraO.top=b;this.cameraO.bottom=-b;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPersepectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(a,b){this.cameraP.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;this.inPersepectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPersepectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(a,b){var c=2*Math.atan((void 0!==b?b:24)/(2*a))*(180/Math.PI);this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;this.inPersepectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.FirstPersonControls=function(a,b){function c(a,b){return function(){b.apply(a,arguments)}}this.object=a;this.target=new THREE.Vector3(0,0,0);this.domElement=void 0!==b?b:document;this.movementSpeed=1;this.lookSpeed=0.0050;this.noFly=!1;this.lookVertical=!0;this.autoForward=!1;this.activeLook=!0;this.heightSpeed=!1;this.heightCoef=1;this.heightMin=0;this.constrainVertical=!1;this.verticalMin=0;this.verticalMax=Math.PI;this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=this.autoSpeedFactor=
0;this.mouseDragOn=this.freeze=this.moveRight=this.moveLeft=this.moveBackward=this.moveForward=!1;this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2,this.domElement.setAttribute("tabindex",-1));this.onMouseDown=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();if(this.activeLook)switch(a.button){case 0:this.moveForward=
true;break;case 2:this.moveBackward=true}this.mouseDragOn=true};this.onMouseUp=function(a){a.preventDefault();a.stopPropagation();if(this.activeLook)switch(a.button){case 0:this.moveForward=false;break;case 2:this.moveBackward=false}this.mouseDragOn=false};this.onMouseMove=function(a){if(this.domElement===document){this.mouseX=a.pageX-this.viewHalfX;this.mouseY=a.pageY-this.viewHalfY}else{this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX;this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY}};
this.onKeyDown=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=true;break;case 37:case 65:this.moveLeft=true;break;case 40:case 83:this.moveBackward=true;break;case 39:case 68:this.moveRight=true;break;case 82:this.moveUp=true;break;case 70:this.moveDown=true;break;case 81:this.freeze=!this.freeze}};this.onKeyUp=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=false;break;case 37:case 65:this.moveLeft=false;break;case 40:case 83:this.moveBackward=false;break;case 39:case 68:this.moveRight=
false;break;case 82:this.moveUp=false;break;case 70:this.moveDown=false}};this.update=function(a){var b=0;if(!this.freeze){if(this.heightSpeed){b=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=a*b*this.heightCoef}else this.autoSpeedFactor=0;b=a*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(b+this.autoSpeedFactor));this.moveBackward&&this.object.translateZ(b);this.moveLeft&&this.object.translateX(-b);
this.moveRight&&this.object.translateX(b);this.moveUp&&this.object.translateY(b);this.moveDown&&this.object.translateY(-b);a=a*this.lookSpeed;this.activeLook||(a=0);this.lon=this.lon+this.mouseX*a;if(this.lookVertical)this.lat=this.lat-this.mouseY*a;this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;var b=this.target,c=this.object.position;b.x=c.x+100*Math.sin(this.phi)*Math.cos(this.theta);b.y=c.y+100*Math.cos(this.phi);b.z=c.z+100*Math.sin(this.phi)*
Math.sin(this.theta);b=1;this.constrainVertical&&(b=Math.PI/(this.verticalMax-this.verticalMin));this.lon=this.lon+this.mouseX*a;if(this.lookVertical)this.lat=this.lat-this.mouseY*a*b;this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;if(this.constrainVertical)this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax);b=this.target;c=this.object.position;b.x=c.x+100*Math.sin(this.phi)*Math.cos(this.theta);b.y=c.y+
100*Math.cos(this.phi);b.z=c.z+100*Math.sin(this.phi)*Math.sin(this.theta);this.object.lookAt(b)}};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousemove",c(this,this.onMouseMove),!1);this.domElement.addEventListener("mousedown",c(this,this.onMouseDown),!1);this.domElement.addEventListener("mouseup",c(this,this.onMouseUp),!1);this.domElement.addEventListener("keydown",c(this,this.onKeyDown),!1);this.domElement.addEventListener("keyup",
c(this,this.onKeyUp),!1)};
THREE.PathControls=function(a,b){function c(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}function d(a,b){return function(){b.apply(a,arguments)}}function e(a,b,c,d){var e={name:c,fps:0.6,length:d,hierarchy:[]},f,g=b.getControlPointsArray(),h=b.getLength(),t=g.length,v=0;f=t-1;b={parent:-1,keys:[]};b.keys[0]={time:0,pos:g[0],rot:[0,0,0,1],scl:[1,1,1]};b.keys[f]={time:d,pos:g[f],rot:[0,0,0,1],scl:[1,1,1]};for(f=1;f<t-1;f++)v=d*h.chunks[f]/h.total,b.keys[f]={time:v,pos:g[f]};e.hierarchy[0]=b;THREE.AnimationHandler.add(e);
return new THREE.Animation(a,c,THREE.AnimationHandler.CATMULLROM_FORWARD,!1)}function f(a,b){var c,d,e=new THREE.Geometry;for(c=0;c<a.points.length*b;c++)d=c/(a.points.length*b),d=a.getPoint(d),e.vertices[c]=new THREE.Vector3(d.x,d.y,d.z);return e}this.object=a;this.domElement=void 0!==b?b:document;this.id="PathControls"+THREE.PathControlsIdCounter++;this.duration=1E4;this.waypoints=[];this.useConstantSpeed=!0;this.resamplingCoef=50;this.debugPath=new THREE.Object3D;this.debugDummy=new THREE.Object3D;
this.animationParent=new THREE.Object3D;this.lookSpeed=0.0050;this.lookHorizontal=this.lookVertical=!0;this.verticalAngleMap={srcRange:[0,2*Math.PI],dstRange:[0,2*Math.PI]};this.horizontalAngleMap={srcRange:[0,2*Math.PI],dstRange:[0,2*Math.PI]};this.target=new THREE.Object3D;this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=0;this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=
this.domElement.offsetHeight/2,this.domElement.setAttribute("tabindex",-1));var g=2*Math.PI,h=Math.PI/180;this.update=function(a){var b;if(this.lookHorizontal)this.lon=this.lon+this.mouseX*this.lookSpeed*a;if(this.lookVertical)this.lat=this.lat-this.mouseY*this.lookSpeed*a;this.lon=Math.max(0,Math.min(360,this.lon));this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*h;this.theta=this.lon*h;a=this.phi%g;this.phi=a>=0?a:a+g;b=this.verticalAngleMap.srcRange;a=this.verticalAngleMap.dstRange;
b=THREE.Math.mapLinear(this.phi,b[0],b[1],a[0],a[1]);var d=a[1]-a[0];this.phi=c((b-a[0])/d)*d+a[0];b=this.horizontalAngleMap.srcRange;a=this.horizontalAngleMap.dstRange;b=THREE.Math.mapLinear(this.theta,b[0],b[1],a[0],a[1]);d=a[1]-a[0];this.theta=c((b-a[0])/d)*d+a[0];a=this.target.position;a.x=100*Math.sin(this.phi)*Math.cos(this.theta);a.y=100*Math.cos(this.phi);a.z=100*Math.sin(this.phi)*Math.sin(this.theta);this.object.lookAt(this.target.position)};this.onMouseMove=function(a){if(this.domElement===
document){this.mouseX=a.pageX-this.viewHalfX;this.mouseY=a.pageY-this.viewHalfY}else{this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX;this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY}};this.init=function(){this.spline=new THREE.Spline;this.spline.initFromArray(this.waypoints);this.useConstantSpeed&&this.spline.reparametrizeByArcLength(this.resamplingCoef);if(this.createDebugDummy){var a=new THREE.MeshLambertMaterial({color:30719}),b=new THREE.MeshLambertMaterial({color:65280}),
c=new THREE.CubeGeometry(10,10,20),g=new THREE.CubeGeometry(2,2,10);this.animationParent=new THREE.Mesh(c,a);a=new THREE.Mesh(g,b);a.position.set(0,10,0);this.animation=e(this.animationParent,this.spline,this.id,this.duration);this.animationParent.add(this.object);this.animationParent.add(this.target);this.animationParent.add(a)}else{this.animation=e(this.animationParent,this.spline,this.id,this.duration);this.animationParent.add(this.target);this.animationParent.add(this.object)}if(this.createDebugPath){var a=
this.debugPath,b=this.spline,g=f(b,10),c=f(b,10),h=new THREE.LineBasicMaterial({color:16711680,linewidth:3}),g=new THREE.Line(g,h),c=new THREE.ParticleSystem(c,new THREE.ParticleBasicMaterial({color:16755200,size:3}));g.scale.set(1,1,1);a.add(g);c.scale.set(1,1,1);a.add(c);for(var g=new THREE.SphereGeometry(1,16,8),h=new THREE.MeshBasicMaterial({color:65280}),m=0;m<b.points.length;m++){c=new THREE.Mesh(g,h);c.position.copy(b.points[m]);a.add(c)}}this.domElement.addEventListener("mousemove",d(this,
this.onMouseMove),false)}};THREE.PathControlsIdCounter=0;
THREE.FlyControls=function(a,b){function c(a,b){return function(){b.apply(a,arguments)}}this.object=a;this.domElement=void 0!==b?b:document;b&&this.domElement.setAttribute("tabindex",-1);this.movementSpeed=1;this.rollSpeed=0.0050;this.autoForward=this.dragToLook=!1;this.object.useQuaternion=!0;this.tmpQuaternion=new THREE.Quaternion;this.mouseStatus=0;this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0};this.moveVector=new THREE.Vector3(0,
0,0);this.rotationVector=new THREE.Vector3(0,0,0);this.handleEvent=function(a){if("function"==typeof this[a.type])this[a.type](a)};this.keydown=function(a){if(!a.altKey){switch(a.keyCode){case 16:this.movementSpeedMultiplier=0.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=
1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector();this.updateRotationVector()}};this.keyup=function(a){switch(a.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=
0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector();this.updateRotationVector()};this.mousedown=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();if(this.dragToLook)this.mouseStatus++;else switch(a.button){case 0:this.object.moveForward=
!0;break;case 2:this.object.moveBackward=!0}};this.mousemove=function(a){if(!this.dragToLook||0<this.mouseStatus){var b=this.getContainerDimensions(),c=b.size[0]/2,g=b.size[1]/2;this.moveState.yawLeft=-(a.pageX-b.offset[0]-c)/c;this.moveState.pitchDown=(a.pageY-b.offset[1]-g)/g;this.updateRotationVector()}};this.mouseup=function(a){a.preventDefault();a.stopPropagation();if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else switch(a.button){case 0:this.moveForward=
!1;break;case 2:this.moveBackward=!1}this.updateRotationVector()};this.update=function(a){var b=a*this.movementSpeed,a=a*this.rollSpeed;this.object.translateX(this.moveVector.x*b);this.object.translateY(this.moveVector.y*b);this.object.translateZ(this.moveVector.z*b);this.tmpQuaternion.set(this.rotationVector.x*a,this.rotationVector.y*a,this.rotationVector.z*a,1).normalize();this.object.quaternion.multiplySelf(this.tmpQuaternion);this.object.matrix.setPosition(this.object.position);this.object.matrix.setRotationFromQuaternion(this.object.quaternion);
this.object.matrixWorldNeedsUpdate=!0};this.updateMovementVector=function(){var a=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right;this.moveVector.y=-this.moveState.down+this.moveState.up;this.moveVector.z=-a+this.moveState.back};this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp;this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft;this.rotationVector.z=
-this.moveState.rollRight+this.moveState.rollLeft};this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}};this.domElement.addEventListener("mousemove",c(this,this.mousemove),!1);this.domElement.addEventListener("mousedown",c(this,this.mousedown),!1);this.domElement.addEventListener("mouseup",c(this,
this.mouseup),!1);this.domElement.addEventListener("keydown",c(this,this.keydown),!1);this.domElement.addEventListener("keyup",c(this,this.keyup),!1);this.updateMovementVector();this.updateRotationVector()};
THREE.RollControls=function(a,b){this.object=a;this.domElement=void 0!==b?b:document;this.mouseLook=!0;this.autoForward=!1;this.rollSpeed=this.movementSpeed=this.lookSpeed=1;this.constrainVertical=[-0.9,0.9];this.object.matrixAutoUpdate=!1;this.forward=new THREE.Vector3(0,0,1);this.roll=0;var c=new THREE.Vector3,d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Matrix4,g=!1,h=1,i=0,j=0,k=0,l=0,p=0,m=window.innerWidth/2,r=window.innerHeight/2;this.update=function(a){if(this.mouseLook){var b=a*this.lookSpeed;
this.rotateHorizontally(b*l);this.rotateVertically(b*p)}b=a*this.movementSpeed;this.object.translateZ(-b*(0<i||this.autoForward&&!(0>i)?1:i));this.object.translateX(b*j);this.object.translateY(b*k);g&&(this.roll+=this.rollSpeed*a*h);this.forward.y>this.constrainVertical[1]?(this.forward.y=this.constrainVertical[1],this.forward.normalize()):this.forward.y<this.constrainVertical[0]&&(this.forward.y=this.constrainVertical[0],this.forward.normalize());e.copy(this.forward);d.set(0,1,0);c.cross(d,e).normalize();
d.cross(e,c).normalize();this.object.matrix.elements[0]=c.x;this.object.matrix.elements[4]=d.x;this.object.matrix.elements[8]=e.x;this.object.matrix.elements[1]=c.y;this.object.matrix.elements[5]=d.y;this.object.matrix.elements[9]=e.y;this.object.matrix.elements[2]=c.z;this.object.matrix.elements[6]=d.z;this.object.matrix.elements[10]=e.z;f.identity();f.elements[0]=Math.cos(this.roll);f.elements[4]=-Math.sin(this.roll);f.elements[1]=Math.sin(this.roll);f.elements[5]=Math.cos(this.roll);this.object.matrix.multiplySelf(f);
this.object.matrixWorldNeedsUpdate=!0;this.object.matrix.elements[12]=this.object.position.x;this.object.matrix.elements[13]=this.object.position.y;this.object.matrix.elements[14]=this.object.position.z};this.translateX=function(a){this.object.position.x+=this.object.matrix.elements[0]*a;this.object.position.y+=this.object.matrix.elements[1]*a;this.object.position.z+=this.object.matrix.elements[2]*a};this.translateY=function(a){this.object.position.x+=this.object.matrix.elements[4]*a;this.object.position.y+=
this.object.matrix.elements[5]*a;this.object.position.z+=this.object.matrix.elements[6]*a};this.translateZ=function(a){this.object.position.x-=this.object.matrix.elements[8]*a;this.object.position.y-=this.object.matrix.elements[9]*a;this.object.position.z-=this.object.matrix.elements[10]*a};this.rotateHorizontally=function(a){c.set(this.object.matrix.elements[0],this.object.matrix.elements[1],this.object.matrix.elements[2]);c.multiplyScalar(a);this.forward.subSelf(c);this.forward.normalize()};this.rotateVertically=
function(a){d.set(this.object.matrix.elements[4],this.object.matrix.elements[5],this.object.matrix.elements[6]);d.multiplyScalar(a);this.forward.addSelf(d);this.forward.normalize()};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousemove",function(a){l=(a.clientX-m)/window.innerWidth;p=(a.clientY-r)/window.innerHeight},!1);this.domElement.addEventListener("mousedown",function(a){a.preventDefault();a.stopPropagation();switch(a.button){case 0:i=
1;break;case 2:i=-1}},!1);this.domElement.addEventListener("mouseup",function(a){a.preventDefault();a.stopPropagation();switch(a.button){case 0:i=0;break;case 2:i=0}},!1);this.domElement.addEventListener("keydown",function(a){switch(a.keyCode){case 38:case 87:i=1;break;case 37:case 65:j=-1;break;case 40:case 83:i=-1;break;case 39:case 68:j=1;break;case 81:g=!0;h=1;break;case 69:g=!0;h=-1;break;case 82:k=1;break;case 70:k=-1}},!1);this.domElement.addEventListener("keyup",function(a){switch(a.keyCode){case 38:case 87:i=
0;break;case 37:case 65:j=0;break;case 40:case 83:i=0;break;case 39:case 68:j=0;break;case 81:g=!1;break;case 69:g=!1;break;case 82:k=0;break;case 70:k=0}},!1)};
THREE.TrackballControls=function(a,b){THREE.EventTarget.call(this);var c=this;this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.screen={width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0};this.radius=(this.screen.width+this.screen.height)/4;this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=0.3;this.staticMoving=this.noPan=this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=0.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.target=
new THREE.Vector3;var d=new THREE.Vector3,e=!1,f=-1,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3,j=new THREE.Vector2,k=new THREE.Vector2,l=new THREE.Vector2,p=new THREE.Vector2,m={type:"change"};this.handleEvent=function(a){if("function"==typeof this[a.type])this[a.type](a)};this.getMouseOnScreen=function(a,b){return new THREE.Vector2(0.5*((a-c.screen.offsetLeft)/c.radius),0.5*((b-c.screen.offsetTop)/c.radius))};this.getMouseProjectionOnBall=function(a,b){var d=new THREE.Vector3((a-
0.5*c.screen.width-c.screen.offsetLeft)/c.radius,(0.5*c.screen.height+c.screen.offsetTop-b)/c.radius,0),e=d.length();1<e?d.normalize():d.z=Math.sqrt(1-e*e);g.copy(c.object.position).subSelf(c.target);e=c.object.up.clone().setLength(d.y);e.addSelf(c.object.up.clone().crossSelf(g).setLength(d.x));e.addSelf(g.setLength(d.z));return e};this.rotateCamera=function(){var a=Math.acos(h.dot(i)/h.length()/i.length());if(a){var b=(new THREE.Vector3).cross(h,i).normalize(),d=new THREE.Quaternion,a=a*c.rotateSpeed;
d.setFromAxisAngle(b,-a);d.multiplyVector3(g);d.multiplyVector3(c.object.up);d.multiplyVector3(i);c.staticMoving?h=i:(d.setFromAxisAngle(b,a*(c.dynamicDampingFactor-1)),d.multiplyVector3(h))}};this.zoomCamera=function(){var a=1+(k.y-j.y)*c.zoomSpeed;1!==a&&0<a&&(g.multiplyScalar(a),c.staticMoving?j=k:j.y+=(k.y-j.y)*this.dynamicDampingFactor)};this.panCamera=function(){var a=p.clone().subSelf(l);if(a.lengthSq()){a.multiplyScalar(g.length()*c.panSpeed);var b=g.clone().crossSelf(c.object.up).setLength(a.x);
b.addSelf(c.object.up.clone().setLength(a.y));c.object.position.addSelf(b);c.target.addSelf(b);c.staticMoving?l=p:l.addSelf(a.sub(p,l).multiplyScalar(c.dynamicDampingFactor))}};this.checkDistances=function(){if(!c.noZoom||!c.noPan)c.object.position.lengthSq()>c.maxDistance*c.maxDistance&&c.object.position.setLength(c.maxDistance),g.lengthSq()<c.minDistance*c.minDistance&&c.object.position.add(c.target,g.setLength(c.minDistance))};this.update=function(){g.copy(c.object.position).subSelf(c.target);
c.noRotate||c.rotateCamera();c.noZoom||c.zoomCamera();c.noPan||c.panCamera();c.object.position.add(c.target,g);c.checkDistances();c.object.lookAt(c.target);0<d.distanceTo(c.object.position)&&(c.dispatchEvent(m),d.copy(c.object.position))};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousemove",function(a){c.enabled&&(e&&(h=i=c.getMouseProjectionOnBall(a.clientX,a.clientY),j=k=c.getMouseOnScreen(a.clientX,a.clientY),l=p=c.getMouseOnScreen(a.clientX,
a.clientY),e=!1),-1!==f&&(0===f&&!c.noRotate?i=c.getMouseProjectionOnBall(a.clientX,a.clientY):1===f&&!c.noZoom?k=c.getMouseOnScreen(a.clientX,a.clientY):2===f&&!c.noPan&&(p=c.getMouseOnScreen(a.clientX,a.clientY))))},!1);this.domElement.addEventListener("mousedown",function(a){c.enabled&&(a.preventDefault(),a.stopPropagation(),-1===f&&(f=a.button,0===f&&!c.noRotate?h=i=c.getMouseProjectionOnBall(a.clientX,a.clientY):1===f&&!c.noZoom?j=k=c.getMouseOnScreen(a.clientX,a.clientY):this.noPan||(l=p=c.getMouseOnScreen(a.clientX,
a.clientY))))},!1);this.domElement.addEventListener("mouseup",function(a){c.enabled&&(a.preventDefault(),a.stopPropagation(),f=-1)},!1);window.addEventListener("keydown",function(a){c.enabled&&-1===f&&(a.keyCode===c.keys[0]&&!c.noRotate?f=0:a.keyCode===c.keys[1]&&!c.noZoom?f=1:a.keyCode===c.keys[2]&&!c.noPan&&(f=2),-1!==f&&(e=!0))},!1);window.addEventListener("keyup",function(){c.enabled&&-1!==f&&(f=-1)},!1)};
THREE.CubeGeometry=function(a,b,c,d,e,f,g,h){function i(a,b,c,g,h,i,k,l){var u,p=d||1,m=e||1,B=h/2,q=i/2,r=j.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)u="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)u="y",m=f||1;else if("z"===a&&"y"===b||"y"===a&&"z"===b)u="x",p=f||1;var o=p+1,t=m+1,v=h/p,w=i/m,T=new THREE.Vector3;T[u]=0<k?1:-1;for(h=0;h<t;h++)for(i=0;i<o;i++){var L=new THREE.Vector3;L[a]=(i*v-B)*c;L[b]=(h*w-q)*g;L[u]=k;j.vertices.push(L)}for(h=0;h<m;h++)for(i=0;i<p;i++)a=new THREE.Face4(i+
o*h+r,i+o*(h+1)+r,i+1+o*(h+1)+r,i+1+o*h+r),a.normal.copy(T),a.vertexNormals.push(T.clone(),T.clone(),T.clone(),T.clone()),a.materialIndex=l,j.faces.push(a),j.faceVertexUvs[0].push([new THREE.UV(i/p,h/m),new THREE.UV(i/p,(h+1)/m),new THREE.UV((i+1)/p,(h+1)/m),new THREE.UV((i+1)/p,h/m)])}THREE.Geometry.call(this);var j=this,k=a/2,l=b/2,p=c/2,m,r,q,t,v,w;if(void 0!==g){if(g instanceof Array)this.materials=g;else{this.materials=[];for(m=0;6>m;m++)this.materials.push(g)}m=0;t=1;r=2;v=3;q=4;w=5}else this.materials=
[];this.sides={px:!0,nx:!0,py:!0,ny:!0,pz:!0,nz:!0};if(void 0!=h)for(var z in h)void 0!==this.sides[z]&&(this.sides[z]=h[z]);this.sides.px&&i("z","y",-1,-1,c,b,k,m);this.sides.nx&&i("z","y",1,-1,c,b,-k,t);this.sides.py&&i("x","z",1,1,a,c,l,r);this.sides.ny&&i("x","z",1,-1,a,c,-l,v);this.sides.pz&&i("x","y",1,-1,a,b,p,q);this.sides.nz&&i("x","y",-1,-1,a,b,-p,w);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=new THREE.Geometry;THREE.CubeGeometry.prototype.constructor=THREE.CubeGeometry;
THREE.CylinderGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);var a=void 0!==a?a:20,b=void 0!==b?b:20,c=void 0!==c?c:100,g=c/2,d=d||8,e=e||1,h,i,j=[],k=[];for(i=0;i<=e;i++){var l=[],p=[],m=i/e,r=m*(b-a)+a;for(h=0;h<=d;h++){var q=h/d,t=new THREE.Vector3;t.x=r*Math.sin(2*q*Math.PI);t.y=-m*c+g;t.z=r*Math.cos(2*q*Math.PI);this.vertices.push(t);l.push(this.vertices.length-1);p.push(new THREE.UV(q,m))}j.push(l);k.push(p)}c=(b-a)/c;for(h=0;h<d;h++){0!==a?(l=this.vertices[j[0][h]].clone(),p=this.vertices[j[0][h+
1]].clone()):(l=this.vertices[j[1][h]].clone(),p=this.vertices[j[1][h+1]].clone());l.setY(Math.sqrt(l.x*l.x+l.z*l.z)*c).normalize();p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*c).normalize();for(i=0;i<e;i++){var m=j[i][h],r=j[i+1][h],q=j[i+1][h+1],t=j[i][h+1],v=l.clone(),w=l.clone(),z=p.clone(),x=p.clone(),A=k[i][h].clone(),F=k[i+1][h].clone(),C=k[i+1][h+1].clone(),D=k[i][h+1].clone();this.faces.push(new THREE.Face4(m,r,q,t,[v,w,z,x]));this.faceVertexUvs[0].push([A,F,C,D])}}if(!f&&0<a){this.vertices.push(new THREE.Vector3(0,
g,0));for(h=0;h<d;h++)m=j[0][h],r=j[0][h+1],q=this.vertices.length-1,v=new THREE.Vector3(0,1,0),w=new THREE.Vector3(0,1,0),z=new THREE.Vector3(0,1,0),A=k[0][h].clone(),F=k[0][h+1].clone(),C=new THREE.UV(F.u,0),this.faces.push(new THREE.Face3(m,r,q,[v,w,z])),this.faceVertexUvs[0].push([A,F,C])}if(!f&&0<b){this.vertices.push(new THREE.Vector3(0,-g,0));for(h=0;h<d;h++)m=j[i][h+1],r=j[i][h],q=this.vertices.length-1,v=new THREE.Vector3(0,-1,0),w=new THREE.Vector3(0,-1,0),z=new THREE.Vector3(0,-1,0),A=
k[i][h+1].clone(),F=k[i][h].clone(),C=new THREE.UV(F.u,1),this.faces.push(new THREE.Face3(m,r,q,[v,w,z])),this.faceVertexUvs[0].push([A,F,C])}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=new THREE.Geometry;THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),a=a instanceof Array?a:[a],this.shapebb=a[a.length-1].getBoundingBox(),this.addShapeList(a,b),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=new THREE.Geometry;THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).addSelf(a)}function d(a,b,c){var d=THREE.ExtrudeGeometry.__v1,e=THREE.ExtrudeGeometry.__v2,f=THREE.ExtrudeGeometry.__v3,g=THREE.ExtrudeGeometry.__v4,h=THREE.ExtrudeGeometry.__v5,i=THREE.ExtrudeGeometry.__v6;d.set(a.x-b.x,a.y-b.y);e.set(a.x-c.x,a.y-c.y);d=d.normalize();e=e.normalize();f.set(-d.y,d.x);g.set(e.y,-e.x);h.copy(a).addSelf(f);i.copy(a).addSelf(g);if(h.equals(i))return g.clone();
h.copy(b).addSelf(f);i.copy(c).addSelf(g);f=d.dot(g);g=i.subSelf(h).dot(g);0===f&&(console.log("Either infinite or no solutions!"),0===g?console.log("Its finite solutions."):console.log("Too bad, no solutions."));g/=f;return 0>g?(b=Math.atan2(b.y-a.y,b.x-a.x),a=Math.atan2(c.y-a.y,c.x-a.x),b>a&&(a+=2*Math.PI),c=(b+a)/2,a=-Math.cos(c),c=-Math.sin(c),new THREE.Vector2(a,c)):d.multiplyScalar(g).addSelf(h).subSelf(a).clone()}function e(c,d){var e,f;for(L=c.length;0<=--L;){e=L;f=L-1;0>f&&(f=c.length-1);
for(var g=0,h=p+2*k,g=0;g<h;g++){var i=P*g,j=P*(g+1),l=d+e+i,i=d+f+i,u=d+f+j,j=d+e+j,o=c,m=g,q=h,l=l+E,i=i+E,u=u+E,j=j+E;s.faces.push(new THREE.Face4(l,i,u,j,null,null,w));l=aa.generateSideWallUV(s,a,o,b,l,i,u,j,m,q);s.faceVertexUvs[0].push(l)}}}function f(a,b,c){s.vertices.push(new THREE.Vector3(a,b,c))}function g(c,d,e,f){c+=E;d+=E;e+=E;s.faces.push(new THREE.Face3(c,d,e,null,null,v));c=f?aa.generateBottomUV(s,a,b,c,d,e):aa.generateTopUV(s,a,b,c,d,e);s.faceVertexUvs[0].push(c)}var h=void 0!==b.amount?
b.amount:100,i=void 0!==b.bevelThickness?b.bevelThickness:6,j=void 0!==b.bevelSize?b.bevelSize:i-2,k=void 0!==b.bevelSegments?b.bevelSegments:3,l=void 0!==b.bevelEnabled?b.bevelEnabled:!0,p=void 0!==b.steps?b.steps:1,m=b.bendPath,r=b.extrudePath,q,t=!1,v=b.material,w=b.extrudeMaterial,z,x,A,F;r&&(q=r.getSpacedPoints(p),t=!0,l=!1,z=new THREE.TubeGeometry.FrenetFrames(r,p,!1),x=new THREE.Vector3,A=new THREE.Vector3,F=new THREE.Vector3);l||(j=i=k=0);var C,D,y,s=this,E=this.vertices.length;m&&a.addWrapPath(m);
var r=a.extractPoints(),m=r.shape,u=r.holes;if(r=!THREE.Shape.Utils.isClockWise(m)){m=m.reverse();D=0;for(y=u.length;D<y;D++)C=u[D],THREE.Shape.Utils.isClockWise(C)&&(u[D]=C.reverse());r=!1}var J=THREE.Shape.Utils.triangulateShape(m,u),N=m;D=0;for(y=u.length;D<y;D++)C=u[D],m=m.concat(C);var B,M,I,o,Q,P=m.length,H,T=J.length,r=[],L=0;I=N.length;B=I-1;for(M=L+1;L<I;L++,B++,M++)B===I&&(B=0),M===I&&(M=0),r[L]=d(N[L],N[B],N[M]);var W=[],ea,da=r.concat();D=0;for(y=u.length;D<y;D++){C=u[D];ea=[];L=0;I=C.length;
B=I-1;for(M=L+1;L<I;L++,B++,M++)B===I&&(B=0),M===I&&(M=0),ea[L]=d(C[L],C[B],C[M]);W.push(ea);da=da.concat(ea)}for(B=0;B<k;B++){I=B/k;o=i*(1-I);M=j*Math.sin(I*Math.PI/2);L=0;for(I=N.length;L<I;L++)Q=c(N[L],r[L],M),f(Q.x,Q.y,-o);D=0;for(y=u.length;D<y;D++){C=u[D];ea=W[D];L=0;for(I=C.length;L<I;L++)Q=c(C[L],ea[L],M),f(Q.x,Q.y,-o)}}M=j;for(L=0;L<P;L++)Q=l?c(m[L],da[L],M):m[L],t?(A.copy(z.normals[0]).multiplyScalar(Q.x),x.copy(z.binormals[0]).multiplyScalar(Q.y),F.copy(q[0]).addSelf(A).addSelf(x),f(F.x,
F.y,F.z)):f(Q.x,Q.y,0);for(I=1;I<=p;I++)for(L=0;L<P;L++)Q=l?c(m[L],da[L],M):m[L],t?(A.copy(z.normals[I]).multiplyScalar(Q.x),x.copy(z.binormals[I]).multiplyScalar(Q.y),F.copy(q[I]).addSelf(A).addSelf(x),f(F.x,F.y,F.z)):f(Q.x,Q.y,h/p*I);for(B=k-1;0<=B;B--){I=B/k;o=i*(1-I);M=j*Math.sin(I*Math.PI/2);L=0;for(I=N.length;L<I;L++)Q=c(N[L],r[L],M),f(Q.x,Q.y,h+o);D=0;for(y=u.length;D<y;D++){C=u[D];ea=W[D];L=0;for(I=C.length;L<I;L++)Q=c(C[L],ea[L],M),t?f(Q.x,Q.y+q[p-1].y,q[p-1].x+o):f(Q.x,Q.y,h+o)}}var aa=
THREE.ExtrudeGeometry.WorldUVGenerator;(function(){if(l){var a;a=P*0;for(L=0;L<T;L++){H=J[L];g(H[2]+a,H[1]+a,H[0]+a,true)}a=p+k*2;a=P*a;for(L=0;L<T;L++){H=J[L];g(H[0]+a,H[1]+a,H[2]+a,false)}}else{for(L=0;L<T;L++){H=J[L];g(H[2],H[1],H[0],true)}for(L=0;L<T;L++){H=J[L];g(H[0]+P*p,H[1]+P*p,H[2]+P*p,false)}}})();(function(){var a=0;e(N,a);a=a+N.length;D=0;for(y=u.length;D<y;D++){C=u[D];e(C,a);a=a+C.length}})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d,e,f){b=a.vertices[e].x;e=a.vertices[e].y;c=a.vertices[f].x;f=a.vertices[f].y;return[new THREE.UV(a.vertices[d].x,1-a.vertices[d].y),new THREE.UV(b,1-e),new THREE.UV(c,1-f)]},generateBottomUV:function(a,b,c,d,e,f){return this.generateTopUV(a,b,c,d,e,f)},generateSideWallUV:function(a,b,c,d,e,f,g,h){var b=a.vertices[e].x,c=a.vertices[e].y,e=a.vertices[e].z,d=a.vertices[f].x,i=a.vertices[f].y,f=a.vertices[f].z,j=a.vertices[g].x,k=
a.vertices[g].y,g=a.vertices[g].z,l=a.vertices[h].x,p=a.vertices[h].y,a=a.vertices[h].z;return 0.01>Math.abs(c-i)?[new THREE.UV(b,e),new THREE.UV(d,f),new THREE.UV(j,g),new THREE.UV(l,a)]:[new THREE.UV(c,e),new THREE.UV(i,f),new THREE.UV(k,g),new THREE.UV(p,a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;
THREE.ExtrudeGeometry.__v6=new THREE.Vector2;
THREE.LatheGeometry=function(a,b,c){THREE.Geometry.call(this);for(var b=b||12,c=c||2*Math.PI,d=[],e=(new THREE.Matrix4).makeRotationZ(c/b),f=0;f<a.length;f++)d[f]=a[f].clone(),this.vertices.push(d[f]);for(var g=b+1,c=0;c<g;c++)for(f=0;f<d.length;f++)d[f]=e.multiplyVector3(d[f].clone()),this.vertices.push(d[f]);for(c=0;c<b;c++){d=0;for(e=a.length;d<e-1;d++)this.faces.push(new THREE.Face4(c*e+d,(c+1)%g*e+d,(c+1)%g*e+(d+1)%e,c*e+(d+1)%e)),this.faceVertexUvs[0].push([new THREE.UV(1-c/b,d/e),new THREE.UV(1-
(c+1)/b,d/e),new THREE.UV(1-(c+1)/b,(d+1)/e),new THREE.UV(1-c/b,(d+1)/e)])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=new THREE.Geometry;THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;
THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this);for(var e=a/2,f=b/2,c=c||1,d=d||1,g=c+1,h=d+1,i=a/c,j=b/d,k=new THREE.Vector3(0,1,0),a=0;a<h;a++)for(b=0;b<g;b++)this.vertices.push(new THREE.Vector3(b*i-e,0,a*j-f));for(a=0;a<d;a++)for(b=0;b<c;b++)e=new THREE.Face4(b+g*a,b+g*(a+1),b+1+g*(a+1),b+1+g*a),e.normal.copy(k),e.vertexNormals.push(k.clone(),k.clone(),k.clone(),k.clone()),this.faces.push(e),this.faceVertexUvs[0].push([new THREE.UV(b/c,a/d),new THREE.UV(b/c,(a+1)/d),new THREE.UV((b+
1)/c,(a+1)/d),new THREE.UV((b+1)/c,a/d)]);this.computeCentroids()};THREE.PlaneGeometry.prototype=new THREE.Geometry;THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;
THREE.SphereGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this);var a=a||50,d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),h,i,j=[],k=[];for(i=0;i<=c;i++){var l=[],p=[];for(h=0;h<=b;h++){var m=h/b,r=i/c,q=new THREE.Vector3;q.x=-a*Math.cos(d+m*e)*Math.sin(f+r*g);q.y=a*Math.cos(f+r*g);q.z=a*Math.sin(d+m*e)*Math.sin(f+r*g);this.vertices.push(q);l.push(this.vertices.length-1);p.push(new THREE.UV(m,
r))}j.push(l);k.push(p)}for(i=0;i<c;i++)for(h=0;h<b;h++){var d=j[i][h+1],e=j[i][h],f=j[i+1][h],g=j[i+1][h+1],l=this.vertices[d].clone().normalize(),p=this.vertices[e].clone().normalize(),m=this.vertices[f].clone().normalize(),r=this.vertices[g].clone().normalize(),q=k[i][h+1].clone(),t=k[i][h].clone(),v=k[i+1][h].clone(),w=k[i+1][h+1].clone();Math.abs(this.vertices[d].y)==a?(this.faces.push(new THREE.Face3(d,f,g,[l,m,r])),this.faceVertexUvs[0].push([q,v,w])):Math.abs(this.vertices[f].y)==a?(this.faces.push(new THREE.Face3(d,
e,f,[l,p,m])),this.faceVertexUvs[0].push([q,t,v])):(this.faces.push(new THREE.Face4(d,e,f,g,[l,p,m,r])),this.faceVertexUvs[0].push([q,t,v,w]))}this.computeCentroids();this.computeFaceNormals();this.boundingSphere={radius:a}};THREE.SphereGeometry.prototype=new THREE.Geometry;THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;
THREE.TextGeometry=function(a,b){var c=(new THREE.TextPath(a,b)).toShapes();b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);if(b.bend){var d=c[c.length-1].getBoundingBox().maxX;b.bendPath=new THREE.QuadraticBezierCurve(new THREE.Vector2(0,0),new THREE.Vector2(d/2,120),new THREE.Vector2(d,0))}THREE.ExtrudeGeometry.call(this,c,b)};THREE.TextGeometry.prototype=new THREE.ExtrudeGeometry;
THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){for(var b=this.getFace(),c=this.size/b.resolution,d=
0,e=(""+a).split(""),f=e.length,g=[],a=0;a<f;a++){var h=new THREE.Path,h=this.extractGlyphPoints(e[a],b,c,d,h),d=d+h.offset;g.push(h.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,b,c,d,e){var f=[],g,h,i,j,k,l,p,m,r,q,t,v=b.glyphs[a]||b.glyphs["?"];if(v){if(v.o){b=v._cachedOutline||(v._cachedOutline=v.o.split(" "));j=b.length;for(a=0;a<j;)switch(i=b[a++],i){case "m":i=b[a++]*c+d;k=b[a++]*c;f.push(new THREE.Vector2(i,k));e.moveTo(i,k);break;case "l":i=b[a++]*c+d;k=b[a++]*c;f.push(new THREE.Vector2(i,
k));e.lineTo(i,k);break;case "q":i=b[a++]*c+d;k=b[a++]*c;m=b[a++]*c+d;r=b[a++]*c;e.quadraticCurveTo(m,r,i,k);if(g=f[f.length-1]){l=g.x;p=g.y;g=1;for(h=this.divisions;g<=h;g++){var w=g/h,z=THREE.Shape.Utils.b2(w,l,m,i),w=THREE.Shape.Utils.b2(w,p,r,k);f.push(new THREE.Vector2(z,w))}}break;case "b":if(i=b[a++]*c+d,k=b[a++]*c,m=b[a++]*c+d,r=b[a++]*-c,q=b[a++]*c+d,t=b[a++]*-c,e.bezierCurveTo(i,k,m,r,q,t),g=f[f.length-1]){l=g.x;p=g.y;g=1;for(h=this.divisions;g<=h;g++)w=g/h,z=THREE.Shape.Utils.b3(w,l,m,
q,i),w=THREE.Shape.Utils.b3(w,p,r,t,k),f.push(new THREE.Vector2(z,w))}}}return{offset:v.ha*c,points:f,path:e}}}};
(function(a){var b=function(a){for(var b=a.length,e=0,f=b-1,g=0;g<b;f=g++)e+=a[f].x*a[g].y-a[g].x*a[f].y;return 0.5*e};a.Triangulate=function(a,d){var e=a.length;if(3>e)return null;var f=[],g=[],h=[],i,j,k;if(0<b(a))for(j=0;j<e;j++)g[j]=j;else for(j=0;j<e;j++)g[j]=e-1-j;var l=2*e;for(j=e-1;2<e;){if(0>=l--){console.log("Warning, unable to triangulate polygon!");break}i=j;e<=i&&(i=0);j=i+1;e<=j&&(j=0);k=j+1;e<=k&&(k=0);var p;a:{p=a;var m=i,r=j,q=k,t=e,v=g,w=void 0,z=void 0,x=void 0,A=void 0,F=void 0,
C=void 0,D=void 0,y=void 0,s=void 0,z=p[v[m]].x,x=p[v[m]].y,A=p[v[r]].x,F=p[v[r]].y,C=p[v[q]].x,D=p[v[q]].y;if(1.0E-10>(A-z)*(D-x)-(F-x)*(C-z))p=!1;else{for(w=0;w<t;w++)if(!(w==m||w==r||w==q)){var y=p[v[w]].x,s=p[v[w]].y,E=void 0,u=void 0,J=void 0,N=void 0,B=void 0,M=void 0,I=void 0,o=void 0,Q=void 0,P=void 0,H=void 0,T=void 0,E=C-A,u=D-F,J=z-C,N=x-D,B=A-z,M=F-x,I=y-z,o=s-x,Q=y-A,P=s-F,H=y-C,T=s-D,E=E*P-u*Q,B=B*o-M*I,J=J*T-N*H;if(0<=E&&0<=J&&0<=B){p=!1;break a}}p=!0}}if(p){f.push([a[g[i]],a[g[j]],
a[g[k]]]);h.push([g[i],g[j],g[k]]);i=j;for(k=j+1;k<e;i++,k++)g[i]=g[k];e--;l=2*e}}return d?h:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};
THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.segmentsR=c||8;this.segmentsT=d||6;this.arc=e||2*Math.PI;e=new THREE.Vector3;a=[];b=[];for(c=0;c<=this.segmentsR;c++)for(d=0;d<=this.segmentsT;d++){var f=d/this.segmentsT*this.arc,g=2*c/this.segmentsR*Math.PI;e.x=this.radius*Math.cos(f);e.y=this.radius*Math.sin(f);var h=new THREE.Vector3;h.x=(this.radius+this.tube*Math.cos(g))*Math.cos(f);h.y=(this.radius+this.tube*Math.cos(g))*Math.sin(f);h.z=
this.tube*Math.sin(g);this.vertices.push(h);a.push(new THREE.UV(d/this.segmentsT,1-c/this.segmentsR));b.push(h.clone().subSelf(e).normalize())}for(c=1;c<=this.segmentsR;c++)for(d=1;d<=this.segmentsT;d++){var e=(this.segmentsT+1)*c+d-1,f=(this.segmentsT+1)*(c-1)+d-1,g=(this.segmentsT+1)*(c-1)+d,h=(this.segmentsT+1)*c+d,i=new THREE.Face4(e,f,g,h,[b[e],b[f],b[g],b[h]]);i.normal.addSelf(b[e]);i.normal.addSelf(b[f]);i.normal.addSelf(b[g]);i.normal.addSelf(b[h]);i.normal.normalize();this.faces.push(i);
this.faceVertexUvs[0].push([a[e].clone(),a[f].clone(),a[g].clone(),a[h].clone()])}this.computeCentroids()};THREE.TorusGeometry.prototype=new THREE.Geometry;THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;
THREE.TorusKnotGeometry=function(a,b,c,d,e,f,g){function h(a,b,c,d,e,f){var g=Math.cos(a);Math.cos(b);b=Math.sin(a);a*=c/d;c=Math.cos(a);g*=0.5*e*(2+c);b=0.5*e*(2+c)*b;e=0.5*f*e*Math.sin(a);return new THREE.Vector3(g,b,e)}THREE.Geometry.call(this);this.radius=a||200;this.tube=b||40;this.segmentsR=c||64;this.segmentsT=d||8;this.p=e||2;this.q=f||3;this.heightScale=g||1;this.grid=Array(this.segmentsR);c=new THREE.Vector3;d=new THREE.Vector3;e=new THREE.Vector3;for(a=0;a<this.segmentsR;++a){this.grid[a]=
Array(this.segmentsT);for(b=0;b<this.segmentsT;++b){var i=2*(a/this.segmentsR)*this.p*Math.PI,g=2*(b/this.segmentsT)*Math.PI,f=h(i,g,this.q,this.p,this.radius,this.heightScale),i=h(i+0.01,g,this.q,this.p,this.radius,this.heightScale);c.sub(i,f);d.add(i,f);e.cross(c,d);d.cross(e,c);e.normalize();d.normalize();i=-this.tube*Math.cos(g);g=this.tube*Math.sin(g);f.x+=i*d.x+g*e.x;f.y+=i*d.y+g*e.y;f.z+=i*d.z+g*e.z;this.grid[a][b]=this.vertices.push(new THREE.Vector3(f.x,f.y,f.z))-1}}for(a=0;a<this.segmentsR;++a)for(b=
0;b<this.segmentsT;++b){var e=(a+1)%this.segmentsR,f=(b+1)%this.segmentsT,c=this.grid[a][b],d=this.grid[e][b],e=this.grid[e][f],f=this.grid[a][f],g=new THREE.UV(a/this.segmentsR,b/this.segmentsT),i=new THREE.UV((a+1)/this.segmentsR,b/this.segmentsT),j=new THREE.UV((a+1)/this.segmentsR,(b+1)/this.segmentsT),k=new THREE.UV(a/this.segmentsR,(b+1)/this.segmentsT);this.faces.push(new THREE.Face4(c,d,e,f));this.faceVertexUvs[0].push([g,i,j,k])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};
THREE.TorusKnotGeometry.prototype=new THREE.Geometry;THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;
THREE.TubeGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.path=a;this.segments=b||64;this.radius=c||1;this.segmentsRadius=d||8;this.closed=e||!1;f&&(this.debug=new THREE.Object3D);this.grid=[];var g,h,f=this.segments+1,i,j,k,l=new THREE.Vector3,p,m,r,b=new THREE.TubeGeometry.FrenetFrames(a,b,e);p=b.tangents;m=b.normals;r=b.binormals;this.tangents=p;this.normals=m;this.binormals=r;for(b=0;b<f;b++){this.grid[b]=[];d=b/(f-1);k=a.getPointAt(d);d=p[b];g=m[b];h=r[b];this.debug&&(this.debug.add(new THREE.ArrowHelper(d,
k,c,255)),this.debug.add(new THREE.ArrowHelper(g,k,c,16711680)),this.debug.add(new THREE.ArrowHelper(h,k,c,65280)));for(d=0;d<this.segmentsRadius;d++)i=2*(d/this.segmentsRadius)*Math.PI,j=-this.radius*Math.cos(i),i=this.radius*Math.sin(i),l.copy(k),l.x+=j*g.x+i*h.x,l.y+=j*g.y+i*h.y,l.z+=j*g.z+i*h.z,this.grid[b][d]=this.vertices.push(new THREE.Vector3(l.x,l.y,l.z))-1}for(b=0;b<this.segments;b++)for(d=0;d<this.segmentsRadius;d++)f=e?(b+1)%this.segments:b+1,l=(d+1)%this.segmentsRadius,a=this.grid[b][d],
c=this.grid[f][d],f=this.grid[f][l],l=this.grid[b][l],p=new THREE.UV(b/this.segments,d/this.segmentsRadius),m=new THREE.UV((b+1)/this.segments,d/this.segmentsRadius),r=new THREE.UV((b+1)/this.segments,(d+1)/this.segmentsRadius),g=new THREE.UV(b/this.segments,(d+1)/this.segmentsRadius),this.faces.push(new THREE.Face4(a,c,f,l)),this.faceVertexUvs[0].push([p,m,r,g]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=new THREE.Geometry;
THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry;
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var e=[],f=[],g=[],h=new THREE.Vector3,i=new THREE.Matrix4,b=b+1,j,k,l;this.tangents=e;this.normals=f;this.binormals=g;for(j=0;j<b;j++)k=j/(b-1),e[j]=a.getTangentAt(k),e[j].normalize();f[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;j=Math.abs(e[0].x);k=Math.abs(e[0].y);l=Math.abs(e[0].z);j<=a&&(a=j,d.set(1,0,0));k<=a&&(a=k,d.set(0,1,0));l<=a&&d.set(0,0,1);h.cross(e[0],d).normalize();
f[0].cross(e[0],h);g[0].cross(e[0],f[0]);for(j=1;j<b;j++)f[j]=f[j-1].clone(),g[j]=g[j-1].clone(),h.cross(e[j-1],e[j]),1.0E-4<h.length()&&(h.normalize(),d=Math.acos(e[j-1].dot(e[j])),i.makeRotationAxis(h,d).multiplyVector3(f[j])),g[j].cross(e[j],f[j]);if(c){d=Math.acos(f[0].dot(f[b-1]));d/=b-1;0<e[0].dot(h.cross(f[0],f[b-1]))&&(d=-d);for(j=1;j<b;j++)i.makeRotationAxis(e[j],d*j).multiplyVector3(f[j]),g[j].cross(e[j],f[j])}};
THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=i.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+0.5,a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;b.uv=new THREE.UV(c,a);return b}function f(a,b,c,d){1>d?(d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]),d.centroid.addSelf(a).addSelf(b).addSelf(c).divideScalar(3),d.normal=d.centroid.clone().normalize(),i.faces.push(d),d=Math.atan2(d.centroid.z,-d.centroid.x),
i.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])):(d-=1,f(a,g(a,b),g(a,c),d),f(g(a,b),b,g(b,c),d),f(g(a,c),g(b,c),c,d),f(g(a,b),g(b,c),g(a,c),d))}function g(a,b){l[a.index]||(l[a.index]=[]);l[b.index]||(l[b.index]=[]);var c=l[a.index][b.index];void 0===c&&(l[a.index][b.index]=l[b.index][a.index]=c=e((new THREE.Vector3).add(a,b).divideScalar(2)));return c}function h(a,b,c){0>c&&1===a.u&&(a=new THREE.UV(a.u-1,a.v));0===b.x&&0===b.z&&(a=new THREE.UV(c/2/Math.PI+0.5,a.v));return a}THREE.Geometry.call(this);
for(var c=c||1,d=d||0,i=this,j=0,k=a.length;j<k;j++)e(new THREE.Vector3(a[j][0],a[j][1],a[j][2]));for(var l=[],a=this.vertices,j=0,k=b.length;j<k;j++)f(a[b[j][0]],a[b[j][1]],a[b[j][2]],d);this.mergeVertices();j=0;for(k=this.vertices.length;j<k;j++)this.vertices[j].multiplyScalar(c);this.computeCentroids();this.boundingSphere={radius:c}};THREE.PolyhedronGeometry.prototype=new THREE.Geometry;THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry;
THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,b)};THREE.IcosahedronGeometry.prototype=new THREE.Geometry;THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;
THREE.OctahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],a,b)};THREE.OctahedronGeometry.prototype=new THREE.Geometry;THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,b)};
THREE.TetrahedronGeometry.prototype=new THREE.Geometry;THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry;
THREE.ParametricGeometry=function(a,b,c,d){THREE.Geometry.call(this);var e=this.vertices,f=this.faces,g=this.faceVertexUvs[0],d=void 0===d?!1:d,h,i,j,k,l=b+1;for(h=0;h<=c;h++){k=h/c;for(i=0;i<=b;i++)j=i/b,j=a(j,k),e.push(j)}var p,m,r,q;for(h=0;h<c;h++)for(i=0;i<b;i++)a=h*l+i,e=h*l+i+1,k=(h+1)*l+i,j=(h+1)*l+i+1,p=new THREE.UV(h/b,i/c),m=new THREE.UV(h/b,(i+1)/c),r=new THREE.UV((h+1)/b,i/c),q=new THREE.UV((h+1)/b,(i+1)/c),d?(f.push(new THREE.Face3(a,e,k)),f.push(new THREE.Face3(e,j,k)),g.push([p,m,
r]),g.push([m,q,r])):(f.push(new THREE.Face4(a,e,j,k)),g.push([p,m,r,q]));this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=new THREE.Geometry;THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry;
THREE.AxisHelper=function(){THREE.Object3D.call(this);var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3);a.vertices.push(new THREE.Vector3(0,100,0));var b=new THREE.CylinderGeometry(0,5,25,5,1),c;c=new THREE.Line(a,new THREE.LineBasicMaterial({color:16711680}));c.rotation.z=-Math.PI/2;this.add(c);c=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:16711680}));c.position.x=100;c.rotation.z=-Math.PI/2;this.add(c);c=new THREE.Line(a,new THREE.LineBasicMaterial({color:65280}));this.add(c);
c=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:65280}));c.position.y=100;this.add(c);c=new THREE.Line(a,new THREE.LineBasicMaterial({color:255}));c.rotation.x=Math.PI/2;this.add(c);c=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:255}));c.position.z=100;c.rotation.x=Math.PI/2;this.add(c)};THREE.AxisHelper.prototype=new THREE.Object3D;THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;
THREE.ArrowHelper=function(a,b,c,d){THREE.Object3D.call(this);void 0===d&&(d=16776960);void 0===c&&(c=20);var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0));e.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:d}));this.add(this.line);e=new THREE.CylinderGeometry(0,0.05,0.25,5,1);this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:d}));this.cone.position.set(0,1,0);this.add(this.cone);b instanceof THREE.Vector3&&(this.position=
b);this.setDirection(a);this.setLength(c)};THREE.ArrowHelper.prototype=new THREE.Object3D;THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper;THREE.ArrowHelper.prototype.setDirection=function(a){var b=(new THREE.Vector3(0,1,0)).crossSelf(a),a=Math.acos((new THREE.Vector3(0,1,0)).dot(a.clone().normalize()));this.matrix=(new THREE.Matrix4).makeRotationAxis(b.normalize(),a);this.rotation.getRotationFromMatrix(this.matrix,this.scale)};
THREE.ArrowHelper.prototype.setLength=function(a){this.scale.set(a,a,a)};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.lineGeometry.vertices.push(new THREE.Vector3);d.lineGeometry.colors.push(new THREE.Color(b));void 0===d.pointMap[a]&&(d.pointMap[a]=[]);d.pointMap[a].push(d.lineGeometry.vertices.length-1)}THREE.Object3D.call(this);var d=this;this.lineGeometry=new THREE.Geometry;this.lineMaterial=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});this.pointMap={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4",
"n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);this.camera=a;this.update(a);
this.lines=new THREE.Line(this.lineGeometry,this.lineMaterial,THREE.LinePieces);this.add(this.lines)};THREE.CameraHelper.prototype=new THREE.Object3D;THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;
THREE.CameraHelper.prototype.update=function(){function a(a,d,e,f){THREE.CameraHelper.__v.set(d,e,f);THREE.CameraHelper.__projector.unprojectVector(THREE.CameraHelper.__v,THREE.CameraHelper.__c);a=b.pointMap[a];if(void 0!==a){d=0;for(e=a.length;d<e;d++)b.lineGeometry.vertices[a[d]].copy(THREE.CameraHelper.__v)}}var b=this;THREE.CameraHelper.__c.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,
1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",0.7,1.1,-1);a("u2",-0.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);this.lineGeometry.verticesNeedUpdate=!0};THREE.CameraHelper.__projector=new THREE.Projector;THREE.CameraHelper.__v=new THREE.Vector3;THREE.CameraHelper.__c=new THREE.Camera;
THREE.SubdivisionModifier=function(a){this.subdivisions=void 0===a?1:a;this.useOldVertexColors=!1;this.supportUVs=!0;this.debug=!1};THREE.SubdivisionModifier.prototype.constructor=THREE.SubdivisionModifier;THREE.SubdivisionModifier.prototype.modify=function(a){for(var b=this.subdivisions;0<b--;)this.smooth(a)};
THREE.SubdivisionModifier.prototype.smooth=function(a){function b(){p.debug&&console.log.apply(console,arguments)}function c(){console&&console.log.apply(console,arguments)}function d(a,c,d,e,g,h,i){var j=new THREE.Face4(a,c,d,e,null,g.color,g.material);if(p.useOldVertexColors){j.vertexColors=[];for(var s,u,o,m=0;4>m;m++){o=h[m];s=new THREE.Color;s.setRGB(0,0,0);for(var E=0;E<o.length;E++)u=g.vertexColors[o[E]-1],s.r+=u.r,s.g+=u.g,s.b+=u.b;s.r/=o.length;s.g/=o.length;s.b/=o.length;j.vertexColors[m]=
s}}k.push(j);p.supportUVs&&(g=[f(a,""),f(c,i),f(d,i),f(e,i)],g[0]?g[1]?g[2]?g[3]?l.push(g):b("d :( ",e+":"+i):b("c :( ",d+":"+i):b("b :( ",c+":"+i):b("a :( ",a+":"+i))}function e(a,b){return Math.min(a,b)+"_"+Math.max(a,b)}function f(a,d){var e=a+":"+d,f=w[e];return!f?(a>=z&&a<z+r.length?b("face pt"):b("edge pt"),c("warning, UV not found for",e),null):f}function g(a,b,d){var e=a+":"+b;e in w?c("dup vertexNo",a,"oldFaceNo",b,"value",d,"key",e,w[e]):w[e]=d}function h(a,b){void 0===J[a]&&(J[a]=[]);J[a].push(b)}
function i(a,b,c){void 0===N[a]&&(N[a]={});N[a][b]=c}var j=[],k=[],l=[],p=this,m=a.vertices,r=a.faces,j=m.concat(),q=[],t={},v={},w={},z=m.length,x,A,F,C,D,y=a.faceVertexUvs[0],s;b("originalFaces, uvs, originalVerticesLength",r.length,y.length,z);if(p.supportUVs){x=0;for(A=y.length;x<A;x++){F=0;for(C=y[x].length;F<C;F++)s=r[x]["abcd".charAt(F)],g(s,x,y[x][F])}}0==y.length&&(p.supportUVs=!1);x=0;for(D in w)x++;x||(p.supportUVs=!1,b("no uvs"));b("-- Original Faces + Vertices UVs completed",w,"vs",y.length);
x=0;for(A=r.length;x<A;x++)D=r[x],q.push(D.centroid),j.push(D.centroid),p.supportUVs&&(y=new THREE.UV,D instanceof THREE.Face3?(y.u=f(D.a,x).u+f(D.b,x).u+f(D.c,x).u,y.v=f(D.a,x).v+f(D.b,x).v+f(D.c,x).v,y.u/=3,y.v/=3):D instanceof THREE.Face4&&(y.u=f(D.a,x).u+f(D.b,x).u+f(D.c,x).u+f(D.d,x).u,y.v=f(D.a,x).v+f(D.b,x).v+f(D.c,x).v+f(D.d,x).v,y.u/=4,y.v/=4),g(z+x,"",y));b("-- added UVs for new Faces",w);A=function(a){function b(a,c){h[a]===void 0&&(h[a]=[]);h[a].push(c)}var c,d,f,g,h={};c=0;for(d=a.faces.length;c<
d;c++){f=a.faces[c];if(f instanceof THREE.Face3){g=e(f.a,f.b);b(g,c);g=e(f.b,f.c);b(g,c);g=e(f.c,f.a);b(g,c)}else if(f instanceof THREE.Face4){g=e(f.a,f.b);b(g,c);g=e(f.b,f.c);b(g,c);g=e(f.c,f.d);b(g,c);g=e(f.d,f.a);b(g,c)}}return h}(a);s=0;var E,u,J={},N={};for(x in A){y=A[x];E=x.split("_");u=E[0];E=E[1];h(u,[u,E]);h(E,[u,E]);F=0;for(C=y.length;F<C;F++)D=y[F],i(u,D,x),i(E,D,x);2>y.length&&(v[x]=!0)}b("vertexEdgeMap",J,"vertexFaceMap",N);for(x in A)if(y=A[x],D=y[0],C=y[1],E=x.split("_"),u=E[0],E=
E[1],y=new THREE.Vector3,v[x]?(y.addSelf(m[u]),y.addSelf(m[E]),y.multiplyScalar(0.5)):(y.addSelf(q[D]),y.addSelf(q[C]),y.addSelf(m[u]),y.addSelf(m[E]),y.multiplyScalar(0.25)),t[x]=z+r.length+s,j.push(y),s++,p.supportUVs)y=new THREE.UV,y.u=f(u,D).u+f(E,D).u,y.v=f(u,D).v+f(E,D).v,y.u/=2,y.v/=2,g(t[x],D,y),v[x]||(y=new THREE.UV,y.u=f(u,C).u+f(E,C).u,y.v=f(u,C).v+f(E,C).v,y.u/=2,y.v/=2,g(t[x],C,y));b("-- Step 2 done");var B,M;C=["123","12","2","23"];E=["123","23","3","31"];var I=["123","31","1","12"],
o=["1234","12","2","23"],Q=["1234","23","3","34"],P=["1234","34","4","41"],H=["1234","41","1","12"];x=0;for(A=q.length;x<A;x++)D=r[x],y=z+x,D instanceof THREE.Face3?(s=e(D.a,D.b),u=e(D.b,D.c),B=e(D.c,D.a),d(y,t[s],D.b,t[u],D,C,x),d(y,t[u],D.c,t[B],D,E,x),d(y,t[B],D.a,t[s],D,I,x)):D instanceof THREE.Face4?(s=e(D.a,D.b),u=e(D.b,D.c),B=e(D.c,D.d),M=e(D.d,D.a),d(y,t[s],D.b,t[u],D,o,x),d(y,t[u],D.c,t[B],D,Q,x),d(y,t[B],D.d,t[M],D,P,x),d(y,t[M],D.a,t[s],D,H,x)):b("face should be a face!",D);t=new THREE.Vector3;
D=new THREE.Vector3;x=0;for(A=m.length;x<A;x++)if(void 0!==J[x]){t.set(0,0,0);D.set(0,0,0);u=new THREE.Vector3(0,0,0);y=0;for(F in N[x])t.addSelf(q[F]),y++;C=0;s=J[x].length;for(F=0;F<s;F++)v[e(J[x][F][0],J[x][F][1])]&&C++;if(2!=C){t.divideScalar(y);for(F=0;F<s;F++)y=J[x][F],y=m[y[0]].clone().addSelf(m[y[1]]).divideScalar(2),D.addSelf(y);D.divideScalar(s);u.addSelf(m[x]);u.multiplyScalar(s-3);u.addSelf(t);u.addSelf(D.multiplyScalar(2));u.divideScalar(s);j[x]=u}}a.vertices=j;a.faces=k;a.faceVertexUvs[0]=
l;delete a.__tmpVertices;a.computeCentroids();a.computeFaceNormals();a.computeVertexNormals()};THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};THREE.ImmediateRenderObject.prototype=new THREE.Object3D;THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject;
THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,e)};THREE.LensFlare.prototype=new THREE.Object3D;THREE.LensFlare.prototype.constructor=THREE.LensFlare;THREE.LensFlare.prototype.supr=THREE.Object3D.prototype;
THREE.LensFlare.prototype.add=function(a,b,c,d,e,f){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===f&&(f=1);void 0===e&&(e=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:f,color:e,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+e*c.distance,c.wantedRotation=0.25*c.x*Math.PI,c.rotation+=0.25*(c.wantedRotation-c.rotation)};
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=new THREE.Mesh;THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh;
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)(\d+)/,c,d={},e=this.geometry,f=0,g=e.morphTargets.length;f<g;f++){var h=e.morphTargets[f].name.match(b);if(h&&1<h.length){var i=h[1];d[i]||(d[i]={start:Infinity,end:-Infinity});h=d[i];f<h.start&&(h.start=f);f>h.end&&(h.end=f);c||(c=i)}}for(i in d)h=d[i],this.createAnimation(i,h.start,h.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)if(d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time)d.time=0,d.directionBackwards=!1}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var f=d.startFrame+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),g=d.weight;
f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f);e=d.time%e/e;d.directionBackwards&&(e=1-e);this.morphTargetInfluences[d.currentFrame]=e*g;this.morphTargetInfluences[d.lastFrame]=(1-e)*g}}};
THREE.LensFlarePlugin=function(){function a(a){var c=b.createProgram(),d=b.createShader(b.FRAGMENT_SHADER),e=b.createShader(b.VERTEX_SHADER);b.shaderSource(d,a.fragmentShader);b.shaderSource(e,a.vertexShader);b.compileShader(d);b.compileShader(e);b.attachShader(c,d);b.attachShader(c,e);b.linkProgram(c);return c}var b,c,d,e,f,g,h,i,j,k,l,p,m;this.init=function(r){b=r.context;c=r;d=new Float32Array(16);e=new Uint16Array(6);r=0;d[r++]=-1;d[r++]=-1;d[r++]=0;d[r++]=0;d[r++]=1;d[r++]=-1;d[r++]=1;d[r++]=
0;d[r++]=1;d[r++]=1;d[r++]=1;d[r++]=1;d[r++]=-1;d[r++]=1;d[r++]=0;d[r++]=1;r=0;e[r++]=0;e[r++]=1;e[r++]=2;e[r++]=0;e[r++]=2;e[r++]=3;f=b.createBuffer();g=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,f);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);b.bufferData(b.ELEMENT_ARRAY_BUFFER,e,b.STATIC_DRAW);h=b.createTexture();i=b.createTexture();b.bindTexture(b.TEXTURE_2D,h);b.texImage2D(b.TEXTURE_2D,0,b.RGB,16,16,0,b.RGB,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,i);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);0>=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(j=!1,k=a(THREE.ShaderFlares.lensFlare)):(j=!0,k=a(THREE.ShaderFlares.lensFlareVertexTexture));l={};p={};l.vertex=b.getAttribLocation(k,"position");l.uv=b.getAttribLocation(k,"uv");p.renderType=b.getUniformLocation(k,"renderType");p.map=b.getUniformLocation(k,"map");p.occlusionMap=b.getUniformLocation(k,"occlusionMap");p.opacity=b.getUniformLocation(k,"opacity");p.color=b.getUniformLocation(k,
"color");p.scale=b.getUniformLocation(k,"scale");p.rotation=b.getUniformLocation(k,"rotation");p.screenPosition=b.getUniformLocation(k,"screenPosition");m=!1};this.render=function(a,d,e,v){var a=a.__webglFlares,w=a.length;if(w){var z=new THREE.Vector3,x=v/e,A=0.5*e,F=0.5*v,C=16/v,D=new THREE.Vector2(C*x,C),y=new THREE.Vector3(1,1,0),s=new THREE.Vector2(1,1),E=p,C=l;b.useProgram(k);m||(b.enableVertexAttribArray(l.vertex),b.enableVertexAttribArray(l.uv),m=!0);b.uniform1i(E.occlusionMap,0);b.uniform1i(E.map,
1);b.bindBuffer(b.ARRAY_BUFFER,f);b.vertexAttribPointer(C.vertex,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(C.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);b.disable(b.CULL_FACE);b.depthMask(!1);var u,J,N,B,M;for(u=0;u<w;u++)if(C=16/v,D.set(C*x,C),B=a[u],z.set(B.matrixWorld.elements[12],B.matrixWorld.elements[13],B.matrixWorld.elements[14]),d.matrixWorldInverse.multiplyVector3(z),d.projectionMatrix.multiplyVector3(z),y.copy(z),s.x=y.x*A+A,s.y=y.y*F+F,j||0<s.x&&s.x<e&&0<s.y&&s.y<v){b.activeTexture(b.TEXTURE1);
b.bindTexture(b.TEXTURE_2D,h);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,s.x-8,s.y-8,16,16,0);b.uniform1i(E.renderType,0);b.uniform2f(E.scale,D.x,D.y);b.uniform3f(E.screenPosition,y.x,y.y,y.z);b.disable(b.BLEND);b.enable(b.DEPTH_TEST);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,i);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGBA,s.x-8,s.y-8,16,16,0);b.uniform1i(E.renderType,1);b.disable(b.DEPTH_TEST);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,
h);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);B.positionScreen.copy(y);B.customUpdateCallback?B.customUpdateCallback(B):B.updateLensFlares();b.uniform1i(E.renderType,2);b.enable(b.BLEND);J=0;for(N=B.lensFlares.length;J<N;J++)M=B.lensFlares[J],0.0010<M.opacity&&0.0010<M.scale&&(y.x=M.x,y.y=M.y,y.z=M.z,C=M.size*M.scale/v,D.x=C*x,D.y=C,b.uniform3f(E.screenPosition,y.x,y.y,y.z),b.uniform2f(E.scale,D.x,D.y),b.uniform1f(E.rotation,M.rotation),b.uniform1f(E.opacity,M.opacity),b.uniform3f(E.color,M.color.r,
M.color.g,M.color.b),c.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),c.setTexture(M.texture,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);b.depthMask(!0)}}};
THREE.ShadowMapPlugin=function(){var a,b,c,d,e=new THREE.Frustum,f=new THREE.Matrix4,g=new THREE.Vector3,h=new THREE.Vector3;this.init=function(e){a=e.context;b=e;var e=THREE.ShaderLib.depthRGBA,f=THREE.UniformsUtils.clone(e.uniforms);c=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:f});d=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:f,morphTargets:!0});c._shadowPass=!0;d._shadowPass=!0};this.render=function(a,
c){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,c)};this.update=function(i,j){var k,l,p,m,r,q,t,v,w,z=[];m=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);b.shadowMapCullFrontFaces?a.cullFace(a.FRONT):a.cullFace(a.BACK);b.setDepthTest(!0);k=0;for(l=i.__lights.length;k<l;k++)if(p=i.__lights[k],p.castShadow)if(p instanceof THREE.DirectionalLight&&p.shadowCascade)for(r=0;r<p.shadowCascadeCount;r++){var x;if(p.shadowCascadeArray[r])x=p.shadowCascadeArray[r];else{w=p;t=r;x=
new THREE.DirectionalLight;x.isVirtual=!0;x.onlyShadow=!0;x.castShadow=!0;x.shadowCameraNear=w.shadowCameraNear;x.shadowCameraFar=w.shadowCameraFar;x.shadowCameraLeft=w.shadowCameraLeft;x.shadowCameraRight=w.shadowCameraRight;x.shadowCameraBottom=w.shadowCameraBottom;x.shadowCameraTop=w.shadowCameraTop;x.shadowCameraVisible=w.shadowCameraVisible;x.shadowDarkness=w.shadowDarkness;x.shadowBias=w.shadowCascadeBias[t];x.shadowMapWidth=w.shadowCascadeWidth[t];x.shadowMapHeight=w.shadowCascadeHeight[t];
x.pointsWorld=[];x.pointsFrustum=[];v=x.pointsWorld;q=x.pointsFrustum;for(var A=0;8>A;A++)v[A]=new THREE.Vector3,q[A]=new THREE.Vector3;v=w.shadowCascadeNearZ[t];w=w.shadowCascadeFarZ[t];q[0].set(-1,-1,v);q[1].set(1,-1,v);q[2].set(-1,1,v);q[3].set(1,1,v);q[4].set(-1,-1,w);q[5].set(1,-1,w);q[6].set(-1,1,w);q[7].set(1,1,w);x.originalCamera=j;q=new THREE.Gyroscope;q.position=p.shadowCascadeOffset;q.add(x);q.add(x.target);j.add(q);p.shadowCascadeArray[r]=x;console.log("Created virtualLight",x)}t=p;v=
r;w=t.shadowCascadeArray[v];w.position.copy(t.position);w.target.position.copy(t.target.position);w.lookAt(w.target);w.shadowCameraVisible=t.shadowCameraVisible;w.shadowDarkness=t.shadowDarkness;w.shadowBias=t.shadowCascadeBias[v];q=t.shadowCascadeNearZ[v];t=t.shadowCascadeFarZ[v];w=w.pointsFrustum;w[0].z=q;w[1].z=q;w[2].z=q;w[3].z=q;w[4].z=t;w[5].z=t;w[6].z=t;w[7].z=t;z[m]=x;m++}else z[m]=p,m++;k=0;for(l=z.length;k<l;k++){p=z[k];p.shadowMap||(p.shadowMap=new THREE.WebGLRenderTarget(p.shadowMapWidth,
p.shadowMapHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}),p.shadowMapSize=new THREE.Vector2(p.shadowMapWidth,p.shadowMapHeight),p.shadowMatrix=new THREE.Matrix4);if(!p.shadowCamera){if(p instanceof THREE.SpotLight)p.shadowCamera=new THREE.PerspectiveCamera(p.shadowCameraFov,p.shadowMapWidth/p.shadowMapHeight,p.shadowCameraNear,p.shadowCameraFar);else if(p instanceof THREE.DirectionalLight)p.shadowCamera=new THREE.OrthographicCamera(p.shadowCameraLeft,p.shadowCameraRight,
p.shadowCameraTop,p.shadowCameraBottom,p.shadowCameraNear,p.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}i.add(p.shadowCamera);b.autoUpdateScene&&i.updateMatrixWorld()}p.shadowCameraVisible&&!p.cameraHelper&&(p.cameraHelper=new THREE.CameraHelper(p.shadowCamera),p.shadowCamera.add(p.cameraHelper));if(p.isVirtual&&x.originalCamera==j){r=j;m=p.shadowCamera;q=p.pointsFrustum;w=p.pointsWorld;g.set(Infinity,Infinity,Infinity);h.set(-Infinity,-Infinity,-Infinity);for(t=
0;8>t;t++)if(v=w[t],v.copy(q[t]),THREE.ShadowMapPlugin.__projector.unprojectVector(v,r),m.matrixWorldInverse.multiplyVector3(v),v.x<g.x&&(g.x=v.x),v.x>h.x&&(h.x=v.x),v.y<g.y&&(g.y=v.y),v.y>h.y&&(h.y=v.y),v.z<g.z&&(g.z=v.z),v.z>h.z)h.z=v.z;m.left=g.x;m.right=h.x;m.top=h.y;m.bottom=g.y;m.updateProjectionMatrix()}m=p.shadowMap;q=p.shadowMatrix;r=p.shadowCamera;r.position.copy(p.matrixWorld.getPosition());r.lookAt(p.target.matrixWorld.getPosition());r.updateMatrixWorld();r.matrixWorldInverse.getInverse(r.matrixWorld);
p.cameraHelper&&(p.cameraHelper.lines.visible=p.shadowCameraVisible);p.shadowCameraVisible&&p.cameraHelper.update();q.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);q.multiplySelf(r.projectionMatrix);q.multiplySelf(r.matrixWorldInverse);r._viewMatrixArray||(r._viewMatrixArray=new Float32Array(16));r._projectionMatrixArray||(r._projectionMatrixArray=new Float32Array(16));r.matrixWorldInverse.flattenToArray(r._viewMatrixArray);r.projectionMatrix.flattenToArray(r._projectionMatrixArray);f.multiply(r.projectionMatrix,
r.matrixWorldInverse);e.setFromMatrix(f);b.setRenderTarget(m);b.clear();w=i.__webglObjects;p=0;for(m=w.length;p<m;p++)if(t=w[p],q=t.object,t.render=!1,q.visible&&q.castShadow&&(!(q instanceof THREE.Mesh)||!q.frustumCulled||e.contains(q)))q._modelViewMatrix.multiply(r.matrixWorldInverse,q.matrixWorld),t.render=!0;p=0;for(m=w.length;p<m;p++)t=w[p],t.render&&(q=t.object,t=t.buffer,v=q.customDepthMaterial?q.customDepthMaterial:q.geometry.morphTargets.length?d:c,t instanceof THREE.BufferGeometry?b.renderBufferDirect(r,
i.__lights,null,v,t,q):b.renderBuffer(r,i.__lights,null,v,t,q));w=i.__webglObjectsImmediate;p=0;for(m=w.length;p<m;p++)t=w[p],q=t.object,q.visible&&q.castShadow&&(q._modelViewMatrix.multiply(r.matrixWorldInverse,q.matrixWorld),b.renderImmediateObject(r,i.__lights,null,c,q))}k=b.getClearColor();l=b.getClearAlpha();a.clearColor(k.r,k.g,k.b,l);a.enable(a.BLEND);b.shadowMapCullFrontFaces&&a.cullFace(a.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.SpritePlugin=function(){function a(a,b){return b.z-a.z}var b,c,d,e,f,g,h,i,j,k;this.init=function(a){b=a.context;c=a;d=new Float32Array(16);e=new Uint16Array(6);a=0;d[a++]=-1;d[a++]=-1;d[a++]=0;d[a++]=1;d[a++]=1;d[a++]=-1;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=1;d[a++]=0;d[a++]=-1;d[a++]=1;d[a++]=0;a=d[a++]=0;e[a++]=0;e[a++]=1;e[a++]=2;e[a++]=0;e[a++]=2;e[a++]=3;f=b.createBuffer();g=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,f);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
g);b.bufferData(b.ELEMENT_ARRAY_BUFFER,e,b.STATIC_DRAW);var a=THREE.ShaderSprite.sprite,p=b.createProgram(),m=b.createShader(b.FRAGMENT_SHADER),r=b.createShader(b.VERTEX_SHADER);b.shaderSource(m,a.fragmentShader);b.shaderSource(r,a.vertexShader);b.compileShader(m);b.compileShader(r);b.attachShader(p,m);b.attachShader(p,r);b.linkProgram(p);h=p;i={};j={};i.position=b.getAttribLocation(h,"position");i.uv=b.getAttribLocation(h,"uv");j.uvOffset=b.getUniformLocation(h,"uvOffset");j.uvScale=b.getUniformLocation(h,
"uvScale");j.rotation=b.getUniformLocation(h,"rotation");j.scale=b.getUniformLocation(h,"scale");j.alignment=b.getUniformLocation(h,"alignment");j.color=b.getUniformLocation(h,"color");j.map=b.getUniformLocation(h,"map");j.opacity=b.getUniformLocation(h,"opacity");j.useScreenCoordinates=b.getUniformLocation(h,"useScreenCoordinates");j.affectedByDistance=b.getUniformLocation(h,"affectedByDistance");j.screenPosition=b.getUniformLocation(h,"screenPosition");j.modelViewMatrix=b.getUniformLocation(h,"modelViewMatrix");
j.projectionMatrix=b.getUniformLocation(h,"projectionMatrix");k=!1};this.render=function(d,e,m,r){var d=d.__webglSprites,q=d.length;if(q){var t=i,v=j,w=r/m,m=0.5*m,z=0.5*r,x=!0;b.useProgram(h);k||(b.enableVertexAttribArray(t.position),b.enableVertexAttribArray(t.uv),k=!0);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.depthMask(!0);b.bindBuffer(b.ARRAY_BUFFER,f);b.vertexAttribPointer(t.position,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(t.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);b.uniformMatrix4fv(v.projectionMatrix,
!1,e._projectionMatrixArray);b.activeTexture(b.TEXTURE0);b.uniform1i(v.map,0);for(var A,F=[],t=0;t<q;t++)A=d[t],A.visible&&0!==A.opacity&&(A.useScreenCoordinates?A.z=-A.position.z:(A._modelViewMatrix.multiply(e.matrixWorldInverse,A.matrixWorld),A.z=-A._modelViewMatrix.elements[14]));d.sort(a);for(t=0;t<q;t++)if(A=d[t],A.visible&&0!==A.opacity&&A.map&&A.map.image&&A.map.image.width)A.useScreenCoordinates?(b.uniform1i(v.useScreenCoordinates,1),b.uniform3f(v.screenPosition,(A.position.x-m)/m,(z-A.position.y)/
z,Math.max(0,Math.min(1,A.position.z)))):(b.uniform1i(v.useScreenCoordinates,0),b.uniform1i(v.affectedByDistance,A.affectedByDistance?1:0),b.uniformMatrix4fv(v.modelViewMatrix,!1,A._modelViewMatrix.elements)),e=A.map.image.width/(A.scaleByViewport?r:1),F[0]=e*w*A.scale.x,F[1]=e*A.scale.y,b.uniform2f(v.uvScale,A.uvScale.x,A.uvScale.y),b.uniform2f(v.uvOffset,A.uvOffset.x,A.uvOffset.y),b.uniform2f(v.alignment,A.alignment.x,A.alignment.y),b.uniform1f(v.opacity,A.opacity),b.uniform3f(v.color,A.color.r,
A.color.g,A.color.b),b.uniform1f(v.rotation,A.rotation),b.uniform2fv(v.scale,F),A.mergeWith3D&&!x?(b.enable(b.DEPTH_TEST),x=!0):!A.mergeWith3D&&x&&(b.disable(b.DEPTH_TEST),x=!1),c.setBlending(A.blending,A.blendEquation,A.blendSrc,A.blendDst),c.setTexture(A.map,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);b.depthMask(!0)}}};
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var a,b,c,d,e=new THREE.Frustum,f=new THREE.Matrix4;this.init=function(e){a=e.context;b=e;var e=THREE.ShaderLib.depthRGBA,f=THREE.UniformsUtils.clone(e.uniforms);c=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:f});d=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:f,morphTargets:!0});c._shadowPass=!0;d._shadowPass=!0};this.render=function(a,
b){this.enabled&&this.update(a,b)};this.update=function(g,h){var i,j,k,l,p,m;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.setDepthTest(!0);b.autoUpdateScene&&g.updateMatrixWorld();h._viewMatrixArray||(h._viewMatrixArray=new Float32Array(16));h._projectionMatrixArray||(h._projectionMatrixArray=new Float32Array(16));h.matrixWorldInverse.getInverse(h.matrixWorld);h.matrixWorldInverse.flattenToArray(h._viewMatrixArray);h.projectionMatrix.flattenToArray(h._projectionMatrixArray);f.multiply(h.projectionMatrix,
h.matrixWorldInverse);e.setFromMatrix(f);b.setRenderTarget(this.renderTarget);b.clear();m=g.__webglObjects;i=0;for(j=m.length;i<j;i++)if(k=m[i],p=k.object,k.render=!1,p.visible&&(!(p instanceof THREE.Mesh)||!p.frustumCulled||e.contains(p)))p._modelViewMatrix.multiply(h.matrixWorldInverse,p.matrixWorld),k.render=!0;i=0;for(j=m.length;i<j;i++)k=m[i],k.render&&(p=k.object,k=k.buffer,b.setObjectFaces(p),l=p.customDepthMaterial?p.customDepthMaterial:p.geometry.morphTargets.length?d:c,k instanceof THREE.BufferGeometry?
b.renderBufferDirect(h,g.__lights,null,l,k,p):b.renderBuffer(h,g.__lights,null,l,k,p));m=g.__webglObjectsImmediate;i=0;for(j=m.length;i<j;i++)k=m[i],p=k.object,p.visible&&p.castShadow&&(p._modelViewMatrix.multiply(h.matrixWorldInverse,p.matrixWorld),b.renderImmediateObject(h,g.__lights,null,c,p));i=b.getClearColor();j=b.getClearAlpha();a.clearColor(i.r,i.g,i.b,j);a.enable(a.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform sampler2D map;\nuniform float opacity;\nuniform int renderType;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform int renderType;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int affectedByDistance;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( affectedByDistance == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
fragmentShader:"precision mediump float;\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n}"}};
(function(a,b){function c(b,c){var g=b.nodeName.toLowerCase();if("area"===g){var g=b.parentNode,h=g.name,i;return!b.href||!h||"map"!==g.nodeName.toLowerCase()?!1:(i=a("img[usemap=#"+h+"]")[0],!!i&&d(i))}return(/input|select|textarea|button|object/.test(g)?!b.disabled:"a"==g?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return"hidden"===a.curCSS(this,"visibility")||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.23",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return"number"==typeof b?this.each(function(){var d=
this;setTimeout(function(){a(d).focus();c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var c=a(this[0]),d;c.length&&c[0]!==document;){d=c.css("position");if("absolute"===d||"relative"===d||"fixed"===d)if(d=parseInt(c.css("zIndex"),10),!isNaN(d)&&0!==d)return d;c=c.parent()}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+
".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function g(b,c,d,e){return a.each(h,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0;d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0);e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var h="Width"===d?["Left","Right"]:["Top","Bottom"],i=d.toLowerCase(),j={innerWidth:a.fn.innerWidth,
innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?j["inner"+d].call(this):this.each(function(){a(this).css(i,g(this,c)+"px")})};a.fn["outer"+d]=function(b,c){return"number"!=typeof b?j["outer"+d].call(this,b):this.each(function(){a(this).css(i,g(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,
d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),g=isNaN(d);return(g||0<=d)&&c(b,!g)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight;a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=100===c.offsetHeight;a.support.selectstart="onselectstart"in c;b.removeChild(c).style.display="none"}),a.curCSS||(a.curCSS=a.css),a.extend(a.ui,{plugin:{add:function(b,
c,d){var b=a.ui[b].prototype,h;for(h in d)b.plugins[h]=b.plugins[h]||[],b.plugins[h].push([c,d[h]])},call:function(a,b,c){if((b=a.plugins[b])&&a.element[0].parentNode)for(var d=0;d<b.length;d++)a.options[b[d][0]]&&b[d][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop";return 0<b[d]?!0:(b[d]=1,b[d]=
0,!1)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,h,i,j){return a.ui.isOverAxis(b,d,i)&&a.ui.isOverAxis(c,h,j)}}))})(jQuery);
(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,g;null!=(g=b[d]);d++)try{a(g).triggerHandler("remove")}catch(h){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var h=b.split(".")[0],i,b=b.split(".")[1];i=h+"-"+b;d||(d=c,c=a.Widget);a.expr[":"][i]=
function(c){return!!a.data(c,b)};a[h]=a[h]||{};a[h][b]=function(a,b){arguments.length&&this._createWidget(a,b)};c=new c;c.options=a.extend(!0,{},c.options);a[h][b].prototype=a.extend(!0,c,{namespace:h,widgetName:b,widgetEventPrefix:a[h][b].prototype.widgetEventPrefix||b,widgetBaseClass:i},d);a.widget.bridge(b,a[h][b])};a.widget.bridge=function(c,d){a.fn[c]=function(g){var h="string"==typeof g,i=Array.prototype.slice.call(arguments,1),j=this;return g=!h&&i.length?a.extend.apply(null,[!0,g].concat(i)):
g,h&&"_"===g.charAt(0)?j:(h?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[g])?d[g].apply(d,i):d;if(f!==d&&f!==b)return j=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(g||{})._init():a.data(this,c,new d(g,this))}),j)}};a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this);this.element=a(c);this.options=a.extend(!0,{},
this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var g=c;if(0===arguments.length)return a.extend({},this.options);if("string"==typeof c){if(d===b)return this.options[c];g={};g[c]=d}return this._setOptions(g),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var h,i=this.options[b],d=d||{},c=a.Event(c);c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();c.target=this.element[0];if(b=c.originalEvent)for(h in b)h in c||(c[h]=b[h]);return this.element.trigger(c,d),!(a.isFunction(i)&&!1===i.call(this.element[0],c,d)||c.isDefaultPrevented())}}})(jQuery);
(function(a){var b=!1;a(document).mouseup(function(){b=!1});a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(d){if(!0===a.data(d.target,b.widgetName+".preventClickEvent"))return a.removeData(d.target,b.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName);this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,e=1==c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(c))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=
setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));return this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+
this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)}},_mouseMove:function(b){return!a.browser.msie||9<=document.documentMode||b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+
this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(a){a.ui=a.ui||{};var b=/left|center|right/,c=/top|center|bottom/,d,e=a.fn.position,f=a.fn.offset;a.fn.position=function(f){if(!f||!f.of)return e.apply(this,arguments);var f=a.extend({},f),h=a(f.of),i=h[0],j=(f.collision||"flip").split(" "),k=f.offset?f.offset.split(" "):[0,0],l,p,m;return 9===i.nodeType?(l=h.width(),p=h.height(),m={top:0,left:0}):i.setTimeout?(l=h.width(),p=h.height(),m={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(f.at="left top",l=p=0,m={top:f.of.pageY,left:f.of.pageX}):
(l=h.outerWidth(),p=h.outerHeight(),m=h.offset()),a.each(["my","at"],function(){var a=(f[this]||"").split(" ");1===a.length&&(a=b.test(a[0])?a.concat(["center"]):c.test(a[0])?["center"].concat(a):["center","center"]);a[0]=b.test(a[0])?a[0]:"center";a[1]=c.test(a[1])?a[1]:"center";f[this]=a}),1===j.length&&(j[1]=j[0]),k[0]=parseInt(k[0],10)||0,1===k.length&&(k[1]=k[0]),k[1]=parseInt(k[1],10)||0,"right"===f.at[0]?m.left+=l:"center"===f.at[0]&&(m.left+=l/2),"bottom"===f.at[1]?m.top+=p:"center"===f.at[1]&&
(m.top+=p/2),m.left+=k[0],m.top+=k[1],this.each(function(){var b=a(this),c=b.outerWidth(),e=b.outerHeight(),h=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,z=c+h+(parseInt(a.curCSS(this,"marginRight",!0))||0),x=e+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0),A=a.extend({},m),F;"right"===f.my[0]?A.left-=c:"center"===f.my[0]&&(A.left-=c/2);"bottom"===f.my[1]?A.top-=e:"center"===f.my[1]&&(A.top-=e/2);d||(A.left=Math.round(A.left),A.top=Math.round(A.top));
F={left:A.left-h,top:A.top-i};a.each(["left","top"],function(b,d){a.ui.position[j[b]]&&a.ui.position[j[b]][d](A,{targetWidth:l,targetHeight:p,elemWidth:c,elemHeight:e,collisionPosition:F,collisionWidth:z,collisionHeight:x,offset:k,my:f.my,at:f.at})});a.fn.bgiframe&&b.bgiframe();b.offset(a.extend(A,{using:f.using}))})};a.ui.position={fit:{left:function(b,c){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=0<d?b.left-d:Math.max(b.left-c.collisionPosition.left,
b.left)},top:function(b,c){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=0<d?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if("center"!==c.at[0]){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),e="left"===c.my[0]?-c.elemWidth:"right"===c.my[0]?c.elemWidth:0,f="left"===c.at[0]?c.targetWidth:-c.targetWidth,l=-2*c.offset[0];b.left+=0>c.collisionPosition.left?e+f+l:0<d?e+f+l:0}},top:function(b,
c){if("center"!==c.at[1]){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),e="top"===c.my[1]?-c.elemHeight:"bottom"===c.my[1]?c.elemHeight:0,f="top"===c.at[1]?c.targetHeight:-c.targetHeight,l=-2*c.offset[1];b.top+=0>c.collisionPosition.top?e+f+l:0<d?e+f+l:0}}}};a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,l=parseInt(a.curCSS(b,
"left",!0),10)||0,e={top:c.top-e.top+f,left:c.left-e.left+l};"using"in c?c.using.call(b,e):d.css(e)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?a.isFunction(b)?this.each(function(c){a(this).offset(b.call(this,c,a(this).offset()))}):this.each(function(){a.offset.setOffset(this,b)}):f.call(this)});a.curCSS||(a.curCSS=a.css);(function(){var b=document.getElementsByTagName("body")[0],c=document.createElement("div"),e,f;e=document.createElement(b?"div":"body");f={visibility:"hidden",
width:0,height:0,border:0,margin:0,background:"none"};b&&a.extend(f,{position:"absolute",left:"-1000px",top:"-1000px"});for(var k in f)e.style[k]=f[k];e.appendChild(c);f=b||document.documentElement;f.insertBefore(e,f.firstChild);c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";c=a(c).offset(function(a,b){return b}).offset();e.innerHTML="";f.removeChild(e);b=c.top+c.left+(b?2E3:0);d=21<b&&22>b})()})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){return!this.element.data("draggable")?void 0:(this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this)},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?
!1:(this.handle=this._getHandle(b),this.handle?(c.iframeFix&&a(!0===c.iframeFix?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),
a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),
this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=
this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b));this.dropped&&(c=this.dropped,this.dropped=!1);
for(var d=this.element[0],e=!1;d&&(d=d.parentNode);)d==document&&(e=!0);if(!e&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!c||"valid"==this.options.revert&&c||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==f._trigger("stop",b)&&f._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},
_mouseUp:function(b){return!0===this.options.iframeFix&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==
b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"==c.helper?this.element.clone().removeAttr("id"):this.element;return b.parents("body").length||b.appendTo("parent"==c.appendTo?this.element[0].parentNode:c.appendTo),b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute"),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],
top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==b.containment?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:a(window).scrollLeft())+a("document"==b.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:a(window).scrollTop())+(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var b=a(b.containment),c=b[0];if(c){b.offset();var d="hidden"!=a(c).css("overflow");this.containment=[(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),
10)||0),(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0),(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"==b?1:-1,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;this.containment&&(this.relative_container?(h=this.relative_container.offset(),h=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]):h=this.containment,b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),
b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top));c.grid&&(g=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY,g=h?g-this.offset.click.top<h[1]||g-this.offset.click.top>h[3]?g-this.offset.click.top<h[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX,f=h?f-this.offset.click.left<h[0]||f-this.offset.click.left>h[2]?f-this.offset.click.left<h[0]?
f+c.grid[0]:f-c.grid[0]:f:f)}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.23"});
a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[];a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this;a.each(d.sortables,function(){this.instance.positionAbs=
d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=d.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,
!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("draggable").options;
b.css("cursor")&&(c._cursor=b.css("cursor"));b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity"));d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable",
"scroll",{start:function(){var b=a(this).data("draggable");b.scrollParent[0]!=document&&"HTML"!=b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("draggable"),d=c.options,e=!1;if(c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName){if(!d.axis||"x"!=d.axis)c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<
d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed);if(!d.axis||"y"!=d.axis)c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||"x"!=d.axis)b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-
d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed));if(!d.axis||"y"!=d.axis)b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed))}!1!==e&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,
b)}});a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("draggable"),c=b.options;b.snapElements=[];a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=a(this),e=c.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(b,c){for(var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,
j=i+d.helperProportions.height,k=d.snapElements.length-1;0<=k;k--){var l=d.snapElements[k].left,p=l+d.snapElements[k].width,m=d.snapElements[k].top,r=m+d.snapElements[k].height;if(l-f<g&&g<p+f&&m-f<i&&i<r+f||l-f<g&&g<p+f&&m-f<j&&j<r+f||l-f<h&&h<p+f&&m-f<i&&i<r+f||l-f<h&&h<p+f&&m-f<j&&j<r+f){if("inner"!=e.snapMode){var q=Math.abs(m-j)<=f,t=Math.abs(r-i)<=f,v=Math.abs(l-h)<=f,w=Math.abs(p-g)<=f;q&&(c.position.top=d._convertPositionTo("relative",{top:m-d.helperProportions.height,left:0}).top-d.margins.top);
t&&(c.position.top=d._convertPositionTo("relative",{top:r,left:0}).top-d.margins.top);v&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left);w&&(c.position.left=d._convertPositionTo("relative",{top:0,left:p}).left-d.margins.left)}var z=q||t||v||w;"outer"!=e.snapMode&&(q=Math.abs(m-i)<=f,t=Math.abs(r-j)<=f,v=Math.abs(l-g)<=f,w=Math.abs(p-h)<=f,q&&(c.position.top=d._convertPositionTo("relative",{top:m,left:0}).top-d.margins.top),t&&(c.position.top=
d._convertPositionTo("relative",{top:r-d.helperProportions.height,left:0}).top-d.margins.top),v&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),w&&(c.position.left=d._convertPositionTo("relative",{top:0,left:p-d.helperProportions.width}).left-d.margins.left));!d.snapElements[k].snapping&&(q||t||v||w||z)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item}));d.snapElements[k].snapping=q||t||v||w||z}else d.snapElements[k].snapping&&
d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options,b=a.makeArray(a(b.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(b.length){var c=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=c+a});this[0].style.zIndex=c+b.length}}});
a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex"));d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(c)?c:function(a){return a.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[];a.ui.ddmanager.droppables[b.scope].push(this);
b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var b=a.ui.ddmanager.droppables[this.options.scope],c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){"accept"==b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)});a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;if(c&&(c.currentItem||c.element)[0]!=this.element[0])this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;if(c&&(c.currentItem||c.element)[0]!=this.element[0])this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=
a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),
this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.23"});a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case "fit":return i<=e&&f<=
j&&k<=g&&h<=l;case "intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case "pointer":return a.ui.isOver((b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,k,i,c.proportions.height,c.proportions.width);case "touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}};
a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf(),g=0;a:for(;g<d.length;g++)if(!(d[g].options.disabled||b&&!d[g].accept.call(d[g].element[0],b.currentItem||b.element))){for(var h=0;h<f.length;h++)if(f[h]==d[g].element[0]){d[g].proportions.height=0;continue a}d[g].visible="none"!=d[g].element.css("display");d[g].visible&&("mousedown"==
e&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight})}},drop:function(b,c){var d=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=
0,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c);a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d=a.ui.intersect(b,this,this.options.tolerance);if(d=!d&&1==this.isover?"isout":d&&0==this.isover?
"isover":null){var e;if(this.options.greedy){var f=this.element.parents(":data(droppable):eq(0)");f.length&&(e=a.data(f[0],"droppable"),e.greedyChild="isover"==d?1:0)}e&&"isover"==d&&(e.isover=0,e.isout=1,e._out.call(e,c));this[d]=1;this["isout"==d?"isover":"isout"]=0;this["isover"==d?"_over":"_out"].call(this,c);e&&"isout"==d&&(e.isout=0,e.isover=1,e._over.call(e,c))}}})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable");b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,
c)}}})(jQuery);
(function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();
this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},destroy:function(){a.Widget.prototype.destroy.call(this);this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var b=this.items.length-1;0<=b;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===
b?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(b);var e=null,f=this;a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f)return e=a(this),!1});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var g=
!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(g=!0)});if(!g)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,d){c=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-
this.margins.left};a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();c.containment&&this._setContainment();c.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",c.cursor));c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity));c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex));this.scrollParent[0]!=
document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),
!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&
(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-
(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed)));!1!==d&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");
if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;0<=c;c--){var d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d);if(f&&e!=this.currentItem[0]&&this.placeholder[1==f?"next":"prev"]()[0]!=e&&!a.ui.contains(this.placeholder[0],e)&&("semi-dynamic"==this.options.type?!a.ui.contains(this.element[0],e):1)){this.direction=1==f?"down":
"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(d))this._rearrange(b,d);else break;this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0;a(this.helper).animate({left:e.left-
this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();
for(var b=this.containers.length-1;0<=b;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,
reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=
this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var c=this.positionAbs.left,d=c+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=a.left,h=g+a.width,i=a.top,j=i+a.height,k=this.offset.click.top,l=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?
"width":"height"]>a[this.floating?"width":"height"]?e+k>i&&e+k<j&&c+l>g&&c+l<h:g<c+this.helperProportions.width/2&&d-this.helperProportions.width/2<h&&i<e+this.helperProportions.height/2&&f-this.helperProportions.height/2<j},_intersectsWithPointer:function(b){var c="x"===this.options.axis||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),b="y"===this.options.axis||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),c=c&&b,b=this._getDragVerticalDirection(),
d=this._getDragHorizontalDirection();return c?this.floating?d&&"right"==d||"down"==b?2:1:b&&("down"==b?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"==e&&b||"left"==e&&!b:d&&("down"==d&&c||"up"==d&&!c)},_getDragVerticalDirection:function(){var a=
this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],d=[],e=this._connectWith();if(e&&b)for(b=e.length-1;0<=b;b--)for(var f=
a(e[b]),g=f.length-1;0<=g;g--){var h=a.data(f[g],this.widgetName);h&&h!=this&&!h.options.disabled&&d.push([a.isFunction(h.options.items)?h.options.items.call(h.element):a(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}d.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=d.length-
1;0<=b;b--)d[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data("+this.widgetName+"-item)"),c=0;c<this.items.length;c++)for(var d=0;d<a.length;d++)a[d]==this.items[c].item[0]&&this.items.splice(c,1)},_refreshItems:function(b){this.items=[];this.containers=[this];var c=this.items,d=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],e=
this._connectWith();if(e&&this.ready)for(var f=e.length-1;0<=f;f--)for(var g=a(e[f]),h=g.length-1;0<=h;h--){var i=a.data(g[h],this.widgetName);i&&i!=this&&!i.options.disabled&&(d.push([a.isFunction(i.options.items)?i.options.items.call(i.element[0],b,{item:this.currentItem}):a(i.options.items,i.element),i]),this.containers.push(i))}for(f=d.length-1;0<=f;f--){b=d[f][1];e=d[f][0];h=0;for(g=e.length;h<g;h++)i=a(e[h]),i.data(this.widgetName+"-item",b),c.push({item:i,instance:b,width:0,height:0,left:0,
top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;0<=c;c--){var d=this.items[c];if(!(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])){var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());e=e.offset();d.left=e.left;d.top=e.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);
else for(c=this.containers.length-1;0<=c;c--)e=this.containers[c].element.offset(),this.containers[c].containerCache.left=e.left,this.containers[c].containerCache.top=e.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=
a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return e||(b.style.visibility="hidden"),b},update:function(a,b){if(!e||d.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||
0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){for(var c=null,d=null,e=this.containers.length-1;0<=e;e--)if(!a.ui.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!c||!a.ui.contains(this.containers[e].element[0],c.element[0]))c=this.containers[e],d=e}else this.containers[e].containerCache.over&&
(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){for(var c=1E4,e=null,f=this.positionAbs[this.containers[d].floating?"left":"top"],g=this.items.length-1;0<=g;g--)if(a.ui.contains(this.containers[d].element[0],this.items[g].item[0])){var h=this.containers[d].floating?
this.items[g].item.offset().left:this.items[g].item.offset().top;Math.abs(h-f)<c&&(c=Math.abs(h-f),e=this.items[g],this.direction=0<h-f?"down":"up")}if(e||this.options.dropOnEmpty)this.currentContainer=this.containers[d],e?this._rearrange(b,e,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",
b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"==c.helper?this.currentItem.clone():this.currentItem;return b.parents("body").length||a("parent"!=c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]),b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==b[0].style.width||c.forceHelperSize)&&b.width(this.currentItem.width()),(""==b[0].style.height||c.forceHelperSize)&&b.height(this.currentItem.height()),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in
b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],b=a(b.containment).offset(),d="hidden"!=a(c).css("overflow");this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||
0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"==b?1:-1,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():
f?0:e.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==
document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&
(g=this.containment[3]+this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3]?g-this.offset.click.top<this.containment[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0],f=this.containment?f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2]?f-this.offset.click.left<
this.containment[0]?f+c.grid[0]:f-c.grid[0]:f:f));return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,c,d,e){d?d[0].appendChild(this.placeholder[0]):
c.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?c.item[0]:c.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)},_clear:function(b,c){this.reverting=!1;var d=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if("auto"==this._storedCSS[e]||
"static"==this._storedCSS[e])this._storedCSS[e]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],
this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(e=this.containers.length-1;0<=e;e--)a.ui.contains(this.containers[e].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[e])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[e])))}for(e=this.containers.length-1;0<=e;e--)c||d.push(function(a){return function(b){a._trigger("deactivate",
b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",
b,this._uiHash());for(e=0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}c||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!c){for(e=0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&
this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}});a.extend(a.ui.sortable,{version:"1.8.23"})})(jQuery);
(function(a){var b=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,d=this.element[0].ownerDocument,e;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(d){if(!b.options.disabled&&
!b.element.propAttr("readOnly")){e=!1;var g=a.ui.keyCode;switch(d.keyCode){case g.PAGE_UP:b._move("previousPage",d);break;case g.PAGE_DOWN:b._move("nextPage",d);break;case g.UP:b._keyEvent("previous",d);break;case g.DOWN:b._keyEvent("next",d);break;case g.ENTER:case g.NUMPAD_ENTER:b.menu.active&&(e=!0,d.preventDefault());case g.TAB:if(!b.menu.active)break;b.menu.select(d);break;case g.ESCAPE:b.element.val(b.term);b.close(d);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=
b.element.val()&&(b.selectedItem=null,b.search(null,d))},b.options.delay)}}}).bind("keypress.autocomplete",function(a){e&&(e=!1,a.preventDefault())}).bind("focus.autocomplete",function(){b.options.disabled||(b.selectedItem=null,b.previous=b.element.val())}).bind("blur.autocomplete",function(a){b.options.disabled||(clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a);b._change(a)},150))});this._initSource();this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||
"body",d)[0]).mousedown(function(d){var e=b.menu.element[0];a(d.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(d){d.target!==b.element[0]&&d.target!==e&&!a.ui.contains(e,d.target)&&b.close()})},1);setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,d){var e=d.item.data("item.autocomplete");!1!==b._trigger("focus",a,{item:e})&&/^key/.test(a.originalEvent.type)&&b.element.val(e.value)},selected:function(a,e){var h=e.item.data("item.autocomplete"),
i=b.previous;b.element[0]!==d.activeElement&&(b.element.focus(),b.previous=i,setTimeout(function(){b.previous=i;b.selectedItem=h},1));!1!==b._trigger("select",a,{item:h})&&b.element.val(h.value);b.term=b.element.val();b.close(a);b.selectedItem=h},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe();b.beforeunloadHandler=function(){b.element.removeAttr("autocomplete")};
a(window).bind("beforeunload",b.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a(window).unbind("beforeunload",this.beforeunloadHandler);a.Widget.prototype.destroy.call(this)},_setOption:function(b,d){a.Widget.prototype._setOption.apply(this,arguments);"source"===b&&this._initSource();"appendTo"===b&&this.menu.element.appendTo(a(d||
"body",this.element[0].ownerDocument)[0]);"disabled"===b&&d&&this.xhr&&this.xhr.abort()},_initSource:function(){var b=this,d,e;a.isArray(this.options.source)?(d=this.options.source,this.source=function(b,c){c(a.ui.autocomplete.filter(d,b.term))}):"string"==typeof this.options.source?(e=this.options.source,this.source=function(d,g){b.xhr&&b.xhr.abort();b.xhr=a.ajax({url:e,data:d,dataType:"json",success:function(a){g(a)},error:function(){g([])}})}):this.source=this.options.source},search:function(a,
b){a=null!=a?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);return!1===this._trigger("search",b)?void 0:this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:a},this._response())},_response:function(){var a=this,d=++b;return function(e){d===b&&a.__response(e);a.pending--;a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){!this.options.disabled&&
a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close()},close:function(a){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||
b.value,value:b.value||b.label},b)})},_suggest:function(b){var d=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(d,b);this.menu.deactivate();this.menu.refresh();d.show();this._resizeMenu();d.position(a.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,d){var e=
this;a.each(d,function(a,d){e._renderItem(b,d)})},_renderItem:function(b,d){return a("<li></li>").data("item.autocomplete",d).append(a("<a></a>").text(d.label)).appendTo(b)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a))this.element.val(this.term),this.menu.deactivate();else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element},_keyEvent:function(a,b){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(a,
b),b.preventDefault()}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,d){var e=RegExp(a.ui.autocomplete.escapeRegex(d),"i");return a.grep(b,function(a){return e.test(a.label||a.value||a)})}})})(jQuery);
(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){a(c.target).closest(".ui-menu-item a").length&&(c.preventDefault(),b.select(c))});this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,c){this.deactivate();if(this.hasScroll()){var d=c.offset().top-this.element.offset().top,e=this.element.scrollTop(),f=this.element.height();0>d?this.element.scrollTop(e+d):d>=f&&this.element.scrollTop(e+d-f+c.height())}this.active=c.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",a,{item:c})},deactivate:function(){this.active&&
(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,c,d){this.active?(a=this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.activate(d,
a):this.activate(d,this.element.children(c))):this.activate(d,this.element.children(c))},nextPage:function(b){if(this.hasScroll())if(!this.active||this.last())this.activate(b,this.element.children(".ui-menu-item:first"));else{var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-d+a(this).height();return 10>b&&-10<b});e.length||(e=this.element.children(".ui-menu-item:last"));this.activate(b,e)}else this.activate(b,
this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll())if(!this.active||this.first())this.activate(b,this.element.children(".ui-menu-item:last"));else{var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+d-a(this).height();return 10>b&&-10<b});e.length||(e=this.element.children(".ui-menu-item:first"));this.activate(b,e)}else this.activate(b,
this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})})(jQuery);
(function(a,b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},d={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,
show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!=typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var b=this,c=b.options,d=c.title||"&#160;",h=a.ui.dialog.getTitleId(b.element),i=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({zIndex:c.zIndex}).attr("tabIndex",-1).css("outline",
0).keydown(function(d){c.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE&&(b.close(d),d.preventDefault())}).attr({role:"dialog","aria-labelledby":h}).mousedown(function(a){b.moveToTop(!1,a)});b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(i);var j=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(i),k=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){k.addClass("ui-state-hover")},function(){k.removeClass("ui-state-hover")}).focus(function(){k.addClass("ui-state-focus")}).blur(function(){k.removeClass("ui-state-focus")}).click(function(a){return b.close(a),!1}).appendTo(j);(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(k);a("<span></span>").addClass("ui-dialog-title").attr("id",h).html(d).prependTo(j);a.isFunction(c.beforeclose)&&!a.isFunction(c.beforeClose)&&
(c.beforeClose=c.beforeclose);j.find("*").add(j).disableSelection();c.draggable&&a.fn.draggable&&b._makeDraggable();c.resizable&&a.fn.resizable&&b._makeResizable();b._createButtons(c.buttons);b._isOpen=!1;a.fn.bgiframe&&i.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){return this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),
this.originalTitle&&this.element.attr("title",this.originalTitle),this},widget:function(){return this.uiDialog},close:function(b){var c=this,d,h;return!1===c._trigger("beforeClose",b)?void 0:(c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c._isOpen=!1,c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",b)}):(c.uiDialog.hide(),c._trigger("close",b)),a.ui.dialog.overlay.resize(),c.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&
(h=a(this).css("z-index"),isNaN(h)||(d=Math.max(d,h)))}),a.ui.dialog.maxZ=d),c)},isOpen:function(){return this._isOpen},moveToTop:function(b,c){var d=this.options,h;return d.modal&&!b||!d.stack&&!d.modal?this._trigger("focus",c):(d.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=d.zIndex),this.overlay&&(a.ui.dialog.maxZ+=1,this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),h={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},a.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",
a.ui.dialog.maxZ),this.element.attr(h),this._trigger("focus",c),this)},open:function(){if(!this._isOpen){var b=this.options,c=this.uiDialog;return this.overlay=b.modal?new a.ui.dialog.overlay(this):null,this._size(),this._position(b.position),c.show(b.show),this.moveToTop(!0),b.modal&&c.bind("keydown.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var c=a(":tabbable",this),d=c.filter(":first"),c=c.filter(":last");if(b.target===c[0]&&!b.shiftKey)return d.focus(1),!1;if(b.target===d[0]&&b.shiftKey)return c.focus(1),
!1}}),a(this.element.find(":tabbable").get().concat(c.find(".ui-dialog-buttonpane :tabbable").get().concat(c.get()))).eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(b){var c=this,d=!1,h=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),i=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(h);c.uiDialog.find(".ui-dialog-buttonpane").remove();"object"==typeof b&&null!==b&&a.each(b,function(){return!(d=!0)});d&&(a.each(b,
function(b,d){var d=a.isFunction(d)?{click:d,text:b}:d,e=a('<button type="button"></button>').click(function(){d.click.apply(c.element[0],arguments)}).appendTo(i);a.each(d,function(a,b){"click"!==a&&(a in e?e[a](b):e.attr(a,b))});a.fn.button&&e.button()}),h.appendTo(c.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=c.options,h=a(document),i;c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",
containment:"document",start:function(h,k){i="auto"===d.height?"auto":a(this).height();a(this).height(a(this).height()).addClass("ui-dialog-dragging");c._trigger("dragStart",h,b(k))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(j,k){d.position=[k.position.left-h.scrollLeft(),k.position.top-h.scrollTop()];a(this).removeClass("ui-dialog-dragging").height(i);c._trigger("dragStop",j,b(k));a.ui.dialog.overlay.resize()}})},_makeResizable:function(c){function d(a){return{originalPosition:a.originalPosition,
originalSize:a.originalSize,position:a.position,size:a.size}}var c=c===b?this.options.resizable:c,g=this,h=g.options,i=g.uiDialog.css("position"),c="string"==typeof c?c:"n,e,s,w,se,sw,ne,nw";g.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:g.element,maxWidth:h.maxWidth,maxHeight:h.maxHeight,minWidth:h.minWidth,minHeight:g._minHeight(),handles:c,start:function(b,c){a(this).addClass("ui-dialog-resizing");g._trigger("resizeStart",b,d(c))},resize:function(a,b){g._trigger("resize",
a,d(b))},stop:function(b,c){a(this).removeClass("ui-dialog-resizing");h.height=a(this).height();h.width=a(this).width();g._trigger("resizeStop",b,d(c));a.ui.dialog.overlay.resize()}}).css("position",i).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],d=[0,0],h;if(b){if("string"==typeof b||"object"==typeof b&&"0"in b)c=b.split?b.split(" "):
[b[0],b[1]],1===c.length&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(h=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b));h||this.uiDialog.hide()},_setOptions:function(b){var f=this,g={},h=!1;a.each(b,function(a,b){f._setOption(a,b);a in
c&&(h=!0);a in d&&(g[a]=b)});h&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(b,c){var d=this.uiDialog;switch(b){case "beforeclose":b="beforeClose";break;case "buttons":this._createButtons(c);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+c);break;case "dialogClass":d.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);break;case "disabled":c?d.addClass("ui-dialog-disabled"):
d.removeClass("ui-dialog-disabled");break;case "draggable":var h=d.is(":data(draggable)");h&&!c&&d.draggable("destroy");!h&&c&&this._makeDraggable();break;case "position":this._position(c);break;case "resizable":(h=d.is(":data(resizable)"))&&!c&&d.resizable("destroy");h&&"string"==typeof c&&d.resizable("option","handles",c);!h&&!1!==c&&this._makeResizable(c);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(c||"&#160;"))}a.Widget.prototype._setOption.apply(this,arguments)},_size:function(){var b=
this.options,c,d,h=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});b.minWidth>b.width&&(b.width=b.minWidth);c=this.uiDialog.css({height:"auto",width:b.width}).height();d=Math.max(0,b.minHeight-c);"auto"===b.height?a.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),b=this.element.css("height","auto").height(),h||this.uiDialog.hide(),this.element.height(Math.max(b,d))):this.element.height(Math.max(b.height-c,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{version:"1.8.23",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");return a||(this.uuid+=1,a=this.uuid),"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){0===this.instances.length&&
(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(c){b.options.closeOnEscape&&!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});return a.fn.bgiframe&&c.bgiframe(),this.instances.push(c),c},destroy:function(b){var c=a.inArray(b,this.instances);-1!=c&&this.oldInstances.push(this.instances.splice(c,1)[0]);0===this.instances.length&&a([document,window]).unbind(".dialog-overlay");b.remove();var d=0;a.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var b,c;return a.browser.msie&&7>a.browser.version?(b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),
c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<c?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<c?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)});b.css({width:0,
height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,c=this.options,d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),e=c.values&&c.values.length||1,f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);c.range&&(!0===c.range&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&2!==c.values.length&&(c.values=[c.values[0],c.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===c.range||"max"===c.range?" ui-slider-range-"+c.range:"")));for(var g=d.length;g<e;g+=1)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=d.add(a(f.join("")).appendTo(b.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){c.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(b){a(this).data("index.ui-slider-handle",
b)});this.handles.keydown(function(c){var d=a(this).data("index.ui-slider-handle"),e,f,g;if(!b.options.disabled){switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c.preventDefault(),!b._keySliding&&(b._keySliding=!0,a(this).addClass("ui-state-active"),e=b._start(c,d),!1===e))return}e=b.options.step;b.options.values&&b.options.values.length?
f=g=b.values(d):f=g=b.value();switch(c.keyCode){case a.ui.keyCode.HOME:g=b._valueMin();break;case a.ui.keyCode.END:g=b._valueMax();break;case a.ui.keyCode.PAGE_UP:g=b._trimAlignValue(f+(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:g=b._trimAlignValue(f-(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(f===b._valueMax())return;g=b._trimAlignValue(f+e);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(f===b._valueMin())return;g=b._trimAlignValue(f-
e)}b._slide(c,d,g)}}).keyup(function(c){var d=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,d),b._change(c,d),a(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},
_mouseCapture:function(b){var c=this.options,d,e,f,g,h,i,j,k,l;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:b.pageX,y:b.pageY},e=this._normValueFromMouse(d),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),!0===c.range&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i])),j=this._start(b,i),!1===j?!1:(this._mouseSliding=
!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),k=g.offset(),l=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:b.pageX-k.left-g.width()/2,top:b.pageY-k.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var c=
this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var c,d,e,f,g;return"horizontal"===
this.orientation?(c=this.elementSize.width,d=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,d=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),e=d/c,1<e&&(e=1),0>e&&(e=0),"vertical"===this.orientation&&(e=1-e),f=this._valueMax()-this._valueMin(),g=this._valueMin()+e*f,this._trimAlignValue(g)},_start:function(a,c){var d={handle:this.handles[c],value:this.value()};return this.options.values&&this.options.values.length&&(d.value=
this.values(c),d.values=this.values()),this._trigger("start",a,d)},_slide:function(a,c,d){var e,f,g;this.options.values&&this.options.values.length?(e=this.values(c?0:1),2===this.options.values.length&&!0===this.options.range&&(0===c&&d>e||1===c&&d<e)&&(d=e),d!==this.values(c)&&(f=this.values(),f[c]=d,g=this._trigger("slide",a,{handle:this.handles[c],value:d,values:f}),this.values(c?0:1),!1!==g&&this.values(c,d,!0))):d!==this.value()&&(g=this._trigger("slide",a,{handle:this.handles[c],value:d}),!1!==
g&&this.value(d))},_stop:function(a,c){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._trigger("stop",a,d)},_change:function(a,c){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._trigger("change",a,d)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,c){var d,e,f;if(1<arguments.length)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();d=this.options.values;e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,
f);this._refreshValue()}},_setOption:function(b,c){var d,e=0;a.isArray(this.options.values)&&(e=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var c,d;if(arguments.length)return c=this.options.values[a],c=this._trimAlignValue(c),c;c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=
this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,d=(a-this._valueMin())%c,a=a-d;return 2*Math.abs(d)>=c&&(a+=0<d?c:-c),parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,d=this,e=this._animateOff?!1:c.animate,f,g=
{},h,i,j,k;this.options.values&&this.options.values.length?this.handles.each(function(b){f=100*((d.values(b)-d._valueMin())/(d._valueMax()-d._valueMin()));g["horizontal"===d.orientation?"left":"bottom"]=f+"%";a(this).stop(1,1)[e?"animate":"css"](g,c.animate);!0===d.options.range&&("horizontal"===d.orientation?(0===b&&d.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},c.animate),1===b&&d.range[e?"animate":"css"]({width:f-h+"%"},{queue:!1,duration:c.animate})):(0===b&&d.range.stop(1,1)[e?"animate":"css"]({bottom:f+
"%"},c.animate),1===b&&d.range[e?"animate":"css"]({height:f-h+"%"},{queue:!1,duration:c.animate})));h=f}):(i=this.value(),j=this._valueMin(),k=this._valueMax(),f=k!==j?100*((i-j)/(k-j)):0,g["horizontal"===d.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[e?"animate":"css"](g,c.animate),"min"===b&&"horizontal"===this.orientation&&this.range.stop(1,1)[e?"animate":"css"]({width:f+"%"},c.animate),"max"===b&&"horizontal"===this.orientation&&this.range[e?"animate":"css"]({width:100-f+"%"},{queue:!1,
duration:c.animate}),"min"===b&&"vertical"===this.orientation&&this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},c.animate),"max"===b&&"vertical"===this.orientation&&this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate}))}});a.extend(a.ui.slider,{version:"1.8.23"})})(jQuery);
(function(a,b){var c=0,d=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){"selected"==a?this.options.collapsible&&b==this.options.selected||this.select(b):
(this.options[a]=b,this._tabify())},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+ ++c},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++d);return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=
a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function d(b,c){b.css("display","");!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var g=this,h=this.options,i=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=a(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return a("a",this)[0]});this.panels=a([]);this.anchors.each(function(b,c){var d=a(c).attr("href"),e=d.split("#")[0],f;e&&(e===location.toString().split("#")[0]||
(f=a("base")[0])&&e===f.href)&&(d=c.hash,c.href=d);i.test(d)?g.panels=g.panels.add(g.element.find(g._sanitizeSelector(d))):d&&"#"!==d?(a.data(c,"href.tabs",d),a.data(c,"load.tabs",d.replace(/#.*$/,"")),d=g._tabId(c),c.href="#"+d,e=g.element.find("#"+d),e.length||(e=a(h.panelTemplate).attr("id",d).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(g.panels[b-1]||g.list),e.data("destroy.tabs",!0)),g.panels=g.panels.add(e)):h.disabled.push(b)});c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),h.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash)return h.selected=a,!1}),"number"!=typeof h.selected&&h.cookie&&(h.selected=parseInt(g._cookie(),10)),"number"!=typeof h.selected&&this.lis.filter(".ui-tabs-selected").length&&(h.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"))),h.selected=h.selected||(this.lis.length?0:-1)):null===h.selected&&(h.selected=-1),h.selected=0<=h.selected&&this.anchors[h.selected]||0>h.selected?h.selected:0,h.disabled=a.unique(h.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a){return g.lis.index(a)}))).sort(),-1!=a.inArray(h.selected,h.disabled)&&h.disabled.splice(a.inArray(h.selected,h.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),
0<=h.selected&&this.anchors.length&&(g.element.find(g._sanitizeSelector(g.anchors[h.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(h.selected).addClass("ui-tabs-selected ui-state-active"),g.element.queue("tabs",function(){g._trigger("show",null,g._ui(g.anchors[h.selected],g.element.find(g._sanitizeSelector(g.anchors[h.selected].hash))[0]))}),this.load(h.selected)),a(window).bind("unload",function(){g.lis.add(g.anchors).unbind(".tabs");g.lis=g.anchors=g.panels=null})):h.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
this.element[h.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");h.cookie&&this._cookie(h.selected,h.cookie);for(var c=0,j;j=this.lis[c];c++)a(j)[-1!=a.inArray(c,h.disabled)&&!a(j).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");!1===h.cache&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if("mouseover"!==h.event){var k=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",
function(){k("hover",a(this))});this.lis.bind("mouseout.tabs",function(){a(this).removeClass("ui-state-hover")});this.anchors.bind("focus.tabs",function(){k("focus",a(this).closest("li"))});this.anchors.bind("blur.tabs",function(){a(this).closest("li").removeClass("ui-state-focus")})}var l,p;h.fx&&(a.isArray(h.fx)?(l=h.fx[0],p=h.fx[1]):l=p=h.fx);var m=p?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active");c.hide().removeClass("ui-tabs-hide").animate(p,p.duration||"normal",
function(){d(c,p);g._trigger("show",null,g._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active");c.removeClass("ui-tabs-hide");g._trigger("show",null,g._ui(b,c[0]))},r=l?function(a,b){b.animate(l,l.duration||"normal",function(){g.lis.removeClass("ui-tabs-selected ui-state-active");b.addClass("ui-tabs-hide");d(b,l);g.element.dequeue("tabs")})}:function(a,b){g.lis.removeClass("ui-tabs-selected ui-state-active");b.addClass("ui-tabs-hide");g.element.dequeue("tabs")};
this.anchors.bind(h.event+".tabs",function(){var b=this,c=a(b).closest("li"),d=g.panels.filter(":not(.ui-tabs-hide)"),e=g.element.find(g._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!h.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||g.panels.filter(":animated").length||!1===g._trigger("select",null,g._ui(this,e[0])))return this.blur(),!1;h.selected=g.anchors.index(this);g.abort();if(h.collapsible){if(c.hasClass("ui-tabs-selected"))return h.selected=
-1,h.cookie&&g._cookie(h.selected,h.cookie),g.element.queue("tabs",function(){r(b,d)}).dequeue("tabs"),this.blur(),!1;if(!d.length)return h.cookie&&g._cookie(h.selected,h.cookie),g.element.queue("tabs",function(){m(b,e)}),g.load(g.anchors.index(this)),this.blur(),!1}h.cookie&&g._cookie(h.selected,h.cookie);if(e.length)d.length&&g.element.queue("tabs",function(){r(b,d)}),g.element.queue("tabs",function(){m(b,e)}),g.load(g.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";
a.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},destroy:function(){var b=this.options;return this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=
a.data(this,"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")}),b.cookie&&this._cookie(null,b.cookie),this},add:function(c,
d,g){g===b&&(g=this.anchors.length);var h=this,i=this.options,d=a(i.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),c=c.indexOf("#")?this._tabId(a("a",d)[0]):c.replace("#","");d.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var j=h.element.find("#"+c);return j.length||(j=a(i.panelTemplate).attr("id",c).data("destroy.tabs",!0)),j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),g>=this.lis.length?(d.appendTo(this.list),j.appendTo(this.list[0].parentNode)):
(d.insertBefore(this.lis[g]),j.insertBefore(this.panels[g])),i.disabled=a.map(i.disabled,function(a){return a>=g?++a:a}),this._tabify(),1==this.anchors.length&&(i.selected=0,d.addClass("ui-tabs-selected ui-state-active"),j.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){h._trigger("show",null,h._ui(h.anchors[0],h.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[g],this.panels[g])),this},remove:function(b){var b=this._getIndex(b),c=this.options,d=this.lis.eq(b).remove(),
h=this.panels.eq(b).remove();return d.hasClass("ui-tabs-selected")&&1<this.anchors.length&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a){return a!=b}),function(a){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],h[0])),this},enable:function(b){var b=this._getIndex(b),c=this.options;return-1==a.inArray(b,c.disabled)?void 0:(this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,function(a){return a!=
b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b])),this)},disable:function(a){var a=this._getIndex(a),b=this.options;return a!=b.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),b.disabled.push(a),b.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a]))),this},select:function(a){a=this._getIndex(a);if(-1==a)if(this.options.collapsible&&-1!=this.options.selected)a=this.options.selected;else return this;return this.anchors.eq(a).trigger(this.options.event+
".tabs"),this},load:function(b){var b=this._getIndex(b),c=this,d=this.options,h=this.anchors.eq(b)[0],i=a.data(h,"load.tabs");this.abort();if(!i||0!==this.element.queue("tabs").length&&a.data(h,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var j=a("span",h);j.data("label.tabs",j.html()).html(d.spinner)}return this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:i,success:function(i,j){c.element.find(c._sanitizeSelector(h.hash)).html(i);c._cleanup();
d.cache&&a.data(h,"cache.tabs",!0);c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(i,j)}catch(p){}},error:function(a,i){c._cleanup();c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,i,b,h)}catch(j){}}})),c.element.dequeue("tabs"),this}},abort:function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup(),
this},url:function(a,b){return this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b),this},length:function(){return this.anchors.length}});a.extend(a.ui.tabs,{version:"1.8.23"});a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,i=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation);c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a);b&&b.stopPropagation()}),j=c._unrotate||(c._unrotate=b?function(){i()}:function(a){a.clientX&&
c.rotate(null)});return a?(this.element.bind("tabsshow",i),this.anchors.bind(d.event+".tabs",j),i()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",i),this.anchors.unbind(d.event+".tabs",j),delete this._rotate,delete this._unrotate),this}})})(jQuery);
window.Modernizr=function(a,b,c){function d(){h.input=function(a){for(var b=0,c=a.length;b<c;b++)v[a[b]]=a[b]in l;return v}("autocomplete,autofocus,list,placeholder,max,min,multiple,pattern,required,step".split(","));h.inputtypes=function(a){for(var d=0,e,f,g,h=a.length;d<h;d++)l.setAttribute("type",f=a[d]),(e="text"!==l.type)&&(l.value=p,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&l.style.WebkitAppearance!==c?(i.appendChild(l),g=b.defaultView,e=g.getComputedStyle&&"textfield"!==
g.getComputedStyle(l,null).WebkitAppearance&&0!==l.offsetHeight,i.removeChild(l)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=l.checkValidity&&!1===l.checkValidity():/^color$/.test(f)?(i.appendChild(l),e=l.value!=p,i.removeChild(l)):e=l.value!=p)),t[a[d]]=!!e;return t}("search,tel,url,email,datetime,date,month,week,time,datetime-local,number,range,color".split(","))}function e(a,b){var c=a.charAt(0).toUpperCase()+a.substr(1),c=(a+" "+q.join(c+" ")+c).split(" ");return f(c,b)}function f(a,
b){for(var d in a)if(k[a[d]]!==c)return"pfx"==b?a[d]:!0;return!1}function g(a,b){return typeof a===b}var h={},i=b.documentElement;b.head||b.getElementsByTagName("head");var j=b.createElement("modernizr"),k=j.style,l=b.createElement("input"),p=":)",m=Object.prototype.toString,r=",-webkit-,-moz-,-o-,-ms-,-khtml-".split(","),q=["Webkit","Moz","O","ms","Khtml"],j={},t={},v={},w=[],z=function(a,c,d,e){var f,g=b.createElement("div");if(parseInt(d,10))for(;d--;)f=b.createElement("div"),f.id=e?e[d]:"modernizr"+
(d+1),g.appendChild(f);d=["&shy;<style>",a,"</style>"].join("");g.id="modernizr";g.innerHTML+=d;i.appendChild(g);a=c(g,a);g.parentNode.removeChild(g);return!!a},x=function(){var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(d,e){var e=e||b.createElement(a[d]||"div"),d="on"+d,f=d in e;f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=g(e[d],"function"),g(e[d],c)||(e[d]=c),e.removeAttribute(d)));
return f}}(),A,F={}.hasOwnProperty,C;!g(F,c)&&!g(F.call,c)?C=function(a,b){return F.call(a,b)}:C=function(a,b){return b in a&&g(a.constructor.prototype[b],c)};(function(c,d){var e=c.join(""),f=d.length;z(e,function(c,d){for(var e=b.styleSheets[b.styleSheets.length-1],e=e.cssRules&&e.cssRules[0]?e.cssRules[0].cssText:e.cssText||"",g=c.childNodes,i={};f--;)i[g[f].id]=g[f];h.touch="ontouchstart"in a||9===i.touch.offsetTop;h.csstransforms3d=9===i.csstransforms3d.offsetLeft;h.generatedcontent=1<=i.generatedcontent.offsetHeight;
h.fontface=/src/i.test(e)&&0===e.indexOf(d.split(" ")[0])},f,d)})(['@font-face {font-family:"font";src:url("https://")}',["@media (",r.join("touch-enabled),("),"modernizr){#touch{top:9px;position:absolute}}"].join(""),["@media (",r.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute}}"].join(""),['#generatedcontent:after{content:"',p,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]);j.flexbox=function(){var a=b.createElement("div"),
c=b.createElement("div"),d;d="display:";a.style.cssText=(d+r.join("box;"+d)).slice(0,-d.length)+"width:42px;padding:0;";c.style.cssText=r.join("box-flex:1;")+"width:10px;";a.appendChild(c);i.appendChild(a);d=42===c.offsetWidth;a.removeChild(c);i.removeChild(a);return d};j.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")};j.canvastext=function(){return!!h.canvas&&!!g(b.createElement("canvas").getContext("2d").fillText,"function")};j.webgl=function(){return!!a.WebGLRenderingContext};
j.touch=function(){return h.touch};j.geolocation=function(){return!!navigator.geolocation};j.postmessage=function(){return!!a.postMessage};j.websqldatabase=function(){return!!a.openDatabase};j.indexedDB=function(){for(var b=-1,c=q.length;++b<c;)if(a[q[b].toLowerCase()+"IndexedDB"])return!0;return!!a.indexedDB};j.hashchange=function(){return x("hashchange",a)&&(b.documentMode===c||7<b.documentMode)};j.history=function(){return!!a.history&&!!history.pushState};j.draganddrop=function(){return x("dragstart")&&
x("drop")};j.websockets=function(){for(var b=-1,c=q.length;++b<c;)if(a[q[b]+"WebSocket"])return!0;return"WebSocket"in a};j.rgba=function(){k.cssText="background-color:rgba(150,255,150,.5)";return!!~(""+k.backgroundColor).indexOf("rgba")};j.hsla=function(){k.cssText="background-color:hsla(120,40%,100%,.5)";return!!~(""+k.backgroundColor).indexOf("rgba")||!!~(""+k.backgroundColor).indexOf("hsla")};j.multiplebgs=function(){k.cssText="background:url(https://),url(https://),red url(https://)";return/(url\s*\(.*?){3}/.test(k.background)};
j.backgroundsize=function(){return e("backgroundSize")};j.borderimage=function(){return e("borderImage")};j.borderradius=function(){return e("borderRadius")};j.boxshadow=function(){return e("boxShadow")};j.textshadow=function(){return""===b.createElement("div").style.textShadow};j.opacity=function(){var a=r.join("opacity:.55;")+"";k.cssText=a;return/^0.55$/.test(k.opacity)};j.cssanimations=function(){return e("animationName")};j.csscolumns=function(){return e("columnCount")};j.cssgradients=function(){var a=
("background-image:"+r.join("gradient(linear,left top,right bottom,from(#9f9),to(white));background-image:")+r.join("linear-gradient(left top,#9f9, white);background-image:")).slice(0,-17);k.cssText=a;return!!~(""+k.backgroundImage).indexOf("gradient")};j.cssreflections=function(){return e("boxReflect")};j.csstransforms=function(){return!!f(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])};j.csstransforms3d=function(){var a=!!f(["perspectiveProperty","WebkitPerspective",
"MozPerspective","OPerspective","msPerspective"]);a&&"webkitPerspective"in i.style&&(a=h.csstransforms3d);return a};j.csstransitions=function(){return e("transitionProperty")};j.fontface=function(){return h.fontface};j.generatedcontent=function(){return h.generatedcontent};j.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"'),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"')||a.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),
c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"')}catch(d){}return c};j.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"'),c.mp3=a.canPlayType("audio/mpeg;"),c.wav=a.canPlayType('audio/wav; codecs="1"'),c.m4a=a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")}catch(d){}return c};j.localstorage=function(){try{return!!localStorage.getItem}catch(a){return!1}};j.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(a){return!1}};
j.webworkers=function(){return!!a.Worker};j.applicationcache=function(){return!!a.applicationCache};j.svg=function(){return!!b.createElementNS&&!!b.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect};j.inlinesvg=function(){var a=b.createElement("div");a.innerHTML="<svg/>";return"http://www.w3.org/2000/svg"==(a.firstChild&&a.firstChild.namespaceURI)};j.smil=function(){return!!b.createElementNS&&/SVG/.test(m.call(b.createElementNS("http://www.w3.org/2000/svg","animate")))};j.svgclippaths=
function(){return!!b.createElementNS&&/SVG/.test(m.call(b.createElementNS("http://www.w3.org/2000/svg","clipPath")))};for(var D in j)C(j,D)&&(A=D.toLowerCase(),h[A]=j[D](),w.push((h[A]?"":"no-")+A));h.input||d();h.addTest=function(a,b){if("object"==typeof a)for(var d in a)C(a,d)&&h.addTest(d,a[d]);else{a=a.toLowerCase();if(h[a]!==c)return;b="boolean"==typeof b?b:!!b();i.className+=" "+(b?"":"no-")+a;h[a]=b}return h};k.cssText="";j=l=null;a.attachEvent&&function(){var a=b.createElement("div");a.innerHTML=
"<elem></elem>";return 1!==a.childNodes.length}()&&function(a,b){function d(a){for(var b=-1;++b<h;)a.createElement(g[b])}a.iepp=a.iepp||{};var e=a.iepp,f=e.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",g=f.split("|"),h=g.length,i=RegExp("(^|\\s)("+f+")","gi"),j=RegExp("<(/*)("+f+")","gi"),k=/^\s*[\{\}]\s*$/,l=RegExp("(^|[^\\n]*?\\s)("+f+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),p=b.createDocumentFragment(),
m=b.documentElement,f=m.firstChild,q=b.createElement("body"),r=b.createElement("style"),t=/print|all/,x;e.getCSS=function(a,b){if(a+""===c)return"";for(var d=-1,f=a.length,g,h=[];++d<f;)g=a[d],g.disabled||(b=g.media||b,t.test(b)&&h.push(e.getCSS(g.imports,b),g.cssText),b="all");return h.join("")};e.parseCSS=function(a){for(var b=[],c;null!=(c=l.exec(a));)b.push(((k.exec(c[1])?"\n":c[1])+c[2]+c[3]).replace(i,"$1.iepp_$2")+c[4]);return b.join("\n")};e.writeHTML=function(){var a=-1;for(x=x||b.body;++a<
h;)for(var c=b.getElementsByTagName(g[a]),d=c.length,e=-1;++e<d;)0>c[e].className.indexOf("iepp_")&&(c[e].className+=" iepp_"+g[a]);p.appendChild(x);m.appendChild(q);q.className=x.className;q.id=x.id;q.innerHTML=x.innerHTML.replace(j,"<$1font")};e._beforePrint=function(){r.styleSheet.cssText=e.parseCSS(e.getCSS(b.styleSheets,"all"));e.writeHTML()};e.restoreHTML=function(){q.innerHTML="";m.removeChild(q);m.appendChild(x)};e._afterPrint=function(){e.restoreHTML();r.styleSheet.cssText=""};d(b);d(p);
e.disablePP||(f.insertBefore(r,f.firstChild),r.media="print",r.className="iepp-printshim",a.attachEvent("onbeforeprint",e._beforePrint),a.attachEvent("onafterprint",e._afterPrint))}(a,b);h._version="2.0.6";h._prefixes=r;h._domPrefixes=q;h.mq=function(b){if(a.matchMedia)return matchMedia(b).matches;var c;z("@media "+b+" { #modernizr { position: absolute; } }",function(b){c="absolute"==(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle).position});return c};h.hasEvent=x;h.testProp=function(a){return f([a])};
h.testAllProps=e;h.testStyles=z;h.prefixed=function(a){return e(a,"pfx")};i.className=i.className.replace(/\bno-js\b/,"")+(" js "+w.join(" "));return h}(this,this.document);
(function(a,b){function c(){v(!0)}a.respond={};respond.update=function(){};respond.mediaQueriesSupported=b;if(!b){var d=a.document,e=d.documentElement,f=[],g=[],h=[],i={},j=d.getElementsByTagName("head")[0]||e,k=j.getElementsByTagName("link"),l=[],p=function(){for(var b=k.length,c=0,d,e,f;c<b;c++)d=k[c],e=d.href,f=d.media,d=d.rel&&"stylesheet"===d.rel.toLowerCase(),e&&d&&!i[e]&&(!/^([a-zA-Z]+?:(\/\/)?(www\.)?)/.test(e)||e.replace(RegExp.$1,"").split("/")[0]===a.location.host?l.push({href:e,media:f}):
i[e]=!0);m()},m=function(){if(l.length){var a=l.shift();w(a.href,function(b){r(b,a.href,a.media);i[a.href]=!0;m()})}},r=function(a,b,c){var d=a.match(/@media[^\{]+\{([^\{\}]+\{[^\}\{]+\})+/gi),e=d&&d.length||0,b=b.substring(0,b.lastIndexOf("/")),h=function(a){return a.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+b+"$2$3")},i=!e&&c,j=0,k,l,m,p,q;b.length&&(b+="/");for(i&&(e=1);j<e;j++){k=0;i?(l=c,g.push(h(a))):(l=d[j].match(/@media ([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,g.push(RegExp.$2&&
h(RegExp.$2)));p=l.split(",");for(q=p.length;k<q;k++)m=p[k],f.push({media:m.match(/(only\s+)?([a-zA-Z]+)(\sand)?/)&&RegExp.$2,rules:g.length-1,minw:m.match(/\(min\-width:[\s]*([\s]*[0-9]+)px[\s]*\)/)&&parseFloat(RegExp.$1),maxw:m.match(/\(max\-width:[\s]*([\s]*[0-9]+)px[\s]*\)/)&&parseFloat(RegExp.$1)})}v()},q,t,v=function(a){var b=e.clientWidth,c="CSS1Compat"===d.compatMode&&b||d.body.clientWidth||b,b={},i=d.createDocumentFragment(),l=k[k.length-1],m=(new Date).getTime();if(a&&q&&30>m-q)clearTimeout(t),
t=setTimeout(v,30);else{q=m;for(var s in f)if(a=f[s],!a.minw&&!a.maxw||(!a.minw||a.minw&&c>=a.minw)&&(!a.maxw||a.maxw&&c<=a.maxw))b[a.media]||(b[a.media]=[]),b[a.media].push(g[a.rules]);for(s in h)h[s]&&h[s].parentNode===j&&j.removeChild(h[s]);for(s in b)a=d.createElement("style"),c=b[s].join("\n"),a.type="text/css",a.media=s,a.styleSheet?a.styleSheet.cssText=c:a.appendChild(d.createTextNode(c)),i.appendChild(a),h.push(a);j.insertBefore(i,l.nextSibling)}},w=function(a,b){var c=z();c&&(c.open("GET",
a,!0),c.onreadystatechange=function(){4==c.readyState&&(200==c.status||304==c.status)&&b(c.responseText)},4!=c.readyState&&c.send())},z=function(){for(var a=!1,b=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new XMLHttpRequest}],c=b.length;c--;){try{a=b[c]()}catch(d){continue}break}return function(){return a}}();p();respond.update=p;a.addEventListener?a.addEventListener("resize",c,!1):a.attachEvent&&a.attachEvent("onresize",c)}})(this,Modernizr.mq("only all"));
(function(a,b,c){function d(){for(var a=1,b=-1;r.length-++b&&(!r[b].s||(a=r[b].r)););a&&g()}function e(a){var c=b.createElement("script"),e;c.src=a.s;c.onreadystatechange=c.onload=function(){!e&&(!c.readyState||"loaded"==c.readyState||"complete"==c.readyState)&&(e=1,d(),c.onload=c.onreadystatechange=null)};l(function(){e||(e=1,d())},N.errorTimeout);a.e?c.onload():p.parentNode.insertBefore(c,p)}function f(a){var c=b.createElement("link"),e;c.href=a.s;c.rel="stylesheet";c.type="text/css";if(!a.e&&(x||
t)){var f=function(a){l(function(){if(!e)try{a.sheet.cssRules.length?(e=1,d()):f(a)}catch(b){1E3==b.code||"security"==b.message||"denied"==b.message?(e=1,l(function(){d()},0)):f(a)}},0)};f(c)}else c.onload=function(){e||(e=1,l(function(){d()},0))},a.e&&c.onload();l(function(){e||(e=1,d())},N.errorTimeout);!a.e&&p.parentNode.insertBefore(c,p)}function g(){var a=r.shift();q=1;a?a.t?l(function(){"c"==a.t?f(a):e(a)},0):(a(),d()):q=0}function h(a,c,e,f,h,i){function j(){!s&&(!k.readyState||"loaded"==k.readyState||
"complete"==k.readyState)&&(u.r=s=1,!q&&d(),k.onload=k.onreadystatechange=null,l(function(){w.removeChild(k)},0))}var k=b.createElement(a),s=0,u={t:e,s:c,e:i};k.src=k.data=c;!v&&(k.style.display="none");k.width=k.height="0";"object"!=a&&(k.type=e);k.onload=k.onreadystatechange=j;"img"==a?k.onerror=j:"script"==a&&(k.onerror=function(){u.e=u.r=1;g()});r.splice(f,0,u);w.insertBefore(k,v?null:p);l(function(){s||(w.removeChild(k),u.r=u.e=s=1,d())},N.errorTimeout)}function i(a,b,c){var d="c"==b?C:F;q=0;
b=b||"j";y(a)?h(d,a,b,this.i++,k,c):(r.splice(this.i++,0,a),1==r.length&&g());return this}function j(){var a=N;a.loader={load:i,i:0};return a}var k=b.documentElement,l=a.setTimeout,p=b.getElementsByTagName("script")[0],m={}.toString,r=[],q=0,t="MozAppearance"in k.style,v=t&&!!b.createRange().compareNode,w=v?k:p.parentNode,z=a.opera&&"[object Opera]"==m.call(a.opera),x="webkitAppearance"in k.style,A=x&&"async"in b.createElement("script"),F=t?"object":z||A?"img":"script",C=x?"img":F,D=Array.isArray||
function(a){return"[object Array]"==m.call(a)},y=function(a){return"string"==typeof a},s=function(a){return"[object Function]"==m.call(a)},E=[],u={},J,N;N=function(a){function b(a){var a=a.split("!"),c=E.length,d=a.pop(),e=a.length,d={url:d,origUrl:d,prefixes:a},f,g;for(g=0;g<e;g++)(f=u[a[g]])&&(d=f(d));for(g=0;g<c;g++)d=E[g](d);return d}function d(a,e,f,g,h){var i=b(a),k=i.autoCallback;if(!i.bypass){e&&(e=s(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]);if(i.instead)return i.instead(a,e,f,
g,h);f.load(i.url,i.forceCSS||!i.forceJS&&/css$/.test(i.url)?"c":c,i.noexec);(s(e)||s(k))&&f.load(function(){j();e&&e(i.origUrl,h,g);k&&k(i.origUrl,h,g)})}}function e(a,b){function c(a){if(y(a))d(a,h,b,0,f);else if(Object(a)===a)for(i in a)a.hasOwnProperty(i)&&d(a[i],h,b,i,f)}var f=!!a.test,g=a.load||a.both,h=a.callback,i;c(f?a.yep:a.nope);c(g);a.complete&&b.load(a.complete)}var f,g,h=this.yepnope.loader;if(y(a))d(a,0,h,0);else if(D(a))for(f=0;f<a.length;f++)g=a[f],y(g)?d(g,0,h,0):D(g)?N(g):Object(g)===
g&&e(g,h);else Object(a)===a&&e(a,h)};N.addPrefix=function(a,b){u[a]=b};N.addFilter=function(a){E.push(a)};N.errorTimeout=1E4;null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",J=function(){b.removeEventListener("DOMContentLoaded",J,0);b.readyState="complete"},0));a.yepnope=j()})(this,this.document);Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
var Conrec=function(){var a=function(a,b){var c=a.x-b.x,d=a.y-b.y;return 1.0E-20>c*c+d*d},b=function(a){for(var b=a.head;b;){var c=b.next;b.next=b.prev;b=b.prev=c}c=a.head;a.head=a.tail;a.tail=c},c=function(a){this.level=a;this.s=null;this.count=0};c.prototype.remove_seq=function(a){a.prev?a.prev.next=a.next:this.s=a.next;a.next&&(a.next.prev=a.prev);--this.count};c.prototype.addSegment=function(c,d){for(var g=this.s,h=null,i=null,j=!1,k=!1;g&&!(null==h&&(a(c,g.head.p)?(h=g,j=!0):a(c,g.tail.p)&&(h=
g)),null==i&&(a(d,g.head.p)?(i=g,k=!0):a(d,g.tail.p)&&(i=g)),null!=i&&null!=h);)g=g.next;switch((null!=h?1:0)|(null!=i?2:0)){case 0:h={p:c,prev:null};i={p:d,next:null};h.next=i;i.prev=h;h={head:h,tail:i,next:this.s,prev:null,closed:!1};this.s&&(this.s.prev=h);this.s=h;++this.count;break;case 1:g={p:d};j?(g.next=h.head,g.prev=null,h.head.prev=g,h.head=g):(g.next=null,g.prev=h.tail,h.tail.next=g,h.tail=g);break;case 2:g={p:c};k?(g.next=i.head,g.prev=null,i.head.prev=g,i.head=g):(g.next=null,g.prev=
i.tail,i.tail.next=g,i.tail=g);break;case 3:if(h===i){g={p:h.tail.p,next:h.head,prev:null};h.head.prev=g;h.head=g;h.closed=!0;break}switch((j?1:0)|(k?2:0)){case 0:b(h);case 1:i.tail.next=h.head;h.head.prev=i.tail;i.tail=h.tail;this.remove_seq(h);break;case 3:b(h);case 2:h.tail.next=i.head,i.head.prev=h.tail,h.tail=i.tail,this.remove_seq(i)}}};var d=function(a){if(a)this.drawContour=a;else{var b=this;b.contours={};this.drawContour=function(a,d,e,j,k,l){var p=b.contours[l];p||(p=b.contours[l]=new c(k));
p.addSegment({x:a,y:d},{x:e,y:j})};this.contourList=function(){var a=[],c=b.contours,d;for(d in c)for(var e=c[d].s,k=c[d].level;e;){var l=e.head,p=[];p.level=k;for(p.k=d;l&&l.p;)p.push(l.p),l=l.next;a.push(p);e=e.next}a.sort(function(a,b){return b.k-a.k});return a}}this.h=Array(5);this.sh=Array(5);this.xh=Array(5);this.yh=Array(5)};d.prototype.contour=function(a,b,c,d){var i=b.length-1,j=c.length-1,k=d.length,l=this.h,p=this.sh,m=this.xh,r=this.yh,q=this.drawContour;this.contours={};for(var t=function(a,
b){return(l[b]*m[a]-l[a]*m[b])/(l[b]-l[a])},v=function(a,b){return(l[b]*r[a]-l[a]*r[b])/(l[b]-l[a])},w,z,x,A,F=0,C=0,D=0,y=0,s=[0,1,1,0],E=[0,0,1,1],u=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],J=j-1;0<=J;J--)for(var N=0;N<=i-1;N++)if(w=Math.min(a[N][J],a[N][J+1]),z=Math.min(a[N+1][J],a[N+1][J+1]),j=Math.min(w,z),w=Math.max(a[N][J],a[N][J+1]),z=Math.max(a[N+1][J],a[N+1][J+1]),A=Math.max(w,z),A>=d[0]&&j<=d[k-1])for(var B=0;B<k;B++)if(d[B]>=j&&d[B]<=A){for(var M=
4;0<=M;M--)0<M?(l[M]=a[N+s[M-1]][J+E[M-1]]-d[B],m[M]=b[N+s[M-1]],r[M]=c[J+E[M-1]]):(l[0]=0.25*(l[1]+l[2]+l[3]+l[4]),m[0]=0.5*(b[N]+b[N+1]),r[0]=0.5*(c[J]+c[J+1])),p[M]=0<l[M]?1:0>l[M]?-1:0;for(M=1;4>=M;M++)if(w=M,z=4!=M?M+1:1,x=u[p[w]+1][p[0]+1][p[z]+1],0!=x){switch(x){case 1:F=m[w];D=r[w];C=m[0];y=r[0];break;case 2:F=m[0];D=r[0];C=m[z];y=r[z];break;case 3:F=m[z];D=r[z];C=m[w];y=r[w];break;case 4:F=m[w];D=r[w];C=t(0,z);y=v(0,z);break;case 5:F=m[0];D=r[0];C=t(z,w);y=v(z,w);break;case 6:F=m[z];D=r[z];
C=t(w,0);y=v(w,0);break;case 7:F=t(w,0);D=v(w,0);C=t(0,z);y=v(0,z);break;case 8:F=t(0,z);D=v(0,z);C=t(z,w);y=v(z,w);break;case 9:F=t(z,w),D=v(z,w),C=t(w,0),y=v(w,0)}q(F,D,C,y,d[B],B)}}};return d}();"undefined"!==typeof exports&&(exports.Conrec=Conrec);var dat=dat||{};dat.gui=dat.gui||{};dat.utils=dat.utils||{};dat.controllers=dat.controllers||{};dat.dom=dat.dom||{};dat.color=dat.color||{};
dat.utils.css=function(){return{load:function(a,b){var b=b||document,c=b.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=a;b.getElementsByTagName("head")[0].appendChild(c)},inject:function(a,b){var b=b||document,c=document.createElement("style");c.type="text/css";c.innerHTML=a;b.getElementsByTagName("head")[0].appendChild(c)}}}();
dat.utils.common=function(){var a=Array.prototype.forEach,b=Array.prototype.slice;return{BREAK:{},extend:function(a){this.each(b.call(arguments,1),function(b){for(var e in b)this.isUndefined(b[e])||(a[e]=b[e])},this);return a},defaults:function(a){this.each(b.call(arguments,1),function(b){for(var e in b)this.isUndefined(a[e])&&(a[e]=b[e])},this);return a},compose:function(){var a=b.call(arguments);return function(){for(var d=b.call(arguments),e=a.length-1;e>=0;e--)d=[a[e].apply(this,d)];return d[0]}},
each:function(b,d,e){if(a&&b.forEach===a)b.forEach(d,e);else if(b.length===b.length+0)for(var f=0,g=b.length;f<g;f++){if(f in b&&d.call(e,b[f],f)===this.BREAK)break}else for(f in b)if(d.call(e,b[f],f)===this.BREAK)break},defer:function(a){setTimeout(a,0)},toArray:function(a){return a.toArray?a.toArray():b.call(a)},isUndefined:function(a){return a===void 0},isNull:function(a){return a===null},isNaN:function(a){return a!==a},isArray:Array.isArray||function(a){return a.constructor===Array},isObject:function(a){return a===
Object(a)},isNumber:function(a){return a===a+0},isString:function(a){return a===a+""},isBoolean:function(a){return a===false||a===true},isFunction:function(a){return Object.prototype.toString.call(a)==="[object Function]"}}}();
dat.controllers.Controller=function(a){var b=function(a,b){this.initialValue=a[b];this.domElement=document.createElement("div");this.object=a;this.property=b;this.__onFinishChange=this.__onChange=void 0};a.extend(b.prototype,{onChange:function(a){this.__onChange=a;return this},onFinishChange:function(a){this.__onFinishChange=a;return this},setValue:function(a){this.object[this.property]=a;this.__onChange&&this.__onChange.call(this,a);this.updateDisplay();return this},getValue:function(){return this.object[this.property]},
updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return b}(dat.utils.common);
dat.dom.dom=function(a){function b(b){if(b==="0"||a.isUndefined(b))return 0;b=b.match(d);return!a.isNull(b)?parseFloat(b[1]):0}var c={};a.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(b,d){a.each(b,function(a){c[a]=d})});var d=/(\d+(\.\d+)?)px/,e={makeSelectable:function(a,b){if(!(a===void 0||a.style===void 0)){a.onselectstart=b?function(){return false}:function(){};a.style.MozUserSelect=b?"auto":"none";a.style.KhtmlUserSelect=
b?"auto":"none";a.unselectable=b?"on":"off"}},makeFullscreen:function(b,c,d){a.isUndefined(c)&&(c=true);a.isUndefined(d)&&(d=true);b.style.position="absolute";if(c){b.style.left=0;b.style.right=0}if(d){b.style.top=0;b.style.bottom=0}},fakeEvent:function(b,d,e,i){var e=e||{},j=c[d];if(!j)throw Error("Event type "+d+" not supported.");var k=document.createEvent(j);switch(j){case "MouseEvents":k.initMouseEvent(d,e.bubbles||false,e.cancelable||true,window,e.clickCount||1,0,0,e.x||e.clientX||0,e.y||e.clientY||
0,false,false,false,false,0,null);break;case "KeyboardEvents":j=k.initKeyboardEvent||k.initKeyEvent;a.defaults(e,{cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:void 0,charCode:void 0});j(d,e.bubbles||false,e.cancelable,window,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);break;default:k.initEvent(d,e.bubbles||false,e.cancelable||true)}a.defaults(k,i);b.dispatchEvent(k)},bind:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||false):a.attachEvent&&
a.attachEvent("on"+b,c);return e},unbind:function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d||false):a.detachEvent&&a.detachEvent("on"+b,c);return e},addClass:function(a,b){if(a.className===void 0)a.className=b;else if(a.className!==b){var c=a.className.split(/ +/);if(c.indexOf(b)==-1){c.push(b);a.className=c.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}}return e},removeClass:function(a,b){if(b){if(a.className!==void 0)if(a.className===b)a.removeAttribute("class");else{var c=a.className.split(/ +/),
d=c.indexOf(b);if(d!=-1){c.splice(d,1);a.className=c.join(" ")}}}else a.className=void 0;return e},hasClass:function(a,b){return RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(a.className)||false},getWidth:function(a){a=getComputedStyle(a);return b(a["border-left-width"])+b(a["border-right-width"])+b(a["padding-left"])+b(a["padding-right"])+b(a.width)},getHeight:function(a){a=getComputedStyle(a);return b(a["border-top-width"])+b(a["border-bottom-width"])+b(a["padding-top"])+b(a["padding-bottom"])+b(a.height)},
getOffset:function(a){var b={left:0,top:0};if(a.offsetParent){do{b.left=b.left+a.offsetLeft;b.top=b.top+a.offsetTop}while(a=a.offsetParent)}return b},isActive:function(a){return a===document.activeElement&&(a.type||a.href)}};return e}(dat.utils.common);
dat.controllers.OptionController=function(a,b,c){var d=function(a,f,g){d.superclass.call(this,a,f);var h=this;this.__select=document.createElement("select");if(c.isArray(g)){var i={};c.each(g,function(a){i[a]=a});g=i}c.each(g,function(a,b){var c=document.createElement("option");c.innerHTML=b;c.setAttribute("value",a);h.__select.appendChild(c)});this.updateDisplay();b.bind(this.__select,"change",function(){h.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)};
d.superclass=a;c.extend(d.prototype,a.prototype,{setValue:function(a){a=d.superclass.prototype.setValue.call(this,a);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return a},updateDisplay:function(){this.__select.value=this.getValue();return d.superclass.prototype.updateDisplay.call(this)}});return d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.controllers.NumberController=function(a,b){var c=function(a,e,f){c.superclass.call(this,a,e);f=f||{};this.__min=f.min;this.__max=f.max;this.__step=f.step;a=this.__impliedStep=b.isUndefined(this.__step)?this.initialValue==0?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step;a=a.toString();this.__precision=a.indexOf(".")>-1?a.length-a.indexOf(".")-1:0};c.superclass=a;b.extend(c.prototype,a.prototype,{setValue:function(a){if(this.__min!==void 0&&a<this.__min)a=this.__min;
else if(this.__max!==void 0&&a>this.__max)a=this.__max;this.__step!==void 0&&a%this.__step!=0&&(a=Math.round(a/this.__step)*this.__step);return c.superclass.prototype.setValue.call(this,a)},min:function(a){this.__min=a;return this},max:function(a){this.__max=a;return this},step:function(a){this.__step=a;return this}});return c}(dat.controllers.Controller,dat.utils.common);
dat.controllers.NumberControllerBox=function(a,b,c){var d=function(a,f,g){function h(){var a=parseFloat(k.__input.value);c.isNaN(a)||k.setValue(a)}function i(a){var b=l-a.clientY;k.setValue(k.getValue()+b*k.__impliedStep);l=a.clientY}function j(){b.unbind(window,"mousemove",i);b.unbind(window,"mouseup",j)}this.__truncationSuspended=false;d.superclass.call(this,a,f,g);var k=this,l;this.__input=document.createElement("input");this.__input.setAttribute("type","text");b.bind(this.__input,"change",h);
b.bind(this.__input,"blur",function(){h();k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())});b.bind(this.__input,"mousedown",function(a){b.bind(window,"mousemove",i);b.bind(window,"mouseup",j);l=a.clientY});b.bind(this.__input,"keydown",function(a){if(a.keyCode===13){k.__truncationSuspended=true;this.blur();k.__truncationSuspended=false}});this.updateDisplay();this.domElement.appendChild(this.__input)};d.superclass=a;c.extend(d.prototype,a.prototype,{updateDisplay:function(){var a=this.__input,
b;if(this.__truncationSuspended)b=this.getValue();else{b=this.getValue();var c=Math.pow(10,this.__precision);b=Math.round(b*c)/c}a.value=b;return d.superclass.prototype.updateDisplay.call(this)}});return d}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common);
dat.controllers.NumberControllerSlider=function(a,b,c,d,e){var f=function(a,c,d,e,k){function l(a){a.preventDefault();var c=b.getOffset(m.__background),d=b.getWidth(m.__background);m.setValue(m.__min+(m.__max-m.__min)*((a.clientX-c.left)/(c.left+d-c.left)));return false}function p(){b.unbind(window,"mousemove",l);b.unbind(window,"mouseup",p);m.__onFinishChange&&m.__onFinishChange.call(m,m.getValue())}f.superclass.call(this,a,c,{min:d,max:e,step:k});var m=this;this.__background=document.createElement("div");
this.__foreground=document.createElement("div");b.bind(this.__background,"mousedown",function(a){b.bind(window,"mousemove",l);b.bind(window,"mouseup",p);l(a)});b.addClass(this.__background,"slider");b.addClass(this.__foreground,"slider-fg");this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};f.superclass=a;f.useDefaultStyles=function(){c.inject(e)};d.extend(f.prototype,a.prototype,{updateDisplay:function(){this.__foreground.style.width=
(this.getValue()-this.__min)/(this.__max-this.__min)*100+"%";return f.superclass.prototype.updateDisplay.call(this)}});return f}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");
dat.controllers.FunctionController=function(a,b,c){var d=function(a,c,g){d.superclass.call(this,a,c);var h=this;this.__button=document.createElement("div");this.__button.innerHTML=g===void 0?"Fire":g;b.bind(this.__button,"click",function(a){a.preventDefault();h.fire();return false});b.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};d.superclass=a;c.extend(d.prototype,a.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this);this.__onFinishChange&&this.__onFinishChange.call(this,
this.getValue());this.getValue().call(this.object)}});return d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.controllers.BooleanController=function(a,b,c){var d=function(a,c){d.superclass.call(this,a,c);var g=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");b.bind(this.__checkbox,"change",function(){g.setValue(!g.__prev)},false);this.domElement.appendChild(this.__checkbox);this.updateDisplay()};d.superclass=a;c.extend(d.prototype,a.prototype,{setValue:function(a){a=d.superclass.prototype.setValue.call(this,a);this.__onFinishChange&&
this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return a},updateDisplay:function(){this.getValue()===true?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=true):this.__checkbox.checked=false;return d.superclass.prototype.updateDisplay.call(this)}});return d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.color.toString=function(a){return function(b){if(b.a==1||a.isUndefined(b.a)){for(b=b.hex.toString(16);b.length<6;)b="0"+b;return"#"+b}return"rgba("+Math.round(b.r)+","+Math.round(b.g)+","+Math.round(b.b)+","+b.a+")"}}(dat.utils.common);
dat.color.interpret=function(a,b){var c,d,e=[{litmus:b.isString,conversions:{THREE_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return a===null?false:{space:"HEX",hex:parseInt("0x"+a[1].toString()+a[1].toString()+a[2].toString()+a[2].toString()+a[3].toString()+a[3].toString())}},write:a},SIX_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9]{6})$/i);return a===null?false:{space:"HEX",hex:parseInt("0x"+a[1].toString())}},write:a},CSS_RGB:{read:function(a){a=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
return a===null?false:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3])}},write:a},CSS_RGBA:{read:function(a){a=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return a===null?false:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3]),a:parseFloat(a[4])}},write:a}}},{litmus:b.isNumber,conversions:{HEX:{read:function(a){return{space:"HEX",hex:a,conversionName:"HEX"}},write:function(a){return a.hex}}}},{litmus:b.isArray,conversions:{RGB_ARRAY:{read:function(a){return a.length!=
3?false:{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function(a){return a.length!=4?false:{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:b.isObject,conversions:{RGBA_OBJ:{read:function(a){return b.isNumber(a.r)&&b.isNumber(a.g)&&b.isNumber(a.b)&&b.isNumber(a.a)?{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}:false},write:function(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function(a){return b.isNumber(a.r)&&
b.isNumber(a.g)&&b.isNumber(a.b)?{space:"RGB",r:a.r,g:a.g,b:a.b}:false},write:function(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function(a){return b.isNumber(a.h)&&b.isNumber(a.s)&&b.isNumber(a.v)&&b.isNumber(a.a)?{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}:false},write:function(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function(a){return b.isNumber(a.h)&&b.isNumber(a.s)&&b.isNumber(a.v)?{space:"HSV",h:a.h,s:a.s,v:a.v}:false},write:function(a){return{h:a.h,s:a.s,v:a.v}}}}}];return function(){d=
false;var a=arguments.length>1?b.toArray(arguments):arguments[0];b.each(e,function(e){if(e.litmus(a))return b.each(e.conversions,function(e,g){c=e.read(a);if(d===false&&c!==false)return d=c,c.conversionName=g,c.conversion=e,b.BREAK}),b.BREAK});return d}}(dat.color.toString,dat.utils.common);
dat.GUI=dat.gui.GUI=function(a,b,c,d,e,f,g,h,i,j,k,l,p,m,r){function q(a,b,c,f){if(b[c]===void 0)throw Error("Object "+b+' has no property "'+c+'"');f.color?b=new k(b,c):(b=[b,c].concat(f.factoryArgs),b=d.apply(a,b));if(f.before instanceof e)f.before=f.before.__li;w(a,b);m.addClass(b.domElement,"c");c=document.createElement("span");m.addClass(c,"property-name");c.innerHTML=b.property;var g=document.createElement("div");g.appendChild(c);g.appendChild(b.domElement);f=t(a,g,f.before);m.addClass(f,o.CLASS_CONTROLLER_ROW);
m.addClass(f,typeof b.getValue());v(a,f,b);a.__controllers.push(b);return b}function t(a,b,c){var d=document.createElement("li");b&&d.appendChild(b);c?a.__ul.insertBefore(d,params.before):a.__ul.appendChild(d);a.onResize();return d}function v(a,b,c){c.__li=b;c.__gui=a;r.extend(c,{options:function(b){if(arguments.length>1)return c.remove(),q(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[r.toArray(arguments)]});if(r.isArray(b)||r.isObject(b))return c.remove(),q(a,c.object,c.property,
{before:c.__li.nextElementSibling,factoryArgs:[b]})},name:function(a){c.__li.firstElementChild.firstElementChild.innerHTML=a;return c},listen:function(){c.__gui.listen(c);return c},remove:function(){c.__gui.remove(c);return c}});if(c instanceof i){var d=new h(c.object,c.property,{min:c.__min,max:c.__max,step:c.__step});r.each(["updateDisplay","onChange","onFinishChange"],function(a){var b=c[a],e=d[a];c[a]=d[a]=function(){var a=Array.prototype.slice.call(arguments);b.apply(c,a);return e.apply(d,a)}});
m.addClass(b,"has-slider");c.domElement.insertBefore(d.domElement,c.domElement.firstElementChild)}else if(c instanceof h){var e=function(b){return r.isNumber(c.__min)&&r.isNumber(c.__max)?(c.remove(),q(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[c.__min,c.__max,c.__step]})):b};c.min=r.compose(e,c.min);c.max=r.compose(e,c.max)}else if(c instanceof f){m.bind(b,"click",function(){m.fakeEvent(c.__checkbox,"click")});m.bind(c.__checkbox,"click",function(a){a.stopPropagation()})}else if(c instanceof
g){m.bind(b,"click",function(){m.fakeEvent(c.__button,"click")});m.bind(b,"mouseover",function(){m.addClass(c.__button,"hover")});m.bind(b,"mouseout",function(){m.removeClass(c.__button,"hover")})}else if(c instanceof k){m.addClass(b,"color");c.updateDisplay=r.compose(function(a){b.style.borderLeftColor=c.__color.toString();return a},c.updateDisplay);c.updateDisplay()}c.setValue=r.compose(function(b){a.getRoot().__preset_select&&c.isModified()&&D(a.getRoot(),true);return b},c.setValue)}function w(a,
b){var c=a.getRoot(),d=c.__rememberedObjects.indexOf(b.object);if(d!=-1){var e=c.__rememberedObjectIndecesToControllers[d];e===void 0&&(e={},c.__rememberedObjectIndecesToControllers[d]=e);e[b.property]=b;if(c.load&&c.load.remembered){c=c.load.remembered;if(c[a.preset])c=c[a.preset];else if(c[s])c=c[s];else return;if(c[d]&&c[d][b.property]!==void 0){d=c[d][b.property];b.initialValue=d;b.setValue(d)}}}}function z(a){var b=a.__save_row=document.createElement("li");m.addClass(a.domElement,"has-save");
a.__ul.insertBefore(b,a.__ul.firstChild);m.addClass(b,"save-row");var c=document.createElement("span");c.innerHTML="&nbsp;";m.addClass(c,"button gears");var d=document.createElement("span");d.innerHTML="Save";m.addClass(d,"button");m.addClass(d,"save");var e=document.createElement("span");e.innerHTML="New";m.addClass(e,"button");m.addClass(e,"save-as");var f=document.createElement("span");f.innerHTML="Revert";m.addClass(f,"button");m.addClass(f,"revert");var g=a.__preset_select=document.createElement("select");
a.load&&a.load.remembered?r.each(a.load.remembered,function(b,c){C(a,c,c==a.preset)}):C(a,s,false);m.bind(g,"change",function(){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].innerHTML=a.__preset_select[b].value;a.preset=this.value});b.appendChild(g);b.appendChild(c);b.appendChild(d);b.appendChild(e);b.appendChild(f);if(E){var b=document.getElementById("dg-save-locally"),h=document.getElementById("dg-local-explain");b.style.display="block";b=document.getElementById("dg-local-storage");
localStorage.getItem(document.location.href+".isLocal")==="true"&&b.setAttribute("checked","checked");var i=function(){h.style.display=a.useLocalStorage?"block":"none"};i();m.bind(b,"change",function(){a.useLocalStorage=!a.useLocalStorage;i()})}var j=document.getElementById("dg-new-constructor");m.bind(j,"keydown",function(a){a.metaKey&&(a.which===67||a.keyCode==67)&&J.hide()});m.bind(c,"click",function(){j.innerHTML=JSON.stringify(a.getSaveObject(),void 0,2);J.show();j.focus();j.select()});m.bind(d,
"click",function(){a.save()});m.bind(e,"click",function(){var b=prompt("Enter a new preset name.");b&&a.saveAs(b)});m.bind(f,"click",function(){a.revert()})}function x(a){function b(f){f.preventDefault();e=f.clientX;m.addClass(a.__closeButton,o.CLASS_DRAG);m.bind(window,"mousemove",c);m.bind(window,"mouseup",d);return false}function c(b){b.preventDefault();a.width=a.width+(e-b.clientX);a.onResize();e=b.clientX;return false}function d(){m.removeClass(a.__closeButton,o.CLASS_DRAG);m.unbind(window,"mousemove",
c);m.unbind(window,"mouseup",d)}a.__resize_handle=document.createElement("div");r.extend(a.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var e;m.bind(a.__resize_handle,"mousedown",b);m.bind(a.__closeButton,"mousedown",b);a.domElement.insertBefore(a.__resize_handle,a.domElement.firstElementChild)}function A(a,b){a.domElement.style.width=b+"px";if(a.__save_row&&a.autoPlace)a.__save_row.style.width=b+"px";if(a.__closeButton)a.__closeButton.style.width=
b+"px"}function F(a,b){var c={};r.each(a.__rememberedObjects,function(d,e){var f={};r.each(a.__rememberedObjectIndecesToControllers[e],function(a,c){f[c]=b?a.initialValue:a.getValue()});c[e]=f});return c}function C(a,b,c){var d=document.createElement("option");d.innerHTML=b;d.value=b;a.__preset_select.appendChild(d);if(c)a.__preset_select.selectedIndex=a.__preset_select.length-1}function D(a,b){var c=a.__preset_select[a.__preset_select.selectedIndex];c.innerHTML=b?c.value+"*":c.value}function y(a){a.length!=
0&&l(function(){y(a)});r.each(a,function(a){a.updateDisplay()})}a.inject(c);var s="Default",E;try{E="localStorage"in window&&window.localStorage!==null}catch(u){E=false}var J,N=true,B,M=false,I=[],o=function(a){function b(){localStorage.setItem(document.location.href+".gui",JSON.stringify(d.getSaveObject()))}function c(){var a=d.getRoot();a.width=a.width+1;r.defer(function(){a.width=a.width-1})}var d=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);
m.addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];a=a||{};a=r.defaults(a,{autoPlace:true,width:o.DEFAULT_WIDTH});a=r.defaults(a,{resizable:a.autoPlace,hideable:a.autoPlace});if(r.isUndefined(a.load))a.load={preset:s};else if(a.preset)a.load.preset=a.preset;r.isUndefined(a.parent)&&a.hideable&&I.push(this);a.resizable=r.isUndefined(a.parent)&&a.resizable;if(a.autoPlace&&r.isUndefined(a.scrollable))a.scrollable=
true;var e=E&&localStorage.getItem(document.location.href+".isLocal")==="true";Object.defineProperties(this,{parent:{get:function(){return a.parent}},scrollable:{get:function(){return a.scrollable}},autoPlace:{get:function(){return a.autoPlace}},preset:{get:function(){return d.parent?d.getRoot().preset:a.load.preset},set:function(b){d.parent?d.getRoot().preset=b:a.load.preset=b;for(b=0;b<this.__preset_select.length;b++)if(this.__preset_select[b].value==this.preset)this.__preset_select.selectedIndex=
b;d.revert()}},width:{get:function(){return a.width},set:function(b){a.width=b;A(d,b)}},name:{get:function(){return a.name},set:function(b){a.name=b;if(g)g.innerHTML=a.name}},closed:{get:function(){return a.closed},set:function(b){a.closed=b;a.closed?m.addClass(d.__ul,o.CLASS_CLOSED):m.removeClass(d.__ul,o.CLASS_CLOSED);this.onResize();if(d.__closeButton)d.__closeButton.innerHTML=b?o.TEXT_OPEN:o.TEXT_CLOSED}},load:{get:function(){return a.load}},useLocalStorage:{get:function(){return e},set:function(a){E&&
((e=a)?m.bind(window,"unload",b):m.unbind(window,"unload",b),localStorage.setItem(document.location.href+".isLocal",a))}}});if(r.isUndefined(a.parent)){a.closed=false;m.addClass(this.domElement,o.CLASS_MAIN);m.makeSelectable(this.domElement,false);if(E&&e){d.useLocalStorage=true;var f=localStorage.getItem(document.location.href+".gui");if(f)a.load=JSON.parse(f)}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=o.TEXT_CLOSED;m.addClass(this.__closeButton,o.CLASS_CLOSE_BUTTON);
this.domElement.appendChild(this.__closeButton);m.bind(this.__closeButton,"click",function(){d.closed=!d.closed})}else{if(a.closed===void 0)a.closed=true;var g=document.createTextNode(a.name);m.addClass(g,"controller-name");f=t(d,g);m.addClass(this.__ul,o.CLASS_CLOSED);m.addClass(f,"title");m.bind(f,"click",function(a){a.preventDefault();d.closed=!d.closed;return false});if(!a.closed)this.closed=false}a.autoPlace&&(r.isUndefined(a.parent)&&(N&&(B=document.createElement("div"),m.addClass(B,"dg"),m.addClass(B,
o.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(B),N=false),B.appendChild(this.domElement),m.addClass(this.domElement,o.CLASS_AUTO_PLACE)),this.parent||A(d,a.width));m.bind(window,"resize",function(){d.onResize()});m.bind(this.__ul,"webkitTransitionEnd",function(){d.onResize()});m.bind(this.__ul,"transitionend",function(){d.onResize()});m.bind(this.__ul,"oTransitionEnd",function(){d.onResize()});this.onResize();a.resizable&&x(this);d.getRoot();a.parent||c()};o.toggleHide=function(){M=!M;r.each(I,
function(a){a.domElement.style.zIndex=M?-999:999;a.domElement.style.opacity=M?0:1})};o.CLASS_AUTO_PLACE="a";o.CLASS_AUTO_PLACE_CONTAINER="ac";o.CLASS_MAIN="main";o.CLASS_CONTROLLER_ROW="cr";o.CLASS_TOO_TALL="taller-than-window";o.CLASS_CLOSED="closed";o.CLASS_CLOSE_BUTTON="close-button";o.CLASS_DRAG="drag";o.DEFAULT_WIDTH=245;o.TEXT_CLOSED="Close Controls";o.TEXT_OPEN="Open Controls";r.extend(o.prototype,{add:function(a,b){return q(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},
addColor:function(a,b){return q(this,a,b,{color:true})},remove:function(a){this.__ul.removeChild(a.__li);this.__controllers.slice(this.__controllers.indexOf(a),1);var b=this;r.defer(function(){b.onResize()})},destroy:function(){this.autoPlace&&B.removeChild(this.domElement)},addFolder:function(a){if(this.__folders[a]!==void 0)throw Error('You already have a folder in this GUI by the name "'+a+'"');var b={name:a,parent:this};b.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[a]){b.closed=
this.load.folders[a].closed;b.load=this.load.folders[a]}b=new o(b);this.__folders[a]=b;a=t(this,b.domElement);m.addClass(a,"folder");return b},open:function(){this.closed=false},close:function(){this.closed=true},onResize:function(){var a=this.getRoot();if(a.scrollable){var b=m.getOffset(a.__ul).top,c=0;r.each(a.__ul.childNodes,function(b){a.autoPlace&&b===a.__save_row||(c=c+m.getHeight(b))});window.innerHeight-b-20<c?(m.addClass(a.domElement,o.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-
b-20+"px"):(m.removeClass(a.domElement,o.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&r.defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"});if(a.__closeButton)a.__closeButton.style.width=a.width+"px"},remember:function(){if(r.isUndefined(J)){J=new p;J.domElement.innerHTML=b}if(this.parent)throw Error("You can only call remember on a top level GUI.");var a=this;r.each(Array.prototype.slice.call(arguments),function(b){a.__rememberedObjects.length==0&&z(a);a.__rememberedObjects.indexOf(b)==
-1&&a.__rememberedObjects.push(b)});this.autoPlace&&A(this,this.width)},getRoot:function(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function(){var a=this.load;a.closed=this.closed;if(this.__rememberedObjects.length>0){a.preset=this.preset;if(!a.remembered)a.remembered={};a.remembered[this.preset]=F(this)}a.folders={};r.each(this.__folders,function(b,c){a.folders[c]=b.getSaveObject()});return a},save:function(){if(!this.load.remembered)this.load.remembered={};this.load.remembered[this.preset]=
F(this);D(this,false)},saveAs:function(a){if(!this.load.remembered){this.load.remembered={};this.load.remembered[s]=F(this,true)}this.load.remembered[a]=F(this);this.preset=a;C(this,a,true)},revert:function(a){r.each(this.__controllers,function(b){this.getRoot().load.remembered?w(a||this.getRoot(),b):b.setValue(b.initialValue)},this);r.each(this.__folders,function(a){a.revert(a)});a||D(this.getRoot(),false)},listen:function(a){var b=this.__listening.length==0;this.__listening.push(a);b&&y(this.__listening)}});
return o}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',
".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",
dat.controllers.factory=function(a,b,c,d,e,f,g){return function(h,i,j,k){var l=h[i];if(g.isArray(j)||g.isObject(j))return new a(h,i,j);if(g.isNumber(l))return g.isNumber(j)&&g.isNumber(k)?new c(h,i,j,k):new b(h,i,{min:j,max:k});if(g.isString(l))return new d(h,i);if(g.isFunction(l))return new e(h,i,"");if(g.isBoolean(l))return new f(h,i)}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(a,b,c){var d=
function(a,c){function g(){h.setValue(h.__input.value)}d.superclass.call(this,a,c);var h=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");b.bind(this.__input,"keyup",g);b.bind(this.__input,"change",g);b.bind(this.__input,"blur",function(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())});b.bind(this.__input,"keydown",function(a){a.keyCode===13&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)};d.superclass=a;c.extend(d.prototype,
a.prototype,{updateDisplay:function(){if(!b.isActive(this.__input))this.__input.value=this.getValue();return d.superclass.prototype.updateDisplay.call(this)}});return d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,
dat.controllers.ColorController=function(a,b,c,d,e){function f(a,b,c,d){a.style.background="";e.each(i,function(e){a.style.cssText=a.style.cssText+("background: "+e+"linear-gradient("+b+", "+c+" 0%, "+d+" 100%); ")})}function g(a){a.style.background="";a.style.cssText=a.style.cssText+"background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";a.style.cssText=a.style.cssText+"background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";
a.style.cssText=a.style.cssText+"background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText=a.style.cssText+"background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText=a.style.cssText+"background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var h=function(a,i){function l(a){q(a);
b.bind(window,"mousemove",q);b.bind(window,"mouseup",p)}function p(){b.unbind(window,"mousemove",q);b.unbind(window,"mouseup",p)}function m(){var a=d(this.value);a!==false?(v.__color.__state=a,v.setValue(v.__color.toOriginal())):this.value=v.__color.toString()}function r(){b.unbind(window,"mousemove",t);b.unbind(window,"mouseup",r)}function q(a){a.preventDefault();var c=b.getWidth(v.__saturation_field),d=b.getOffset(v.__saturation_field),e=(a.clientX-d.left+document.body.scrollLeft)/c,a=1-(a.clientY-
d.top+document.body.scrollTop)/c;a>1?a=1:a<0&&(a=0);e>1?e=1:e<0&&(e=0);v.__color.v=a;v.__color.s=e;v.setValue(v.__color.toOriginal());return false}function t(a){a.preventDefault();var c=b.getHeight(v.__hue_field),d=b.getOffset(v.__hue_field),a=1-(a.clientY-d.top+document.body.scrollTop)/c;a>1?a=1:a<0&&(a=0);v.__color.h=a*360;v.setValue(v.__color.toOriginal());return false}h.superclass.call(this,a,i);this.__color=new c(this.getValue());this.__temp=new c(0);var v=this;this.domElement=document.createElement("div");
b.makeSelectable(this.domElement,false);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className=
"hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";b.bind(this.__input,"keydown",function(a){a.keyCode===13&&m.call(this)});b.bind(this.__input,"blur",m);b.bind(this.__selector,"mousedown",function(){b.addClass(this,"drag").bind(window,"mouseup",function(){b.removeClass(v.__selector,"drag")})});var w=document.createElement("div");e.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});
e.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<0.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});e.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});e.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});e.extend(w.style,
{width:"100%",height:"100%",background:"none"});f(w,"top","rgba(0,0,0,0)","#000");e.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});g(this.__hue_field);e.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});b.bind(this.__saturation_field,"mousedown",l);b.bind(this.__field_knob,"mousedown",l);b.bind(this.__hue_field,"mousedown",
function(a){t(a);b.bind(window,"mousemove",t);b.bind(window,"mouseup",r)});this.__saturation_field.appendChild(w);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()};h.superclass=a;e.extend(h.prototype,a.prototype,{updateDisplay:function(){var a=d(this.getValue());
if(a!==false){var b=false;e.each(c.COMPONENTS,function(c){if(!e.isUndefined(a[c])&&!e.isUndefined(this.__color.__state[c])&&a[c]!==this.__color.__state[c])return b=true,{}},this);b&&e.extend(this.__color.__state,a)}e.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var g=this.__color.v<0.5||this.__color.s>0.5?255:0,h=255-g;e.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+
"rgb("+g+","+g+","+g+")"});this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px";this.__temp.s=1;this.__temp.v=1;f(this.__saturation_field,"left","#fff",this.__temp.toString());e.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+g+","+g+","+g+")",textShadow:this.__input_textShadow+"rgba("+h+","+h+","+h+",.7)"})}});var i=["-moz-","-o-","-webkit-","-ms-",""];return h}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(a,b,c,d){function e(a,
b,c){Object.defineProperty(a,b,{get:function(){if(this.__state.space==="RGB")return this.__state[b];g(this,b,c);return this.__state[b]},set:function(a){if(this.__state.space!=="RGB"){g(this,b,c);this.__state.space="RGB"}this.__state[b]=a}})}function f(a,b){Object.defineProperty(a,b,{get:function(){if(this.__state.space==="HSV")return this.__state[b];h(this);return this.__state[b]},set:function(a){if(this.__state.space!=="HSV"){h(this);this.__state.space="HSV"}this.__state[b]=a}})}function g(a,c,e){if(a.__state.space===
"HEX")a.__state[c]=b.component_from_hex(a.__state.hex,e);else if(a.__state.space==="HSV")d.extend(a.__state,b.hsv_to_rgb(a.__state.h,a.__state.s,a.__state.v));else throw"Corrupted color state";}function h(a){var c=b.rgb_to_hsv(a.r,a.g,a.b);d.extend(a.__state,{s:c.s,v:c.v});if(d.isNaN(c.h)){if(d.isUndefined(a.__state.h))a.__state.h=0}else a.__state.h=c.h}var i=function(){this.__state=a.apply(this,arguments);if(this.__state===false)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||
1};i.COMPONENTS=["r","g","b","h","s","v","hex","a"];d.extend(i.prototype,{toString:function(){return c(this)},toOriginal:function(){return this.__state.conversion.write(this)}});e(i.prototype,"r",2);e(i.prototype,"g",1);e(i.prototype,"b",0);f(i.prototype,"h");f(i.prototype,"s");f(i.prototype,"v");Object.defineProperty(i.prototype,"a",{get:function(){return this.__state.a},set:function(a){this.__state.a=a}});Object.defineProperty(i.prototype,"hex",{get:function(){if(!this.__state.space!=="HEX")this.__state.hex=
b.rgb_to_hex(this.r,this.g,this.b);return this.__state.hex},set:function(a){this.__state.space="HEX";this.__state.hex=a}});return i}(dat.color.interpret,dat.color.math=function(){var a;return{hsv_to_rgb:function(a,c,d){var e=a/60-Math.floor(a/60),f=d*(1-c),g=d*(1-e*c),c=d*(1-(1-e)*c),a=[[d,c,f],[g,d,f],[f,d,c],[f,g,d],[c,f,d],[d,f,g]][Math.floor(a/60)%6];return{r:a[0]*255,g:a[1]*255,b:a[2]*255}},rgb_to_hsv:function(a,c,d){var e=Math.min(a,c,d),f=Math.max(a,c,d),e=f-e;if(f==0)return{h:NaN,s:0,v:0};
a=(a==f?(c-d)/e:c==f?2+(d-a)/e:4+(a-c)/e)/6;a<0&&(a=a+1);return{h:a*360,s:e/f,v:f/255}},rgb_to_hex:function(a,c,d){a=this.hex_with_component(0,2,a);a=this.hex_with_component(a,1,c);return this.hex_with_component(a,0,d)},component_from_hex:function(a,c){return a>>c*8&255},hex_with_component:function(b,c,d){return d<<(a=c*8)|b&~(255<<a)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}(),dat.dom.CenteredDiv=function(a,b){var c=function(){this.backgroundElement=document.createElement("div");b.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"});a.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=
document.createElement("div");b.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var c=this;a.bind(this.backgroundElement,"click",function(){c.hide()})};c.prototype.show=function(){var a=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=
0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();b.defer(function(){a.backgroundElement.style.opacity=1;a.domElement.style.opacity=1;a.domElement.style.webkitTransform="scale(1)"})};c.prototype.hide=function(){var b=this,c=function(){b.domElement.style.display="none";b.backgroundElement.style.display="none";a.unbind(b.domElement,"webkitTransitionEnd",c);a.unbind(b.domElement,"transitionend",c);a.unbind(b.domElement,"oTransitionEnd",c)};a.bind(this.domElement,"webkitTransitionEnd",
c);a.bind(this.domElement,"transitionend",c);a.bind(this.domElement,"oTransitionEnd",c);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};c.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-a.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-a.getHeight(this.domElement)/2+"px"};return c}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);
var Handsontable={extension:{},helper:{}};
(function(a,b,c){function d(a){return(a=a.data("typeahead"))&&a.$menu.is(":visible")?a:false}function e(a,b,d,e){c.helper.stringify(a.getDataAtCell(b,d))===c.helper.stringify(e.checkedTemplate)?a.setDataAtCell(b,d,e.uncheckedTemplate):a.setDataAtCell(b,d,e.checkedTemplate)}function f(a,b){this.instance=a;this.settings=b;this.wtDom=new h;this.main=document.createElement("div");this.main.style.position="absolute";this.main.style.top=0;for(var c=this.main.style.left=0;c<5;c++){var d=document.createElement("DIV");
d.className="wtBorder "+(b.className||"");d.style.backgroundColor=b.border.color;d.style.height=b.border.width+"px";d.style.width=b.border.width+"px";this.main.appendChild(d)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.corner=this.main.childNodes[4];this.corner.className=this.corner.className+" corner";this.corner.style.width="5px";this.corner.style.height="5px";this.corner.style.border="2px solid #FFF";
this.disappear();a.wtTable.hider.appendChild(this.main)}function g(a){var b=[];this.wtSettings=new p(this,a);this.wtTable=new m(this);this.wtScroll=new j(this);this.wtWheel=new r(this);this.wtEvent=new i(this);this.wtDom=new h;if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var a=0,c=this.wtTable.THEAD.childNodes[0].childNodes.length;a<c;a++)b.push(this.wtTable.THEAD.childNodes[0].childNodes[a].innerHTML);this.hasSetting("columnHeaders")||this.update("columnHeaders",
function(a,c){c.innerHTML=b[a]})}this.selections={};if(a=this.getSetting("selections"))for(var d in a)a.hasOwnProperty(d)&&(this.selections[d]=new l(this,a[d]));this.drawn=false}function h(){}function i(b){var c=this;this.instance=b;this.wtDom=new h;var d=[null,null,null,null],e=null,f;a(this.instance.wtTable.parent).on("mousedown",function(a){var b=c.parentCell(a.target);b.TD&&b.TD.nodeName==="TD"?c.instance.hasSetting("onCellMouseDown")&&c.instance.getSetting("onCellMouseDown",a,b.coords,b.TD):
c.wtDom.hasClass(a.target,"corner")&&c.instance.getSetting("onCellCornerMouseDown",a,a.target);if(a.button!==2)if(b.TD&&b.TD.nodeName==="TD"){d.shift();d.push(b.TD)}else if(c.wtDom.hasClass(a.target,"corner")){d.shift();d.push(a.target)}});a(this.instance.wtTable.TABLE).on("mouseover",function(a){if(c.instance.hasSetting("onCellMouseOver")){var b=c.wtDom.closest(a.target,["TD","TH"]);if(b&&b!==f){f=b;b.nodeName==="TD"&&c.instance.getSetting("onCellMouseOver",a,c.instance.wtTable.getCoords(b),b)}}});
a(this.instance.wtTable.parent).on("mouseup",function(a){if(a.button!==2){var b=c.parentCell(a.target);if(b.TD&&b.TD.nodeName==="TD"){d.shift();d.push(b.TD)}else{d.shift();d.push(a.target)}if(d[3]!==null&&d[3]===d[2])if(e&&d[2]===d[1]&&d[1]===d[0]){b.TD?c.instance.getSetting("onCellDblClick",a,b.coords,b.TD):c.wtDom.hasClass(a.target,"corner")&&c.instance.getSetting("onCellCornerDblClick",a,b.coords,b.TD);clearTimeout(e);e=null}else{clearTimeout(e);e=setTimeout(function(){e=null},500)}}})}function j(a){this.instance=
a;this.wtScrollbarV=new k(a,"vertical");this.wtScrollbarH=new k(a,"horizontal")}function k(b,c){var d=this;this.instance=b;this.type=c;this.$table=a(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.slider.style.position="absolute";this.slider.style.top="0";this.slider.style.left="0";this.slider.style.display="none";this.slider.className="dragdealer "+c;this.handle=document.createElement("DIV");this.handle.className="handle";this.slider.appendChild(this.handle);this.instance.wtTable.parent.appendChild(this.slider);
var e=true;this.dragTimeout=null;var f,g=function(){d.onScroll(f)};this.dragdealer=new y(this.slider,{vertical:c==="vertical",horizontal:c==="horizontal",speed:100,yPrecision:100,animationCallback:function(a,b){if(e)e=false;else{d.skipRefresh=true;f=c==="vertical"?b:a;if(d.dragTimeout===null){d.dragTimeout=setInterval(g,100);g()}}},callback:function(a,b){d.skipRefresh=false;clearInterval(d.dragTimeout);d.dragTimeout=null;f=c==="vertical"?b:a;d.onScroll(f)}});d.skipRefresh=false}function l(a,b){this.instance=
a;this.settings=b;this.selected=[];if(b.border)this.border=new f(a,b);this.onAdd=function(c){c=a.wtTable.getCell(c);typeof c==="object"&&b.className&&a.wtDom.addClass(c,b.className)}}function p(a,b){var c=this;this.instance=a;this.defaults={table:void 0,async:false,scrollH:"auto",scrollV:"auto",stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,frozenColumns:null,columnHeaders:null,totalRows:void 0,totalColumns:void 0,width:null,height:null,
cellRenderer:function(a,b,d){a=c.getSetting("data",a,b);d.innerHTML=a!==void 0?a:""},columnWidth:50,selections:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var d in this.defaults)if(this.defaults.hasOwnProperty(d))if(b[d]!==void 0)this.settings[d]=b[d];else{if(this.defaults[d]===void 0)throw Error('A required setting "'+d+'" was not provided');this.settings[d]=this.defaults[d]}this.rowHeightCache=
[]}function m(b){this.instance=b;this.TABLE=this.instance.getSetting("table");this.wtDom=new h;this.wtDom.removeTextNodes(this.TABLE);this.hasEmptyCellProblem=a.browser.msie&&parseInt(a.browser.version,10)<=7;if(this.hasCellSpacingProblem=a.browser.msie&&parseInt(a.browser.version,10)<=7)this.TABLE.cellSpacing=0;this.visibilityStartRow=this.visibilityStartColumn=this.visibilityEdgeRow=this.visibilityEdgeColumn=null;b=this.TABLE.parentNode;if(!b||b.nodeType!==1||!this.wtDom.hasClass(b,"wtHolder")){var c=
document.createElement("DIV");if(this.instance.hasSetting("width")&&this.instance.hasSetting("height")){c.style.position="absolute";c.style.top="0";c.style.left="0";c.style.width="4000px";c.style.height="4000px"}c.className="wtSpreader";b&&b.insertBefore(c,this.TABLE);c.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;b=this.spreader.parentNode;if(!b||b.nodeType!==1||!this.wtDom.hasClass(b,"wtHolder")){c=document.createElement("DIV");c.style.position="relative";c.className="wtHider";b&&
b.insertBefore(c,this.spreader);c.appendChild(this.spreader)}this.hider=this.spreader.parentNode;b=this.hider.parentNode;if(!b||b.nodeType!==1||!this.wtDom.hasClass(b,"wtHolder")){c=document.createElement("DIV");c.style.position="relative";c.className="wtHolder";b&&b.insertBefore(c,this.hider);c.appendChild(this.hider)}this.parent=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=
this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}this.instance.hasSetting("columnHeaders")&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"));this.colgroupChildrenLength=this.COLGROUP.childNodes.length;
this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length}function r(b){var c=this;this.instance=b;var d;a(this.instance.wtTable.TABLE).on("mousewheel",function(a,b,e,f){clearTimeout(d);d=setTimeout(function(){f?c.instance.scrollVertical(-Math.ceil(f)).draw():e&&c.instance.scrollHorizontal(Math.ceil(e)).draw()},0);a.preventDefault()})}c.Core=function(d,e){this.rootElement=d;var f,g,h,i,j,k,l,m=this;f={settings:{},
selStart:new c.SelectionPoint,selEnd:new c.SelectionPoint,editProxy:false,isPopulated:null,scrollable:null,undoRedo:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:true};g={recursiveDuckSchema:function(b){var c;if(a.isPlainObject(b)){c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.isPlainObject(b[d])?g.recursiveDuckSchema(b[d]):null)}else c=[];return c},recursiveDuckColumns:function(b,c,d){var e,h;if(typeof c==="undefined"){c=0;d=""}if(a.isPlainObject(b))for(h in b)if(b.hasOwnProperty(h))if(b[h]===
null){e=d+h;f.colToProp.push(e);f.propToCol[e]=c;c++}else c=g.recursiveDuckColumns(b[h],c,h+".");return c},createMap:function(){if(typeof g.getSchema()==="undefined")throw Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var a,b;a=g.getSchema();f.colToProp=[];f.propToCol={};if(f.settings.columns){a=0;for(b=f.settings.columns.length;a<b;a++){f.colToProp[a]=f.settings.columns[a].data;f.propToCol[f.settings.columns[a].data]=a}}else g.recursiveDuckColumns(a)},
colToProp:function(a){a=c.PluginModifiers.run(m,"col",a);return f.colToProp&&typeof f.colToProp[a]!=="undefined"?f.colToProp[a]:a},propToCol:function(a){a=typeof f.propToCol[a]!=="undefined"?f.propToCol[a]:a;return a=c.PluginModifiers.run(m,"col",a)},getSchema:function(){return f.settings.dataSchema?typeof f.settings.dataSchema==="function"?f.settings.dataSchema():f.settings.dataSchema:f.duckDataSchema},createRow:function(b){var c;if(f.dataType==="array"){c=[];for(var d=0,e=m.countCols();d<e;d++)c.push(null)}else c=
a.extend(true,{},g.getSchema());if(!b||b.row>=m.countRows()){if(f.settings.onCreateRow)f.settings.onCreateRow(m.countRows(),c);f.settings.data.push(c)}else{if(f.settings.onCreateRow)f.settings.onCreateRow(b.row,c);f.settings.data.splice(b.row,0,c)}m.forceFullRender=true},createCol:function(a){if(f.dataType==="object"||f.settings.columns)throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting");
var b=0,c=m.countRows();if(!a||a.col>=m.countCols())for(;b<c;b++){typeof f.settings.data[b]==="undefined"&&(f.settings.data[b]=[]);f.settings.data[b].push("")}else for(;b<c;b++)f.settings.data[b].splice(a.col,0,"");m.forceFullRender=true},removeRow:function(a,b){!a||a.row===m.countRows()-1?f.settings.data.pop():f.settings.data.splice(a.row,b.row-a.row+1);m.forceFullRender=true},removeCol:function(a,b){if(f.dataType==="object"||f.settings.columns)throw Error("cannot remove column with object data source or columns option specified");
var c=0;if(!a||a.col===m.countCols()-1)for(;c<m.countRows();c++)f.settings.data[c].pop();else for(var d=b.col-a.col+1;c<m.countRows();c++)f.settings.data[c].splice(a.col,d);m.forceFullRender=true},getVars:{},get:function(a,b){g.getVars.row=a;g.getVars.prop=b;c.PluginHooks.run(m,"beforeGet",g.getVars);if(typeof g.getVars.prop==="string"&&g.getVars.prop.indexOf(".")>-1){var d=g.getVars.prop.split("."),e=f.settings.data[g.getVars.row];if(!e)return null;for(var h=0,i=d.length;h<i;h++){e=e[d[h]];if(typeof e===
"undefined")return null}return e}return f.settings.data[g.getVars.row]?f.settings.data[g.getVars.row][g.getVars.prop]:null},setVars:{},set:function(a,b,d){g.setVars.row=a;g.setVars.prop=b;g.setVars.value=d;c.PluginHooks.run(m,"beforeSet",g.setVars);if(typeof g.setVars.prop==="string"&&g.setVars.prop.indexOf(".")>-1){for(var a=g.setVars.prop.split("."),b=f.settings.data[g.setVars.row],d=0,e=a.length-1;d<e;d++)b=b[a[d]];b[a[d]]=g.setVars.value}else f.settings.data[g.setVars.row][g.setVars.prop]=g.setVars.value},
clear:function(){for(var a=0;a<m.countRows();a++)for(var b=0;b<m.countCols();b++)g.set(a,g.colToProp(b),"")},getAll:function(){return f.settings.data},getRange:function(a,b){var c,d,e,f,h=[],i;d=Math.max(a.row,b.row);f=Math.max(a.col,b.col);for(c=Math.min(a.row,b.row);c<=d;c++){i=[];for(e=Math.min(a.col,b.col);e<=f;e++)i.push(g.get(c,g.colToProp(e)));h.push(i)}return h},getText:function(a,b){return SheetClip.stringify(g.getRange(a,b))}};h={alter:function(b,c,d){var e,j,k,s;e=a.extend(true,[],g.getAll());
switch(b){case "insert_row":if(m.countRows()<f.settings.maxRows){g.createRow(c);if(f.selStart.exists()&&f.selStart.row()>=c.row){f.selStart.row(f.selStart.row()+1);i.transformEnd(1,0)}else i.refreshBorders()}break;case "insert_col":if(m.countCols()<f.settings.maxCols){g.createCol(c);if(f.selStart.exists()&&f.selStart.col()>=c.col){f.selStart.col(f.selStart.col()+1);i.transformEnd(0,1)}else i.refreshBorders()}break;case "remove_row":g.removeRow(c,d);h.keepEmptyRows();i.refreshBorders();break;case "remove_col":g.removeCol(c,
d);h.keepEmptyRows();i.refreshBorders()}c=[];b=g.getAll();d=0;for(j=b.length;d<j;d++){k=0;for(s=b[d].length;k<s;k++)c.push([d,k,e[d]?e[d][k]:null,b[d][k]])}p("datachange.handsontable",[c,"alter"]);h.keepEmptyRows()},keepEmptyRows:function(){var a,b,c,d=0,e=0,h;a=m.countRows()-1;a:for(;a>=0;a--){b=0;for(c=m.countCols();b<c;b++){h=g.get(a,g.colToProp(b));if(h!==""&&h!==null&&typeof h!=="undefined")break a}d++}b=m.countRows();if(b<f.settings.minRows)for(a=0;a<f.settings.minRows-b;a++)g.createRow();if(d<
f.settings.minSpareRows)for(;d<f.settings.minSpareRows&&m.countRows()<f.settings.maxRows;d++)g.createRow();if(m.countRows()-1>0){b=m.countCols()-1;a:for(;b>=0;b--){for(a=0;a<m.countRows();a++){h=g.get(a,g.colToProp(b));if(h!==""&&h!==null&&typeof h!=="undefined")break a}e++}}if(!f.settings.columns&&m.countCols()<f.settings.minCols)for(;m.countCols()<f.settings.minCols;e++)g.createCol();if(!f.settings.columns&&f.dataType==="array"&&e<f.settings.minSpareCols)for(;e<f.settings.minSpareCols&&m.countCols()<
f.settings.maxCols;e++)g.createCol();if(f.settings.enterBeginsEditing)for(;(f.settings.minRows||f.settings.minSpareRows)&&m.countRows()>f.settings.minRows&&f.settings.minSpareRows&&d>f.settings.minSpareRows;d--)g.removeRow();if(f.settings.enterBeginsEditing&&!f.settings.columns)for(;(f.settings.minCols||f.settings.minSpareCols)&&m.countCols()>f.settings.minCols&&f.settings.minSpareCols&&e>f.settings.minSpareCols;e--)g.removeCol();a=m.countRows();d=m.countCols();(a===0||d===0)&&i.deselect();if(f.selStart.exists()){var j,
e=f.selStart.row();b=f.selStart.col();c=f.selEnd.row();h=f.selEnd.col();if(e>a-1){e=a-1;j=true;c>e&&(c=e)}else if(c>a-1){c=a-1;j=true;e>c&&(e=c)}if(b>d-1){b=d-1;j=true;h>b&&(h=b)}else if(h>d-1){h=d-1;j=true;b>h&&(b=h)}j&&m.selectCell(e,b,c,h)}},populateFromArray:function(a,b,c,d){var e,h,i,j,k=[],s,l;h=b.length;if(h===0)return false;s=a.row;for(e=0;e<h;e++){if(c&&s>c.row||!f.settings.minSpareRows&&s>m.countRows()-1||s>=f.settings.maxRows)break;l=a.col;j=b[e]?b[e].length:0;for(i=0;i<j;i++){if(c&&l>
c.col||!f.settings.minSpareCols&&l>m.countCols()-1||l>=f.settings.maxCols)break;if(m.getCellMeta(s,l).isWritable){var o=g.colToProp(l);k.push([s,o,b[e][i]])}l++;c&&i===j-1&&(i=-1)}s++;c&&e===h-1&&(e=-1)}m.setDataAtCell(k,null,null,d||"populateFromArray")},getCornerCoords:function(b){function c(b,d,e){function f(a){return a[e]}return Array.prototype.map?b.apply(Math,d.map(f)):b.apply(Math,a.map(d,f))}return{TL:{row:c(Math.min,b,"row"),col:c(Math.min,b,"col")},BR:{row:c(Math.max,b,"row"),col:c(Math.max,
b,"col")}}},getCellsAtCoords:function(a,b){var c=h.getCornerCoords([a,b]),d,e,f=[];for(d=c.TL.row;d<=c.BR.row;d++)for(e=c.TL.col;e<=c.BR.col;e++)f.push(m.view.getCellAtCoords({row:d,col:e}));return f}};this.selection=i={setRangeStart:function(a){i.deselect();f.selStart.coords(a);i.setRangeEnd(a)},setRangeEnd:function(a,b){f.selEnd.coords(a);f.settings.multiSelect||f.selStart.coords(a);m.view.wt.selections.current.clear();m.view.wt.selections.current.add(f.selStart.arr());m.view.wt.selections.area.clear();
if(i.isMultiple()){m.view.wt.selections.area.add(f.selStart.arr());m.view.wt.selections.area.add(f.selEnd.arr())}m.rootElement.triggerHandler("selection.handsontable",[f.selStart.row(),f.selStart.col(),f.selEnd.row(),f.selEnd.col()]);m.rootElement.triggerHandler("selectionbyprop.handsontable",[f.selStart.row(),g.colToProp(f.selStart.col()),f.selEnd.row(),g.colToProp(f.selEnd.col())]);if(b!==false){m.view.scrollViewport(a);m.view.wt.draw(true);m.view.scrollViewport(a)}i.refreshBorders()},refreshBorders:function(a,
b){b||j.destroy(a);m.view.render();i.isSelected()&&!b&&j.prepare()},isMultiple:function(){return!(f.selEnd.col()===f.selStart.col()&&f.selEnd.row()===f.selStart.row())},transformStart:function(a,b,c){if(f.selStart.row()+a>m.countRows()-1)if(c&&f.settings.minSpareRows>0)m.alter("insert_row",m.countRows());else{if(f.settings.autoWrapCol&&f.selStart.col()+b<m.countCols()-1){a=1-m.countRows();b=1}}else if(f.settings.autoWrapCol&&f.selStart.row()+a<0&&f.selStart.col()+b>=0){a=m.countRows()-1;b=-1}if(f.selStart.col()+
b>m.countCols()-1)if(c&&f.settings.minSpareCols>0)m.alter("insert_col",m.countCols());else{if(f.settings.autoWrapRow&&f.selStart.row()+a<m.countRows()-1){a=1;b=1-m.countCols()}}else if(f.settings.autoWrapRow&&f.selStart.col()+b<0&&f.selStart.row()+a>=0){a=-1;b=m.countCols()-1}var c=m.countRows(),d=m.countCols(),a={row:f.selStart.row()+a,col:f.selStart.col()+b};if(a.row<0)a.row=0;else if(a.row>0&&a.row>=c)a.row=c-1;if(a.col<0)a.col=0;else if(a.col>0&&a.col>=d)a.col=d-1;i.setRangeStart(a)},transformEnd:function(a,
b){if(f.selEnd.exists()){var c=m.countRows(),d=m.countCols(),e={row:f.selEnd.row()+a,col:f.selEnd.col()+b};if(e.row<0)e.row=0;else if(e.row>0&&e.row>=c)e.row=c-1;if(e.col<0)e.col=0;else if(e.col>0&&e.col>=d)e.col=d-1;i.setRangeEnd(e)}},isSelected:function(){return f.selEnd.exists()},inInSelection:function(a){if(!i.isSelected())return false;var b=h.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);return b.TL.row<=a.row&&b.BR.row>=a.row&&b.TL.col<=a.col&&b.BR.col>=a.col},deselect:function(){if(i.isSelected()){f.selEnd=
new c.SelectionPoint;m.view.wt.selections.current.clear();m.view.wt.selections.area.clear();j.destroy();i.refreshBorders();m.rootElement.triggerHandler("deselect.handsontable")}},selectAll:function(){if(f.settings.multiSelect){i.setRangeStart({row:0,col:0});i.setRangeEnd({row:m.countRows()-1,col:m.countCols()-1},false)}},empty:function(){if(i.isSelected()){var a=h.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]),b,c,d=[];for(b=a.TL.row;b<=a.BR.row;b++)for(c=a.TL.col;c<=a.BR.col;c++)m.getCellMeta(b,
c).isWritable&&d.push([b,g.colToProp(c),""]);m.setDataAtCell(d)}}};this.autofill=k={handle:null,init:function(){k.handle?k.handle.disabled=false:k.handle={}},disable:function(){k.handle.disabled=true},selectAdjacent:function(){var a,b,c,d,e;a=i.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners();b=g.getAll();c=a[2]+1;a:for(;c<m.countRows();c++){for(e=a[1];e<=a[3];e++)if(b[c][e])break a;if(b[c][a[1]-1]||b[c][a[3]+1])d=c}if(d){m.view.wt.selections.fill.clear();
m.view.wt.selections.fill.add([a[0],a[1]]);m.view.wt.selections.fill.add([d,a[3]]);k.apply()}},apply:function(){var a,b,c,d;k.handle.isDragged=0;if(a=m.view.wt.selections.fill.getCorners()){m.view.wt.selections.fill.clear();b=i.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners();if(a[0]===b[0]&&a[1]<b[1]){c={row:a[0],col:a[1]};d={row:a[2],col:b[1]-1}}else if(a[0]===b[0]&&a[3]>b[3]){c={row:a[0],col:b[3]+1};d={row:a[2],col:a[3]}}else if(a[0]<b[0]&&a[1]===b[1]){c=
{row:a[0],col:a[1]};d={row:b[0]-1,col:a[3]}}else if(a[2]>b[2]&&a[1]===b[1]){c={row:b[2]+1,col:a[1]};d={row:a[2],col:a[3]}}if(c){h.populateFromArray(c,SheetClip.parse(g.getText(f.selStart.coords(),f.selEnd.coords())),d,"autofill");i.setRangeStart({row:a[0],col:a[1]});i.setRangeEnd({row:a[2],col:a[3]})}}},showBorder:function(a){a.row=a[0];a.col=a[1];var b=h.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);if(f.settings.fillHandle!=="horizontal"&&(b.BR.row<a.row||b.TL.row>a.row))a=[a.row,b.BR.col];
else if(f.settings.fillHandle!=="vertical")a=[b.BR.row,a.col];else return;m.view.wt.selections.fill.clear();m.view.wt.selections.fill.add([f.selStart.coords().row,f.selStart.coords().col]);m.view.wt.selections.fill.add([f.selEnd.coords().row,f.selEnd.coords().col]);m.view.wt.selections.fill.add(a);m.view.render()}};j={init:function(){f.editProxy=a('<textarea class="handsontableInput">');f.editProxyHolder=a('<div class="handsontableInputHolder">');f.editProxyHolder.append(f.editProxy);var b=a(document.body);
f.editProxy.on("click",function(a){a.stopPropagation()});f.editProxyHolder.on("cut",function(){setTimeout(function(){i.empty()},100)});f.editProxyHolder.on("paste",function(){setTimeout(function(){m.rootElement.one("datachange.handsontable",function(a,b){if(b.length){var c=b[b.length-1];i.setRangeEnd({row:c[0],col:m.propToCol(c[1])})}});var a=f.editProxy[0].value.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),a=SheetClip.parse(a),b=h.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);h.populateFromArray(b.TL,
a,{row:Math.max(b.BR.row,a.length-1+b.TL.row),col:Math.max(b.BR.col,a[0].length-1+b.TL.col)},"paste")},100)});f.editProxyHolder.on("keydown",function(d){if(!b.children(".context-menu-list:visible").length)if(d.keyCode===17||d.keyCode===224||d.keyCode===91||d.keyCode===93)j.setCopyableText();else{f.lastKeyCode=d.keyCode;if(i.isSelected()){var e=(d.ctrlKey||d.metaKey)&&!d.altKey;if(c.helper.isPrintableChar(d.keyCode)&&e)if(d.keyCode===65){i.selectAll();j.setCopyableText()}else d.keyCode===88&&a.browser.opera?
f.editProxyHolder.triggerHandler("cut"):d.keyCode===86&&a.browser.opera?f.editProxyHolder.triggerHandler("paste"):d.keyCode===89||d.shiftKey&&d.keyCode===90?f.undoRedo&&f.undoRedo.redo():d.keyCode===90&&f.undoRedo&&f.undoRedo.undo();else{e=d.shiftKey?i.setRangeEnd:i.setRangeStart;switch(d.keyCode){case 38:d.shiftKey?i.transformEnd(-1,0):i.transformStart(-1,0);d.preventDefault();break;case 9:e=typeof f.settings.tabMoves==="function"?f.settings.tabMoves(d):f.settings.tabMoves;d.shiftKey?i.transformStart(-e.row,
-e.col):i.transformStart(e.row,e.col,true);d.preventDefault();break;case 39:d.shiftKey?i.transformEnd(0,1):i.transformStart(0,1);d.preventDefault();break;case 37:d.shiftKey?i.transformEnd(0,-1):i.transformStart(0,-1);d.preventDefault();break;case 8:case 46:i.empty(d);d.preventDefault();break;case 40:d.shiftKey?i.transformEnd(1,0):i.transformStart(1,0);d.preventDefault();break;case 113:d.preventDefault();break;case 13:e=typeof f.settings.enterMoves==="function"?f.settings.enterMoves(d):f.settings.enterMoves;
d.shiftKey?i.transformStart(-e.row,-e.col):i.transformStart(e.row,e.col,true);d.preventDefault();break;case 36:d.ctrlKey||d.metaKey?e({row:0,col:f.selStart.col()}):e({row:f.selStart.row(),col:0});break;case 35:d.ctrlKey||d.metaKey?e({row:m.countRows()-1,col:f.selStart.col()}):e({row:f.selStart.row(),col:m.countCols()-1});break;case 33:i.transformStart(-m.countVisibleRows(),0);m.view.wt.scrollVertical(-m.countVisibleRows());m.view.render();d.preventDefault();break;case 34:i.transformStart(m.countVisibleRows(),
0);m.view.wt.scrollVertical(m.countVisibleRows());m.view.render();d.preventDefault()}}}}});m.rootElement.append(f.editProxyHolder)},destroy:function(a){if(typeof f.editorDestroyer==="function"){f.editorDestroyer(a);f.editorDestroyer=null}},setCopyableText:function(){var a=Math.min(f.selStart.row(),f.selEnd.row()),b=Math.min(f.selStart.col(),f.selEnd.col()),c=Math.max(f.selStart.row(),f.selEnd.row()),d=Math.max(f.selStart.col(),f.selEnd.col()),e=Math.min(c,a+f.settings.copyRowsLimit-1),h=Math.min(d,
b+f.settings.copyColsLimit-1);f.editProxy[0].value=g.getText({row:a,col:b},{row:e,col:h});setTimeout(j.focus,1);if((c!==e||d!==h)&&f.settings.onCopyLimit)f.settings.onCopyLimit(c-a+1,d-b+1,f.settings.copyRowsLimit,f.settings.copyColsLimit)},prepare:function(){f.editProxy.height(f.editProxy.parent().innerHeight()-4);f.editProxy[0].value="";setTimeout(j.focus,1);if(f.settings.asyncRendering){clearTimeout(b.prepareFrame);b.prepareFrame=setTimeout(function(){f.editorDestroyer=m.view.applyCellTypeMethod("editor",
m.view.getCellAtCoords(f.selStart.coords()),f.selStart.coords(),f.editProxy)},0)}else f.editorDestroyer=m.view.applyCellTypeMethod("editor",m.view.getCellAtCoords(f.selStart.coords()),f.selStart.coords(),f.editProxy)},focus:function(){try{i.isSelected()&&f.editProxy[0].select()}catch(a){}}};this.init=function(){c.PluginHooks.run(m,"beforeInit");j.init();q();this.updateSettings(e);this.view=new c.TableView(this);if(typeof f.firstRun==="object"){p("datachange.handsontable",f.firstRun);f.firstRun=false}c.PluginHooks.run(m,
"afterInit")};l=function(b,c){var d=a.Deferred(),e=[];if(c==="paste")for(var g=function(c){var d=a.Deferred();e.push(d);var f=b[c][3],g=typeof f==="string"?f.toLowerCase():null;return function(a){for(var e=false,h=0,i=a.length;h<i;h++)if(f===a[h]){e=true;break}else if(g===a[h].toLowerCase()){b[c][3]=a[h];e=true;break}e||(b[c]=null);d.resolve()}},h=b.length-1;h>=0;h--){var i=m.getCellMeta(b[h][0],b[h][1]);if(i.strict&&i.source)(i=a.isFunction(i.source)?i.source(b[h][3],g(h)):i.source)&&g(h)(i)}a.when(e).then(function(){for(var e=
b.length-1;e>=0;e--)b[e]===null&&b.splice(e,1);if(f.settings.onBeforeChange&&b.length){e=f.settings.onBeforeChange.apply(m.rootElement[0],[b,c]);if(typeof e==="function")a.when(e).then(function(){d.resolve()});else{e===false&&b.splice(0,b.length);d.resolve()}}else d.resolve()});return a.when(d)};var p=function(a,b){f.settings.asyncRendering?setTimeout(function(){m.rootElement.triggerHandler(a,b)},0):m.rootElement.triggerHandler(a,b)},q=function(){m.rootElement.on("datachange.handsontable",function(a,
b,c){f.settings.onChange&&f.settings.onChange.apply(m.rootElement[0],[b,c])});m.rootElement.on("selection.handsontable",function(a,b,c,d,e){f.settings.onSelection&&f.settings.onSelection.apply(m.rootElement[0],[b,c,d,e])});m.rootElement.on("selectionbyprop.handsontable",function(a,b,c,d,e){f.settings.onSelectionByProp&&f.settings.onSelectionByProp.apply(m.rootElement[0],[b,c,d,e])})};this.setDataAtCell=function(b,c,d,e){var j,k,s;j=typeof b==="object"?b:a.isPlainObject(d)?d:[[b,c,d]];k=0;for(s=j.length;k<
s;k++)j[k].splice(2,0,g.get(j[k][0],j[k][1]));l(j,e).then(function(){k=0;for(s=j.length;k<s;k++){b=j[k][0];c=j[k][1];var a=g.propToCol(c);d=j[k][3];if(f.settings.minSpareRows)for(;b>m.countRows()-1;)g.createRow();if(f.dataType==="array"&&f.settings.minSpareCols)for(;a>m.countCols()-1;)g.createCol();g.set(b,c,d)}m.forceFullRender=true;h.keepEmptyRows();i.refreshBorders();p("datachange.handsontable",[j,e||"edit"])})};this.destroyEditor=function(a){i.refreshBorders(a)};this.populateFromArray=function(a,
b,c,d){return h.populateFromArray(a,b,c,d)};this.getCornerCoords=function(a){return h.getCornerCoords(a)};this.getSelected=function(){if(i.isSelected()){var a=h.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);return[a.TL.row,a.TL.col,a.BR.row,a.BR.col]}};this.render=function(){if(m.view){m.forceFullRender=true;i.refreshBorders(null,true);f.editProxy.triggerHandler("refreshBorder")}};this.loadData=function(b,d){var e;f.isPopulated=false;f.settings.data=b;f.dataType=a.isPlainObject(f.settings.dataSchema)||
a.isPlainObject(b[0])?"object":"array";f.duckDataSchema=b[0]?g.recursiveDuckSchema(b[0]):{};g.createMap();if(d){e=m.countRows();if(f.settings.startRows)for(;f.settings.startRows>e;){g.createRow();e++}}h.keepEmptyRows();c.PluginHooks.run(m,"afterLoadData");if(f.firstRun)f.firstRun=[null,"loadData"];else{p("datachange.handsontable",[null,"loadData"]);m.render()}f.isPopulated=true;m.clearUndo()};this.getData=function(a,b,c,d){return typeof a==="undefined"?g.getAll():g.getRange({row:a,col:b},{row:c,col:d})};
this.updateSettings=function(a){var b;if(typeof a.rows!=="undefined")throw Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(typeof a.cols!=="undefined")throw Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");if(typeof a.undo!=="undefined")if(f.undoRedo&&a.undo===false)f.undoRedo=null;else if(!f.undoRedo&&a.undo===true)f.undoRedo=new c.UndoRedo(m);for(b in a)if(b!=="data"&&a.hasOwnProperty(b)){f.settings[b]=a[b];
c.extension[b]&&(f.extensions[b]=new c.extension[b](m,a[b]))}if(f.settings.data===void 0&&a.data===void 0){a.data=[];for(var d=0,e=f.settings.startRows;d<e;d++){b=[];for(var j=0,s=f.settings.startCols;j<s;j++)b.push(null);a.data.push(b)}}a.data!==void 0?m.loadData(a.data,true):a.columns!==void 0&&g.createMap();typeof a.fillHandle!=="undefined"&&(k.handle&&a.fillHandle===false?k.disable():!k.handle&&a.fillHandle!==false&&k.init());h.keepEmptyRows();if(m.view){m.forceFullRender=true;i.refreshBorders(null,
true)}};this.getSettings=function(){return f.settings};this.clear=function(){i.selectAll();i.empty()};this.isUndoAvailable=function(){return f.undoRedo&&f.undoRedo.isUndoAvailable()};this.isRedoAvailable=function(){return f.undoRedo&&f.undoRedo.isRedoAvailable()};this.undo=function(){f.undoRedo&&f.undoRedo.undo()};this.redo=function(){f.undoRedo&&f.undoRedo.redo()};this.clearUndo=function(){f.undoRedo&&f.undoRedo.clear()};this.alter=function(a,b,c){typeof c==="undefined"&&(c=b);switch(a){case "insert_row":case "remove_row":h.alter(a,
{row:b,col:0},{row:c,col:0});break;case "insert_col":case "remove_col":h.alter(a,{row:0,col:b},{row:0,col:c});break;default:throw Error('There is no such action "'+a+'"');}};this.getCell=function(a,b){return m.view.getCellAtCoords({row:a,col:b})};this.colToProp=function(a){return g.colToProp(a)};this.propToCol=function(a){return g.propToCol(a)};this.getDataAtCell=function(a,b){return g.get(a,g.colToProp(b))};this.getCellMeta=function(b,d){var e={},h=g.colToProp(d);f.settings.columns&&(e=a.extend(true,
e,f.settings.columns[d]||{}));f.settings.cells&&(e=a.extend(true,e,f.settings.cells(b,d,h)||{}));e.isWritable=!e.readOnly;c.PluginHooks.run(m,"afterGetCellMeta",b,d,e);return e};this.getRowHeader=function(a){return Object.prototype.toString.call(f.settings.rowHeaders)==="[object Array]"&&f.settings.rowHeaders[a]!==void 0?f.settings.rowHeaders[a]:typeof f.settings.rowHeaders==="function"?f.settings.rowHeaders(a):f.settings.rowHeaders&&typeof f.settings.rowHeaders!=="string"&&typeof f.settings.rowHeaders!==
"number"?a+1:f.settings.rowHeaders};this.getColHeader=function(a,b){var a=c.PluginModifiers.run(m,"col",a),d=document.createElement("DIV");d.className="relative";if(f.settings.columns&&f.settings.columns[a]&&f.settings.columns[a].title)d.innerHTML='<span class="colHeader">'+f.settings.columns[a].title+"</span>";else if(Object.prototype.toString.call(f.settings.colHeaders)==="[object Array]"&&f.settings.colHeaders[a]!==void 0)d.innerHTML='<span class="colHeader">'+f.settings.colHeaders[a]+"</span>";
else if(typeof f.settings.colHeaders==="function")d.innerHTML='<span class="colHeader">'+f.settings.colHeaders(a)+"</span>";else if(f.settings.colHeaders&&typeof f.settings.colHeaders!=="string"&&typeof f.settings.colHeaders!=="number"){for(var e=a+1,g="",h;e>0;){h=(e-1)%26;g=String.fromCharCode(65+h)+g;e=parseInt((e-h)/26)}d.innerHTML='<span class="colHeader">'+g+"</span>"}else d.innerHTML='<span class="colHeader">'+f.settings.colHeaders+"</span>";for(;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(d);
c.PluginHooks.run(m,"afterGetColHeader",a,b)};this.getColWidth=function(a){var a=c.PluginModifiers.run(m,"col",a),b={};b.width=f.settings.columns&&f.settings.columns[a]&&f.settings.columns[a].width?f.settings.columns[a].width:Object.prototype.toString.call(f.settings.colWidths)==="[object Array]"&&f.settings.colWidths[a]!==void 0?f.settings.colWidths[a]:50;c.PluginHooks.run(m,"afterGetColWidth",a,b);return b.width};this.countRows=function(){return f.settings.data.length};this.countCols=function(){if(f.dataType===
"object")return f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.colToProp.length;if(f.dataType==="array")return f.settings.columns&&f.settings.columns.length?f.settings.columns.length:Math.max(f.settings.columns&&f.settings.columns.length||0,f.settings.data&&f.settings.data[0]&&f.settings.data[0].length||0)};this.rowOffset=function(){return m.view.wt.getSetting("offsetRow")};this.colOffset=function(){return m.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return m.view.wt.getSetting("viewportRows")};
this.countVisibleCols=function(){return m.view.wt.getSetting("viewportColumns")};this.selectCell=function(a,b,c,d,e){if(typeof a!=="number"||a<0||a>=m.countRows()||typeof b!=="number"||b<0||b>=m.countCols()||typeof c!=="undefined"&&(typeof c!=="number"||c<0||c>=m.countRows()||typeof d!=="number"||d<0||d>=m.countCols()))return false;f.selStart.coords({row:a,col:b});typeof c==="undefined"?i.setRangeEnd({row:a,col:b},e):i.setRangeEnd({row:c,col:d},e)};this.selectCellByProp=function(a,b,c,d,e){arguments[1]=
g.propToCol(arguments[1]);typeof arguments[3]!=="undefined"&&(arguments[3]=g.propToCol(arguments[3]));return m.selectCell.apply(m,arguments)};this.deselectCell=function(){i.deselect()};this.destroy=function(){m.rootElement.empty();m.rootElement.removeData("handsontable");m.rootElement.off(".handsontable")};this.version="0.8.3"};var q={data:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,undo:true,outsideClickDeselects:true,
enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1E3,copyColsLimit:1E3,currentRowClassName:void 0,currentColClassName:void 0,asyncRendering:true,stretchH:"hybrid"};a.fn.handsontable=function(b){var d,e,f,g=[],h;if(typeof b!=="string"){h=b||{};return this.each(function(){var b=a(this);if(b.data("handsontable")){e=b.data("handsontable");e.updateSettings(h)}else{var e=a.extend(true,{},q),e;for(d in h)h.hasOwnProperty(d)&&(e[d]=
h[d]);e=new c.Core(b,e);b.data("handsontable",e);e.init()}})}f=[];if(arguments.length>1){d=1;for(e=arguments.length;d<e;d++)f.push(arguments[d])}this.each(function(){g=a(this).data("handsontable")[b].apply(this,f)});return g};c.TableView=function(d){var e=this;this.instance=d;var f=this.instance.getSettings();d.rootElement.addClass("handsontable");var h=a('<table class="htCore"><thead></thead><tbody></tbody></table>');d.rootElement.prepend(h);this.overflow=d.rootElement.css("overflow");if((f.width||
f.height)&&!(this.overflow==="scroll"||this.overflow==="auto"))this.overflow="auto";if(this.overflow==="scroll"||this.overflow==="auto")d.rootElement[0].style.overflow="hidden";this.determineContainerSize();var i,j;a(document.body).on("mouseup",function(){i=false;clearInterval(j);j=null;if(d.autofill.handle&&d.autofill.handle.isDragged){d.autofill.handle.isDragged>1&&d.autofill.apply();d.autofill.handle.isDragged=0}});a(document.documentElement).on("mousedown",function(b){b=b.target;if(b!==e.wt.wtTable.spreader)for(;b!==
null&&b!==document.documentElement;){if(b===d.rootElement[0]||a(b).attr("id")==="context-menu-layer"||a(b).is(".context-menu-list")||a(b).is(".typeahead li"))return;b=b.parentNode}e.instance.getSettings().outsideClickDeselects?e.instance.deselectCell():e.instance.destroyEditor()});h.on("selectstart",function(a){a.preventDefault()});h.on("mouseenter",function(){if(j){clearInterval(j);j=null}});h.on("mouseleave",function(a){if(i||d.autofill.handle&&d.autofill.handle.isDragged){var b=e.wt.wtDom.offset(h[0]),
c=b.top+1,b=b.left+1,f=e.containerWidth-e.wt.getSetting("scrollbarWidth")-2,g=e.containerHeight-e.wt.getSetting("scrollbarHeight")-2,k,l=0,m=0;if(a.pageY<c){l=-1;k="scrollVertical"}else if(a.pageY>=c+g){l=1;k="scrollVertical"}else if(a.pageX<b){m=-1;k="scrollHorizontal"}else if(a.pageX>=b+f){m=1;k="scrollHorizontal"}if(k){a=function(){(i||d.autofill.handle&&d.autofill.handle.isDragged)&&e.wt[k](l+m).draw()};a();j=setInterval(a,100)}}});var k={table:h[0],async:f.asyncRendering,stretchH:f.stretchH,
data:d.getDataAtCell,totalRows:d.countRows,totalColumns:d.countCols,offsetRow:0,offsetColumn:0,displayRows:null,displayColumns:null,width:this.containerWidth,height:this.containerHeight,frozenColumns:f.rowHeaders?[d.getRowHeader]:null,columnHeaders:f.colHeaders?d.getColHeader:null,columnWidth:d.getColWidth,cellRenderer:function(a,b,c){e.applyCellTypeMethod("renderer",c,{row:a,col:b},d.getDataAtCell(a,b))},currentRowClassName:f.currentRowClassName,currentColumnClassName:f.currentColClassName,selections:{current:{className:"current",
border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return f.fillHandle&&!t.isCellEdited&&!d.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return f.fillHandle&&!t.isCellEdited&&d.selection.isMultiple()}}},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},onCellMouseDown:function(a,b){i=true;var c={row:b[0],col:b[1]};a.button===2&&d.selection.inInSelection(c)||(a.shiftKey?d.selection.setRangeEnd(c):
d.selection.setRangeStart(c))},onCellMouseOver:function(a,b){var c={row:b[0],col:b[1]};if(i)d.selection.setRangeEnd(c);else if(d.autofill.handle&&d.autofill.handle.isDragged){d.autofill.handle.isDragged++;d.autofill.showBorder(b)}},onCellCornerMouseDown:function(a){d.autofill.handle.isDragged=1;a.preventDefault()},onCellCornerDblClick:function(){d.autofill.selectAdjacent()}};c.PluginHooks.run(this.instance,"walkontableConfig",k);this.wt=new g(k);this.instance.forceFullRender=true;this.render();a(b).on("resize",
function(){e.determineContainerSize();e.wt.update("width",e.containerWidth);e.wt.update("height",e.containerHeight);e.instance.forceFullRender=true;e.render()});a(e.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(a){a.target===e.wt.wtTable.spreader&&a.which===3&&a.stopPropagation()})};c.TableView.prototype.determineContainerSize=function(){this.instance.rootElement[0].firstChild.style.display="none";var a=this.instance.getSettings();this.containerWidth=a.width;
this.containerHeight=a.height;var b=this.instance.rootElement.width(),c=this.instance.rootElement.height();if(a.width===void 0&&b>0)this.containerWidth=b;if((this.overflow==="scroll"||this.overflow==="auto")&&a.height===void 0&&c>0)this.containerHeight=c;this.instance.rootElement[0].firstChild.style.display="table"};c.TableView.prototype.render=function(){this.instance.forceFullRender&&c.PluginHooks.run(this.instance,"beforeRender");this.wt.draw(!this.instance.forceFullRender);this.instance.rootElement.triggerHandler("render.handsontable");
this.instance.forceFullRender=false;this.instance.forceFullRender&&c.PluginHooks.run(this.instance,"afterRender")};c.TableView.prototype.applyCellTypeMethod=function(a,b,d,e){var f=this.instance.colToProp(d.col),g,h=this.instance.getCellMeta(d.row,d.col);if(typeof h.type==="string")switch(h.type){case "autocomplete":h.type=c.AutocompleteCell;break;case "checkbox":h.type=c.CheckboxCell}h.type&&typeof h.type[a]==="function"&&(g=h.type[a]);typeof g!=="function"&&(g=c.TextCell[a]);return g(this.instance,
b,d.row,d.col,f,e,h)};c.TableView.prototype.getCellAtCoords=function(a){a=this.wt.wtTable.getCell([a.row,a.col]);return a<0?null:a};c.TableView.prototype.scrollViewport=function(a){this.wt.scrollViewport([a.row,a.col])};c.helper.isPrintableChar=function(a){return a==32||a>=48&&a<=57||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222||a>=226||a>=65&&a<=90};c.helper.stringify=function(a){switch(typeof a){case "string":case "number":return a+"";case "object":return a===null?"":a.toString();case "undefined":return"";
default:return a.toString()}};c.UndoRedo=function(a){var b=this;this.instance=a;this.clear();a.rootElement.on("datachange.handsontable",function(a,c,d){d!=="undo"&&d!=="redo"&&b.add(c)})};c.UndoRedo.prototype.undo=function(){var b,c;if(this.isUndoAvailable()){var d=a.extend(true,[],this.data[this.rev]);b=0;for(c=d.length;b<c;b++)d[b].splice(3,1);this.instance.setDataAtCell(d,null,null,"undo");this.rev--}};c.UndoRedo.prototype.redo=function(){var b,c;if(this.isRedoAvailable()){this.rev++;var d=a.extend(true,
[],this.data[this.rev]);b=0;for(c=d.length;b<c;b++)d[b].splice(2,1);this.instance.setDataAtCell(d,null,null,"redo")}};c.UndoRedo.prototype.isUndoAvailable=function(){return this.rev>=0};c.UndoRedo.prototype.isRedoAvailable=function(){return this.rev<this.data.length-1};c.UndoRedo.prototype.add=function(a){this.rev++;this.data.splice(this.rev);this.data.push(a)};c.UndoRedo.prototype.clear=function(){this.data=[];this.rev=-1};c.SelectionPoint=function(){this._col=this._row=null};c.SelectionPoint.prototype.exists=
function(){return this._row!==null};c.SelectionPoint.prototype.row=function(a){if(a!==void 0)this._row=a;return this._row};c.SelectionPoint.prototype.col=function(a){if(a!==void 0)this._col=a;return this._col};c.SelectionPoint.prototype.coords=function(a){if(a!==void 0){this._row=a.row;this._col=a.col}return{row:this._row,col:this._col}};c.SelectionPoint.prototype.arr=function(a){if(a!==void 0){this._row=a[0];this._col=a[1]}return[this._row,this._col]};c.TextRenderer=function(a,b,d,e,f,g){a=c.helper.stringify(g);
a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");b.innerHTML=a.replace(/\n/g,"<br/>")};c.AutocompleteRenderer=function(b,d,e,f,g,h,i){var d=a(d),j=a('<div class="htAutocomplete"></div>'),k=a('<div class="htAutocompleteArrow">&#x25BC;</div>');k.mouseup(function(){b.view.wt.getSetting("onCellDblClick")});c.TextCell.renderer(b,j[0],e,f,g,h,i);j.html()===""&&j.html("&nbsp;");j.append(k);d.empty().append(j)};c.CheckboxRenderer=function(b,
d,e,f,g,h,i){if(typeof i.checkedTemplate==="undefined")i.checkedTemplate=true;if(typeof i.uncheckedTemplate==="undefined")i.uncheckedTemplate=false;d.innerHTML=h===i.checkedTemplate||h===c.helper.stringify(i.checkedTemplate)?"<input type='checkbox' checked autocomplete='no'>":h===i.uncheckedTemplate||h===c.helper.stringify(i.uncheckedTemplate)?"<input type='checkbox' autocomplete='no'>":h===null?"<input type='checkbox' autocomplete='no' style='opacity: 0.5'>":"";f=a(d).find("input:first");f.mousedown(function(c){a(this).is(":checked")?
b.setDataAtCell(e,g,i.uncheckedTemplate):b.setDataAtCell(e,g,i.checkedTemplate);c.stopPropagation()});f.mouseup(function(a){a.stopPropagation()});return d};var t={isCellEdited:false,getCaretPosition:function(a){var b=a[0];if(b.selectionStart)return b.selectionStart;if(document.selection){b.focus();a=document.selection.createRange();if(a==null)return 0;var b=b.createTextRange(),c=b.duplicate();b.moveToBookmark(a.getBookmark());c.setEndPoint("EndToStart",b);return c.text.length}return 0},setCaretPosition:function(a,
b){var c=a[0];if(c.setSelectionRange){c.focus();c.setSelectionRange(b,b)}else if(c.createTextRange){c=c.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",b);c.select()}},beginEditing:function(a,b,d,e,f,g,h,i){if(!t.isCellEdited){t.isCellEdited=true;a.view.scrollViewport({row:d,col:e});a.view.render();g.on("cut.editor",function(a){a.stopPropagation()});g.on("paste.editor",function(a){a.stopPropagation()});if(a.getCellMeta(d,e).isWritable){if(h){b=a.getDataAtCell(d,
f);b=c.helper.stringify(b)+(i||"");g.val(b);t.setCaretPosition(g,b.length)}else g.val("");a.getSettings().asyncRendering?setTimeout(function(){t.refreshDimensions(a,d,e,g)},0):t.refreshDimensions(a,d,e,g)}}},refreshDimensions:function(b,c,d,e){if(t.isCellEdited){var c=a(b.getCell(c,d)),f=c.offset(),g=b.rootElement.offset(),d=b.rootElement.scrollTop(),h=b.rootElement.scrollLeft(),d=f.top-g.top+d-1,g=f.left-g.left+h-1,h=b.getSettings(),f=h.rowHeaders===false?0:1,h=h.colHeaders===false?0:1;d<0&&(d=0);
g<0&&(g=0);f>0&&parseInt(c.css("border-top-width"))>0&&(d=d+1);h>0&&parseInt(c.css("border-left-width"))>0&&(g=g+1);a.browser.msie&&parseInt(a.browser.version,10)<=7&&(d=d-1);e.parent().addClass("htHidden").css({top:d,left:g});d=c.width();g=c.outerHeight()-4;parseInt(c.css("border-top-width"))>0&&(g=g-1);parseInt(c.css("border-left-width"))>0&&f>0&&(d=d-1);e.autoResize({maxHeight:200,minHeight:g,minWidth:d,maxWidth:Math.max(168,d),animate:false,extraSpace:0});e.parent().removeClass("htHidden");b.rootElement.triggerHandler("beginediting.handsontable");
setTimeout(function(){e.parent().css({overflow:"visible"})},1)}},finishEditing:function(b,c,d,e,f,g,h,i){if(!t.triggerOnlyByDestroyer){if(t.isCellEdited){t.isCellEdited=false;c=h?[[t.originalValue]]:[[a.trim(g.val())]];if(i){d=b.getSelected();b.populateFromArray({row:d[0],col:d[1]},c,{row:d[2],col:d[3]},false,"edit")}else b.populateFromArray({row:d,col:e},c,null,false,"edit")}g.off(".editor");b.view.wt.update("onCellDblClick",null);g.css({width:0,height:0});g.parent().addClass("htHidden").css({overflow:"hidden"});
b.rootElement.triggerHandler("finishediting.handsontable")}}};c.TextEditor=function(b,d,e,f,g,h,i){t.isCellEdited=false;t.originalValue=b.getDataAtCell(e,g);t.triggerOnlyByDestroyer=i.strict;h.parent().addClass("htHidden").css({top:0,left:0,overflow:"hidden"});h.css({width:0,height:0});h.on("refreshBorder.editor",function(){setTimeout(function(){t.isCellEdited&&t.refreshDimensions(b,e,f,h)},0)});h.on("keydown.editor",function(d){var i=(d.ctrlKey||d.metaKey)&&!d.altKey;if(c.helper.isPrintableChar(d.keyCode))if(!t.isCellEdited&&
!i){t.beginEditing(b,null,e,f,g,h);d.stopImmediatePropagation()}else i&&(t.isCellEdited&&d.keyCode===65?d.stopPropagation():t.isCellEdited&&d.keyCode===88&&a.browser.opera?d.stopPropagation():t.isCellEdited&&d.keyCode===86&&a.browser.opera&&d.stopPropagation());else if(t.isCellEdited&&(d.keyCode===17||d.keyCode===224||d.keyCode===91||d.keyCode===93))d.stopPropagation();else switch(d.keyCode){case 38:t.isCellEdited&&t.finishEditing(b,null,e,f,g,h,false);break;case 9:t.isCellEdited&&t.finishEditing(b,
null,e,f,g,h,false);d.preventDefault();break;case 39:t.isCellEdited&&(t.getCaretPosition(h)===h.val().length?t.finishEditing(b,null,e,f,g,h,false):d.stopPropagation());break;case 37:t.isCellEdited&&(t.getCaretPosition(h)===0?t.finishEditing(b,null,e,f,g,h,false):d.stopPropagation());break;case 8:case 46:t.isCellEdited&&d.stopPropagation();break;case 40:t.isCellEdited&&t.finishEditing(b,null,e,f,g,h,false);break;case 27:if(t.isCellEdited){b.destroyEditor(true);d.stopPropagation()}break;case 113:if(!t.isCellEdited){t.beginEditing(b,
null,e,f,g,h,true);d.stopPropagation();d.preventDefault()}break;case 13:if(t.isCellEdited){var j=b.getSelected(),j=!(j[0]===j[2]&&j[1]===j[3]);if(d.ctrlKey&&!j||d.altKey){h.val(h.val()+"\n");h[0].focus();d.stopPropagation()}else t.finishEditing(b,null,e,f,g,h,false,i)}else if(b.getSettings().enterBeginsEditing){i&&!selection.isMultiple()||d.altKey?t.beginEditing(b,null,e,f,g,h,true,"\n"):t.beginEditing(b,null,e,f,g,h,true);d.stopPropagation()}d.preventDefault();break;case 36:t.isCellEdited&&d.stopPropagation();
break;case 35:t.isCellEdited&&d.stopPropagation()}});b.view.wt.update("onCellDblClick",function(){h[0].focus();t.beginEditing(b,null,e,f,g,h,true)});return function(a){t.triggerOnlyByDestroyer=false;t.finishEditing(b,null,e,f,g,h,a)}};c.AutocompleteEditor=function(b,e,f,g,h,i,j){var k=i.data("typeahead"),l,m,p=false;if(k){k.$menu.off();i.off();k.listen()}else{i.typeahead();k=i.data("typeahead");k._show=k.show;k._hide=k.hide;k._render=k.render;k._highlighter=k.highlighter}k.minLength=0;k.highlighter=
k._highlighter;k.show=function(){return i.parent().hasClass("htHidden")?void 0:k._show.call(this)};k.hide=function(){if(!p){p=false;return k._hide.call(this)}};k.lookup=function(){var b;this.query=this.$element.val();return(b=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source)?this.process(b):this};k.matcher=function(){return true};k.select=function(){var a=this.$menu.find(".active").attr("data-value")||i.val();v(true);b.setDataAtCell(f,h,k.updater(a));return this.hide()};
k.render=function(a){k._render.call(this,a);j.strict||this.$menu.find("li:eq(0)").removeClass("active");return this};for(l in j)if(j.hasOwnProperty(l))if(l==="options")for(m in j.options)j.options.hasOwnProperty(m)&&(k.options[m]=j.options[m]);else k[l]=j[l];var q=false;i.on("keydown.editor",function(a){switch(a.keyCode){case 27:p=false;break;case 37:case 39:case 38:case 40:case 9:case 13:i.parent().hasClass("htHidden")||a.stopImmediatePropagation();a.preventDefault()}});i.on("keyup.editor",function(b){switch(b.keyCode){case 9:case 13:if(!q&&
!d(i)){var e=a.Event("keyup");e.keyCode=113;i.trigger(e)}else setTimeout(function(){var c=a.Event("keydown");c.keyCode=b.keyCode;i.parent().trigger(c)},10);break;default:!q&&!c.helper.isPrintableChar(b.keyCode)&&b.stopImmediatePropagation()}});var r=c.TextEditor(b,e,f,g,h,i,j);b.view.wt.update("onCellDblClick",function(){i[0].focus();t.beginEditing(b,null,f,g,h,i,true);p=true;setTimeout(function(){i.data("typeahead").lookup()},1)});var v=function(a){q=true;i.off();r(a);p=false;d(i)&&d(i).hide()};
return v};c.CheckboxEditor=function(a,b,d,f,g,h,i){typeof i==="undefined"&&(i={});if(typeof i.checkedTemplate==="undefined")i.checkedTemplate=true;if(typeof i.uncheckedTemplate==="undefined")i.uncheckedTemplate=false;h.on("keydown.editor",function(b){if((!b.ctrlKey&&!b.metaKey||b.altKey)&&c.helper.isPrintableChar(b.keyCode)){e(a,d,g,i);b.stopPropagation()}});a.view.wt.update("onCellDblClick",function(){e(a,d,g,i)});return function(){h.off(".editor");a.view.wt.update("onCellDblClick",null)}};c.AutocompleteCell=
{renderer:c.AutocompleteRenderer,editor:c.AutocompleteEditor};c.CheckboxCell={renderer:c.CheckboxRenderer,editor:c.CheckboxEditor};c.TextCell={renderer:c.TextRenderer,editor:c.TextEditor};c.PluginHooks={hooks:{beforeInit:[],afterInit:[],afterLoadData:[],beforeRender:[],afterRender:[],beforeGet:[],beforeSet:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],walkontableConfig:[]},push:function(a,b){this.hooks[a].push(b)},unshift:function(a,b){this.hooks[a].unshift(b)},run:function(a,b,
c,d,e,f,g){for(var h=0,i=this.hooks[b].length;h<i;h++)this.hooks[b][h].call(a,c,d,e,f,g)}};c.PluginModifiers={modifiers:{col:[]},push:function(a,b){this.modifiers[a].push(b)},unshift:function(a,b){this.modifiers[a].unshift(b)},run:function(a,b,c,d,e,f,g){for(var h=0,i=this.modifiers[b].length;h<i;h++)c=this.modifiers[b][h].call(a,c,d,e,f,g);return c}};var v=new function(){var b=this,d,e,f,g,h;this.beforeInit=function(){this.autoColumnWidths=[]};this.determineColumnWidth=function(b){if(!e){e=document.createElement("DIV");
e.style.position="absolute";e.style.top="0";e.style.left="0";e.style.display="none";g=a("<table><thead><tr><td></td></tr></thead></table>")[0];e.appendChild(g);e.appendChild(document.createElement("BR"));h=a("<table><tbody><tr><td></td></tr></tbody></table>")[0];e.appendChild(h);document.body.appendChild(e);f=a(e)}for(var i=d.countRows(),j={},k=0;k<i;k++){var l=c.helper.stringify(d.getDataAtCell(k,b)),m=l.length;j[m]||(j[m]={needed:5,strings:[]});if(j[m].needed){j[m].strings.push(l);j[m].needed--}}d.getSettings().colHeaders&&
d.getColHeader(b,h.firstChild.firstChild.firstChild);var b="",s;for(s in j)if(j.hasOwnProperty(s)){i=0;for(k=j[s].strings.length;i<k;i++)b=b+(j[s].strings[i]+"<br>")}g.firstChild.firstChild.firstChild.innerHTML=b;e.style.display="block";j=f.outerWidth();e.style.display="none";return j};this.determineColumnsWidth=function(){d=this;var a=this.getSettings();if(a.autoColumnSize||!a.colWidths)for(var a=this.countCols(),c=0;c<a;c++)this.autoColumnWidths[c]=b.determineColumnWidth(c)};this.getColWidth=function(a,
b){if(this.autoColumnWidths[a]&&this.autoColumnWidths[a]>b.width)b.width=this.autoColumnWidths[a]}};c.PluginHooks.push("beforeInit",v.beforeInit);c.PluginHooks.push("beforeRender",v.determineColumnsWidth);c.PluginHooks.push("afterGetColWidth",v.getColWidth);var w=new function(){var b=this,c;this.afterInit=function(){var c=this;if(this.getSettings().columnSorting){this.sortIndex=[];this.rootElement.on("click.handsontable",".columnSorting",function(d){d=a(d.target);if(d.is(".columnSorting")){d=d.closest("th").index();
c.getSettings().rowHeaders&&d--;if(c.sortColumn===d)c.sortOrder=!c.sortOrder;else{c.sortColumn=d;c.sortOrder=true}b.sort.call(c);c.render()}})}};this.sort=function(){c=false;for(var a=this,b=this.sortIndex.length=0,d=this.countRows();b<d;b++)this.sortIndex.push([b,a.getDataAtCell(b,this.sortColumn)]);this.sortIndex.sort(function(b,c){return b[1]===c[1]?0:b[1]===null?1:c[1]===null?-1:b[1]<c[1]?a.sortOrder?-1:1:b[1]>c[1]?a.sortOrder?1:-1:0});c=true};this.translateRow=function(a){if(c&&this.sortIndex&&
this.sortIndex.length)a.row=this.sortIndex[a.row][0]};this.getColHeader=function(b,c){this.getSettings().columnSorting&&a(c).find("span.colHeader").addClass("columnSorting")}};c.PluginHooks.push("afterInit",w.afterInit);c.PluginHooks.push("beforeGet",w.translateRow);c.PluginHooks.push("beforeSet",w.translateRow);c.PluginHooks.push("afterGetColHeader",w.getColHeader);c.PluginHooks.push("afterInit",function(){function b(a){return c.countRows()>=c.getSettings().maxRows&&(a==="row_above"||a==="row_below")?
true:c.countCols()>=c.getSettings().maxCols&&(a==="col_left"||a==="col_right")?true:false}var c=this,d={selector:"#"+c.rootElement.attr("id")+" table, #"+c.rootElement.attr("id")+" div",trigger:"right",callback:function(a){var b=c.getSelected();if(b)switch(a){case "row_above":c.alter("insert_row",b[0]);break;case "row_below":c.alter("insert_row",b[2]+1);break;case "col_left":c.alter("insert_col",b[1]);break;case "col_right":c.alter("insert_col",b[3]+1);break;case "remove_row":c.alter(a,b[0],b[2]);
break;case "remove_col":c.alter(a,b[1],b[3]);break;case "undo":c.undo();break;case "redo":c.redo()}}},e={row_above:{name:"Insert row above",disabled:b},row_below:{name:"Insert row below",disabled:b},hsep1:"---------",col_left:{name:"Insert column on the left",disabled:b},col_right:{name:"Insert column on the right",disabled:b},hsep2:"---------",remove_row:{name:"Remove row",disabled:b},remove_col:{name:"Remove column",disabled:b},hsep3:"---------",undo:{name:"Undo",disabled:function(){return!c.isUndoAvailable()}},
redo:{name:"Redo",disabled:function(){return!c.isRedoAvailable()}}},f={},g,h,i=c.getSettings();if(i.contextMenu){if(i.contextMenu===true)f.items=e;else if(Object.prototype.toString.apply(i.contextMenu)==="[object Array]"){f.items={};g=0;for(h=i.contextMenu.length;g<h;g++){var j=i.contextMenu[g];if(typeof e[j]==="undefined")throw Error('Context menu key "'+j+'" is not recognised');f.items[j]=e[j]}}else if(Object.prototype.toString.apply(i.contextMenu)==="[object Object]"){f=i.contextMenu;if(f.items)for(g in f.items)f.items.hasOwnProperty(g)&&
e[g]&&(f.items[g]=typeof f.items[g]==="string"?e[g]:a.extend(true,e[g],f.items[g]));else f.items=e;if(f.callback){var k=d.callback,l=f.callback;f.callback=function(a,b){k(a,b);l(a,b)}}}if(!c.rootElement.attr("id"))throw Error("Handsontable container must have an id");a.contextMenu(a.extend(true,d,f))}});c.PluginHooks.push("afterGetCellMeta",function(a,b,d){var e=this.getSettings(),f=this.getData(),g,h,i;if(e.autoComplete){g=0;for(h=e.autoComplete.length;g<h;g++)if(e.autoComplete[g].match(a,b,f)){if(typeof d.type===
"undefined")d.type=c.AutocompleteCell;else{if(typeof d.type.renderer==="undefined")d.type.renderer=c.AutocompleteCell.renderer;if(typeof d.type.editor==="undefined")d.type.editor=c.AutocompleteCell.editor}for(i in e.autoComplete[g])e.autoComplete[g].hasOwnProperty(i)&&i!=="match"&&typeof d[g]==="undefined"&&(d[i]=i==="source"?e.autoComplete[g][i](a,b):e.autoComplete[g][i]);break}}});w=new function(){var b,c,d,e,f,g,h=a('<div class="ghost"></div>');h.css({position:"absolute",top:"25px",left:0,width:"10px",
height:"10px",backgroundColor:"#CCC",opacity:0.7});a(document).mousemove(function(a){if(c){h[0].style.left=g+a.pageX-f+6+"px";if(h[0].style.display==="none")h[0].style.display="block"}});a(document).mouseup(function(){if(c){d<e&&e--;if(b.getSettings().rowHeaders){d--;e--}b.manualColumnPositions.splice(e,0,b.manualColumnPositions.splice(d,1)[0]);a(".manualColumnMover.active").removeClass("active");c=false;b.forceFullRender=true;b.view.render();h[0].style.display="none"}});this.beforeInit=function(){this.manualColumnPositions=
[]};this.afterInit=function(){if(this.getSettings().manualColumnMove){var i=this;this.rootElement.on("mousedown.handsontable",".manualColumnMover",function(e){b=i;var j=a(e.target),k=j.closest("th");d=k.index();c=true;f=e.pageX;e=i.rootElement.find(".htCore");h.appendTo(e.parent());h.width(j.parent().width());h.height(e.height());g=parseInt(k.offset().left-e.offset().left);h[0].style.left=g+6+"px"});this.rootElement.on("mouseenter.handsontable","td, th",function(){if(c){a(".manualColumnMover.active").removeClass("active");
var b=i.rootElement.find("thead th");e=a(this).index();var d=b.eq(e).find(".manualColumnMover").addClass("active");b.not(d).removeClass("active")}})}};this.modifyCol=function(a){if(this.getSettings().manualColumnMove){typeof this.manualColumnPositions[a]==="undefined"&&(this.manualColumnPositions[a]=a);return this.manualColumnPositions[a]}return a};this.getColHeader=function(a,b){if(this.getSettings().manualColumnMove){var c=document.createElement("DIV");c.className="manualColumnMover";b.firstChild.appendChild(c)}}};
c.PluginHooks.push("beforeInit",w.beforeInit);c.PluginHooks.push("afterInit",w.afterInit);c.PluginHooks.push("afterGetColHeader",w.getColHeader);c.PluginModifiers.push("col",w.modifyCol);w=new function(){var b,c,d,e,f,g,h,i,j=a('<div class="manualColumnResizerLine"><div class="manualColumnResizer"></div></div>');j.css({position:"absolute",top:0,left:0,width:0,borderRight:"1px dashed #777"});a(document).mousemove(function(a){if(b){d=h+(a.pageX-g);k(c,d);j[0].style.left=i+d-1+"px";if(j[0].style.display===
"none")j[0].style.display="block"}});a(document).mouseup(function(){if(b){a(".manualColumnResizer.active").removeClass("active");b=false;e.forceFullRender=true;e.view.render();j[0].style.display="none"}});a(document).dblclick(function(b){a(b.target).is(".manualColumnResizer")&&k(c,v.determineColumnWidth.call(e,c))});this.beforeInit=function(){this.manualColumnWidths=[]};this.afterInit=function(){if(this.getSettings().manualColumnResize){var k=this;this.rootElement.on("mousedown.handsontable",".manualColumnResizer",
function(l){e=k;var m=a(l.target);c=m.attr("rel");f=k.rootElement.find("col").eq(m.parent().parent().index());b=true;g=l.pageX;d=h=f.width();m.addClass("active");l=k.rootElement.find(".htCore");j.appendTo(l.parent()).height(l.height());i=parseInt(m.parent().parent().offset().left-l.offset().left);j[0].style.left=i+d-1+"px"})}};var k=function(a,b){b=Math.max(b,20);b=Math.min(b,500);e.manualColumnWidths[a]=b};this.getColHeader=function(b,c){if(this.getSettings().manualColumnResize){var d=document.createElement("DIV");
d.className="manualColumnResizer";a(d).attr("rel",b);c.firstChild.appendChild(d)}};this.getColWidth=function(a,b){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[a])b.width=this.manualColumnWidths[a]}};c.PluginHooks.push("beforeInit",w.beforeInit);c.PluginHooks.push("afterInit",w.afterInit);c.PluginHooks.push("afterGetColHeader",w.getColHeader);c.PluginHooks.push("afterGetColWidth",w.getColWidth);(function(a){function b(d){this.filter(b.resizableFilterSelector).each(function(){new c(a(this),
d)});return this}function c(d,e){if(!this.clones){this.config=a.extend({},b.defaults,e);this.el=d;this.nodeName=d[0].nodeName.toLowerCase();this.previousScrollTop=null;if(e.maxWidth==="original")e.maxWidth=d.width();if(e.minWidth==="original")e.minWidth=d.width();if(e.maxHeight==="original")e.maxHeight=d.height();if(e.minHeight==="original")e.minHeight=d.height();this.nodeName==="textarea"&&d.css({resize:"none",overflowY:"hidden"});d.data("AutoResizer",this);this.createClone();this.injectClone();
this.bind()}}b.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};b.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];b.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",border:"1px solid black",padding:"0.49em"};
b.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";b.AutoResizer=c;a.fn.autoResize=b;c.prototype={bind:function(){var b=a.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",b).bind("change.autoResize",b);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var c=this.el,d=this,e=this.config;this.clones=a();if(e.minHeight!=="original"||e.maxHeight!=="original"){this.hClone=
c.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(e.minWidth!=="original"||e.maxWidth!=="original"){this.wClone=a("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});this.clones=this.clones.add(this.wClone)}a.each(b.cloneCSSProperties,function(a,b){d.clones.css(b,c.css(b))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(b.cloneCSSValues)},check:function(a,b){var c=this.config,d=this.wClone,e=this.hClone,f=this.el,g=f.val();if(d){d.text(g);
var h=d.outerWidth(),h=h+c.extraSpace>=c.minWidth?h+c.extraSpace:c.minWidth,d=f.width(),h=Math.min(h,c.maxWidth);if(h<d&&h>=c.minWidth||h>=c.minWidth&&h<=c.maxWidth){c.onResize.call(f);f.scrollLeft(0);c.animate&&!b?f.stop(1,1).animate({width:h},c.animate):f.width(h)}}if(e){h&&e.width(h);e.height(0).val(g).scrollTop(1E4);e=e[0].scrollTop+c.extraSpace;if(this.previousScrollTop!==e){this.previousScrollTop=e;if(e>=c.maxHeight)f.css("overflowY","");else{f.css("overflowY","hidden");if(e<c.minHeight)e=c.minHeight;
c.onResize.call(f);c.animate&&!b?f.stop(1,1).animate({height:e},c.animate):f.height(e)}}}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(b.cloneContainer||(b.cloneContainer=a("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(a){a.SheetClip={parse:function(a){var b,c,d=[],e=0,f,g,h,i;c=a.split("\n");c.length>1&&c[c.length-1]===
""&&c.pop();a=0;for(b=c.length;a<b;a=a+1){c[a]=c[a].split("\t");f=0;for(g=c[a].length;f<g;f=f+1){d[e]||(d[e]=[]);if(h&&f===0){i=d[e].length-1;d[e][i]=d[e][i]+"\n"+c[a][0];if(h&&(c[a][0].split('"').length-1)%2===1){h=false;d[e][i]=d[e][i].substring(0,d[e][i].length-1).replace(/""/g,'"')}}else if(f===g-1&&c[a][f].indexOf('"')===0){d[e].push(c[a][f].substring(1).replace(/""/g,'"'));h=true}else{d[e].push(c[a][f].replace(/""/g,'"'));h=false}}h||(e=e+1)}return d},stringify:function(a){var b,c,d,e,f="",
g;b=0;for(c=a.length;b<c;b=b+1){d=0;for(e=a[b].length;d<e;d=d+1){d>0&&(f=f+"\t");g=a[b][d];f=typeof g==="string"?g.indexOf("\n")>-1?f+('"'+g.replace(/"/g,'""')+'"'):f+g:g===null||g===void 0?f+"":f+g}f=f+"\n"}return f}}})(b);f.prototype.appear=function(b){var c,d,e,f,g,h;if(!this.disabled){d=this.instance.getSetting("offsetRow");g=this.instance.getSetting("offsetColumn");var i=this.instance.getSetting("displayRows"),j=this.instance.getSetting("displayColumns"),k=false,l=false,m=false,p=false;if(i!==
null)if(b[0]>d+i-1||b[2]<d)k=l=m=p=true;else{if(b[0]<d){b[0]=d;k=true}if(b[2]>d+i-1){b[2]=d+i-1;m=true}}if(j!==null)if(b[1]>g+j-1||b[3]<g)k=l=m=p=true;else{if(b[1]<g){b[1]=g;l=true}if(b[3]>g+j-1){b[3]=g+j-1;p=true}}if(k+l+m+p<4){c=b[0]!==b[2]||b[1]!==b[3];d=a(this.instance.wtTable.getCell([b[0],b[1]]));e=c?a(this.instance.wtTable.getCell([b[2],b[3]])):d;f=this.wtDom.offset(d[0]);g=c?this.wtDom.offset(e[0]):f;b=this.wtDom.offset(this.instance.wtTable.TABLE);h=f.top;c=g.top+e.outerHeight()-h;f=f.left;
e=g.left+e.outerWidth()-f;h=h-b.top-1;f=f-b.left-1;if(parseInt(d.css("border-top-width"))>0){h=h+1;c=c-1}if(parseInt(d.css("border-left-width"))>0){f=f+1;e=e-1}}if(k)this.top.style.display="none";else{this.top.style.top=h+"px";this.top.style.left=f+"px";this.top.style.width=e+"px";this.top.style.display="block"}if(l)this.left.style.display="none";else{this.left.style.top=h+"px";this.left.style.left=f+"px";this.left.style.height=c+"px";this.left.style.display="block"}k=Math.floor(this.settings.border.width/
2);if(m)this.bottom.style.display="none";else{this.bottom.style.top=h+c-k+"px";this.bottom.style.left=f+"px";this.bottom.style.width=e+"px";this.bottom.style.display="block"}if(p)this.right.style.display="none";else{this.right.style.top=h+"px";this.right.style.left=f+e-k+"px";this.right.style.height=c+1+"px";this.right.style.display="block"}if(m&&p||!this.hasSetting(this.settings.border.cornerVisible))this.corner.style.display="none";else{this.corner.style.top=h+c-4+"px";this.corner.style.left=f+
e-4+"px";this.corner.style.display="block"}}};f.prototype.disappear=function(){this.top.style.display="none";this.left.style.display="none";this.bottom.style.display="none";this.right.style.display="none";this.corner.style.display="none"};f.prototype.hasSetting=function(a){return typeof a==="function"?a():!!a};g.prototype.draw=function(a){if(this.hasSetting("async")){var b=this;b.drawFrame=setTimeout(function(){b._doDraw(a)},0)}else this._doDraw(a);return this};g.prototype._doDraw=function(a){a=a&&
this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(a)};g.prototype.update=function(a,b){return this.wtSettings.update(a,b)};g.prototype.scrollVertical=function(a){return this.wtScroll.scrollVertical(a)};g.prototype.scrollHorizontal=function(a){return this.wtScroll.scrollHorizontal(a)};g.prototype.scrollViewport=function(a){if(this.hasSetting("async")){var b=
this;clearTimeout(b.scrollFrame);b.scrollFrame=setTimeout(function(){b.wtScroll.scrollViewport(a)},0)}else this.wtScroll.scrollViewport(a);return this};g.prototype.getViewport=function(){return[this.getSetting("offsetRow"),this.getSetting("offsetColumn"),this.wtTable.visibilityEdgeRow!==null?this.wtTable.visibilityEdgeRow:this.getSetting("totalRows")-1,this.wtTable.visibilityEdgeColumn!==null?this.wtTable.visibilityEdgeColumn:this.getSetting("totalColumns")-1]};g.prototype.getSetting=function(a,b,
c,d){return this.wtSettings.getSetting(a,b,c,d)};g.prototype.hasSetting=function(a){return this.wtSettings.has(a)};h.prototype.closest=function(a,b){for(;a!=null;){if(a.nodeType===1&&b.indexOf(a.nodeName)>-1)return a;a=a.parentNode}return null};h.prototype.prevSiblings=function(a){for(var b=[];(a=a.previousSibling)!=null;)a.nodeType===1&&b.push(a);return b};h.prototype.hasClass=function(a,b){return a.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))};h.prototype.addClass=function(a,b){if(!this.hasClass(a,
b))a.className=a.className+(" "+b)};h.prototype.removeClass=function(a,b){if(this.hasClass(a,b))a.className=a.className.replace(RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")};h.prototype.removeTextNodes=function(a,b){if(a.nodeType===3)b.removeChild(a);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName)>-1)for(var c=a.childNodes,d=c.length-1;d>=0;d--)this.removeTextNodes(c[d],a)};h.prototype.offset=function(a){for(var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;){b=
b+a.offsetLeft;c=c+a.offsetTop}return{left:b,top:c}};i.prototype.parentCell=function(a){var b={};b.TD=this.wtDom.closest(a,["TD","TH"]);if(b.TD)b.coords=this.instance.wtTable.getCoords(b.TD);else if(!b.TD&&this.wtDom.hasClass(a,"wtBorder")&&this.wtDom.hasClass(a,"current")&&!this.wtDom.hasClass(a,"corner")){b.coords=this.instance.selections.current.selected[0];b.TD=this.instance.wtTable.getCell(b.coords)}return b};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,b){var c=this.length>>>
0,d=Number(b)||0,d=d<0?Math.ceil(d):Math.floor(d);for(d<0&&(d=d+c);d<c;d++)if(d in this&&this[d]===a)return d;return-1};b.requestAnimFrame=function(){return b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a){return b.setTimeout(a,1E3/60)}}();b.cancelRequestAnimFrame=b.cancelAnimationFrame||b.webkitCancelRequestAnimationFrame||b.mozCancelRequestAnimationFrame||b.oCancelRequestAnimationFrame||b.msCancelRequestAnimationFrame||
clearTimeout;j.prototype.refreshScrollbars=function(){this.wtScrollbarH.prepare();this.wtScrollbarV.prepare();this.instance.wtTable.recalcViewportCells();this.wtScrollbarH.refresh();this.wtScrollbarV.refresh()};j.prototype.scrollVertical=function(a){if(!this.instance.drawn)throw Error("scrollVertical can only be called after table was drawn to DOM");var b=this.instance.getSetting("offsetRow"),a=b+a;if(a>0){var c=this.instance.getSetting("totalRows"),d=(this.instance.getSetting("height")||Infinity)-
this.instance.getSetting("scrollbarHeight");a>=c&&(a=c-1);var e=this.instance.wtTable.TBODY.firstChild.firstChild;if(e.nodeName==="TH")e=e.nextSibling;for(var f=this.instance.wtTable.tableOffset,e=this.instance.wtDom.offset(e).top-f.top,f=a;e<d&&f<c;){e=e+this.instance.getSetting("rowHeight",f);f++}if(e<d)for(;a>0;){e=e+this.instance.getSetting("rowHeight",a-1);if(e<d)a--;else break}}else a<0&&(a=0);a!==b&&this.instance.update("offsetRow",a);return this.instance};j.prototype.scrollHorizontal=function(a){if(!this.instance.drawn)throw Error("scrollHorizontal can only be called after table was drawn to DOM");
var b=this.instance.getSetting("offsetColumn"),a=b+a;if(a>0){var c=this.instance.getSetting("totalColumns"),d=this.instance.getSetting("width");a>=c&&(a=c-1);var e=this.instance.wtTable.TBODY.firstChild.firstChild;if(e.nodeName==="TH")e=e.nextSibling;for(var f=this.instance.wtTable.tableOffset,e=this.instance.wtDom.offset(e).left-f.left,f=a;e<d&&f<c;){e=e+this.instance.getSetting("columnWidth",f);f++}if(e<d)for(;a>0;){e=e+this.instance.getSetting("columnWidth",a-1);if(e<d)a--;else break}}else a<0&&
(a=0);a!==b&&this.instance.update("offsetColumn",a);return this.instance};j.prototype.scrollViewport=function(a){var b=this.instance.getSetting("offsetRow"),c=this.instance.getSetting("offsetColumn"),d=this.instance.getSetting("viewportRows"),e=this.instance.getSetting("viewportColumns"),f=this.instance.getSetting("totalRows"),g=this.instance.getSetting("totalColumns");if(a[0]<0||a[0]>f-1)throw Error("row "+a[0]+" does not exist");if(a[1]<0||a[1]>g-1)throw Error("column "+a[1]+" does not exist");
d=d||1;e=e||1;d<f&&(a[0]>b+d-1?this.scrollVertical(a[0]-(b+d-1)):a[0]<b?this.scrollVertical(a[0]-b):this.scrollVertical(0));e>0&&e<g&&(a[1]>c+e-1?this.scrollHorizontal(a[1]-(c+e-1)):a[1]<c?this.scrollHorizontal(a[1]-c):this.scrollHorizontal(0));return this.instance};k.prototype.onScroll=function(a){if(this.instance.drawn){var b=this.type==="vertical"?["offsetRow","totalRows","viewportRows","top","height"]:["offsetColumn","totalColumns","viewportColumns","left","width"],c=this.instance.getSetting(b[1]),
d=this.instance.getSetting(b[2]);if(c>d){c=Math.round(parseInt(this.handle.style[b[3]])*c/parseInt(this.slider.style[b[4]]));a===1?this.type==="vertical"?this.instance.scrollVertical(Infinity).draw():this.instance.scrollHorizontal(Infinity).draw():c!==this.instance.getSetting(b[0])?this.type==="vertical"?this.instance.scrollVertical(c-this.instance.getSetting(b[0])).draw():this.instance.scrollHorizontal(c-this.instance.getSetting(b[0])).draw():this.refresh()}}};k.prototype.getHandleSizeRatio=function(a,
b){if(!b)return 1;a>b&&(a=b);return a/b};k.prototype.prepare=function(){if(!this.skipRefresh){var a,b;if(this.type==="vertical"){a=this.getHandleSizeRatio(this.instance.getSetting("viewportRows"),this.instance.getSetting("totalRows"));b=this.instance.getSetting("scrollV")}else{a=this.getHandleSizeRatio(this.instance.getSetting("viewportColumns"),this.instance.getSetting("totalColumns"));b=this.instance.getSetting("scrollH")}this.visible=(a===1||isNaN(a))&&b==="auto"||b==="none"?false:true}};k.prototype.refresh=
function(){if(!this.skipRefresh)if(this.visible){var a,b,c,d,e;b=this.$table.outerWidth();d=this.$table.outerHeight();var f=this.instance.hasSetting("width")?this.instance.getSetting("width"):b;c=this.instance.hasSetting("height")?this.instance.getSetting("height"):d;if(f&&c){this.instance.hasSetting("width")&&this.instance.wtScroll.wtScrollbarV.visible&&(f=f-this.instance.getSetting("scrollbarWidth"));f>b+this.instance.getSetting("scrollbarWidth")&&(f=b);this.instance.hasSetting("height")&&this.instance.wtScroll.wtScrollbarH.visible&&
(c=c-this.instance.getSetting("scrollbarHeight"));c>d+this.instance.getSetting("scrollbarHeight")&&(c=d);if(this.type==="vertical"){d=this.instance.getSetting("offsetRow");e=this.instance.getSetting("totalRows");a=this.getHandleSizeRatio(this.instance.getSetting("viewportRows"),e);b=c-2;this.slider.style.top=this.$table.position().top+"px";this.slider.style.left=f-1+"px";this.slider.style.height=b+"px"}else{d=this.instance.getSetting("offsetColumn");e=this.instance.getSetting("totalColumns");a=this.getHandleSizeRatio(this.instance.getSetting("viewportColumns"),
e);b=f-2;this.slider.style.left=this.$table.position().left+"px";this.slider.style.top=c-1+"px";this.slider.style.width=b+"px"}c=Math.round(b*a);c<10&&(c=15);b=Math.round(b*(d/e));b>f-c&&(b=f-c);if(this.type==="vertical"){this.handle.style.height=c+"px";this.handle.style.top=b+"px"}else{this.handle.style.width=c+"px";this.handle.style.left=b+"px"}this.slider.style.display="block";this.dragdealer.setWrapperOffset();this.dragdealer.setBounds()}}else this.slider.style.display="none"};l.prototype.add=
function(a){this.selected.push(a)};l.prototype.remove=function(a){a=this.isSelected(a);a>-1&&this.selected.splice(a,1)};l.prototype.clear=function(){this.selected.length=0};l.prototype.isSelected=function(a){for(var b=0,c=this.selected.length;b<c;b++)if(this.selected[b][0]===a[0]&&this.selected[b][1]===a[1])return b;return-1};l.prototype.getSelected=function(){return this.selected};l.prototype.getCorners=function(){var a,b,c,d,e,f=this.selected.length;if(f>0){a=c=this.selected[0][0];b=d=this.selected[0][1];
if(f>1)for(e=1;e<f;e++){this.selected[e][0]<a?a=this.selected[e][0]:this.selected[e][0]>c&&(c=this.selected[e][0]);this.selected[e][1]<b?b=this.selected[e][1]:this.selected[e][1]>d&&(d=this.selected[e][1])}}return[a,b,c,d]};l.prototype.draw=function(a){var b,c,d,e,f;if(d=this.selected.length){d=this.getCorners();b=this.instance.getSetting("offsetRow");a=b+this.instance.getSetting("displayRows")-1;c=this.instance.getSetting("offsetColumn");var g=c+this.instance.getSetting("displayColumns")-1,h=this.instance.getSetting("currentRowClassName"),
i=this.instance.getSetting("currentColumnClassName");for(e=b;e<=a;e++)for(f=c;f<=g;f++){b=this.instance.wtTable.getCell([e,f]);if(e>=d[0]&&e<=d[2]&&f>=d[1]&&f<=d[3]){h&&this.instance.wtDom.removeClass(b,h);i&&this.instance.wtDom.removeClass(b,i);this.onAdd([e,f],b)}else{if(e>=d[0]&&e<=d[2]){i&&this.instance.wtDom.removeClass(b,i);h&&this.instance.wtDom.addClass(b,h)}else if(f>=d[1]&&f<=d[3]){h&&this.instance.wtDom.removeClass(b,h);i&&this.instance.wtDom.addClass(b,i)}else{h&&this.instance.wtDom.removeClass(b,
h);i&&this.instance.wtDom.removeClass(b,i)}this.instance.wtDom.removeClass(b,this.settings.className)}}this.border&&this.border.appear(d)}else{if(a&&this.settings.className){a=this.instance.wtTable.TABLE.getElementsByTagName("TD");c=0;for(d=a.length;c<d;c++)this.instance.wtDom.removeClass(a[c],this.settings.className)}this.border&&this.border.disappear()}};p.prototype.update=function(a,b){if(b===void 0)for(var c in a)a.hasOwnProperty(c)&&(this.settings[c]=a[c]);else this.settings[a]=b;return this.instance};
p.prototype.getSetting=function(a,b,c,d){return this[a]?this[a](b,c,d):this._getSetting(a,b,c,d)};p.prototype._getSetting=function(a,b,c,d){return typeof this.settings[a]==="function"?this.settings[a](b,c,d):b!==void 0&&Object.prototype.toString.call(this.settings[a])==="[object Array]"&&b!==void 0?this.settings[a][b]:this.settings[a]};p.prototype.has=function(a){return!!this.settings[a]};p.prototype.rowHeight=function(a){return typeof this.rowHeightCache[a]!=="undefined"?this.rowHeightCache[a]:20};
p.prototype.columnWidth=function(a){return Math.min(200,this._getSetting("columnWidth",a))};p.prototype.displayRows=function(){var a,b;if(this.settings.height){a=Math.ceil(this.settings.height/20);b=this.getSetting("totalRows")-this.getSetting("offsetRow");if(b<0){this.update("offsetRow",Math.max(0,this.getSetting("totalRows")-a));return a}return Math.min(a,b)}return this.getSetting("totalRows")};p.prototype.displayColumns=function(){var a,b;if(this.settings.width){a=Math.ceil(this.settings.width/
50);b=this.getSetting("totalColumns")-this.getSetting("offsetColumn");if(b<0){this.update("offsetColumn",Math.max(0,this.getSetting("totalColumns")-a));return a}return Math.min(a,b)}return this.getSetting("totalColumns")};p.prototype.viewportRows=function(){return this.instance.wtTable.visibilityEdgeRow!==null?this.instance.wtTable.visibilityEdgeRow-this.instance.wtTable.visibilityStartRow:this.getSetting("displayRows")};p.prototype.viewportColumns=function(){return this.instance.wtTable.visibilityEdgeColumn!==
null?this.instance.wtTable.visibilityEdgeColumn-this.instance.wtTable.visibilityStartColumn:this.getSetting("displayColumns")};m.prototype.refreshHiderDimensions=function(){var a=this.instance.getSetting("height"),b=this.instance.getSetting("width");if(a||b)this.hider.style.overflow="hidden";if(a)this.hider.style.height=this.instance.wtScroll.wtScrollbarH.visible?a-this.instance.getSetting("scrollbarHeight")+"px":a+"px";if(b)this.hider.style.width=this.instance.wtScroll.wtScrollbarV.visible?b-this.instance.getSetting("scrollbarWidth")+
"px":b+"px"};m.prototype.refreshStretching=function(){var a=this.instance.getSetting("stretchH"),b=this.instance.getSetting("totalColumns"),c=this.instance.getSetting("displayColumns"),b=Math.min(c,b),d=this.instance.getSetting("offsetColumn"),c=(c=this.instance.getSetting("frozenColumns"))?c.length:0;if(this.instance.hasSetting("columnWidth")){a==="hybrid"&&(a=this.instance.wtScroll.wtScrollbarH.visible?"last":"none");var e;if(this.instance.wtTable.TBODY.firstChild&&this.instance.wtTable.TBODY.firstChild.firstChild)e=
this.instance.wtTable.TBODY.firstChild.firstChild;else if(this.instance.wtTable.THEAD.firstChild&&this.instance.wtTable.THEAD.firstChild.firstChild)e=this.instance.wtTable.THEAD.firstChild.firstChild;if(c)e=e.nextSibling;if(e){var f=this.instance.wtTable.tableOffset,g=this.instance.wtDom.offset(e).left-f.left;e=[];var f=0,h;for(h=0;h<b;h++){e.push(this.instance.getSetting("columnWidth",d+h));f=f+e[h]}d=f+g;if(a==="all"||a==="last"){h=this.instance.getSetting("width");this.instance.wtScroll.wtScrollbarV.visible&&
(h=h-this.instance.getSetting("scrollbarWidth"));d=h-d;if(d>0)if(a==="all"){var i,a=d,f=d/f;for(h=0;h<b;h++){if(e[h])if(h===b-1)i=e[h]+a;else{i=e[h]+Math.floor(f*e[h]);a=a-Math.floor(f*e[h])}e[h]=i}}else e[e.length-1]&&(e[e.length-1]=e[e.length-1]+d)}for(h=0;h<b;h++)this.COLGROUP.childNodes[h+c].style.width=e[h]?e[h]+"px":""}}};m.prototype.adjustAvailableNodes=function(){for(var a=this.instance.getSetting("totalRows"),b=this.instance.getSetting("totalColumns"),c=this.instance.getSetting("displayRows"),
d=this.instance.getSetting("displayColumns"),e=this.instance.getSetting("frozenColumns"),e=e?e.length:0,c=Math.min(c,a),a=Math.min(d,b);this.colgroupChildrenLength<a+e;){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}for(;this.colgroupChildrenLength>a+e;){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}if(this.instance.hasSetting("columnHeaders")){for(;this.theadChildrenLength<a+e;){this.THEAD.firstChild.appendChild(document.createElement("TH"));
this.theadChildrenLength++}for(;this.theadChildrenLength>a+e;){this.THEAD.firstChild.removeChild(this.THEAD.firstChild.lastChild);this.theadChildrenLength--}}for(;this.tbodyChildrenLength<c;){b=document.createElement("TR");for(d=0;d<e;d++)b.appendChild(document.createElement("TH"));for(d=0;d<a;d++)b.appendChild(document.createElement("TD"));this.TBODY.appendChild(b);this.tbodyChildrenLength++}for(;this.tbodyChildrenLength>c;){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}for(var c=
this.TBODY.childNodes,d=0,f=c.length;d<f;d++){for(b=c[d].childNodes.length;b<a+e;){c[d].appendChild(document.createElement("TD"));b++}for(;b>a+e;){c[d].removeChild(c[d].lastChild);b--}}};m.prototype.draw=function(a){if(!a){this.tableOffset=this.wtDom.offset(this.TABLE);this.adjustAvailableNodes();this._doDraw()}if(this.instance.hasSetting("async")){var c=this;b.cancelRequestAnimFrame(this.selectionsFrame);c.selectionsFrame=b.requestAnimFrame(function(){c.refreshPositions(a)})}else this.refreshPositions(a);
this.instance.drawn=true;return this};m.prototype._doDraw=function(){var a,b,c=this.instance.getSetting("offsetRow"),d=this.instance.getSetting("offsetColumn");a=this.instance.getSetting("totalRows");b=this.instance.getSetting("totalColumns");var e=this.instance.getSetting("displayRows"),f=this.instance.getSetting("displayColumns"),g=this.instance.getSetting("frozenColumns"),h=g?g.length:0,i,j,k,e=Math.min(e,a),f=Math.min(f,b);for(b=0;b<this.colgroupChildrenLength;b++)if(b<h){this.wtDom.addClass(this.COLGROUP.childNodes[b],
"rowHeader");if(typeof g[b]==="function")g[b](null,this.COLGROUP.childNodes[b])}else this.wtDom.removeClass(this.COLGROUP.childNodes[b],"rowHeader");this.refreshStretching();if(h&&this.instance.hasSetting("columnHeaders"))for(b=0;b<h;b++){j=this.THEAD.childNodes[0].childNodes[b];if(typeof g[b]==="function")g[b](null,j);else j.innerHTML="";if(this.hasEmptyCellProblem&&j.innerHTML==="")j.innerHTML="&nbsp;"}if(this.instance.hasSetting("columnHeaders"))for(b=0;b<f;b++)this.instance.getSetting("columnHeaders",
d+b,this.THEAD.childNodes[0].childNodes[h+b]);this.visibilityEdgeRow=this.visibilityEdgeColumn=null;this.visibilityStartRow=c;this.visibilityStartColumn=d;for(a=0;a<e;a++){i=this.TBODY.childNodes[a];for(b=0;b<h;b++){j=i.childNodes[b];k=typeof g[b]==="function"?g[b](c+a,j):g[b];if(k!==void 0)j.innerHTML=k}var l=k=null;for(b=0;b<f;b++)if(this.visibilityEdgeColumn!==null&&d+b>this.visibilityEdgeColumn)break;else{j=i.childNodes[b+h];j.className="";this.instance.getSetting("cellRenderer",c+a,d+b,j);if(this.hasEmptyCellProblem&&
j.innerHTML==="")j.innerHTML="&nbsp;";j=this.isCellVisible(c+a,d+b,j);if(this.visibilityEdgeColumn===null&&j&z)l=d+b;else if(this.visibilityEdgeColumn===null&&j&A)this.visibilityEdgeColumn=d+b;if(this.visibilityEdgeRow===null&&j&x)k=c+a;else if(this.visibilityEdgeRow===null&&j&F)this.visibilityEdgeRow=c+a}}if(this.visibilityEdgeRow===null)this.visibilityEdgeRow=k+1;if(this.visibilityEdgeColumn===null)this.visibilityEdgeColumn=l+1};m.prototype.refreshPositions=function(a){this.instance.wtScroll.refreshScrollbars();
this.refreshHiderDimensions();this.refreshStretching();this.refreshSelections(a)};m.prototype.refreshSelections=function(a){var b;if(this.instance.selections)for(b in this.instance.selections)this.instance.selections.hasOwnProperty(b)&&this.instance.selections[b].draw(a)};m.prototype.recalcViewportCells=function(){if(this.instance.wtScroll.wtScrollbarV.visible&&this.visibilityEdgeColumnRemainder<=this.instance.getSetting("scrollbarWidth")){this.visibilityEdgeColumn--;this.visibilityEdgeColumnRemainder=
Infinity}if(this.instance.wtScroll.wtScrollbarH.visible&&this.visibilityEdgeRowRemainder<=this.instance.getSetting("scrollbarHeight")){this.visibilityEdgeRow--;this.visibilityEdgeRowRemainder=Infinity}};var z=1,x=2,A=4,F=8;m.prototype.isCellVisible=function(b,c,d){c=0;this.instance.getSetting("scrollV");this.instance.getSetting("scrollH");var e=this.wtDom.offset(d),f=this.tableOffset,g=e.top-f.top,e=e.left-f.left,f=a(d),d=f.outerWidth(),f=f.outerHeight(),h=this.instance.hasSetting("width")?this.instance.getSetting("width"):
Infinity,i=this.instance.hasSetting("height")?this.instance.getSetting("height"):Infinity;this.instance.wtSettings.rowHeightCache[b]=f;if(g>i)c=c|50;else if(g+f>i){this.visibilityEdgeRowRemainder=i-g;c=c|F}else c=c|x;if(e>h)c=c|22;else if(e+d>h){this.visibilityEdgeColumnRemainder=h-e;c=c|A}else c=c|z;return c};m.prototype.getCell=function(a){var b=this.instance.getSetting("offsetRow");if(a[0]<b)return-1;if(a[0]>b+this.instance.getSetting("displayRows")-1)return-2;var c=this.instance.getSetting("offsetColumn");
if(a[1]<c)return-3;if(a[1]>c+this.instance.getSetting("displayColumns")-1)return-4;var d=this.instance.getSetting("frozenColumns");return this.TBODY.childNodes[a[0]-b].childNodes[a[1]-c+(d?d.length:0)]};m.prototype.getCoords=function(a){var b=this.instance.getSetting("frozenColumns"),b=b?b.length:0;return[this.wtDom.prevSiblings(a.parentNode).length+this.instance.getSetting("offsetRow"),a.cellIndex+this.instance.getSetting("offsetColumn")-b]};var C={x:0,y:0,init:function(){this.setEvent("mouse");
this.setEvent("touch")},setEvent:function(a){var b=document["on"+a+"move"]||function(){};document["on"+a+"move"]=function(a){b(a);C.refresh(a)}},refresh:function(a){if(!a)a=b.event;a.type=="mousemove"?this.set(a):a.touches&&this.set(a.touches[0])},set:function(a){if(a.pageX||a.pageY){this.x=a.pageX;this.y=a.pageY}else if(a.clientX||a.clientY){this.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop}}};
C.init();var D={get:function(a){var b=0,c=0;if(a.offsetParent){do{c=c+a.offsetLeft;b=b+a.offsetTop}while(a=a.offsetParent)}return[c,b]}},y=function(a,b){typeof a=="string"&&(a=document.getElementById(a));if(a){var c=a.getElementsByTagName("div")[0];if(c&&c.className.search(/(^|\s)handle(\s|$)/)!=-1){this.init(a,c,b||{});this.setup()}}};y.prototype={init:function(a,b,c){this.wrapper=a;this.handle=b;this.options=c;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",
true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=c.callback||null;this.animationCallback=c.animationCallback||null;this.bounds={left:c.left||0,right:-(c.right||0),top:c.top||0,bottom:-(c.bottom||
0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[c.x||0,c.y||0],target:[c.x||0,c.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.tapping=this.dragging=this.activity=false},getOption:function(a,b){return this.options[a]!==void 0?this.options[a]:b},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=
D.get(this.wrapper)},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=D.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=D.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth;
this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var a=0;a<=this.steps-1;a++)this.stepRatios[a]=a/(this.steps-1)}},addListeners:function(){var a=
this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(b){a.handleDownHandler(b)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(b){a.wrapperDownHandler(b)};var c=document.onmouseup||function(){};document.onmouseup=function(b){c(b);a.documentUpHandler(b)};var d=document.ontouchend||function(){};document.ontouchend=function(b){d(b);a.documentUpHandler(b)};var e=b.onresize||function(){};b.onresize=function(b){e(b);a.documentResizeHandler(b)};
this.wrapper.onmousemove=function(){a.activity=true};this.wrapper.onclick=function(){return!a.activity};this.interval=setInterval(function(){a.animate()},25);a.animate(false,true)},handleDownHandler:function(a){this.activity=false;C.refresh(a);this.preventDefaults(a,true);this.startDrag();this.cancelEvent(a)},wrapperDownHandler:function(a){C.refresh(a);this.preventDefaults(a,true);this.startTap()},documentUpHandler:function(){this.stopDrag();this.stopTap()},documentResizeHandler:function(){this.setWrapperOffset();
this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className=this.handle.className+" disabled"},setStep:function(a,b,c){this.setValue(this.steps&&a>1?(a-1)/(this.steps-1):0,this.steps&&b>1?(b-1)/(this.steps-1):0,c)},setValue:function(a,b,c){this.setTargetValue([a,b||0]);c&&this.groupCopy(this.value.current,this.value.target)},startTap:function(a){if(!this.disabled){this.tapping=
true;a===void 0&&(a=[C.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,C.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]);this.setTargetOffset(a)}},stopTap:function(){if(!this.disabled&&this.tapping){this.tapping=false;this.setTargetValue(this.value.current);this.result()}},startDrag:function(){if(!this.disabled){this.offset.mouse=[C.x-D.get(this.handle)[0],C.y-D.get(this.handle)[1]];this.dragging=true}},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=false;var a=this.groupClone(this.value.current);
if(this.slide){var b=this.change;a[0]=a[0]+b[0]*4;a[1]=a[1]+b[1]*4}this.setTargetValue(a);this.result()}},feedback:function(){var a=this.value.current;this.snap&&this.steps>1&&(a=this.getClosestSteps(a));if(!this.groupCompare(a,this.value.prev)){typeof this.animationCallback=="function"&&this.animationCallback(a[0],a[1]);this.groupCopy(this.value.prev,a)}},result:function(){typeof this.callback=="function"&&this.callback(this.value.target[0],this.value.target[1])},animate:function(a,b){if(!a||this.dragging){if(this.dragging){var c=
this.groupClone(this.value.target);this.setTargetOffset([C.x-this.offset.wrapper[0]-this.offset.mouse[0],C.y-this.offset.wrapper[1]-this.offset.mouse[1]],this.loose);this.change=[this.value.target[0]-c[0],this.value.target[1]-c[1]]}(this.dragging||b)&&this.groupCopy(this.value.current,this.value.target);if(this.dragging||this.glide()||b){this.update();this.feedback()}}},glide:function(){var a=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!a[0]&&!a[1])return false;
if(Math.abs(a[0])>this.bounds.xStep||Math.abs(a[1])>this.bounds.yStep){this.value.current[0]=this.value.current[0]+a[0]*this.speed;this.value.current[1]=this.value.current[1]+a[1]*this.speed}else this.groupCopy(this.value.current,this.value.target);return true},update:function(){this.offset.current=this.snap?this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.getOffsetsByRatios(this.value.current);this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal)this.handle.style.left=
""+this.offset.current[0]+"px";if(this.vertical)this.handle.style.top=""+this.offset.current[1]+"px";this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(a,b){var c=b?this.getLooseValue(a):this.getProperValue(a);this.groupCopy(this.value.target,c);this.offset.target=this.getOffsetsByRatios(c)},setTargetOffset:function(a,b){var c=this.getRatiosByOffsets(a),c=b?this.getLooseValue(c):this.getProperValue(c);this.groupCopy(this.value.target,c);this.offset.target=this.getOffsetsByRatios(c)},
getLooseValue:function(a){var b=this.getProperValue(a);return[b[0]+(a[0]-b[0])/4,b[1]+(a[1]-b[1])/4]},getProperValue:function(a){a=this.groupClone(a);a[0]=Math.max(a[0],0);a[1]=Math.max(a[1],0);a[0]=Math.min(a[0],1);a[1]=Math.min(a[1],1);if(!this.dragging&&!this.tapping||this.snap)this.steps>1&&(a=this.getClosestSteps(a));return a},getRatiosByOffsets:function(a){return[this.getRatioByOffset(a[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(a[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(a,
b,c){return b?(a-c)/b:0},getOffsetsByRatios:function(a){return[this.getOffsetByRatio(a[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(a[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(a,b,c){return Math.round(a*b)+c},getClosestSteps:function(a){return[this.getClosestStep(a[0]),this.getClosestStep(a[1])]},getClosestStep:function(a){for(var b=0,c=1,d=0;d<=this.steps-1;d++)if(Math.abs(this.stepRatios[d]-a)<c){c=Math.abs(this.stepRatios[d]-a);b=d}return this.stepRatios[b]},
groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0];a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},preventDefaults:function(a,c){if(!a)a=b.event;a.preventDefault&&a.preventDefault();a.returnValue=false;c&&document.selection&&document.selection.empty()},cancelEvent:function(a){if(!a)a=b.event;a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}};(function(a){function c(d){var e=d||b.event,f=[].slice.call(arguments,1),g=0,h=0,i=0,d=a.event.fix(e);
d.type="mousewheel";e.wheelDelta&&(g=e.wheelDelta/120);e.detail&&(g=-e.detail/3);i=g;if(e.axis!==void 0&&e.axis===e.HORIZONTAL_AXIS){i=0;h=-1*g}e.wheelDeltaY!==void 0&&(i=e.wheelDeltaY/120);e.wheelDeltaX!==void 0&&(h=-1*e.wheelDeltaX/120);f.unshift(d,g,h,i);return(a.event.dispatch||a.event.handle).apply(this,f)}var d=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var e=d.length;e;)a.event.fixHooks[d[--e]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=
d.length;a;)this.addEventListener(d[--a],c,false);else this.onmousewheel=c},teardown:function(){if(this.removeEventListener)for(var a=d.length;a;)this.removeEventListener(d[--a],c,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery)})(jQuery,window,Handsontable);
!function(a){var b=function(b,d){this.$element=a(b);this.options=a.extend({},a.fn.typeahead.defaults,d);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=a(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};b.prototype={constructor:b,select:function(){this.$element.val(this.updater(this.$menu.find(".active").attr("data-value"))).change();
return this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:b.top+b.height,left:b.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(){var b;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength)return this.shown?this.hide():this;return(b=a.isFunction(this.source)?this.source(this.query,
a.proxy(this.process,this)):this.source)?this.process(b):this},process:function(b){var d=this,b=a.grep(b,function(a){return d.matcher(a)}),b=this.sorter(b);return!b.length?this.shown?this.hide():this:this.render(b.slice(0,this.options.items)).show()},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b=[],e=[],f=[],g;g=a.shift();)g.toLowerCase().indexOf(this.query.toLowerCase())?~g.indexOf(this.query)?e.push(g):f.push(g):b.push(g);return b.concat(e,
f)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var d=this,b=a(b).map(function(b,c){b=a(d.options.item).attr("data-value",c);b.find("a").html(d.highlighter(c));return b[0]});b.first().addClass("active");this.$menu.html(b);return this},next:function(){var b=this.$menu.find(".active").removeClass("active").next();b.length||(b=a(this.$menu.find("li")[0]));
b.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active").prev();a.length||(a=this.$menu.find("li").last());a.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this));if(a.browser.chrome||a.browser.webkit||a.browser.msie)this.$element.on("keydown",a.proxy(this.keydown,this));this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,
this))},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault();this.prev();break;case 40:a.preventDefault();this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=!~a.inArray(b.keyCode,[40,38,9,13,27]);this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;
this.hide();break;default:this.lookup()}a.stopPropagation();a.preventDefault()},blur:function(){var a=this;setTimeout(function(){a.hide()},150)},click:function(a){a.stopPropagation();a.preventDefault();this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active");a(b.currentTarget).addClass("active")}};a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f=typeof c=="object"&&c;e||d.data("typeahead",e=new b(this,f));if(typeof c=="string")e[c]()})};
a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};a.fn.typeahead.Constructor=b;a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var d=a(this);if(!d.data("typeahead")){b.preventDefault();d.typeahead(d.data())}})})}(window.jQuery);"function"!==typeof Object.create&&(Object.create=function(a){function b(){}b.prototype=a;return new b});
(function(a){var b={init:function(b){this.options=a.extend({},a.noty.defaults,b);this.options.layout=this.options.custom?a.noty.layouts.inline:a.noty.layouts[this.options.layout];this.options.theme=a.noty.themes[this.options.theme];delete b.layout;delete b.theme;this.options=a.extend({},this.options,this.options.layout.options);this.options.id="noty_"+(new Date).getTime()*Math.floor(Math.random()*1E6);this.options=a.extend({},this.options,b);this._build();return this},_build:function(){var b=a('<div class="noty_bar"></div>').attr("id",
this.options.id);b.append(this.options.template).find(".noty_text").html(this.options.text);this.$bar=this.options.layout.parent.object!==null?a(this.options.layout.parent.object).css(this.options.layout.parent.css).append(b):b;if(this.options.buttons){this.options.closeWith=[];this.options.timeout=false;b=a("<div/>").addClass("noty_buttons");this.options.layout.parent.object!==null?this.$bar.find(".noty_bar").append(b):this.$bar.append(b);var c=this;a.each(this.options.buttons,function(b,d){var h=
a("<button/>").addClass(d.addClass?d.addClass:"gray").html(d.text).appendTo(c.$bar.find(".noty_buttons")).bind("click",function(){a.isFunction(d.onClick)&&d.onClick.call(h,c)})})}this.$message=this.$bar.find(".noty_message");this.$closeButton=this.$bar.find(".noty_close");this.$buttons=this.$bar.find(".noty_buttons");a.noty.store[this.options.id]=this},show:function(){var b=this;a(b.options.layout.container.selector).append(b.$bar);b.options.theme.style.apply(b);a.type(b.options.layout.css)==="function"?
this.options.layout.css.apply(b.$bar):b.$bar.css(this.options.layout.css||{});b.$bar.addClass(b.options.layout.addClass);b.options.layout.container.style.apply(a(b.options.layout.container.selector));b.options.theme.callback.onShow.apply(this);if(a.inArray("click",b.options.closeWith)>-1)b.$bar.css("cursor","pointer").one("click",function(){b.close()});if(a.inArray("hover",b.options.closeWith)>-1)b.$bar.one("mouseenter",function(){b.close()});if(a.inArray("button",b.options.closeWith)>-1)b.$closeButton.one("click",
function(){b.close()});a.inArray("button",b.options.closeWith)==-1&&b.$closeButton.remove();b.options.callback.onShow&&b.options.callback.onShow.apply(b);b.$bar.animate(b.options.animation.open,b.options.animation.speed,b.options.animation.easing,function(){b.options.callback.afterShow&&b.options.callback.afterShow.apply(b);b.shown=true});b.options.timeout&&b.$bar.delay(b.options.timeout).promise().done(function(){b.close()});return this},close:function(){if(!this.closed){var b=this;if(this.shown){b.$bar.addClass("i-am-closing-now");
b.options.callback.onClose&&b.options.callback.onClose.apply(b);b.$bar.clearQueue().stop().animate(b.options.animation.close,b.options.animation.speed,b.options.animation.easing,function(){b.options.callback.afterClose&&b.options.callback.afterClose.apply(b)}).promise().done(function(){if(b.options.modal){a.notyRenderer.setModalCount(-1);a.notyRenderer.getModalCount()==0&&a(".noty_modal").fadeOut("fast",function(){a(this).remove()})}a.notyRenderer.setLayoutCountFor(b,-1);a.notyRenderer.getLayoutCountFor(b)==
0&&a(b.options.layout.container.selector).remove();if(typeof b.$bar!=="undefined"&&b.$bar!==null){b.$bar.remove();b.$bar=null;b.closed=true}delete a.noty.store[b.options.id];b.options.theme.callback.onClose.apply(b);if(!b.options.dismissQueue){a.noty.ontap=true;a.notyRenderer.render()}})}else{var c=[];a.each(a.noty.queue,function(a,g){g.options.id!=b.options.id&&c.push(g)});a.noty.queue=c}}},setText:function(a){if(!this.closed){this.options.text=a;this.$bar.find(".noty_text").html(a)}return this},
setType:function(a){if(!this.closed){this.options.type=a;this.options.theme.style.apply(this);this.options.theme.callback.onShow.apply(this)}return this},setTimeout:function(a){if(!this.closed){var b=this;this.options.timeout=a;b.$bar.delay(b.options.timeout).promise().done(function(){b.close()})}return this},closed:false,shown:false};a.notyRenderer={};a.notyRenderer.init=function(c){c=Object.create(b).init(c);c.options.force?a.noty.queue.unshift(c):a.noty.queue.push(c);a.notyRenderer.render();return a.noty.returns==
"object"?c:c.options.id};a.notyRenderer.render=function(){var b=a.noty.queue[0];if(a.type(b)==="object")if(b.options.dismissQueue)a.notyRenderer.show(a.noty.queue.shift());else{if(a.noty.ontap){a.notyRenderer.show(a.noty.queue.shift());a.noty.ontap=false}}else a.noty.ontap=true};a.notyRenderer.show=function(b){if(b.options.modal){a.notyRenderer.createModalFor(b);a.notyRenderer.setModalCount(1)}a(b.options.layout.container.selector).length==0?b.options.custom?b.options.custom.append(a(b.options.layout.container.object).addClass("i-am-new")):
a("body").append(a(b.options.layout.container.object).addClass("i-am-new")):a(b.options.layout.container.selector).removeClass("i-am-new");a.notyRenderer.setLayoutCountFor(b,1);b.show()};a.notyRenderer.createModalFor=function(b){a(".noty_modal").length==0&&a("<div/>").addClass("noty_modal").data("noty_modal_count",0).css(b.options.theme.modal.css).prependTo(a("body")).fadeIn("fast")};a.notyRenderer.getLayoutCountFor=function(b){return a(b.options.layout.container.selector).data("noty_layout_count")||
0};a.notyRenderer.setLayoutCountFor=function(b,c){return a(b.options.layout.container.selector).data("noty_layout_count",a.notyRenderer.getLayoutCountFor(b)+c)};a.notyRenderer.getModalCount=function(){return a(".noty_modal").data("noty_modal_count")||0};a.notyRenderer.setModalCount=function(b){return a(".noty_modal").data("noty_modal_count",a.notyRenderer.getModalCount()+b)};a.fn.noty=function(b){b.custom=a(this);return a.notyRenderer.init(b)};a.noty={};a.noty.queue=[];a.noty.ontap=true;a.noty.layouts=
{};a.noty.themes={};a.noty.returns="object";a.noty.store={};a.noty.get=function(b){return a.noty.store.hasOwnProperty(b)?a.noty.store[b]:false};a.noty.close=function(b){return a.noty.get(b)?a.noty.get(b).close():false};a.noty.setText=function(b,c){return a.noty.get(b)?a.noty.get(b).setText(c):false};a.noty.setType=function(b,c){return a.noty.get(b)?a.noty.get(b).setType(c):false};a.noty.clearQueue=function(){a.noty.queue=[]};a.noty.closeAll=function(){a.noty.clearQueue();a.each(a.noty.store,function(a,
b){b.close()})};var c=window.alert;a.noty.consumeAlert=function(b){window.alert=function(c){b?b.text=c:b={text:c};a.notyRenderer.init(b)}};a.noty.stopConsumeAlert=function(){window.alert=c};a.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:true,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:false,force:false,modal:false,
closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){}},buttons:false};a(window).resize(function(){a.each(a.noty.layouts,function(b,c){c.container.style.apply(a(c.container.selector))})})})(jQuery);
function noty(a){var b=0,c={animateOpen:"animation.open",animateClose:"animation.close",easing:"animation.easing",speed:"animation.speed",onShow:"callback.onShow",onShown:"callback.afterShow",onClose:"callback.onClose",onClosed:"callback.afterClose"};jQuery.each(a,function(d,e){if(c[d]){b++;var f=c[d].split(".");a[f[0]]||(a[f[0]]={});a[f[0]][f[1]]=e?e:function(){};delete a[d]}});if(!a.closeWith)a.closeWith=jQuery.noty.defaults.closeWith;if(a.hasOwnProperty("closeButton")){b++;a.closeButton&&a.closeWith.push("button");
delete a.closeButton}if(a.hasOwnProperty("closeOnSelfClick")){b++;a.closeOnSelfClick&&a.closeWith.push("click");delete a.closeOnSelfClick}if(a.hasOwnProperty("closeOnSelfOver")){b++;a.closeOnSelfOver&&a.closeWith.push("hover");delete a.closeOnSelfOver}if(a.hasOwnProperty("custom")){b++;if(a.custom.container!="null")a.custom=a.custom.container}if(a.hasOwnProperty("cssPrefix")){b++;delete a.cssPrefix}if(a.theme=="noty_theme_default"){b++;a.theme="defaultTheme"}if(!a.hasOwnProperty("dismissQueue"))a.dismissQueue=
a.layout=="topLeft"||a.layout=="topRight"||a.layout=="bottomLeft"||a.layout=="bottomRight"?true:false;a.buttons&&jQuery.each(a.buttons,function(a,c){if(c.click){b++;c.onClick=c.click;delete c.click}if(c.type){b++;c.addClass=c.type;delete c.type}});b&&typeof console!=="undefined"&&console.warn&&console.warn("You are using noty v2 with v1.x.x options. @deprecated until v2.2.0 - Please update your options.");return jQuery.notyRenderer.init(a)}
function notyConfirm(a,b,c,d){var e=b!==void 0?b instanceof Array?b[0]:b:function(a){a.close();noty({text:'You clicked "Ok" button',type:"success",layout:"topRight"})},f=c!==void 0?c instanceof Array?c[0]:c:function(a){a.close()},d=d===void 0?{}:d;d.text=a;d.buttons=[{addClass:"",text:b!==void 0&&b instanceof Array?b[1]:"Ok",onClick:e},{addClass:"",text:c!==void 0&&c instanceof Array?c[1]:"Cancel",onClick:f}];d.type=d.type===void 0?"confirmation":d.type;d.modal=d.modal===void 0?true:d.modal;d.layout=
d.layout===void 0?"center":d.layout;noty(d)}
(function(a){a.noty.layouts.center={name:"center",options:{},container:{object:'<ul id="noty_center_layout_container" />',selector:"ul#noty_center_layout_container",style:function(){a(this).css({position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1E7});var b=a(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");a("body").append(b);b.find(".i-am-closing-now").remove();b.find("li").css("display","block");
var c=b.height();b.remove();a(this).hasClass("i-am-new")?a(this).css({left:(a(window).width()-a(this).outerWidth(false))/2+"px",top:(a(window).height()-c)/2+"px"}):a(this).animate({left:(a(window).width()-a(this).outerWidth(false))/2+"px",top:(a(window).height()-c)/2+"px"},500)}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}})(jQuery);
(function(a){a.noty.layouts.topRight={name:"topRight",options:{},container:{object:'<ul id="noty_topRight_layout_container" />',selector:"ul#noty_topRight_layout_container",style:function(){a(this).css({top:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1E7});window.innerWidth<600&&a(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}})(jQuery);
(function(a){a.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){a(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""}})(jQuery);
(function(a){a.noty.layouts.bottom={name:"bottom",options:{},container:{object:'<ul id="noty_bottom_layout_container" />',selector:"ul#noty_bottom_layout_container",style:function(){a(this).css({bottom:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""}})(jQuery);
(function(a){a.noty.themes.defaultTheme={name:"defaultTheme",helpers:{borderFix:function(){if(this.options.dismissQueue){var b=this.options.layout.container.selector+" "+this.options.layout.parent.selector;switch(this.options.layout.name){case "top":a(b).css({borderRadius:"0px 0px 0px 0px"});a(b).last().css({borderRadius:"0px 0px 5px 5px"});break;case "topCenter":case "topLeft":case "topRight":case "bottomCenter":case "bottomLeft":case "bottomRight":case "center":case "centerLeft":case "centerRight":case "inline":a(b).css({borderRadius:"0px 0px 0px 0px"});
a(b).first().css({"border-top-left-radius":"5px","border-top-right-radius":"5px"});a(b).last().css({"border-bottom-left-radius":"5px","border-bottom-right-radius":"5px"});break;case "bottom":a(b).css({borderRadius:"0px 0px 0px 0px"});a(b).first().css({borderRadius:"5px 5px 0px 0px"})}}}},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1E4,opacity:0.6,display:"none",left:0,top:0}},style:function(){this.$bar.css({overflow:"hidden",background:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAoCAYAAAAPOoFWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPZJREFUeNq81tsOgjAMANB2ov7/7ypaN7IlIwi9rGuT8QSc9EIDAsAznxvY4pXPKr05RUE5MEVB+TyWfCEl9LZApYopCmo9C4FKSMtYoI8Bwv79aQJU4l6hXXCZrQbokJEksxHo9KMOgc6w1atHXM8K9DVC7FQnJ0i8iK3QooGgbnyKgMDygBWyYFZoqx4qS27KqLZJjA1D0jK6QJcYEQEiWv9PGkTsbqxQ8oT+ZtZB6AkdsJnQDnMoHXHLGKOgDYuCWmYhEERCI5gaamW0bnHdA3k2ltlIN+2qKRyCND0bhqSYCyTB3CAOc4WusBEIpkeBuPgJMAAX8Hs1NfqHRgAAAABJRU5ErkJggg==') repeat-x scroll left top #fff"});
this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"});this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAATpJREFUeNoszrFqVFEUheG19zlz7sQ7ijMQBAvfYBqbpJCoZSAQbOwEE1IHGytbLQUJ8SUktW8gCCFJMSGSNxCmFBJO7j5rpXD6n5/P5vM53H3b3T9LOiB5AQDuDjM7BnA7DMPHDGBH0nuSzwHsRcRVRNRSysuU0i6AOwA/02w2+9Fae00SEbEh6SGAR5K+k3zWWptKepCm0+kpyRoRGyRBcpPkDsn1iEBr7drdP2VJZyQXERGSPpiZAViTBACXKaV9kqd5uVzCzO5KKb/d/UZSDwD/eyxqree1VqSu6zKAF2Z2RPJJaw0rAkjOJT0m+SuT/AbgDcmnkmBmfwAsJL1dXQ8lWY6IGwB1ZbrOOb8zs8thGP4COFwx/mE8Ho9Go9ErMzvJOW/1fY/JZIJSypqZfXX3L13X9fcDAKJct1sx3OiuAAAAAElFTkSuQmCC)",
display:"none",cursor:"pointer"});this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"});this.$buttons.find("button").css({marginLeft:5});this.$buttons.find("button:first").css({marginLeft:0});this.$bar.bind({mouseenter:function(){a(this).find(".noty_close").fadeIn()},mouseleave:function(){a(this).find(".noty_close").fadeOut()}});switch(this.options.layout.name){case "top":this.$bar.css({borderRadius:"0px 0px 5px 5px",borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",
borderRight:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case "topCenter":case "center":case "bottomCenter":case "inline":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});this.$message.css({fontSize:"13px",textAlign:"center"});break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":case "centerLeft":case "centerRight":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});
this.$message.css({fontSize:"13px",textAlign:"left"});break;case "bottom":this.$bar.css({borderRadius:"5px 5px 0px 0px",borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case "alert":case "notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"});break;case "warning":this.$bar.css({backgroundColor:"#FFEAA8",
borderColor:"#FFC237",color:"#826200"});this.$buttons.css({borderTop:"1px solid #FFC237"});break;case "error":this.$bar.css({backgroundColor:"red",borderColor:"darkred",color:"#FFF"});this.$message.css({fontWeight:"bold"});this.$buttons.css({borderTop:"1px solid darkred"});break;case "information":this.$bar.css({backgroundColor:"#57B7E2",borderColor:"#0B90C4",color:"#FFF"});this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case "success":this.$bar.css({backgroundColor:"lightgreen",borderColor:"#50C24E",
color:"darkgreen"});this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){a.noty.themes.defaultTheme.helpers.borderFix.apply(this)},onClose:function(){a.noty.themes.defaultTheme.helpers.borderFix.apply(this)}}}})(jQuery);
(function(a){function b(){}for(var c=["assert","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","timeStamp","profile","profileEnd","time","timeEnd","trace","warn"],d;d=c.pop();)a[d]=a[d]||b})(function(){try{console.log();return window.console}catch(a){return window.console={}}}());var VG=VG||{REVISION:"1"};VG.Bus=$({});
var captureSave=function(a){$(window).keypress(function(a){if(!(a.which==115&&(navigator.platform.match("Mac")?a.metaKey:a.ctrlKey))&&a.which!=19)return true;a.preventDefault();return false});$(document).keydown(function(b){if(b.which==83&&(navigator.platform.match("Mac")?b.metaKey:b.ctrlKey)){b.preventDefault();a(b);return false}})},toRadians=function(a){return a/57.29577951308232},firstWv=function(a,b){b===void 0&&console.error("firstWv must provide wv");var c=Math.atan(Math.sin(a*(3.141592653589793/
b))/Math.cos(a*(3.141592653589793/b)));c<0&&(c=c+3.141592653589793);return c*(b/3.141592653589793)},nextInt=function(a){return Math.floor(Math.random()*a)},clamp=function(a,b,c){return a>c?c:a<b?b:a},getBearing=function(a,b){var c=(new VG.Vector(a.x,a.y,0)).normalize();if(Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2))<1.0E-5)return 0;var d=b!==void 0?b:new VG.Vector(0,1,0),e=d.dot(c),e=Math.acos(e);d.y*c.x-d.x*c.y<0&&(e=2*Math.PI-e);return e*180/Math.PI},getBearingInPlane=function(a,b,c){b=(new VG.Matrix4).rotateY(-toRadians(b));
c=(new VG.Matrix4).rotateZ(+toRadians(a)).multiplyVector(c);c=b.multiplyVector(c);c.normalize();return firstWv(getBearing(c),360)},getRakeVector=function(a,b,c){var c=(new VG.Matrix4).rotateZ(-toRadians(c)),b=(new VG.Matrix4).rotateY(toRadians(b)),a=(new VG.Matrix4).rotateZ(-toRadians(a)),d=new VG.Vector(0,1,0),d=c.multiplyVector(d),d=b.multiplyVector(d),d=a.multiplyVector(d);d.normalize();return d},getStrikeAndDipFromNormal=function(a){a=(new VG.Vector).copy(a).normalize();if(Math.sqrt(Math.pow(a.x,
2)+Math.pow(a.y,2))<1.0E-5)return[0,0];var b=Array(2);b[0]=getBearing(a)-90;b[0]=b[0]<0?b[0]+360:b[0];b[1]=90-Math.asin(a.z)*180/Math.PI;return b[1]>90?getStrikeAndDipFromNormal(a.negate()):b},getTrendAndPlungeFromVector=function(a){a=(new VG.Vector).copy(a).normalize();if(abs(a.z)===1)return[0,90];if(Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))<1.0E-5)return[0,0];var b=Array(2);b[0]=getBearing(a);b[0]=b[0]<0?b[0]+360:b[0];b[1]=-(Math.asin(a.z)*180/Math.PI);b[1]=b[1]<0?0:b[1]>90?90:b[1];return b},getVectorFromTrendAndPlunge=
function(a,b){var c=(new VG.Matrix4).rotateZ(toRadians(-a)),d=new VG.Vector(0,Math.cos(toRadians(b)),-Math.sin(toRadians(b)));return c.multiplyVector(d)},radiusFrom3Points=function(a,b,c){var d=a.clone().subSelf(b).length(),b=b.clone().subSelf(c).length(),a=c.clone().subSelf(a).length(),c=(d+b+a)/2,c=Math.sqrt(c*(c-d)*(c-b)*(c-a));return d*b*a/(4*c)},centerFrom3Points=function(a,b,c){var d=b.y-a.y,e=b.x-a.x,f=c.y-b.y,g=c.x-b.x,h=new VG.Vector,d=d/e,f=f/g;h.x=(d*f*(a.y-c.y)+f*(a.x+b.x)-d*(b.x+c.x))/
(2*(f-d));h.y=-1*(h.x-(a.x+b.x)/2)/d+(a.y+b.y)/2;return h},inTriangle=function(a,b,c,d){var e=new VG.Vector,f=new VG.Vector,g=new VG.Vector;e.sub(c,a);f.sub(b,a);g.sub(d,a);a=e.dot(e);b=e.dot(f);e=e.dot(g);c=f.dot(f);f=f.dot(g);g=1/(a*c-b*b);c=(c*e-b*f)*g;f=(a*f-b*e)*g;return c+1.0E-5>=0&&f+1.0E-5>=0&&c+f-2.0E-5<=1},forAll=function(a,b){if(a instanceof Array||a instanceof Float32Array)for(var c=0;c<a.length;c++)b(a[c],c)},setAll=function(a,b){if(typeof a==="number")return b(a,0);if(a instanceof VG.Matrix){for(var c=
1;c<=a.matrix.length;c++)a.matrix[c-1]=b(a.matrix[c-1],c-1,a.matrix,a.ind2sub(c));return a}if(a instanceof Array){for(var c=Array(a.length),d=0;d<a.length;d++)c[d]=b(a[d],d,c);return c}throw"setAll: only number matrix, and array implemented";},loopAll=function(a,b,c){if(typeof a==="number")return b(a,c);if(a instanceof VG.Matrix){var d=a.matrix[0];c!==void 0&&(d=c);for(c=1;c<=a.matrix.length;c++)d=b(a.matrix[c-1],d);return d}if(a instanceof Array){d=a[0];c!==void 0&&(d=c);for(c=0;c<a.length;c++)d=
b(a[c],d);return d}throw"setAll: only number matrix, and array implemented";},max=function(a){return loopAll(a,Math.max)},min=function(a){return loopAll(a,Math.min)},minIg=function(a,b){return loopAll(a,function(a,d){return d===b?a:a<d&&a!==b?a:d})},maxIg=function(a,b){return loopAll(a,function(a,d){return d===b?a:a>d&&a!==b?a:d})},sum=function(a){return loopAll(a,function(a,c){return a+c},0)},prod=function(a){return loopAll(a,function(a,c){return a*c},1)},cumsum=function(a){return setAll(a,function(a,
c,d){return c>0?a+d[c-1]:a})},abs=function(a){return setAll(a,function(a){return Math.abs(a)})},log=function(a){return setAll(a,function(a){return Math.log(a)})},log10=function(a){return setAll(a,function(a){return Math.log(a)/2.302585092994046})},unique=function(a,b){for(var c=[],d=setAll(Array(a.length),function(){return 0}),e=0;e<a.length;e++){if(d[e]===0)for(var f=e+1;f<a.length;f++)d[f]===0&&(d[f]=isequal(a[e],a[f],b)?1:0);d[e]===0&&c.push(a[e])}return c},find=function(a,b){var c=[];if(typeof b===
"function")forAll(a,function(a,e){b(a,e)&&c.push(e+1)});else if(typeof b==="number")forAll(a,function(a,e){a===b&&c.push(e+1)});else throw"find: v must be a number or a function";return c},vcat=function(a){function b(){var b=new VG.Matrix(null,[d,e]);for(h=0;h<a.length;h++)if(a[h]instanceof VG.Matrix)for(var c=1;c<=a[h].sizeDim(1);c++){for(var f=1;f<=a[h].sizeDim(2);f++){var g=a[h].getIJ([c,f]);b.setIJ([i,f],g)}i=i+1}else throw"vcat: can only cat Matrix and Sparse";return b}function c(){var b=new VG.Sparse;
b.allocate([d,e],g);for(h=0;h<a.length;h++){var c=1;if(a[h]instanceof VG.Sparse)for(;c<=a[h].sizeDim(1);c++){var f=a[h].getRow(c);if(f.length>0)for(var p=a[h].getRowCol(c),m=0;m<f.length;m++)b.construct(i,p[m],f[m]);i=i+1}else if(a[h]instanceof VG.Matrix)for(;c<=a[h].sizeDim(1);c++){for(f=1;f<=a[h].sizeDim(2);f++){p=a[h].getIJ([c,f]);p!==0&&b.construct(i,f,p)}i=i+1}else throw"vcat: can only cat Matrix and Sparse";}return b}for(var d=0,e=a[0].sizeDim(2),f=false,g=0,h=0;h<a.length;h++){d=d+a[h].sizeDim(1);
if(e!==a[h].sizeDim(2))throw"vcat: dim(2) must remain the same";if(!a[h].is2D())throw"vcat: must be 2D matrix";f=f||a[h]instanceof VG.Sparse;g=g+a[h].nnz()}var i=1;return f?c():b()},hcat=function(a){for(var b=a[0].sizeDim(1),c=0;c<a.length;c++){if(b!==a[c].sizeDim(1))throw"hcat: dim(1) must remain the same";if(!a[c].is2D())throw"vcat: must be 2D matrix";}for(c=0;c<a.length;c++)a[c].transpose();b=vcat(a).transpose();for(c=0;c<a.length;c++)a[c].transpose();return b},isequal=function(a,b,c){function d(){if(a.length!==
b.length)return false;for(var c=a.length,d=0;d<c;d++)if(!f(a[d],b[d]))return false;return true}function e(){if(a.size.length!==b.size.length||a.numel()!==b.numel())return false;for(var c=1;c<=a.size.length;c++)if(a.sizeDim(c)!==b.sizeDim(c))return false;for(var c=a.numel(),d=1;d<=c;d++)if(!f(a.get(d),b.get(d)))return false;return true}if(a===b)return true;var f;f=c===void 0?function(a,b){return a===b}:function(a,b){return Math.abs(a-b)<=c};if((a instanceof VG.Matrix||a instanceof VG.Sparse)&&(b instanceof
VG.Matrix||b instanceof VG.Sparse))return e();if(a instanceof Array&&b instanceof Array)return d();if((a instanceof THREE.Vector3||a instanceof VG.Vector)&&(b instanceof THREE.Vector3||b instanceof VG.Vector))return f(a.x,b.x)&&f(a.y,b.y)&&f(a.z,b.z)?true:false;if(typeof a==="number"&&typeof b==="number")return f(a,b)},isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},KeyCodes={KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40},emailRegExp="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$",
rgbToHex=function(a,b,c){return"#"+(16777216+(a<<16)+(b<<8)+c).toString(16).slice(1)},hexToRgb=function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},strip_tags=function(a,b){var c=$("<div>").html(a);c.children().not(b).each(function(){var a=$(this).contents();$(this).replaceWith(a)});return c.html()},linspace=function(a,b,c){for(var d=[],b=(b-a)/(c-1),e=0;e<c;e++)d.push(a+b*e);return d},spaceArray=function(a,b,
c){for(var a=[a],d=0;a[d]+b<=c;){a.push(a[d]+b);d++}return a};VG.Timer=function(a){this.run=a};VG.Timer.prototype={constructor:VG.Timer,schedule:function(a){var b=this;this.timer=setTimeout(function(){b.run()},a);return this},scheduleRepeating:function(a){var b=this;this.timer=setInterval(function(){b.run()},a);return this},cancel:function(){try{clearTimeout(this.timer)}catch(a){}try{clearInterval(this.timer)}catch(b){}return this},fire:function(){this.run();return this}};
VG.NumberFormat=function(a,b){this.formatString=a===void 0?"0.00":a;this.units=b===void 0?"":b};
VG.NumberFormat.prototype={constructor:VG.NumberFormat,format:function(a){if(a instanceof Array)return this.arrayFormat(a);if(this.formatString.indexOf("E")!==-1)return this.exponentialFormat(a);var b=this.formatString,c=false;if(b.indexOf("+")!==-1){b=b.replace("+","");c=true}if(!b||isNaN(+a))return a;var a=b.charAt(0)==="-"?-a:+a,d=a<0?a=-a:0,e=b.match(/[^\d\-\+#]/g),f=e&&e[e.length-1]||".",e=e&&e[1]&&e[0]||",",b=b.split(f),a=a.toFixed(b[1]&&b[1].length),a=a.toString(),g=b[1]&&b[1].lastIndexOf("0"),
h=a.split(".");if(!h[1]||h[1]&&h[1].length<=g)a=(+a).toFixed(g+1);g=b[0].split(e);b[0]=g.join("");var i=b[0]&&b[0].indexOf("0");if(i>-1)for(;h[0].length<b[0].length-i;)h[0]="0"+h[0];else+h[0]===0&&(h[0]="");a=a.split(".");a[0]=h[0];if(h=g[1]&&g[g.length-1].length){for(var g=a[0],i="",j=g.length%h,k=0,l=g.length;k<l;k++){i=i+g.charAt(k);!((k-j+1)%h)&&k<l-h&&(i=i+e)}a[0]=i}a[1]=b[1]&&a[1]?f+a[1]:"";return this.addUnits((d?"-":c?"+":"")+a[0]+a[1])},arrayFormat:function(a){for(var b=this.units,c=this.units=
"",d=0;d<a.length;d++)c=c+(this.format(a[d])+"-");c=c.slice(0,-1);this.units=b;return c=this.addUnits(c)},exponentialFormat:function(a){var b=this.formatString,c=this.units;this.units="";var d=Math.floor(Math.log(Math.abs(a))/Math.log(10)),a=d!==0?a/Math.pow(10,d):a;this.formatString=b.split("E")[0];a=this.format(a);this.formatString=b.split("E")[1];d=this.format(d);this.formatString=b;this.units=c;return this.addUnits(a+"E"+d)},addUnits:function(a){return this.units instanceof Array?this.units[0]+
a+this.units[1]:a+this.units}};VG.NumberFormat.StrikeDip=function(a,b,c){var c=c===void 0?0:c,d;if(c>0){for(decimalStr=".";decimalStr.length<=c;)decimalStr=decimalStr+"0";c=new VG.NumberFormat("000"+decimalStr,"&deg;");d=new VG.NumberFormat("00"+decimalStr,"&deg;")}else{c=VG.NumberFormat.Strike();d=VG.NumberFormat.Dip()}return c.format(a)+" / "+d.format(b)};VG.NumberFormat.Strike=function(){return new VG.NumberFormat("000","&deg;")};
VG.NumberFormat.Rake=function(){return new VG.NumberFormat("+000","&deg;")};VG.NumberFormat.Dip=function(){return new VG.NumberFormat("00","&deg;")};VG.NumberFormat.Length=function(){return new VG.NumberFormat("0.0","")};VG.NumberFormat.Money=function(){return new VG.NumberFormat("#0.00",["$",""])};VG.NumberFormat.USD=function(){return new VG.NumberFormat("#0.00",["$","USD"])};VG.NumberFormat.Scientific=function(){return new VG.NumberFormat("0.00E00","")};
VG.ThreeUtils={loadDataURITexture:function(a,b){var c=document.createElement("img");c.src=a;var d=new THREE.Texture(c);c.onload=function(){d.needsUpdate=true;b&&b.render()};return d},cutPatch:function(a,b,c,d,e,f){for(var g=a.vertices,a=a.faces,h=g.length,i=-1,j=false;!j;){i=i+1;if(i===3)return;var k=b.getDistance(c[i]);d&&k>=0?j=true:!d&&k<=0&&(j=true)}j=Array(3);for(k=0;k<3;k++){j[k]=c[i];i=i+1;i===3&&(i=0)}c=b.bisectPoints(j[0],j[1]);i=b.bisectPoints(j[0],j[2]);b=b.bisectPoints(j[1],j[2]);d&&c!==
null&&f.push(c);d&&i!==null&&f.push(i);d&&b!==null&&f.push(b);if(c!==null&&i!==null){g.push(new THREE.Vector3(j[0].x,j[0].y,j[0].z));g.push(new THREE.Vector3(c.x,c.y,c.z));g.push(new THREE.Vector3(i.x,i.y,i.z));VG.ThreeUtils.pushFace(g,a,e,h,h+1,h+2)}else if(c!==null&&b!==null){g.push(new THREE.Vector3(j[0].x,j[0].y,j[0].z));g.push(new THREE.Vector3(c.x,c.y,c.z));g.push(new THREE.Vector3(j[2].x,j[2].y,j[2].z));g.push(new THREE.Vector3(b.x,b.y,b.z));VG.ThreeUtils.pushFace(g,a,e,h,h+1,h+2);VG.ThreeUtils.pushFace(g,
a,e,h+1,h+2,h+3)}else if(i!==null&&b!==null){g.push(new THREE.Vector3(j[0].x,j[0].y,j[0].z));g.push(new THREE.Vector3(j[1].x,j[1].y,j[1].z));g.push(new THREE.Vector3(i.x,i.y,i.z));g.push(new THREE.Vector3(b.x,b.y,b.z));VG.ThreeUtils.pushFace(g,a,e,h,h+1,h+2);VG.ThreeUtils.pushFace(g,a,e,h+1,h+2,h+3)}else if(c===null&&i===null&&b===null){g.push(new THREE.Vector3(j[0].x,j[0].y,j[0].z));g.push(new THREE.Vector3(j[1].x,j[1].y,j[1].z));g.push(new THREE.Vector3(j[2].x,j[2].y,j[2].z));VG.ThreeUtils.pushFace(g,
a,e,h,h+1,h+2)}},cutLine:function(a,b,c,d){for(var e=0;e<c.length-1;e++){b.onThisSideOfPlane(c[e],d)&&a.push((new THREE.Vector3).copy(c[e]));var f=b.bisectPoints(c[e],c[e+1]);f!==null&&a.push((new THREE.Vector3).copy(f))}a.length>0&&a.push(a[0].clone())},pushFace:function(a,b,c,d,e,f){var g=(new THREE.Vector3).copy(a[d]),h=(new THREE.Vector3).copy(a[e]),a=(new THREE.Vector3).copy(a[f]),h=(new THREE.Vector3).copy(h).subSelf(g),g=(new THREE.Vector3).copy(a).subSelf(g),g=(new THREE.Vector3).cross(h,
g);(new THREE.Vector3).copy(c).dot(g)>=0?b.push(new THREE.Face3(d,e,f)):b.push(new THREE.Face3(e,d,f))}};VG.Matrix=function(a,b){this.set(a,b)};
VG.Matrix.prototype={constructor:VG.Matrix,set:function(a,b){b=b||[1,1];this.setSize(b);this.init();a?this.copy(a):this.zeros();return this},init:function(){var a=this.numel();this.matrix=Array(a)},copy:function(a){if(a.length!==this.matrix.length)throw"Copy: Matrix length must be equal to prod(size);";for(var b=0;b<this.matrix.length;b++)this.matrix[b]=a[b]},setSize:function(a){this.size=Array(a.length);for(var b=0;b<a.length;b++)this.size[b]=a[b];return this},setIJ:function(a,b){this.matrix[this.sub2ind(a)-
1]=b},setAll:function(a){for(var b=1;b<=this.matrix.length;b++)this.matrix[b-1]=a(this.matrix[b-1],b,this.ind2sub(b))},forAll:function(a){for(var b=1;b<=this.matrix.length;b++)a(this.matrix[b-1],b,this.ind2sub(b))},get:function(a){return this.matrix[a-1]},getIJ:function(a){for(var b=0;b<a.length;b++)if(a[b]>this.size[b])throw"getIJ: Index out of bounds.";return this.matrix[this.sub2ind(a)-1]},getRowArray:function(a){if(this.is2D()){for(var b=this.sizeDim(2),c=Array(b),d=1;d<=b;d++)c[d-1]=this.getIJ([a,
d]);return c}throw"GetRow: Row not defined over two dimensions";},getRow:function(a){return new VG.Matrix(this.getRowArray(a),[1,this.sizeDim(2)])},getColArray:function(a){if(this.is2D()){for(var b=Array(this.sizeDim(1)),c=1;c<=this.sizeDim(1);c++)b[c-1]=this.getIJ([c,a]);return b}throw"GetCol: Column not defined over two dimensions";},getCol:function(a){return new VG.Matrix(this.getColArray(a),[this.sizeDim(1),1])},reshape:function(a){var b=this.size,c=this.numel();this.size=a;a=this.numel();if(c==
a)return this;this.size=b;throw"CangeSize: Number of elements must not change.";},numel:function(){return prod(this.size)},nnz:function(){return loopAll(this,function(a,b){return a===0?b:b+1},0)},sizeDim:function(a){if(a<=this.size.length&&a>0)return this.size[a-1];if(a<=0)throw"sizeDim: dimension must be > 0";return 0},is2D:function(){return this.size.length==2},is3D:function(){return this.size.length==3},ind2sub:function(a){for(var b=this.size,c=Array(b.length),d=b.length,b=this.cumprod(),d=d-1;d>=
0;d--){var e=(a-1)%b[d]+1;c[d]=(a-e)/b[d]+1;a=e}return c},sub2ind:function(a){var b=this.size;if(a.length==b.length){for(var c=this.cumprod(),d=0,e=0;e<b.length;e++)d=d+(a[e]-1)*c[e];return d+1}throw"sub2ind: ij.length must equal size.length";},cumprod:function(){for(var a=this.size,b=Array(a.length),c=b[0]=1;c<a.length;c++)b[c]=b[c-1]*a[c-1];return b},multiply:function(a){if(!this.is2D()||!a.is2D())throw"Multiply: Both matrices must be 2D";if(this.sizeDim(2)!=a.sizeDim(1))throw"Multiply: Check sizes of mats. Can not multiply.";
for(var b=new VG.Matrix(Array(this.sizeDim(1)*a.sizeDim(2)),[this.sizeDim(1),a.sizeDim(2)]),c=1;c<=a.sizeDim(2);c++)for(var d=1;d<=this.sizeDim(1);d++){for(var e=0,f=1;f<=this.sizeDim(2);f++)e=e+this.getIJ([d,f])*a.getIJ([f,c]);b.setIJ([d,c],e)}return b},squeeze:function(){for(var a=0,b=0;b<this.size.length;b++)this.size[b]!=1&&(a=a+1);a=Array(Math.max(a,2));a[0]=1;a[1]=1;for(var c=0,b=0;b<this.size.length;b++)if(this.size[b]!=1){a[c]=this.size[b];c=c+1}this.size=a;return this},transpose:function(){if(this.is2D()){this.permute([2,
1]);return this}throw"Transpose: Transpose only works in 2D";},permute:function(a){if(this.size.length!=a.length)throw"Permute: length(dim) must equal length(size)";for(var b=Array(this.size.length),c=0;c<this.size.length;c++)b[a[c]-1]=this.size[c];var d=this,c=new VG.Matrix(null,b),e=this.size;c.setSize(b);c.setAll(function(b,c,h){b=Array(e.length);for(c=0;c<a.length;c++)b[a[c]-1]=h[c];return d.getIJ(b)});this.size=b;this.matrix=c.matrix;return this},flipDim:function(a){var b=new VG.Matrix(this.matrix,
this.size);this.setAll(function(c,d,e){e[a-1]=b.sizeDim(a)-(e[a-1]-1);return b.getIJ(e)});return this},repmat:function(a){for(var b=new VG.Matrix(this.matrix,this.size),c=0;c<a.length;c++)this.size[c]=this.size[c]*a[c];this.init();this.setAll(function(c,e,f){for(c=0;c<a.length;c++)f[c]=(f[c]-1)%b.size[c]+1;return b.getIJ(f)});return this},zeros:function(){this.setAll(function(){return 0});return this},ones:function(){this.setAll(function(){return 1});return this},log:function(){this.setAll(function(a){return Math.log(a)});
return this},log10:function(){this.setAll(function(a){return Math.log(a)/Math.log(10)});return this},scalarMultiply:function(a){this.setAll(function(b){return b*a});return this},scalarAdd:function(a){this.setAll(function(b){return b+a});return this},min:function(){var a=this.matrix[0];this.forAll(function(b){a=b<a?b:a});return a},max:function(){var a=this.matrix[0];this.forAll(function(b){a=b>a?b:a});return a},toNestedArray:function(){for(var a=[],b=1;b<=this.sizeDim(1);b++){for(var c=[],d=1;d<=this.sizeDim(2);d++)c.push(this.getIJ([b,
d]));a.push(c)}return a},toNestedArrayJI:function(){for(var a=[],b=1;b<=this.sizeDim(2);b++){for(var c=[],d=1;d<=this.sizeDim(1);d++)c.push(this.getIJ([d,b]));a.push(c)}return a},toString:function(){if(!this.is2D())throw"toString: Only 2D is implemented.";for(var a="[",b=1;b<=this.sizeDim(1);b++){for(var c=1;c<=this.sizeDim(2);c++)a=a+(this.getIJ([b,c])+",");a=a.slice(0,-1)+";"}return a.slice(0,-1)+"]"},fromVectorArray:function(a){for(var b=new VG.Matrix(null,[a.length,1,3]),c=1;c<=a.length;c++){b.setIJ([c,
1,1],a[c-1].x);b.setIJ([c,1,2],a[c-1].y);b.setIJ([c,1,3],a[c-1].z)}return b}};
var eye=function(a){a=new VG.Matrix(null,[a,a]);a.setAll(function(a,c,d){return d[0]==d[1]?1:0});return a},kron=function(a,b){if(!a.is2D()||!b.is2D())throw"Kron: A and B must be 2D arrays";if(a instanceof VG.Matrix&&b instanceof VG.Matrix){var c=new VG.Matrix(null,[a.sizeDim(1)*b.sizeDim(1),a.sizeDim(2)*b.sizeDim(2)]);c.setAll(function(c,d,e){var c=e[0],e=e[1],d=c%b.sizeDim(1),f=e%b.sizeDim(2);return a.getIJ([Math.floor((c-1)/a.sizeDim(1))+1,Math.floor((e-1)/a.sizeDim(2))+1])*b.getIJ([d==0?b.sizeDim(1):
d,f==0?b.sizeDim(2):f])});return c}c=new VG.Sparse;c.size=[a.sizeDim(1)*b.sizeDim(1),a.sizeDim(2)*b.sizeDim(2)];c.rind=[];c.cind=[];c.A=[];var d=1;c.rind.push(1);for(var e=1;e<=c.size[0];e++){for(var f=1;f<=c.size[1];f++){var g=e%b.sizeDim(1),h=f%b.sizeDim(2),g=a.getIJ([Math.floor((e-1)/a.sizeDim(1))+1,Math.floor((f-1)/a.sizeDim(2))+1])*b.getIJ([g==0?b.sizeDim(1):g,h==0?b.sizeDim(2):h]);if(g!=0){c.cind.push(f);c.A.push(g);d=d+1}}c.rind.push(d)}return c},kron3=function(a,b,c){return new kron(a,kron(b,
c))},triu=function(a){if(a instanceof VG.Matrix){if(!a.is2D())throw"triu: must be 2D";for(var b=new VG.Matrix(null,a.size),c=1;c<=b.sizeDim(1);c++)for(var d=c;d<=b.sizeDim(2);d++)b.setIJ([c,d],a.getIJ([c,d]));return b}if(a instanceof VG.Sparse){if(!a.is2D())throw"triu: must be 2D";b=(new VG.Sparse).allocate(a.size,a.nnz());for(c=1;c<=b.sizeDim(1);c++){var e=a.getRow(c);if(e.length>0)for(var f=a.getRowCol(c),g=find(f,function(a){return a>=c?true:false}),d=0;d<g.length;d++)b.construct(c,f[g[d]-1],e[g[d]-
1])}b.clean();return b}throw"triu: must be a matrix";},tril=function(a){if(a instanceof VG.Matrix||a instanceof VG.Sparse){if(!a.is2D())throw"tril: must be 2D";a.transpose();var b=triu(a).transpose();a.transpose();return b}throw"tril: must be a matrix";};VG.Octree=function(a,b){this.blkSize=b;this.blocks=new VG.Matrix(null,a);this.blocks.matrix=Array(prod(a))};
VG.Octree.prototype={constructor:VG.Octree,create:function(a){for(var b=a.length,c=0;c<b;c++)this.setIJ(a[c][0],a[c][1],a[c][2],a[c][3],a[c][4])},setIJ:function(a,b,c,d,e){if(d==this.blkSize){a=(a-1)/this.blkSize+1;b=(b-1)/this.blkSize+1;c=(c-1)/this.blkSize+1;this.blocks.setIJ([a,b,c],e)}else{var f=Math.floor((a-1)/this.blkSize)+1,g=Math.floor((b-1)/this.blkSize)+1,h=Math.floor((c-1)/this.blkSize)+1,i=this.blocks.getIJ([f,g,h]);if(typeof i=="number"||i==void 0){i=new VG.Octree([2,2,2],this.blkSize/
2);this.blocks.setIJ([f,g,h],i)}a=a-(f-1)*this.blkSize;b=b-(g-1)*this.blkSize;c=c-(h-1)*this.blkSize;i.setIJ(a,b,c,d,e)}return this},getIJ:function(a){var b=a[0],c=a[1],a=a[2],d=Math.floor((b-1)/this.blkSize)+1,e=Math.floor((c-1)/this.blkSize)+1,f=Math.floor((a-1)/this.blkSize)+1,g=this.blocks.getIJ([d,e,f]);if(g==void 0)return null;if(typeof g=="number")return g;if(g instanceof VG.Octree){b=b-(d-1)*this.blkSize;c=c-(e-1)*this.blkSize;a=a-(f-1)*this.blkSize;return g.getIJ([b,c,a])}throw"Octree:getIJ: Not defined.";
}};VG.Sparse=function(){this.size=[0,0];this.A=[0];this.rind=[0];this.cind=[0]};
VG.Sparse.prototype={constructor:VG.Sparse,allocate:function(a,b){this.A=Array(b);this.size=[a[0],a[1]];this.cind=Array(b);this.rind=setAll(Array(a[0]+1),function(){return 1});this._nextEnt=0;return this},construct:function(a,b,c){this.A[this._nextEnt]=c;this.cind[this._nextEnt]=b;this.rind=setAll(this.rind,function(b,c){return c<a?b:b+1});this._nextEnt=this._nextEnt+1;return this},clean:function(){if(!(this._nextEnt>=this.A.length)){var a=this._nextEnt-this.A.length;this.A=this.A.slice(0,a);this.cind=
this.cind.slice(0,a)}},getIJ:function(a){if(a.length!=2)throw"getIJ: length of IJ must equal 2";var b=a[0],a=a[1];if(!(b>this.size[0]||a>this.size[1])){var c=this.cind.slice(this.rind[b-1]-1,this.rind[b]-1),a=find(c,a);return a.length==1?this.A[a-1+this.rind[b-1]-1]:0}},getRow:function(a){if(a<=this.sizeDim(1)&&a>0)return this.A.slice(this.rind[a-1]-1,this.rind[a]-1)},getRowCol:function(a){if(a<=this.sizeDim(1)&&a>0)return this.cind.slice(this.rind[a-1]-1,this.rind[a]-1)},sizeDim:function(a){if(a<=
this.size.length&&a>0)return this.size[a-1];if(a<=0)throw"sizeDim: dimension must be > 0";return 0},is2D:function(){return this.size.length==2},is3D:function(){return this.size.length==3},numel:function(){return this.size[0]*this.size[1]},nnz:function(){return this.A.length},multiply:function(a){if(a.sizeDim(1)!=this.sizeDim(2))throw"multiply: dimensions must agree";for(var b=[],c=1;c<=a.sizeDim(2);c++)for(var d=1;d<=a.sizeDim(1);d++){var e=this.getRow(d);if(e.length>0){for(var f=this.getRowCol(d),
g=0,h=0;h<e.length;h++)g=g+e[h]*a.getIJ([f[h],c]);b.push(g)}}return new VG.Matrix(b,[this.sizeDim(1),a.sizeDim(2)])},transpose:function(){for(var a=this.triplet(),b=[this.size[1],this.size[0]],b=(new VG.Sparse).allocate(b,this.nnz()),c=1;c<=b.sizeDim(1);c++)for(var d=find(this.cind,c),e=0;e<d.length;e++){var f=a.getIJ([d[e],1]);b.construct(c,f,this.A[d[e]-1])}this.A=b.A;this.rind=b.rind;this.cind=b.cind;this.size=b.size;return this},triplet:function(){for(var a=new VG.Matrix(null,[this.A.length,3]),
b=1,c=1;c<=this.sizeDim(1);c++)for(var d=this.rind[c]-this.rind[c-1],e=0;e<d;e++){a.setIJ([b,1],c);a.setIJ([b,2],this.cind[b-1]);a.setIJ([b,3],this.A[b-1]);b=b+1}return a},full:function(){for(var a=Array(this.size[0]*this.size[1]),b=0,c=1;c<=this.size[1];c++)for(var d=1;d<=this.size[0];d++){a[b]=this.getIJ([d,c]);b=b+1}return new VG.Matrix(a,this.size)}};
var sparse=function(a){if(!(a instanceof VG.Matrix))throw"sparse: input must be a matrix";if(!a.is2D())throw"sparse: matrix must be 2D";var b=new VG.Sparse;b.size[0]=a.sizeDim(1);b.size[1]=a.sizeDim(2);b.rind=[];b.cind=[];b.A=[];var c=1;b.rind.push(c);for(var d=1;d<=b.sizeDim(1);d++){for(var e=1;e<=b.sizeDim(2);e++){var f=a.getIJ([d,e]);if(f!=0){b.cind.push(e);b.A.push(f);c=c+1}}b.rind.push(c)}return b},sdiag=function(a){if(a instanceof VG.Matrix){if(a.sizeDim(2)!=1)throw"sdiag: vector must be an array or a column vector";
a=a.matrix}var b=a.length,c=new VG.Sparse;c.size=[b,b];c.A=Array(b);c.cind=Array(b);c.rind=Array(b+1);for(var d=0;d<b;d++){c.A[d]=a[d];c.cind[d]=d+1;c.rind[d]=d+1}c.rind[b]=b+1;return c},spdiags=function(a,b,c){if(c.length!=2)throw"spdiags: size must equal 2";if(!a.is2D())throw"spdiags: matrix must be 2D";if(a.sizeDim(2)!=b.length)throw"spdiags: matrix columns must equal number of diagonals";if(b.join()!==b.sort().join())throw"spdiags: diagonals must be sorted.";var d=new VG.Sparse,e=c[0],f=c[1],
c=e>=f?1:0;d.size[0]=e;d.size[1]=f;d.rind=[];d.cind=[];d.A=[];e=1;d.rind.push(e);for(f=1;f<=d.sizeDim(1);f++){for(var g=0;g<b.length;g++){var h=b[g],i=f+h;if(i<=d.sizeDim(2)&&i>0){d.cind.push(i);d.A.push(a.getIJ([f+c*h,g+1]));e=e+1}}d.rind.push(e)}return d},speye=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=1;return sdiag(b)},spy=function(a){if(!a.is2D())throw"toString: Only 2D is implemented.";for(var b="",c=1;c<=a.sizeDim(1);c++){for(var d=1;d<=a.sizeDim(2);d++)b=a.getIJ([c,d])==0?b+" ":b+"*";
b=b+"\n"}console.log(b)};VG.Plane=function(){this.type="";this.D=this.C=this.B=this.A=0;this.centroid=new VG.Vector;this.normal=new VG.Vector;this.planepts=[];this.dip=this.strike=0};
VG.Plane.prototype={constructor:VG.Plane,from3Points:function(a,b,c){this.type="points";this.planepts[0]=new VG.Vector(a);this.planepts[1]=new VG.Vector(b);this.planepts[2]=new VG.Vector(c);this.centroid=new VG.Vector(this.planepts[0]);this.centroid.addSelf(this.planepts[1]);this.centroid.addSelf(this.planepts[2]);this.centroid.divideScalar(3);var d=new VG.Vector,e=new VG.Vector,f=new VG.Vector;d.sub(b,a);e.sub(c,a);d.normalize();e.normalize();f.cross(d,e);f.normalize();this.normal.copy(f);this.A=
f.x;this.B=f.y;this.C=f.z;this.calcD(a);a=getStrikeAndDipFromNormal(this.normal);this.strike=a[0];this.dip=a[1];return this},fromStrikeAndDip:function(a,b,c){c=c||new VG.Vector;this.type="SandD";this.strike=a;this.dip=b;this.centroid.copy(c);this.A=Math.sin((a+90)*Math.PI/180)*Math.sin(b*Math.PI/180);this.B=Math.cos((a+90)*Math.PI/180)*Math.sin(b*Math.PI/180);this.C=Math.cos(b*Math.PI/180);this.normal.set(this.A,this.B,this.C).normalize();this.calcD(c);return this},fromNormalAndPoint:function(a,b){b=
b||new VG.Vector;this.type="normal";this.normal.copy(a).normalize();this.A=this.normal.x;this.B=this.normal.y;this.C=this.normal.z;this.calcD(b);this.centroid=new VG.Vector(b);return this},bisectPoints:function(a,b){if(this.getDistance(a)>=0&&this.getDistance(b)>=0||this.getDistance(a)<=0&&this.getDistance(b)<=0)return null;var c=(new VG.Vector).copy(b);c.subSelf(a);c.normalize();var d=(this.A*a.x+this.B*a.y+this.C*a.z-this.D)/(-this.A*c.x-this.B*c.y-this.C*c.z);return new VG.Vector(a.x+d*c.x,a.y+
d*c.y,a.z+d*c.z)},calcD:function(a){this.D=-(this.A*-a.x+this.B*-a.y+this.C*-a.z)},getDistance:function(a){a=this.A*a.x+this.B*a.y+this.C*a.z-this.D;Math.abs(a)<1.0E-6&&(a=0);return a},onThisSideOfPlane:function(a,b){var c=this.getDistance(a);return b&&c>=0?true:!b&&c<=0?true:false},getDistanceCentroid:function(a){var b=(new VG.Vector).copy(this.centroid);b.subSelf(a);return b.length()}};VG.Vector=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
VG.Vector.prototype={constructor:VG.Vector,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addSelf:function(a){this.x=this.x+a.x;this.y=this.y+a.y;this.z=this.z+a.z;return this},addScalar:function(a){this.x=this.x+a;this.y=this.y+a;this.z=
this.z+a;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},subSelf:function(a){this.x=this.x-a.x;this.y=this.y-a.y;this.z=this.z-a.z;return this},multiply:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},multiplySelf:function(a){this.x=this.x*a.x;this.y=this.y*a.y;this.z=this.z*a.z;return this},multiplyScalar:function(a){this.x=this.x*a;this.y=this.y*a;this.z=this.z*a;return this},divideSelf:function(a){this.x=this.x/a.x;this.y=this.y/
a.y;this.z=this.z/a.z;return this},divideScalar:function(a){if(a){this.x=this.x/a;this.y=this.y/a;this.z=this.z/a}else this.z=this.y=this.x=0;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){return this.normalize().multiplyScalar(a)},lerpSelf:function(a,b){this.x=this.x+(a.x-this.x)*b;this.y=this.y+(a.y-this.y)*b;this.z=this.z+(a.z-this.z)*b;return this},cross:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},crossSelf:function(a){var b=this.x,c=this.y,d=this.z;this.x=c*a.z-d*a.y;this.y=d*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){return(new THREE.Vector3).sub(this,
a).lengthSq()},getPositionFromMatrix:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},getRotationFromMatrix:function(a,b){var c=b?b.x:1,d=b?b.y:1,e=b?b.z:1,f=a.elements[0]/c,g=a.elements[4]/d,c=a.elements[1]/c,d=a.elements[5]/d,h=a.elements[9]/e,i=a.elements[10]/e;this.y=Math.asin(a.elements[8]/e);e=Math.cos(this.y);if(Math.abs(e)>1.0E-5){this.x=Math.atan2(-h/e,i/e);this.z=Math.atan2(-g/e,f/e)}else{this.x=0;this.z=Math.atan2(c,d)}return this},getScaleFromMatrix:function(a){var b=
this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},isZero:function(){return this.lengthSq()<1.0E-4},clone:function(){return new VG.Vector(this.x,this.y,this.z)}};
VG.Matrix4=function(a,b,c,d,e,f,g,h,i,j,k,l,p,m,r,q){this.elements=new Float32Array(16);this.set(a!==void 0?a:1,b||0,c||0,d||0,e||0,f!==void 0?f:1,g||0,h||0,i||0,j||0,k!==void 0?k:1,l||0,p||0,m||0,r||0,q!==void 0?q:1)};
VG.Matrix4.prototype={constructor:VG.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,p,m,r,q){var t=this.elements;t[0]=a;t[4]=b;t[8]=c;t[12]=d;t[1]=e;t[5]=f;t[9]=g;t[13]=h;t[2]=i;t[6]=j;t[10]=k;t[14]=l;t[3]=p;t[7]=m;t[11]=r;t[15]=q;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},lookAt:function(a,b,c){var d=this.elements,e=
VG.Matrix4.__v1,f=VG.Matrix4.__v2,g=VG.Matrix4.__v3;g.sub(a,b).normalize();if(g.length()===0)g.z=1;e.cross(c,g).normalize();if(e.length()===0){g.x=g.x+1.0E-4;e.cross(c,g).normalize()}f.cross(g,e);d[0]=e.x;d[4]=f.x;d[8]=g.x;d[1]=e.y;d[5]=f.y;d[9]=g.y;d[2]=e.z;d[6]=f.z;d[10]=g.z;return this},multiply:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],p=c[13],m=c[2],r=c[6],q=c[10],t=c[14],v=c[3],w=c[7],z=c[11],c=c[15],x=d[0],A=d[4],F=d[8],C=
d[12],D=d[1],y=d[5],s=d[9],E=d[13],u=d[2],J=d[6],N=d[10],B=d[14],M=d[3],I=d[7],o=d[11],d=d[15];e[0]=f*x+g*D+h*u+i*M;e[4]=f*A+g*y+h*J+i*I;e[8]=f*F+g*s+h*N+i*o;e[12]=f*C+g*E+h*B+i*d;e[1]=j*x+k*D+l*u+p*M;e[5]=j*A+k*y+l*J+p*I;e[9]=j*F+k*s+l*N+p*o;e[13]=j*C+k*E+l*B+p*d;e[2]=m*x+r*D+q*u+t*M;e[6]=m*A+r*y+q*J+t*I;e[10]=m*F+r*s+q*N+t*o;e[14]=m*C+r*E+q*B+t*d;e[3]=v*x+w*D+z*u+c*M;e[7]=v*A+w*y+z*J+c*I;e[11]=v*F+w*s+z*N+c*o;e[15]=v*C+w*E+z*B+c*d;return this},multiplySelf:function(a){return this.multiply(this,
a)},multiplyToArray:function(a,b,c){var d=this.elements;this.multiply(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]=b[0]*a;b[4]=b[4]*a;b[8]=b[8]*a;b[12]=b[12]*a;b[1]=b[1]*a;b[5]=b[5]*a;b[9]=b[9]*a;b[13]=b[13]*a;b[2]=b[2]*a;b[6]=b[6]*a;b[10]=b[10]*a;b[14]=b[14]*a;b[3]=b[3]*a;b[7]=b[7]*a;b[11]=b[11]*a;b[15]=
b[15]*a;return this},multiplyVector:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=1/(b[3]*c+b[7]*d+b[11]*e+b[15]);a.x=(b[0]*c+b[4]*d+b[8]*e+b[12])*f;a.y=(b[1]*c+b[5]*d+b[9]*e+b[13])*f;a.z=(b[2]*c+b[6]*d+b[10]*e+b[14])*f;return a},multiplyMatrix:function(a){if(a.sizeDim(3)!==3)throw"multiplyMatrix: sizeDim(3) must equal 3";for(var b=1;b<=a.sizeDim(1);b++)for(var c=1;c<=a.sizeDim(2);c++){var d=new VG.Vector(a.getIJ([b,c,1]),a.getIJ([b,c,2]),a.getIJ([b,c,3])),d=this.multiplyVector(d);a.setIJ([b,
c,1],d.x);a.setIJ([b,c,2],d.y);a.setIJ([b,c,3],d.z)}return a},multiplyVector3Array:function(a){for(var b=VG.Matrix4.__v1,c=0,d=a.length;c<d;c=c+3){b.x=a[c];b.y=a[c+1];b.z=a[c+2];this.multiplyVector3(b);a[c]=b.x;a[c+1]=b.y;a[c+2]=b.z}return a},rotateAxis:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;a.x=c*b[0]+d*b[4]+e*b[8];a.y=c*b[1]+d*b[5]+e*b[9];a.z=c*b[2]+d*b[6]+e*b[10];a.normalize();return a},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],
j=a[2],k=a[6],l=a[10],p=a[14],m=a[3],r=a[7],q=a[11],a=a[15];return e*h*k*m-d*i*k*m-e*g*l*m+c*i*l*m+d*g*p*m-c*h*p*m-e*h*j*r+d*i*j*r+e*f*l*r-b*i*l*r-d*f*p*r+b*h*p*r+e*g*j*q-c*i*j*q-e*f*k*q+b*i*k*q+c*f*p*q-b*g*p*q-d*g*j*a+c*h*j*a+d*f*k*a-b*h*k*a-c*f*l*a+b*g*l*a},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=
this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=this.elements;
return VG.Matrix4.__v1.set(a[12],a[13],a[14])},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getColumnX:function(){var a=this.elements;return VG.Matrix4.__v1.set(a[0],a[1],a[2])},getColumnY:function(){var a=this.elements;return VG.Matrix4.__v1.set(a[4],a[5],a[6])},getColumnZ:function(){var a=this.elements;return VG.Matrix4.__v1.set(a[8],a[9],a[10])},getInverse:function(a){var b=this.elements,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[12],h=c[1],i=c[5],j=c[9],k=
c[13],l=c[2],p=c[6],m=c[10],r=c[14],q=c[3],t=c[7],v=c[11],c=c[15];b[0]=j*r*t-k*m*t+k*p*v-i*r*v-j*p*c+i*m*c;b[4]=g*m*t-f*r*t-g*p*v+e*r*v+f*p*c-e*m*c;b[8]=f*k*t-g*j*t+g*i*v-e*k*v-f*i*c+e*j*c;b[12]=g*j*p-f*k*p-g*i*m+e*k*m+f*i*r-e*j*r;b[1]=k*m*q-j*r*q-k*l*v+h*r*v+j*l*c-h*m*c;b[5]=f*r*q-g*m*q+g*l*v-d*r*v-f*l*c+d*m*c;b[9]=g*j*q-f*k*q-g*h*v+d*k*v+f*h*c-d*j*c;b[13]=f*k*l-g*j*l+g*h*m-d*k*m-f*h*r+d*j*r;b[2]=i*r*q-k*p*q+k*l*t-h*r*t-i*l*c+h*p*c;b[6]=g*p*q-e*r*q-g*l*t+d*r*t+e*l*c-d*p*c;b[10]=e*k*q-g*i*q+g*h*t-
d*k*t-e*h*c+d*i*c;b[14]=g*i*l-e*k*l-g*h*p+d*k*p+e*h*r-d*i*r;b[3]=j*p*q-i*m*q-j*l*t+h*m*t+i*l*v-h*p*v;b[7]=e*m*q-f*p*q+f*l*t-d*m*t-e*l*v+d*p*v;b[11]=f*i*q-e*j*q-f*h*t+d*j*t+e*h*v-d*i*v;b[15]=e*j*l-f*i*l+f*h*p-d*j*p-e*h*m+d*i*m;this.multiplyScalar(1/a.determinant());return this},setRotationFromEuler:function(a,b){var c=this.elements,d=a.x,e=a.y,f=a.z,g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e),i=Math.cos(f),f=Math.sin(f);if(b===void 0||b==="XYZ"){var j=g*i,k=g*f,l=d*i,p=d*f;c[0]=h*i;c[4]=
-h*f;c[8]=e;c[1]=k+l*e;c[5]=j-p*e;c[9]=-d*h;c[2]=p-j*e;c[6]=l+k*e;c[10]=g*h}else if(b==="YXZ"){j=h*i;k=h*f;l=e*i;p=e*f;c[0]=j+p*d;c[4]=l*d-k;c[8]=g*e;c[1]=g*f;c[5]=g*i;c[9]=-d;c[2]=k*d-l;c[6]=p+j*d;c[10]=g*h}else if(b==="ZXY"){j=h*i;k=h*f;l=e*i;p=e*f;c[0]=j-p*d;c[4]=-g*f;c[8]=l+k*d;c[1]=k+l*d;c[5]=g*i;c[9]=p-j*d;c[2]=-g*e;c[6]=d;c[10]=g*h}else if(b==="ZYX"){j=g*i;k=g*f;l=d*i;p=d*f;c[0]=h*i;c[4]=l*e-k;c[8]=j*e+p;c[1]=h*f;c[5]=p*e+j;c[9]=k*e-l;c[2]=-e;c[6]=d*h;c[10]=g*h}else if(b==="YZX"){j=g*h;k=g*
e;l=d*h;p=d*e;c[0]=h*i;c[4]=p-j*f;c[8]=l*f+k;c[1]=f;c[5]=g*i;c[9]=-d*i;c[2]=-e*i;c[6]=k*f+l;c[10]=j-p*f}else if(b==="XZY"){j=g*h;k=g*e;l=d*h;p=d*e;c[0]=h*i;c[4]=-f;c[8]=e*i;c[1]=j*f+p;c[5]=g*i;c[9]=k*f-l;c[2]=l*f-k;c[6]=d*i;c[10]=p*f+j}return this},extractRotation:function(a){var b=this.elements,a=a.elements,c=VG.Matrix4.__v1,d=1/c.set(a[0],a[1],a[2]).length(),e=1/c.set(a[4],a[5],a[6]).length(),c=1/c.set(a[8],a[9],a[10]).length();b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;b[4]=a[4]*e;b[5]=a[5]*e;b[6]=a[6]*
e;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;return this},translate:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[12]=b[0]*c+b[4]*d+b[8]*a+b[12];b[13]=b[1]*c+b[5]*d+b[9]*a+b[13];b[14]=b[2]*c+b[6]*d+b[10]*a+b[14];b[15]=b[3]*c+b[7]*d+b[11]*a+b[15];return this},rotateX:function(a){var b=this.elements,c=b[4],d=b[5],e=b[6],f=b[7],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);b[4]=k*c+a*g;b[5]=k*d+a*h;b[6]=k*e+a*i;b[7]=k*f+a*j;b[8]=k*g-a*c;b[9]=k*h-a*d;b[10]=k*i-a*e;b[11]=k*j-a*f;return this},
rotateY:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),a=Math.sin(a);b[0]=k*c-a*g;b[1]=k*d-a*h;b[2]=k*e-a*i;b[3]=k*f-a*j;b[8]=k*g+a*c;b[9]=k*h+a*d;b[10]=k*i+a*e;b[11]=k*j+a*f;return this},rotateZ:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=Math.cos(a),a=Math.sin(a);b[0]=k*c+a*g;b[1]=k*d+a*h;b[2]=k*e+a*i;b[3]=k*f+a*j;b[4]=k*g-a*c;b[5]=k*h-a*d;b[6]=k*i-a*e;b[7]=k*j-a*f;return this},rotateByAxis:function(a,
b){var c=this.elements;if(a.x===1&&a.y===0&&a.z===0)return this.rotateX(b);if(a.x===0&&a.y===1&&a.z===0)return this.rotateY(b);if(a.x===0&&a.y===0&&a.z===1)return this.rotateZ(b);var d=a.x,e=a.y,f=a.z,g=Math.sqrt(d*d+e*e+f*f),d=d/g,e=e/g,f=f/g,g=d*d,h=e*e,i=f*f,j=Math.cos(b),k=Math.sin(b),l=1-j,p=d*e*l,m=d*f*l,l=e*f*l,d=d*k,r=e*k,k=f*k,f=g+(1-g)*j,g=p+k,e=m-r,p=p-k,h=h+(1-h)*j,k=l+d,m=m+r,l=l-d,i=i+(1-i)*j,j=c[0],d=c[1],r=c[2],q=c[3],t=c[4],v=c[5],w=c[6],z=c[7],x=c[8],A=c[9],F=c[10],C=c[11];c[0]=
f*j+g*t+e*x;c[1]=f*d+g*v+e*A;c[2]=f*r+g*w+e*F;c[3]=f*q+g*z+e*C;c[4]=p*j+h*t+k*x;c[5]=p*d+h*v+k*A;c[6]=p*r+h*w+k*F;c[7]=p*q+h*z+k*C;c[8]=m*j+l*t+i*x;c[9]=m*d+l*v+i*A;c[10]=m*r+l*w+i*F;c[11]=m*q+l*z+i*C;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[0]=b[0]*c;b[4]=b[4]*d;b[8]=b[8]*a;b[1]=b[1]*c;b[5]=b[5]*d;b[9]=b[9]*a;b[2]=b[2]*c;b[6]=b[6]*d;b[10]=b[10]*a;b[3]=b[3]*c;b[7]=b[7]*d;b[11]=b[11]*a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*
a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,
0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*
f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){var a=c*Math.tan(a*Math.PI/360),e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/i;g[9]=0;g[13]=-((c+d)/i);g[2]=0;g[6]=0;g[10]=-2/j;g[14]=-((f+e)/j);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},clone:function(){var a=this.elements;return new VG.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],
a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};VG.Matrix4.__v1=new VG.Vector;VG.Matrix4.__v2=new VG.Vector;VG.Matrix4.__v3=new VG.Vector;VG.Matrix4.__m1=new VG.Matrix4;VG.Matrix4.__m2=new VG.Matrix4;
var ddx=function(a,b){var c=a.length;if(b=="nodal"){var d=(new VG.Matrix(a,[c,1])).repmat([1,2]);d.setAll(function(a,b,c){return c[1]==1?-1/a:1/a});return spdiags(d,[0,1],[c,c+1])}if(b=="ccn"){var e=setAll(a.slice(0,-1),function(b,c){return(b+a[c+1])/2}),d=(new VG.Matrix(e,[c-1,1])).repmat([1,2]);d.setAll(function(a,b,c){return c[1]==1?-1/a:1/a});e=(new VG.Sparse).allocate([1,c],0);return vcat([e,spdiags(d,[0,1],[c-1,c]),e])}if(b=="ccd"){e=setAll(a.slice(0,-1),function(b,c){return(b+a[c+1])/2});d=
(new VG.Matrix(e,[c-1,1])).repmat([1,2]);d.setAll(function(a,b,c){return c[1]==1?-1/a:1/a});var f=(new VG.Sparse).allocate([1,c],1).construct(1,1,2/e[0]),e=(new VG.Sparse).allocate([1,c],1).construct(1,c,-2/e[c-2]);return vcat([f,spdiags(d,[0,1],[c-1,c]),e])}if(b=="ccdBC"){e=setAll(a.slice(0,-1),function(b,c){return(b+a[c+1])/2});d=(new VG.Sparse).allocate([c+1,2],2);d.construct(1,1,-2/e[0]);d.construct(c+1,2,2/e[c-2]);return d}};VG.Delauny=function(a){a!==void 0&&this.triangulate(a)};
VG.Delauny.prototype={constructor:VG.Delauny,interp:function(a){for(var b=0;b<this.triangles.length;b++)if(this.triangles[b].inside(a,true))return this.triangles[b].interp(a,new VG.Vector(0,0,1));this.vertices.sort(function(b,c){b.__dist=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));c.__dist=Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2));return b.__dist-c.__dist});for(var c=min([20,this.vertices.length]),d=0,e=0,b=0;b<c;b++)d=d+1/Math.pow(this.vertices[b].__dist,1.3);for(b=0;b<c;b++)var f=
1/Math.pow(this.vertices[b].__dist,1.3),e=e+f*this.vertices[b].z/d;return a.clone().setZ(e)},drawCanvas:function(a){for(var b=this.triangles.length;b;)this.triangles[--b].drawCanvas(a)},triangulate:function(a){function b(a){var b=a.length,c,d,e,f,g;a:for(;b;){d=a[--b];c=a[--b];for(e=b;e;){g=a[--e];f=a[--e];if(c===f&&d===g||c===g&&d===f){a.splice(b,2);a.splice(e,2);b=b-2;continue a}}}}this.vertices=a;if(a.length<3)return[];a.sort(function(a,b){return b.x-a.x});for(var c=a.length-1,d=a[c].x,e=a[0].x,
f=a[c].y,g=f;c--;){if(a[c].y<f)f=a[c].y;if(a[c].y>g)g=a[c].y}for(var h=e-d,i=g-f,c=h>i?h:i,h=(e+d)*0.5,i=(g+f)*0.5,f=[new VG.Triangle({x:h-20*c,y:i-c,__sentinel:true},{x:h,y:i+20*c,__sentinel:true},{x:h+20*c,y:i-c,__sentinel:true})],g=[],d=[],c=a.length;c--;){d.length=0;for(e=f.length;e--;){h=a[c].x-f[e].x;if(h>0&&h*h>f[e].r){g.push(f[e]);f.splice(e,1)}else{i=a[c].y-f[e].y;if(!(h*h+i*i>f[e].r)){d.push(f[e].a,f[e].b,f[e].b,f[e].c,f[e].c,f[e].a);f.splice(e,1)}}}b(d);for(e=d.length;e;){i=d[--e];h=d[--e];
f.push(new VG.Triangle(h,i,a[c]))}}Array.prototype.push.apply(g,f);for(c=g.length;c--;)(g[c].a.__sentinel||g[c].b.__sentinel||g[c].c.__sentinel)&&g.splice(c,1);this.triangles=g;this.open=f;return g}};
VG.Triangle=function(a,b,c){this.a=a;this.b=b;this.c=c;var d=b.x-a.x,e=b.y-a.y,f=c.x-a.x,g=c.y-a.y,h=d*(a.x+b.x)+e*(a.y+b.y),i=f*(a.x+c.x)+g*(a.y+c.y),j=2*(d*(c.y-b.y)-e*(c.x-b.x));if(Math.abs(j)<1.0E-6){d=Math.min(a.x,b.x,c.x);e=Math.min(a.y,b.y,c.y);f=(Math.max(a.x,b.x,c.x)-d)*0.5;a=(Math.max(a.y,b.y,c.y)-e)*0.5;this.x=d+f;this.y=e+a}else{this.x=(g*h-e*i)/j;this.y=(d*i-f*h)/j;f=this.x-a.x;a=this.y-a.y}this.r=f*f+a*a};
VG.Triangle.prototype={constructor:VG.Triangle,inside:function(a,b){var c=new VG.Vector,d=new VG.Vector,e=new VG.Vector,f=new VG.Vector(this.a.x,this.a.y,b===true?0:this.a.z),g=new VG.Vector(this.b.x,this.b.y,b===true?0:this.b.z),h=new VG.Vector(this.c.x,this.c.y,b===true?0:this.c.z),i=new VG.Vector(a.x,a.y,b===true?0:a.z);c.sub(h,f);d.sub(g,f);e.sub(i,f);f=c.dot(c);g=c.dot(d);c=c.dot(e);h=d.dot(d);d=d.dot(e);e=1/(f*h-g*g);h=(h*c-g*d)*e;d=(f*d-g*c)*e;return h+1.0E-5>=0&&d+1.0E-5>=0&&h+d-2.0E-5<=1},
getZ:function(){var a=0,b=0;if(this.a.z!==void 0){b=b+1;a=a+this.a.z}if(this.b.z!==void 0){b=b+1;a=a+this.b.z}if(this.c.z!==void 0){b=b+1;a=a+this.c.z}return a/b},interp:function(a,b){var c=this.normal(),b=b===void 0?c.clone():b.clone().normalize(),d=b.dot(c);if(d===0)return null;c=(new VG.Vector).sub(this.a,a).dot(c)/d;return a.clone().addSelf(b.setLength(c))},normal:function(){var a=(new VG.Vector).sub(this.b,this.a).normalize(),b=(new VG.Vector).sub(this.c,this.a).normalize();return(new VG.Vector).cross(a,
b).normalize()},drawCanvas:function(a){a.beginPath();a.moveTo(this.a.x,this.a.y);a.lineTo(this.b.x,this.b.y);a.lineTo(this.c.x,this.c.y);a.closePath();a.stroke()}};
VG.ColorMap={numberOfDefaults:13,names:"Jet,HSV,Hot,Cool,Spring,Summer,Autumn,Winter,Gray,Bone,Copper,Pink,Lines".split(","),getColorMap:function(a){switch(a){case 0:return VG.ColorMap.Jet();case 1:return VG.ColorMap.HSV();case 2:return VG.ColorMap.Hot();case 3:return VG.ColorMap.Cool();case 4:return VG.ColorMap.Spring();case 5:return VG.ColorMap.Summer();case 6:return VG.ColorMap.Autumn();case 7:return VG.ColorMap.Winter();case 8:return VG.ColorMap.Gray();case 9:return VG.ColorMap.Bone();case 10:return VG.ColorMap.Copper();
case 11:return VG.ColorMap.Pink();case 12:return VG.ColorMap.Lines();default:return null}},Jet:function(){return new VG.Matrix([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9375,0.875,0.8125,0.75,0.6875,0.625,0.5625,0.5,0,0,0,0,0,0,0,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9375,
0.875,0.8125,0.75,0.6875,0.625,0.5625,0.5,0.4375,0.375,0.3125,0.25,0.1875,0.125,0.0625,0,0,0,0,0,0,0,0,0,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9375,0.875,0.8125,0.75,0.6875,0.625,0.5625,0.5,0.4375,0.375,0.3125,0.25,0.1875,0.125,0.0625,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[64,3])},HSV:function(){return new VG.Matrix([1,1,1,1,1,1,1,1,1,1,1,0.9688,0.875,0.7812,0.6875,0.5938,0.5,0.4062,0.3125,0.2188,0.125,0.0312,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0.0312,0.125,0.2188,0.3125,0.4062,0.5,0.5938,0.6875,0.7812,0.875,0.9688,1,1,1,1,1,1,1,1,1,1,0,0.0938,0.1875,0.2812,0.375,0.4688,0.5625,0.6562,0.75,0.8438,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9062,0.8125,0.7188,0.625,0.5312,0.4375,0.3438,0.25,0.1562,0.0625,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.1562,0.25,0.3438,0.4375,0.5312,0.625,0.7188,0.8125,0.9062,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9375,0.8438,0.75,0.6562,
0.5625,0.4688,0.375,0.2812,0.1875,0.0938],[64,3])},Hot:function(){return new VG.Matrix([0.0417,0.0833,0.125,0.1667,0.2083,0.25,0.2917,0.3333,0.375,0.4167,0.4583,0.5,0.5417,0.5833,0.625,0.6667,0.7083,0.75,0.7917,0.8333,0.875,0.9167,0.9583,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0417,0.0833,0.125,0.1667,0.2083,0.25,0.2917,0.3333,0.375,0.4167,0.4583,0.5,0.5417,0.5833,0.625,0.6667,0.7083,0.75,0.7917,0.8333,0.875,
0.9167,0.9583,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1],[64,3])},Cool:function(){return new VG.Matrix([0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,
0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,1,0.9841,0.9683,0.9524,0.9365,0.9206,0.9048,0.8889,0.873,0.8571,0.8413,0.8254,0.8095,0.7937,0.7778,0.7619,0.746,0.7302,0.7143,0.6984,0.6825,0.6667,0.6508,0.6349,0.619,0.6032,0.5873,0.5714,0.5556,0.5397,0.5238,0.5079,0.4921,0.4762,0.4603,0.4444,0.4286,0.4127,0.3968,0.381,0.3651,0.3492,
0.3333,0.3175,0.3016,0.2857,0.2698,0.254,0.2381,0.2222,0.2063,0.1905,0.1746,0.1587,0.1429,0.127,0.1111,0.0952,0.0794,0.0635,0.0476,0.0317,0.0159,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[64,3])},Spring:function(){return new VG.Matrix([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,
0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,1,0.9841,0.9683,0.9524,0.9365,0.9206,0.9048,0.8889,0.873,0.8571,0.8413,0.8254,0.8095,0.7937,0.7778,0.7619,0.746,0.7302,0.7143,
0.6984,0.6825,0.6667,0.6508,0.6349,0.619,0.6032,0.5873,0.5714,0.5556,0.5397,0.5238,0.5079,0.4921,0.4762,0.4603,0.4444,0.4286,0.4127,0.3968,0.381,0.3651,0.3492,0.3333,0.3175,0.3016,0.2857,0.2698,0.254,0.2381,0.2222,0.2063,0.1905,0.1746,0.1587,0.1429,0.127,0.1111,0.0952,0.0794,0.0635,0.0476,0.0317,0.0159,0],[64,3])},Summer:function(){return new VG.Matrix([0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,
0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,0.5,0.5079,0.5159,0.5238,0.5317,0.5397,0.5476,0.5556,0.5635,0.5714,0.5794,0.5873,0.5952,0.6032,0.6111,0.619,0.627,0.6349,0.6429,0.6508,0.6587,0.6667,0.6746,0.6825,0.6905,0.6984,0.7063,0.7143,0.7222,0.7302,0.7381,0.746,
0.754,0.7619,0.7698,0.7778,0.7857,0.7937,0.8016,0.8095,0.8175,0.8254,0.8333,0.8413,0.8492,0.8571,0.8651,0.873,0.881,0.8889,0.8968,0.9048,0.9127,0.9206,0.9286,0.9365,0.9444,0.9524,0.9603,0.9683,0.9762,0.9841,0.9921,1,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4],[64,3])},Autumn:function(){return new VG.Matrix([1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,
0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[64,3])},Winter:function(){return new VG.Matrix([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,
0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,1,0.9921,0.9841,0.9762,0.9683,0.9603,0.9524,0.9444,0.9365,0.9286,0.9206,0.9127,0.9048,0.8968,0.8889,0.881,0.873,0.8651,0.8571,0.8492,0.8413,0.8333,0.8254,0.8175,0.8095,0.8016,0.7937,0.7857,0.7778,0.7698,0.7619,
0.754,0.746,0.7381,0.7302,0.7222,0.7143,0.7063,0.6984,0.6905,0.6825,0.6746,0.6667,0.6587,0.6508,0.6429,0.6349,0.627,0.619,0.6111,0.6032,0.5952,0.5873,0.5794,0.5714,0.5635,0.5556,0.5476,0.5397,0.5317,0.5238,0.5159,0.5079,0.5],[64,3])},Gray:function(){return new VG.Matrix([0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,
0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,
0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1,0,0.0159,0.0317,0.0476,0.0635,0.0794,0.0952,0.1111,0.127,0.1429,0.1587,0.1746,0.1905,0.2063,0.2222,0.2381,0.254,0.2698,0.2857,0.3016,0.3175,0.3333,0.3492,0.3651,0.381,0.3968,0.4127,0.4286,0.4444,0.4603,0.4762,0.4921,0.5079,0.5238,0.5397,0.5556,0.5714,0.5873,0.6032,0.619,0.6349,0.6508,0.6667,0.6825,0.6984,0.7143,0.7302,0.746,0.7619,0.7778,0.7937,0.8095,0.8254,0.8413,
0.8571,0.873,0.8889,0.9048,0.9206,0.9365,0.9524,0.9683,0.9841,1],[64,3])},Bone:function(){return new VG.Matrix([0,0.0139,0.0278,0.0417,0.0556,0.0694,0.0833,0.0972,0.1111,0.125,0.1389,0.1528,0.1667,0.1806,0.1944,0.2083,0.2222,0.2361,0.25,0.2639,0.2778,0.2917,0.3056,0.3194,0.3333,0.3472,0.3611,0.375,0.3889,0.4028,0.4167,0.4306,0.4444,0.4583,0.4722,0.4861,0.5,0.5139,0.5278,0.5417,0.5556,0.5694,0.5833,0.5972,0.6111,0.625,0.6389,0.6528,0.6745,0.6962,0.7179,0.7396,0.7613,0.783,0.8047,0.8264,0.8481,0.8698,
0.8915,0.9132,0.9349,0.9566,0.9783,1,0,0.0139,0.0278,0.0417,0.0556,0.0694,0.0833,0.0972,0.1111,0.125,0.1389,0.1528,0.1667,0.1806,0.1944,0.2083,0.2222,0.2361,0.25,0.2639,0.2778,0.2917,0.3056,0.3194,0.3385,0.3576,0.3767,0.3958,0.4149,0.434,0.4531,0.4722,0.4913,0.5104,0.5295,0.5486,0.5677,0.5868,0.6059,0.625,0.6441,0.6632,0.6823,0.7014,0.7205,0.7396,0.7587,0.7778,0.7917,0.8056,0.8194,0.8333,0.8472,0.8611,0.875,0.8889,0.9028,0.9167,0.9306,0.9444,0.9583,0.9722,0.9861,1,0.0052,0.0243,0.0434,0.0625,0.0816,
0.1007,0.1198,0.1389,0.158,0.1771,0.1962,0.2153,0.2344,0.2535,0.2726,0.2917,0.3108,0.3299,0.349,0.3681,0.3872,0.4062,0.4253,0.4444,0.4583,0.4722,0.4861,0.5,0.5139,0.5278,0.5417,0.5556,0.5694,0.5833,0.5972,0.6111,0.625,0.6389,0.6528,0.6667,0.6806,0.6944,0.7083,0.7222,0.7361,0.75,0.7639,0.7778,0.7917,0.8056,0.8194,0.8333,0.8472,0.8611,0.875,0.8889,0.9028,0.9167,0.9306,0.9444,0.9583,0.9722,0.9861,1],[64,3])},Copper:function(){return new VG.Matrix([0,0.0198,0.0397,0.0595,0.0794,0.0992,0.119,0.1389,0.1587,
0.1786,0.1984,0.2183,0.2381,0.2579,0.2778,0.2976,0.3175,0.3373,0.3571,0.377,0.3968,0.4167,0.4365,0.4563,0.4762,0.496,0.5159,0.5357,0.5556,0.5754,0.5952,0.6151,0.6349,0.6548,0.6746,0.6944,0.7143,0.7341,0.754,0.7738,0.7937,0.8135,0.8333,0.8532,0.873,0.8929,0.9127,0.9325,0.9524,0.9722,0.9921,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0.0124,0.0248,0.0372,0.0496,0.062,0.0744,0.0868,0.0992,0.1116,0.124,0.1364,0.1488,0.1612,0.1736,0.186,0.1984,0.2108,0.2232,0.2356,0.248,0.2604,0.2728,0.2852,0.2976,0.31,0.3224,0.3348,
0.3472,0.3596,0.372,0.3844,0.3968,0.4092,0.4216,0.434,0.4464,0.4588,0.4712,0.4836,0.496,0.5084,0.5208,0.5332,0.5456,0.558,0.5704,0.5828,0.5952,0.6076,0.62,0.6324,0.6448,0.6572,0.6696,0.682,0.6944,0.7068,0.7192,0.7316,0.744,0.7564,0.7688,0.7812,0,0.0079,0.0158,0.0237,0.0316,0.0395,0.0474,0.0553,0.0632,0.0711,0.079,0.0869,0.0948,0.1027,0.1106,0.1185,0.1263,0.1342,0.1421,0.15,0.1579,0.1658,0.1737,0.1816,0.1895,0.1974,0.2053,0.2132,0.2211,0.229,0.2369,0.2448,0.2527,0.2606,0.2685,0.2764,0.2843,0.2922,
0.3001,0.308,0.3159,0.3238,0.3317,0.3396,0.3475,0.3554,0.3633,0.3712,0.379,0.3869,0.3948,0.4027,0.4106,0.4185,0.4264,0.4343,0.4422,0.4501,0.458,0.4659,0.4738,0.4817,0.4896,0.4975],[64,3])},Pink:function(){return new VG.Matrix([0.1179,0.1959,0.2507,0.2955,0.3343,0.3691,0.4009,0.4303,0.4579,0.4839,0.5085,0.532,0.5546,0.5762,0.5971,0.6172,0.6367,0.6557,0.6741,0.692,0.7094,0.7265,0.7431,0.7594,0.7664,0.7732,0.78,0.7868,0.7935,0.8001,0.8067,0.8133,0.8197,0.8262,0.8325,0.8389,0.8452,0.8514,0.8576,0.8637,
0.8698,0.8759,0.8819,0.8879,0.8938,0.8997,0.9056,0.9114,0.9172,0.923,0.9287,0.9344,0.94,0.9456,0.9512,0.9567,0.9623,0.9677,0.9732,0.9786,0.984,0.9894,0.9947,1,0,0.1029,0.1455,0.1782,0.2057,0.23,0.252,0.2722,0.291,0.3086,0.3253,0.3412,0.3563,0.3709,0.3849,0.3984,0.4115,0.4241,0.4364,0.4484,0.46,0.4714,0.4825,0.4933,0.5175,0.5407,0.5628,0.5842,0.6048,0.6247,0.644,0.6627,0.6809,0.6986,0.7159,0.7328,0.7493,0.7655,0.7813,0.7968,0.812,0.827,0.8416,0.856,0.8702,0.8842,0.8979,0.9114,0.9172,0.923,0.9287,0.9344,
0.94,0.9456,0.9512,0.9567,0.9623,0.9677,0.9732,0.9786,0.984,0.9894,0.9947,1,0,0.1029,0.1455,0.1782,0.2057,0.23,0.252,0.2722,0.291,0.3086,0.3253,0.3412,0.3563,0.3709,0.3849,0.3984,0.4115,0.4241,0.4364,0.4484,0.46,0.4714,0.4825,0.4933,0.504,0.5143,0.5245,0.5345,0.5443,0.554,0.5634,0.5727,0.5819,0.5909,0.5998,0.6086,0.6172,0.6257,0.6341,0.6424,0.6506,0.6587,0.6667,0.6746,0.6824,0.6901,0.6977,0.7052,0.7272,0.7485,0.7692,0.7893,0.809,0.8282,0.8469,0.8653,0.8832,0.9008,0.9181,0.9351,0.9517,0.9681,0.9842,
1],[64,3])},Lines:function(){return new VG.Matrix([0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,1,0,0.75,0.75,0.25,0,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,0.5,0,0.75,0,0.75,0.25,0,1,0,0,0.75,0.75,
0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1,0,0,0.75,0.75,0,0.25,1],[64,3])}};VG.ColorBar=function(a,b,c){this.colorMap=a||VG.ColorMap.Jet;this.setCLim(b!=void 0?b:0,c!=void 0?c:1);this.ignoreValue=null;this.numberFormat=new VG.NumberFormat("0.00");this.updateHandlers=[];this.showingColorBars=false};
VG.ColorBar.prototype={constructor:VG.ColorBar,setCLim:function(a,b){this.caxis=[a,b];this.range=b-a},getHex:function(a){a=this.getColor(a);return rgbToHex(Math.floor(a[0]*255),Math.floor(a[1]*255),Math.floor(a[2]*255))},getColor:function(a){if(this.ignoreValue!=null&&abs(a-this.ignoreValue)<1.0E-13)return[0,0,0];var b=(a-this.caxis[0])/this.range,c=this.colorMap.sizeDim(1),a=Math.floor(b*c),d=Math.ceil(b*c),a=Math.min(Math.max(a,1),c),d=Math.min(Math.max(d,1),c),a=this.colorMap.getRowArray(a),e=
this.colorMap.getRowArray(d),d=d-b*c,b=a[0]*d+e[0]*(1-d),c=a[1]*d+e[1]*(1-d),a=a[2]*d+e[2]*(1-d),b=Math.min(Math.max(b,0),1),c=Math.min(Math.max(c,0),1),a=Math.min(Math.max(a,0),1);return[b,c,a]},createViewer:function(a,b,c){var d=this;this.logScale=a;c=c===void 0?7:c;a=$("<div>");if(b)for(var e=VG.ColorMap.numberOfDefaults-1;e>=0;e--){var f=this.createBar(VG.ColorMap.getColorMap(e),25,c);f.hide();f.click(function(a){return function(){d.colorMap=VG.ColorMap.getColorMap(a);d.fireColorBarChangeEvent();
d.showingColorBars=false}}(e));a.append(f)}e=this.createBar(this.colorMap,25,c);if(b){e.css({cursor:"pointer"});e.click(function(){d.toggleShowColorBars()})}a.append(e);a.css({top:"50%","margin-top":-c*this.colorMap.sizeDim(1)/2,right:25,position:"absolute",overflow:"visible",height:c*this.colorMap.sizeDim(1),width:b?140:60});for(c=0;c<=100;c=c+25)this.createText(c,a,b);this.hoverValue=$("<div>");this.hoverValue.addClass("hoverValue");a.append(this.hoverValue);return this.panel=a},addLabel:function(a){this.panel!==
void 0&&this.panel.append($("<div>").html(a).addClass("colorBarLabel"))},alignTop:function(){this.panel.css({"margin-top":""})},addHandler:function(a){this.updateHandlers.push(a)},fireColorBarChangeEvent:function(){for(var a=0;a<this.updateHandlers.length;a++)this.updateHandlers[a]()},setHoverValue:function(a){a=(a-this.caxis[0])/this.range;a>=0&&a<=1&&this.hoverValue.css({bottom:a*100+"%"})},toggleShowColorBars:function(){var a=$(".colorBar");if(this.showingColorBars){for(c=0;c<a.length;c++)$(a[c]).stop().animate({left:0});
this.showingColorBars=false;(new VG.Timer(function(){a.hide();a.last().show()})).schedule(600)}else{a.show();this.showingColorBars=true;for(var b=35*VG.ColorMap.numberOfDefaults,c=0;c<a.length;c++){$(a[c]).stop().animate({left:-b});b=b-35}}},createBar:function(a,b,c){for(var d=$("<table>"),e=a.sizeDim(1);e>0;e--){var f=$("<tr>");f.html("<td></td>");var g=a.getRow(e);f.css({height:c,width:b,"font-size":c,"background-color":rgbToHex(Math.floor(g.get(1)*255),Math.floor(g.get(2)*255),Math.floor(g.get(3)*
255))});d.append(f)}d.addClass("colorBar");d.css({width:b+2,height:c*a.sizeDim(1)});return d},createText:function(a,b,c){var d=this,e=this.range*(a/100)+this.caxis[0];this.logScale&&(e=Math.pow(10,e));if(c&&(a==0||a==100)){var f=$("<input>");f.attr("value",this.numberFormat.format(e));f.addClass("hoverTextBox");a==0?f.blur(function(){var a=parseFloat(f.val());if(isNaN(a))f.attr("value",d.getFormattedMin(d.logScale));else{d.logScale&&(a=log10(a));d.setCLim(a,d.caxis[1]);d.fireColorBarChangeEvent()}}):
a==100&&f.blur(function(){var a=parseFloat(f.val());if(isNaN(a))f.attr("value",d.getFormattedMax(d.logScale));else{d.logScale&&(a=log10(a));d.setCLim(d.caxis[0],a);d.fireColorBarChangeEvent()}});f.css({position:"absolute",bottom:a+"%",left:30,"font-size":12,"margin-bottom":-8});b.append(f)}else{c=$("<div>");c.html(this.numberFormat.format(e));c.css({position:"absolute",bottom:a+"%",left:34,"font-size":12,"margin-bottom":-6});b.append(c)}},getFormattedMin:function(){return this.logScale?this.numberFormat.format(Math.pow(10,
this.caxis[0])):this.numberFormat.format(this.caxis[0])},getFormattedMax:function(){return this.logScale?this.numberFormat.format(Math.pow(10,this.caxis[1])):this.numberFormat.format(this.caxis[1])}};VG.Canvas=function(a,b){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.setSize(a,b);this.res=1};
VG.Canvas.prototype={constructor:VG.Canvas,colorPixels:function(a){for(var b=0;b<this.canvas.width;b=b+this.res)for(var c=0;c<this.canvas.height;c=c+this.res){var d=a(b+this.res/2,c+this.res/2,b/this.res,c/this.res);this.context.fillStyle="rgb("+Math.floor(d[0]*255)+","+Math.floor(d[1]*255)+","+Math.floor(d[2]*255)+")";this.context.fillRect(b,c,this.res,this.res);this.context.fill()}return this.canvas.toDataURL("image/png")},setSize:function(a,b){this.canvas.width=a?a:100;this.canvas.height=b?b:100},
writeText:function(a,b){this.context.font=b+"pt Helvetica";this.context.fillStyle="#abc789";this.canvas.width=this.context.measureText(a).width;this.canvas.height=b*1.3*96/72;this.context.font=b+"pt Helvetica";this.context.fillStyle="#000000";this.context.fillText(a,0,b*96/72)}};
VG.Login=function(){this.info={sessionID:$.cookie("sid")};var a=this;$(VG.Bus).bind("loginInfoChangeEvent",function(b,c){a.info=c;if(c!==null&&c.sessionID!==void 0){$.cookie("sid",c.sessionID,{expires:30});$(VG.Bus).trigger("login",[c]);$("#loginInfo").html(c.firstName+" "+c.lastName)}else{$.cookie("sid",null);$("#loginInfo").html("")}});$(VG.Bus).bind("loginFailedEvent",function(){(new VG.Notify("Login Failed","The username/password combination was not recognized.")).subTheme("Error")});this.passiveLogin()};
VG.Login.prototype={constructor:VG.Login,createRegisterBox:function(a){var b=new VG.Input(a),c=this;b.addTextInput(["First Name","firstname"],"");b.addTextInput(["Last Name","lastname"],"");b.addTextInput(["Organization","university"],"");b.addOptionInput(["I am a","usertype"],["Student","Teacher","Professional","Avid Enthusiast"]);var d=b.addTextInput("Email","",emailRegExp,false,"Email in use");d.element.change(function(){c.checkEmail(d.getValue())});$(VG.Bus).bind("emailInUseEvent",function(){b.setError(4,
"Email in use")});$(VG.Bus).bind("emailNotFoundEvent",function(){b.clearError(4);b.checkList[4].validate()});b.addTextInput("Password","",null,true);b.addButton("Create Account",function(a,b){b&&c.register(a)});return b},createLoginBox:function(a,b){if(this.info!==null&&this.info.sessionID!==null)return this.createLogoutBox(a);var c=new VG.Input(a),d=this;c.addTextInput("Email","",emailRegExp);c.addTextInput("Password","",null,true);c.addButton("Login",function(a,b){if(b){d.login(a.email,a.password);
VG.Notify.closeAll()}});if(b){c.addText("Don't have an account?");c.addButton("Sign Up",function(){VG.Notify.closeAll();(new VG.Notify("Sign Up","",d.createRegisterBox().panel)).subTheme("Warn")})}return c},createLogoutBox:function(a){a=new VG.Input(a);a.addText("You are currently logged in.");var b=this;a.addButton("Logout",function(){b.logout();VG.Notify.closeAll()});return a},register:function(a){$.getJSON("loginService",{requestType:"register",firstName:a.firstname,lastName:a.lastname,emailAddress:a.email,
password:a.password,university:a.university,userDescription:a.usertype},function(a){if(a===null)$(VG.Bus).trigger("emailInUseEvent");else{VG.Notify.closeAll();$(VG.Bus).trigger("loginInfoChangeEvent",[a])}})},checkEmail:function(a){$.getJSON("loginService",{requestType:"checkEmail",emailAddress:a},function(a){a!==null?$(VG.Bus).trigger("emailInUseEvent"):$(VG.Bus).trigger("emailNotFoundEvent")})},resetPassword:function(a){$.getJSON("loginService",{requestType:"checkEmail",emailAddress:a},function(a){a===
null?$(VG.Bus).trigger("emailNotFoundEvent"):$(VG.Bus).trigger("passwordResetEvent")})},login:function(a,b){$.getJSON("loginService",{requestType:"validate",emailAddress:a,password:b},function(a){$(VG.Bus).trigger("loginInfoChangeEvent",[a]);a===null&&$(VG.Bus).trigger("loginFailedEvent")})},passiveLogin:function(){this.info={sessionID:$.cookie("sid")};this.info.sessionID!==null&&$.getJSON("loginService",{requestType:"validate",sessionID:this.info.sessionID},function(a){$(VG.Bus).trigger("loginInfoChangeEvent",
[a])})},logout:function(){this.info.sessionID===null&&$.cookie("sid")===null||$.getJSON("loginService",{requestType:"logout",sessionID:this.info.sessionID},function(a){$(VG.Bus).trigger("logoutEvent",[a])})},isLoggedIn:function(){return!(this.info===null||this.info.sessionID===void 0||this.info.sessionID===null||this.info.sessionID.length===0)}};
var Contact=function(a,b){function c(a,b,d){if(a===-1)for(a=0;a<m.length;a++)c(a,b,d);else{b?m[a].addClass("emailError"):m[a].removeClass("emailError");d!==void 0&&b?i.html(d):i.html("")}}function d(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a);c(1,!b&&a.length>0,"Please enter a valid email.");return b}var e=this,f=a===void 0?"":a;e.mailService=b===void 0?"email.php":b;var g=
$('<div id="emailDiv">'),h=$('<div id="emailForm">'),i=$('<div id="emailError">');h.append(i);var j=$('<textarea placeholder="Message goes here!" id="emailMessage" tabindex="3" class="emailFormInput">');h.append(j);var k=$('<input type="text" placeholder="Name" id="emailName" tabindex="1" class="emailFormInput">');h.append(k);h.append($("<br>"));var l=$('<input type="email" placeholder="Email" id="emailAddress" tabindex="2" class="emailFormInput">');h.append(l);h.append($("<br>"));sendEmailButton=
$('<input id="sendEmailButton" type="submit" value="Send" class="emailFormInput">');h.append(sendEmailButton);var p=$('<div id="emailSent">');p.append($("<span>").html("Sending mail..."));p.append($("<span>").html("There was an error sending the email. Please refresh and try again later."));p.append($("<span>").html("Thank you for contacting me, I will try to get back to you soon."));g.append(h).append(p);this.closeLink=$('<div id="emailCloseFeedback" class="emailButton">').html("Close").hide();this.div=
g;this.button=sendEmailButton;this.emailError=i;this.modal=$('<div class="contact_modal" style="position: fixed; width: 100%; height: 100%; background-color: rgb(0, 0, 0); z-index: 1000; opacity: 0.3; left: 0px; top: 0px;">');var m=[k,l,j];this.ids=m;this.changeError=c;m[0].keypress(function(){c(0,false)});m[1].blur(function(){d($(this).val())});m[2].keypress(function(){c(2,false)});e._open=function(){sendEmailButton.val("Send");g.animate({left:0},500,"swing");e.isClosed=false;e.closeLink.show();
$("body").prepend(e.modal.show()).fadeIn();e.modal.click(function(){e.closeFeedback()})};sendEmailButton.click(function(){function a(b){l.hide();b.sent?$(l[2]).show():$(l[1]).show();if(e.isFeedback&&b.sent){c(-1,false);m[2].val("");setTimeout(function(){g.children().css({position:"relative"}).animate({top:0},500,"swing",function(){e.closeFeedback()})},1500)}}function b(c){var d={sent:false};try{d.sent=c.sent}catch(e){try{d=JSON.parse(c)}catch(f){}}a(d)}if(e.isFeedback&&e.isClosed)e.open();else{c(0,
m[0].val().length===0);c(2,m[2].val().length===0);var h=d(m[1].val());c(1,!h||m[1].val().length===0,"Please enter a valid email.");if(!h||m[0].val().length===0||m[2].val().length===0){if(i.html().length===0){var h=m[0].val().length===0?"name":"",j=m[2].val().length===0?"message":"",k=m[0].val().length===0&&m[2].val().length===0?" and ":"";i.html("Please enter your "+h+k+j+".")}}else{var l=p.children().hide();l.first().show();g.children().css({position:"relative"}).animate({top:-150},500,"swing");
h={name:m[0].val(),email:m[1].val(),comments:m[2].val(),subject:f};try{$.post(e.mailService,h,b)}catch(x){a({sent:false})}}}})};
Contact.prototype={constructor:Contact,makeFeedback:function(){var a=this;this.isClosed=this.isFeedback=true;this.div.css({position:"fixed","z-index":1001,bottom:40,left:-661});this.button.val("Feedback");a.closeLink.click(function(){a.closeFeedback()});this.div.children().first().append(this.closeLink);$("body").append(this.div)},closeFeedback:function(){this.changeError(-1,false);this.isClosed=true;this.emailError.html("");this.button.val("Feedback");this.div.animate({left:-661},500,"swing");this.modal.fadeOut(500,
function(){$(this).remove()});this.closeLink.hide()},set:function(a,b){this.ids[0].val(a);this.ids[1].val(b)},open:function(){this._open()}};VG.Request=function(a,b,c){this.success=b;this.fail=c===void 0?function(){VG.Notify.Error()}:c;this.loginInfo=a===void 0?{}:a;this.url="requestData";var d=this;this.response=function(a){a===null?d.fail():d.success(a)}};
VG.Request.prototype={constructor:VG.Request,groupData:function(a){a!==void 0&&a.length===8?this.getListByProperty("group","code","string",a):a!==void 0&&a==="ALL"?$.getJSON(this.url,{requestType:"getList",entityName:"group"},this.response):a!==void 0?$.getJSON(this.url,{requestType:"getbyid",entityName:"group",id:a,sid:this.loginInfo.sessionID},this.response):$.getJSON(this.url,{requestType:"getListByUser",entityName:"group",sid:this.loginInfo.sessionID},this.response)},groupMemberData:function(a){this.getListByProperty("groupMember",
"code","string",a)},getListByProperty:function(a,b,c,d){$.getJSON(this.url,{requestType:"getListByProperty",entityName:a,property:b,propertyType:c,equalsThis:d,sid:this.loginInfo.sessionID},this.response)}};VG.Alt=function(a,b){this.element=a;this.alt=$("<div>").addClass("altTip");this.showTimer=new VG.Timer(function(){c.show()});this.changeString(b);var c=this;$(this.element).bind({mouseover:function(a){c.mouseover(a)},mouseleave:function(a){c.mouseleave(a)},mousemove:function(a){c.mousemove(a)}})};
VG.Alt.prototype={constructor:VG.Alt,mouseover:function(a){this.x=a.pageX;this.y=a.pageY;this.showTimer.schedule(700)},mouseleave:function(){this.showTimer.cancel();this.hide()},mousemove:function(a){this.x=a.pageX;this.y=a.pageY},changeString:function(a){this.alt.html(a)},hide:function(){this.alt.remove()},show:function(){$("body").append(this.alt);this.updatePosition()},updatePosition:function(){if(this.alt.parent().length>0){var a=$(window).width(),b=$(window).height(),c=$(this.alt).width(),d=
$(this.alt).height(),e=this.x,f=this.y;this.x+c*1.3>a&&(e=e-c*1.3);this.y+d*2>b&&(f=f-d*2);$(this.alt).css({top:f+"px",left:e+"px"})}}};
VG.Slider=function(a,b,c){if(c.range==void 0)c.range="min";if(c.animate==void 0)c.animate=true;if(c.step==void 0)c.step=0.1;this.container=a.length>0?$(a):$("<div>");this.isRange=c.range===true?true:false;this.numberFormat=new VG.NumberFormat("000");var d=this;this.slideHandlers=[];c.slide!==void 0&&this.slideHandlers.push(c.slide);c.slide=function(a,b){for(var c=d.slideHandlers.length-1;c>=0;c--)d.slideHandlers[c](a,b);d.setText()};this.changeHandlers=[];c.change!==void 0?this.changeHandlers.push(c.change):
this.changeHandlers.push(c.slide);c.change=function(a,b){if(d.firedFromTextBox){for(var c=d.slideHandlers.length-1;c>=0;c--)d.slideHandlers[c](a,b);d.firedFromTextBox=false}for(c=d.changeHandlers.length-1;c>=0;c--)d.changeHandlers[c](a,b);d.setText()};this.label=$("<span>").addClass("ui-slider-text").html(b+":").width(65).height(16);this.container.append(this.label);this.slider=$("<div>").slider(c).width(200);this.container.append(this.slider);this.text=$("<input>").addClass("hoverTextBox").width(60).height(13).css({position:"relative",
top:-4});this.container.append(this.text);this.text.change(function(){d.parseText($(d.text).attr("value"))});this.options=c;this.setText()};
VG.Slider.prototype={constructor:VG.Slider,setText:function(){this.isRange?this.text.attr("value",this.numberFormat.format(this.values())):this.text.attr("value",this.numberFormat.format(this.value()))},setNumberFormat:function(a){this.numberFormat=a;this.setText()},value:function(a){if(a==void 0)return $(this.slider).slider("value");$(this.slider).slider("value",a);this.setText()},values:function(a){if(a==void 0)return $(this.slider).slider("values");$(this.slider).slider("values",a);this.setText()},
parseText:function(a){if(this.isRange)try{if(a.split("-").length==2){var b=parseFloat(a.split("-")[0]),c=parseFloat(a.split("-")[1]);if(!isNaN(b)&&!isNaN(c)){this.firedFromTextBox=true;this.values([Math.min(b,c),Math.max(b,c)])}}}catch(d){}else try{var e=parseFloat(a);if(!isNaN(e)){this.firedFromTextBox=true;this.value(e)}}catch(f){}this.setText()}};
VG.Input=function(a,b){this.panel=a===void 0?$("<div>"):$("#"+a);this.widths=b===void 0?[100,200,100]:b;this.panel.addClass("ui-input").width(sum(this.widths));this.checkList=[];this.goFlags=[]};
VG.Input.prototype={constructor:VG.Input,validate:function(){for(var a=0;a<this.checkList.length;a++)this.checkList[a].validate();for(a=0;a<this.goFlags.length;a++)if(!this.goFlags[a]){this.checkList[a].element.focus();return false}return true},getValues:function(){for(var a=0,b={};a<this.checkList.length;a++)b[this.checkList[a].getJSONid()]=this.checkList[a].getValue();return b},createContainer:function(){return $("<div>").addClass("ui-input-container").width(sum(this.widths)).height(40)},addText:function(a){var b=
this.createContainer().height(""),a=$("<span>").addClass("ui-input-text").html(a).width(sum(this.widths)).height(16);b.append(a);this.panel.append(b);return b},addTextInput:function(a,b,c,d,e){a instanceof Array||(a=[a,a.replace(" ","").toLowerCase()]);var c=c===void 0?null:c,b=b===void 0?"":b,d=d===void 0?false:d,e=e===void 0?null:e,f=this.checkList.length,g=this,h=this.createContainer(),i=$("<span>").addClass("ui-input-text").html(a[0]+":").width(this.widths[0]).height(16);h.append(i);var j=$("<input>").addClass("textBox").width(this.widths[1]-
12).val(b);d&&j.attr("type","password");h.append(j);var k=$("<div>").addClass("ui-input-error").width(this.widths[2]-5).height(13);h.append(k);var l={container:h,label:i,element:j,error:k,getName:function(){return a[0]},getJSONid:function(){return a[1]},getValue:function(){return $(j).val()},validate:function(){$(j).val().length===0?g.setError(f,"Must not be empty"):c!==null&&!$(j).val().match(c)?g.setError(f,a[0]+" not valid"):d&&$(j).val().length<4?g.setError(f,"Must be at least 4 characters"):
e!==null&&k.html()===e?g.setError(f,e):g.clearError(f);return g.goFlags[f]}};j.change(function(){l.validate()});this.checkList.push(l);this.goFlags.push(true);this.panel.append(h);return l},addOptionInput:function(a,b){a instanceof Array||(a=[a,a.replace(" ","").toLowerCase()]);var c=this.checkList.length,d=this,e=this.createContainer(),f=$("<span>").addClass("ui-input-text").html(a[0]+":").width(this.widths[0]).height(16);e.append(f);var g=$("<select>").addClass("optionBox").width(this.widths[1]-
12);g.append($("<option>").html(" "));for(var h=0;h<b.length;h++)g.append($("<option>").html(b[h]));e.append(g);h=$("<div>").addClass("ui-input-error").width(this.widths[2]-5).height(13);e.append(h);var i={container:e,label:f,element:g,error:h,getName:function(){return a[0]},getJSONid:function(){return a[1]},getValue:function(){return $(g).val()},validate:function(){$(g).val().length===0?d.setError(c,"Select an Option"):d.clearError(c);return d.goFlags[c]}};g.change(function(){i.validate()});this.checkList.push(i);
this.goFlags.push(true);this.panel.append(e);return i},setError:function(a,b){this.checkList[a].error.html(b);this.goFlags[a]=false;var c=this.checkList[a].element;if(c.attr("class").split(" ").length===1){var d=c.attr("class");c.attr("class",d+" "+d+"-Error")}},clearError:function(a){this.checkList[a].error.html("");this.goFlags[a]=true;a=this.checkList[a].element;if(a.attr("class").split(" ").length===2){var b=a.attr("class").split(" ")[0];a.attr("class",b)}},addButton:function(a,b){var c=this,
d=this.createContainer().css({"text-align":"right"}),e=$("<button>");e.attr("type","button").addClass("ui-input-button").html(a).css({"margin-right":this.widths[2]}).click(function(){var a=c.validate(),d=c.getValues();b(d,a)});d.append(e);this.panel.append(d)}};
VG.Spinner=function(a,b,c,d,e,f){var g=d||12,d=f||"#333",f=Math.max(b,c)||15,b=Math.min(b,c)||0.5*f,h=e||0.2*f,e=f+h,c=f+h,i=Raphael(a,f*2+h*2,f*2+h*2),j=[],k=[],a=2*Math.PI/g,h={stroke:d,"stroke-width":h,"stroke-linecap":"round"};Raphael.getColor.reset();for(var l=0;l<g;l++){var p=a*l-Math.PI/2,m=Math.cos(p),p=Math.sin(p);k[l]=1/g*l;j[l]=i.path([["M",e+b*m,c+b*p],["L",e+f*m,c+f*p]]).attr(h);d==="rainbow"&&j[l].attr("stroke",Raphael.getColor())}var r;(function t(){k.unshift(k.pop());for(var a=0;a<
g;a++)j[a].attr("opacity",k[a]);i.safari();r=setTimeout(t,1E3/g)})();return function(){clearTimeout(r);i.remove()}};
VG.Icon=function(a,b,c,d,e,f,g){f=f!==void 0?f:{fill:"#333",stroke:"none"};g=g!==void 0?g:{stroke:"#fff","stroke-width":3,"stroke-linejoin":"round",opacity:0};this.element=typeof a==="string"?$("#"+a).get(0):a;this.r=Raphael(this.element,c,c);var h=this.r.path(VG.Icon.paths[b]).attr(g).translate(0,-2),i=this.r.path(VG.Icon.paths[b]).attr(f).translate(0,-2);this.rect=this.r.rect(0,0,c,c);this.rect.attr({fill:"#000",opacity:0});d!==void 0&&d!==null&&this.rect.click(function(a){a.preventDefault();a.stopPropagation();
d(a)});this.rect.hover(function(){i.stop().animate({fill:"90-#0050af-#002c62"},200);h.stop().animate({opacity:1},200)},function(){i.stop().attr({fill:f.fill});h.stop().attr({opacity:0})});this.stroke=h;this.icon=i;this.r.setViewBox(0,0,50,50,false);if(e!==void 0){a={};if(e instanceof Array){a=e[1];e=e[0]}a.gravity=a.gravity===void 0?"nw":a.gravity;a.delayIn=a.delayIn===void 0?250:a.delayIn;a.delayOut=a.delayOut===void 0?250:a.delayOut;a.fade=a.fade===void 0?true:a.fade;$(this.element).attr({title:e}).tipsy(a)}};
VG.Icon.prototype={constructor:VG.Icon,addAlt:function(a){this.alt=new VG.Alt(this.element,a)}};
VG.Icon.paths={undo:"M12.981,9.073V6.817l-12.106,6.99l12.106,6.99v-2.422c3.285-0.002,9.052,0.28,9.052,2.269c0,2.78-6.023,4.263-6.023,4.263v2.132c0,0,13.53,0.463,13.53-9.823C29.54,9.134,17.952,8.831,12.981,9.073z",refresh:"M24.083,15.5c-0.009,4.739-3.844,8.574-8.583,8.583c-4.741-0.009-8.577-3.844-8.585-8.583c0.008-4.741,3.844-8.577,8.585-8.585c1.913,0,3.665,0.629,5.09,1.686l-1.782,1.783l8.429,2.256l-2.26-8.427l-1.89,1.89c-2.072-1.677-4.717-2.688-7.587-2.688C8.826,3.418,3.418,8.826,3.416,15.5C3.418,22.175,8.826,27.583,15.5,27.583S27.583,22.175,27.583,15.5H24.083z",page2:"M23.024,5.673c-1.744-1.694-3.625-3.051-5.168-3.236c-0.084-0.012-0.171-0.019-0.263-0.021H7.438c-0.162,0-0.322,0.063-0.436,0.18C6.889,2.71,6.822,2.87,6.822,3.033v25.75c0,0.162,0.063,0.317,0.18,0.435c0.117,0.116,0.271,0.179,0.436,0.179h18.364c0.162,0,0.317-0.062,0.434-0.179c0.117-0.117,0.182-0.272,0.182-0.435V11.648C26.382,9.659,24.824,7.49,23.024,5.673zM22.157,6.545c0.805,0.786,1.529,1.676,2.069,2.534c-0.468-0.185-0.959-0.322-1.42-0.431c-1.015-0.228-2.008-0.32-2.625-0.357c0.003-0.133,0.004-0.283,0.004-0.446c0-0.869-0.055-2.108-0.356-3.2c-0.003-0.01-0.005-0.02-0.009-0.03C20.584,5.119,21.416,5.788,22.157,6.545zM25.184,28.164H8.052V3.646h9.542v0.002c0.416-0.025,0.775,0.386,1.05,1.326c0.25,0.895,0.313,2.062,0.312,2.871c0.002,0.593-0.027,0.991-0.027,0.991l-0.049,0.652l0.656,0.007c0.003,0,1.516,0.018,3,0.355c1.426,0.308,2.541,0.922,2.645,1.617c0.004,0.062,0.005,0.124,0.004,0.182V28.164z",
page:"M23.024,5.673c-1.744-1.694-3.625-3.051-5.168-3.236c-0.084-0.012-0.171-0.019-0.263-0.021H7.438c-0.162,0-0.322,0.063-0.436,0.18C6.889,2.71,6.822,2.87,6.822,3.033v25.75c0,0.162,0.063,0.317,0.18,0.435c0.117,0.116,0.271,0.179,0.436,0.179h18.364c0.162,0,0.317-0.062,0.434-0.179c0.117-0.117,0.182-0.272,0.182-0.435V11.648C26.382,9.659,24.824,7.49,23.024,5.673zM25.184,28.164H8.052V3.646h9.542v0.002c0.416-0.025,0.775,0.386,1.05,1.326c0.25,0.895,0.313,2.062,0.312,2.871c0.002,0.593-0.027,0.991-0.027,0.991l-0.049,0.652l0.656,0.007c0.003,0,1.516,0.018,3,0.355c1.426,0.308,2.541,0.922,2.645,1.617c0.004,0.062,0.005,0.124,0.004,0.182V28.164z",
location:"M16,3.5c-4.142,0-7.5,3.358-7.5,7.5c0,4.143,7.5,18.121,7.5,18.121S23.5,15.143,23.5,11C23.5,6.858,20.143,3.5,16,3.5z M16,14.584c-1.979,0-3.584-1.604-3.584-3.584S14.021,7.416,16,7.416S19.584,9.021,19.584,11S17.979,14.584,16,14.584z",key:"M18.386,16.009l0.009-0.006l-0.58-0.912c1.654-2.226,1.876-5.319,0.3-7.8c-2.043-3.213-6.303-4.161-9.516-2.118c-3.212,2.042-4.163,6.302-2.12,9.517c1.528,2.402,4.3,3.537,6.944,3.102l0.424,0.669l0.206,0.045l0.779-0.447l-0.305,1.377l2.483,0.552l-0.296,1.325l1.903,0.424l-0.68,3.06l1.406,0.313l-0.424,1.906l4.135,0.918l0.758-3.392L18.386,16.009z M10.996,8.944c-0.685,0.436-1.593,0.233-2.029-0.452C8.532,7.807,8.733,6.898,9.418,6.463s1.594-0.233,2.028,0.452C11.883,7.6,11.68,8.509,10.996,8.944z",
zoomout:"M22.646,19.307c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127l3.535-3.537L22.646,19.307zM13.688,20.369c-3.582-0.008-6.478-2.904-6.484-6.484c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486C20.165,17.465,17.267,20.361,13.688,20.369zM8.854,11.884v4.001l9.665-0.001v-3.999L8.854,11.884z",zoomin:"M22.646,19.307c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127l3.535-3.537L22.646,19.307zM13.688,20.369c-3.582-0.008-6.478-2.904-6.484-6.484c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486C20.165,17.465,17.267,20.361,13.688,20.369zM15.687,9.051h-4v2.833H8.854v4.001h2.833v2.833h4v-2.834h2.832v-3.999h-2.833V9.051z",
cross:"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z",run:"M17.41,20.395l-0.778-2.723c0.228-0.2,0.442-0.414,0.644-0.643l2.721,0.778c0.287-0.418,0.534-0.862,0.755-1.323l-2.025-1.96c0.097-0.288,0.181-0.581,0.241-0.883l2.729-0.684c0.02-0.252,0.039-0.505,0.039-0.763s-0.02-0.51-0.039-0.762l-2.729-0.684c-0.061-0.302-0.145-0.595-0.241-0.883l2.026-1.96c-0.222-0.46-0.469-0.905-0.756-1.323l-2.721,0.777c-0.201-0.228-0.416-0.442-0.644-0.643l0.778-2.722c-0.418-0.286-0.863-0.534-1.324-0.755l-1.96,2.026c-0.287-0.097-0.581-0.18-0.883-0.241l-0.683-2.73c-0.253-0.019-0.505-0.039-0.763-0.039s-0.51,0.02-0.762,0.039l-0.684,2.73c-0.302,0.061-0.595,0.144-0.883,0.241l-1.96-2.026C7.048,3.463,6.604,3.71,6.186,3.997l0.778,2.722C6.736,6.919,6.521,7.134,6.321,7.361L3.599,6.583C3.312,7.001,3.065,7.446,2.844,7.907l2.026,1.96c-0.096,0.288-0.18,0.581-0.241,0.883l-2.73,0.684c-0.019,0.252-0.039,0.505-0.039,0.762s0.02,0.51,0.039,0.763l2.73,0.684c0.061,0.302,0.145,0.595,0.241,0.883l-2.026,1.96c0.221,0.46,0.468,0.905,0.755,1.323l2.722-0.778c0.2,0.229,0.415,0.442,0.643,0.643l-0.778,2.723c0.418,0.286,0.863,0.533,1.323,0.755l1.96-2.026c0.288,0.097,0.581,0.181,0.883,0.241l0.684,2.729c0.252,0.02,0.505,0.039,0.763,0.039s0.51-0.02,0.763-0.039l0.683-2.729c0.302-0.061,0.596-0.145,0.883-0.241l1.96,2.026C16.547,20.928,16.992,20.681,17.41,20.395zM11.798,15.594c-1.877,0-3.399-1.522-3.399-3.399s1.522-3.398,3.399-3.398s3.398,1.521,3.398,3.398S13.675,15.594,11.798,15.594zM27.29,22.699c0.019-0.547-0.06-1.104-0.23-1.654l1.244-1.773c-0.188-0.35-0.4-0.682-0.641-0.984l-2.122,0.445c-0.428-0.364-0.915-0.648-1.436-0.851l-0.611-2.079c-0.386-0.068-0.777-0.105-1.173-0.106l-0.974,1.936c-0.279,0.054-0.558,0.128-0.832,0.233c-0.257,0.098-0.497,0.22-0.727,0.353L17.782,17.4c-0.297,0.262-0.568,0.545-0.813,0.852l0.907,1.968c-0.259,0.495-0.437,1.028-0.519,1.585l-1.891,1.06c0.019,0.388,0.076,0.776,0.164,1.165l2.104,0.519c0.231,0.524,0.541,0.993,0.916,1.393l-0.352,2.138c0.32,0.23,0.66,0.428,1.013,0.6l1.715-1.32c0.536,0.141,1.097,0.195,1.662,0.15l1.452,1.607c0.2-0.057,0.399-0.118,0.596-0.193c0.175-0.066,0.34-0.144,0.505-0.223l0.037-2.165c0.455-0.339,0.843-0.747,1.152-1.206l2.161-0.134c0.152-0.359,0.279-0.732,0.368-1.115L27.29,22.699zM23.127,24.706c-1.201,0.458-2.545-0.144-3.004-1.345s0.143-2.546,1.344-3.005c1.201-0.458,2.547,0.144,3.006,1.345C24.931,22.902,24.328,24.247,23.127,24.706z",
video:"M27.188,4.875v1.094h-4.5V4.875H8.062v1.094h-4.5V4.875h-1v21.25h1v-1.094h4.5v1.094h14.625v-1.094h4.5v1.094h1.25V4.875H27.188zM8.062,23.719h-4.5v-3.125h4.5V23.719zM8.062,19.281h-4.5v-3.125h4.5V19.281zM8.062,14.844h-4.5v-3.125h4.5V14.844zM8.062,10.406h-4.5V7.281h4.5V10.406zM11.247,20.59V9.754l9.382,5.418L11.247,20.59zM27.188,23.719h-4.5v-3.125h4.5V23.719zM27.188,19.281h-4.5v-3.125h4.5V19.281zM27.188,14.844h-4.5v-3.125h4.5V14.844zM27.188,10.406h-4.5V7.281h4.5V10.406z",roseChart:"M19.764,23.046c1.033,0,2.066-0.394,2.853-1.182l0.547,0.612c0.891-0.891,1.441-2.121,1.441-3.481  l6.05,0.057c0-2.807-1.069-5.614-3.208-7.756l1.75-1.714c-2.423-2.419-5.767-3.918-9.461-3.918l0.024,9.364  c-1.034,0-2.065,0.395-2.855,1.182l-0.621-0.686c-0.89,0.891-1.439,2.121-1.439,3.48l-6.033-0.025c0,2.808,1.07,5.615,3.212,7.757  L10.31,28.43c2.419,2.421,5.764,3.921,9.458,3.921L19.764,23.046z M35.196,19.008c0,8.541-6.924,15.462-15.46,15.462  c-8.541,0-15.461-6.925-15.461-15.462c0-8.54,6.924-15.461,15.461-15.461C28.272,3.547,35.196,10.469,35.196,19.008z M19.734,4.925  c-7.776,0-14.08,6.304-14.08,14.081c0,7.777,6.304,14.083,14.08,14.083c7.777,0,14.085-6.304,14.085-14.083  C33.819,11.228,27.511,4.925,19.734,4.925z",
histogram:"M7.824,30.332h-3.91V14.627h3.91V30.332z M14.701,6.515h-3.912V30.33h3.91L14.701,6.515  L14.701,6.515z M21.576,11.094h-3.914v19.238h3.914V11.094z M28.45,25.356h-3.911v4.974h3.911V25.356z M35.326,9.132h-3.912v21.2  h3.912V9.132z",plane:"M8.696,29.839c-3.019-3.018-4.535-6.986-4.532-10.938l0,0c-0.003-3.957,1.513-7.926,4.532-10.939  l0,0c3.019-3.018,6.987-4.536,10.939-4.534l0,0c3.955-0.001,7.922,1.516,10.941,4.535l0,0c3.016,3.016,4.532,6.987,4.532,10.939l0,0  c0,3.952-1.517,7.92-4.532,10.938l0,0c-3.016,3.014-6.983,4.531-10.938,4.531l0,0C15.683,34.37,11.715,32.86,8.696,29.839  L8.696,29.839z M10.806,10.072c-2.44,2.44-3.655,5.625-3.655,8.83l0,0c0,3.2,1.215,6.384,3.655,8.825l0,0  c2.444,2.441,5.63,3.653,8.833,3.658l0,0c3.201-0.005,6.384-1.217,8.824-3.658l0,0c2.44-2.44,3.654-5.627,3.657-8.825l0,0  c-0.004-3.201-1.221-6.388-3.657-8.83l0,0c-2.439-2.443-5.63-3.659-8.828-3.659l0,0C16.435,6.417,13.25,7.63,10.806,10.072  L10.806,10.072z M29.757,11.574c-0.176-0.24-0.739-0.892-0.739-0.892c-0.087,4.633-2.067,8.86-5.412,12.209l0,0  c-3.245,3.251-7.956,5.392-12.142,5.452c0,0,0.729,0.589,0.938,0.74c0.259,0.189,0.933,0.609,0.931,0.609  c4.102-0.562,8.267-2.698,11.332-5.746l0,0c3.148-3.149,5.185-7.104,5.692-11.436C30.357,12.509,29.919,11.797,29.757,11.574z   M17.757,14.144c-0.796-0.795-2.082-0.795-2.878,0c-0.792,0.796-0.792,2.083,0,2.874c0.796,0.797,2.082,0.797,2.875,0  C18.55,16.224,18.55,14.94,17.757,14.144z",
rake:"M8.697,29.839c-3.021-3.018-4.537-6.986-4.534-10.938l0,0C4.16,14.944,5.676,10.975,8.697,7.961  l0,0c3.019-3.02,6.985-4.538,10.939-4.535l0,0c3.953-0.001,7.921,1.516,10.942,4.535l0,0c3.014,3.016,4.53,6.985,4.53,10.939l0,0  c0,3.952-1.517,7.92-4.53,10.938l0,0c-3.018,3.015-6.985,4.531-10.937,4.531l0,0C15.684,34.37,11.715,32.86,8.697,29.839  L8.697,29.839z M10.806,10.072c-2.44,2.44-3.655,5.625-3.655,8.83l0,0c0,3.2,1.215,6.384,3.655,8.825l0,0  c2.444,2.441,5.63,3.653,8.833,3.658l0,0c3.198-0.005,6.384-1.217,8.824-3.658l0,0c2.44-2.44,3.653-5.627,3.656-8.825l0,0  c-0.004-3.201-1.22-6.388-3.656-8.83l0,0c-2.44-2.443-5.63-3.659-8.828-3.659l0,0C16.435,6.417,13.25,7.63,10.806,10.072  L10.806,10.072z M29.757,11.574c-0.176-0.24-0.739-0.892-0.739-0.892c-0.087,4.633-2.067,8.86-5.412,12.209l0,0  c-3.245,3.251-7.956,5.392-12.142,5.452c0,0,0.729,0.589,0.938,0.74c0.259,0.189,0.933,0.609,0.933,0.609  c4.1-0.562,8.266-2.698,11.329-5.746l0,0c3.147-3.149,5.186-7.104,5.69-11.436C30.357,12.509,29.919,11.797,29.757,11.574z   M17.757,14.144c-0.796-0.795-2.082-0.795-2.878,0c-0.792,0.796-0.792,2.083,0,2.874c0.796,0.797,2.082,0.797,2.878,0  C18.552,16.224,18.552,14.94,17.757,14.144z M29.89,15.394c-0.79-0.797-2.079-0.797-2.873,0c-0.794,0.795-0.794,2.081,0,2.874  c0.794,0.794,2.079,0.794,2.873,0C30.684,17.475,30.684,16.189,29.89,15.394z",
line:"M8.697,29.839c-3.021-3.018-4.537-6.986-4.535-10.938l0,0c-0.001-3.957,1.514-7.926,4.535-10.939  l0,0c3.016-3.018,6.985-4.536,10.938-4.534l0,0c3.955-0.001,7.922,1.516,10.941,4.535l0,0c3.016,3.016,4.532,6.987,4.532,10.939l0,0  c0,3.954-1.517,7.92-4.532,10.938l0,0c-3.016,3.014-6.983,4.531-10.936,4.531l0,0C15.684,34.37,11.715,32.86,8.697,29.839  L8.697,29.839z M10.806,10.072c-2.44,2.44-3.655,5.625-3.655,8.83l0,0c0,3.2,1.216,6.384,3.655,8.825l0,0  c2.444,2.441,5.628,3.653,8.834,3.658l0,0c3.197-0.005,6.382-1.217,8.821-3.658l0,0c2.439-2.44,3.655-5.627,3.657-8.825l0,0  c-0.004-3.201-1.218-6.388-3.657-8.83l0,0c-2.44-2.443-5.629-3.659-8.829-3.659l0,0C16.435,6.417,13.25,7.63,10.806,10.072  L10.806,10.072z M17.757,14.144c-0.796-0.795-2.082-0.795-2.878,0c-0.792,0.796-0.792,2.083,0,2.874  c0.796,0.797,2.082,0.797,2.878,0C18.552,16.224,18.552,14.94,17.757,14.144z",
smallCircle:"M8.697,29.839c-3.021-3.018-4.537-6.986-4.534-10.938l0,0  C4.16,14.944,5.676,10.975,8.697,7.961l0,0c3.019-3.02,6.985-4.538,10.939-4.535l0,0c3.953-0.001,7.921,1.516,10.942,4.535l0,0  c3.014,3.016,4.53,6.985,4.53,10.939l0,0c0,3.952-1.517,7.92-4.53,10.938l0,0c-3.018,3.015-6.985,4.531-10.937,4.531l0,0  C15.684,34.37,11.715,32.86,8.697,29.839L8.697,29.839z M10.806,10.072c-2.44,2.44-3.655,5.625-3.655,8.83l0,0  c0,3.2,1.215,6.384,3.655,8.825l0,0c2.444,2.441,5.63,3.653,8.833,3.658l0,0c3.198-0.005,6.384-1.217,8.824-3.658l0,0  c2.44-2.44,3.653-5.627,3.656-8.825l0,0c-0.004-3.201-1.22-6.388-3.656-8.83l0,0c-2.44-2.443-5.63-3.659-8.828-3.659l0,0  C16.435,6.417,13.25,7.63,10.806,10.072L10.806,10.072z M23.135,15.569c1.585,1.543,3.841,1.931,4.987,0.782  c1.161-1.162,0.815-3.392-0.778-4.982c-1.59-1.593-3.822-1.94-4.984-0.78C21.213,11.735,21.598,13.982,23.135,15.569l0.505-0.629  c-1.047-1.152-1.317-2.756-0.502-3.57c0.848-0.849,2.475-0.597,3.639,0.568c1.162,1.162,1.416,2.79,0.562,3.636  c-0.849,0.85-2.538,0.528-3.702-0.634",
calculator:"M31.819,30.461c0,2.399-1.944,4.343-4.343,4.343H11.908c-2.396,0-4.342-1.943-4.342-4.343V7.963  c0-2.398,1.945-4.344,4.342-4.344h15.568c2.398,0,4.343,1.945,4.343,4.344V30.461z M28.963,7.502c0-0.798-0.648-1.447-1.448-1.447  H11.869c-0.799,0-1.448,0.649-1.448,1.447v3.24c0,0.799,0.649,1.447,1.448,1.447h15.646c0.802,0,1.448-0.648,1.448-1.447V7.502z   M15.031,28.403c0-0.37-0.298-0.667-0.667-0.667h-2.549c-0.369,0-0.667,0.3-0.667,0.667v2.55c0,0.369,0.298,0.666,0.667,0.666h2.549  c0.37,0,0.667-0.3,0.667-0.666V28.403z M21.63,28.403c0-0.37-0.295-0.667-0.665-0.667h-2.549c-0.367,0-0.667,0.3-0.667,0.667v2.55  c0,0.369,0.299,0.666,0.667,0.666h2.549c0.372,0,0.665-0.3,0.665-0.666V28.403z M28.235,28.403c0-0.37-0.301-0.667-0.667-0.667  h-2.552c-0.365,0-0.665,0.3-0.665,0.667v2.55c0,0.369,0.3,0.666,0.665,0.666h2.552c0.366,0,0.667-0.3,0.667-0.666V28.403z   M15.031,22.122c0-0.366-0.298-0.666-0.667-0.666h-2.549c-0.369,0-0.667,0.3-0.667,0.666v2.553c0,0.366,0.298,0.663,0.667,0.663  h2.549c0.37,0,0.667-0.3,0.667-0.663V22.122z M21.63,22.122c0-0.366-0.295-0.666-0.665-0.666h-2.549c-0.367,0-0.667,0.3-0.667,0.666  v2.553c0,0.366,0.299,0.663,0.667,0.663h2.549c0.372,0,0.665-0.3,0.665-0.663V22.122z M28.235,22.122  c0-0.366-0.301-0.666-0.667-0.666h-2.552c-0.365,0-0.665,0.3-0.665,0.666v2.553c0,0.366,0.3,0.663,0.665,0.663h2.552  c0.366,0,0.667-0.3,0.667-0.663V22.122z M15.031,15.843c0-0.367-0.298-0.666-0.667-0.666h-2.549c-0.369,0-0.667,0.299-0.667,0.666  v2.553c0,0.366,0.298,0.665,0.667,0.665h2.549c0.37,0,0.667-0.299,0.667-0.665V15.843z M21.63,15.843  c0-0.367-0.295-0.666-0.665-0.666h-2.549c-0.367,0-0.667,0.299-0.667,0.666v2.553c0,0.366,0.299,0.665,0.667,0.665h2.549  c0.372,0,0.665-0.299,0.665-0.665V15.843z M28.235,15.843c0-0.367-0.301-0.666-0.667-0.666h-2.552c-0.365,0-0.665,0.299-0.665,0.666  v2.553c0,0.366,0.3,0.665,0.665,0.665h2.552c0.366,0,0.667-0.299,0.667-0.665V15.843z",
save:"M11.672,13.522h12.341V4.839h2.56l6.403,6.68v18.069c0,1.816-1.349,3.287-3.02,3.287H10.229  c-1.669,0-3.02-1.471-3.02-3.287V8.124c0-1.814,1.351-3.285,3.02-3.285h1.442L11.672,13.522L11.672,13.522z M21.968,11.685h-2.66  V6.792h2.66V11.685z M27.731,19.499c0-0.874-0.653-1.579-1.463-1.579H12.861c-0.81,0-1.464,0.706-1.464,1.579v8.568  c0,0.874,0.652,1.579,1.464,1.579h13.407c0.81,0,1.463-0.705,1.463-1.579V19.499z M25.802,20.617H13.328v1.13h12.474V20.617  L25.802,20.617z M25.802,23.219H13.328v1.132h12.474V23.219L25.802,23.219z M25.802,25.821H13.328v1.13h12.474V25.821L25.802,25.821  z",
trash:"M29.984,10.846v20.318c0,3.686-2.504,3.557-5.59,3.557H13.966c-3.085,0-5.588,0.129-5.588-3.557  V10.846 M14.391,14.775c0-0.86-0.584-1.557-1.304-1.557l0,0c-0.719,0-1.304,0.699-1.304,1.557v15.572c0,0.863,0.585,1.56,1.304,1.56  l0,0c0.72,0,1.304-0.696,1.304-1.56V14.775z M20.486,14.923c0-0.86-0.584-1.557-1.305-1.557l0,0c-0.721,0-1.304,0.697-1.304,1.557  v15.574c0,0.86,0.583,1.554,1.304,1.554l0,0c0.721,0,1.305-0.693,1.305-1.554V14.923z M26.573,14.923  c0-0.86-0.582-1.557-1.302-1.557l0,0c-0.722,0-1.304,0.697-1.304,1.557v15.574c0,0.86,0.584,1.554,1.304,1.554l0,0  c0.722,0,1.302-0.693,1.302-1.554V14.923z M21.544,5.957c0-1.474-1.011-2.648-2.243-2.648c-1.235,0-2.262,1.176-2.262,2.648l0,0  c-2.363,0-4.793,0-4.793,0c-2.894,0-4.667-0.094-4.667,2.311v1.645h23.202V8.268c0-2.405-1.534-2.311-4.428-2.311  C26.353,5.957,21.544,5.957,21.544,5.957L21.544,5.957z",
copy:"M25.911,34.197c0,0.16-0.064,0.31-0.176,0.425c-0.116,0.112-0.27,0.173-0.428,0.173H7.393  c-0.161,0-0.311-0.061-0.426-0.173c-0.112-0.115-0.175-0.268-0.175-0.425V9.073c0-0.161,0.066-0.317,0.175-0.43  C7.079,8.532,7.235,8.47,7.393,8.47h5.513l0.013,0.001V4.114c0-0.16,0.067-0.315,0.175-0.427c0.112-0.113,0.27-0.175,0.426-0.175  h9.909c0.089,0.003,0.171,0.008,0.257,0.022c1.503,0.18,3.337,1.504,5.039,3.156c1.758,1.776,3.278,3.889,3.312,5.833v16.714  c0,0.163-0.062,0.313-0.176,0.428c-0.115,0.114-0.267,0.17-0.424,0.17h-5.561v-1.199h4.957h0.002V12.521  c0-0.057,0-0.117-0.004-0.178c-0.102-0.677-1.191-1.276-2.579-1.578c-1.45-0.328-2.927-0.344-2.928-0.344l-0.642-0.006l0.05-0.638  c0,0,0.026-0.388,0.023-0.968c0.005-0.786-0.058-1.925-0.3-2.799c-0.27-0.919-0.621-1.319-1.026-1.294V4.714h-9.309v3.715  l-0.06,0.043h3.241c0.09,0.003,0.173,0.009,0.256,0.021c1.505,0.181,3.343,1.504,5.04,3.156c1.759,1.775,3.28,3.891,3.314,5.831   M24.708,33.592V17.479c0-0.056,0-0.117-0.003-0.176c-0.103-0.679-1.192-1.278-2.58-1.579c-1.45-0.328-2.927-0.346-2.928-0.346  l-0.64-0.006l0.048-0.636c0,0,0.029-0.39,0.028-0.969c0.001-0.788-0.062-1.928-0.303-2.799c-0.271-0.918-0.621-1.319-1.028-1.294  V9.673h-9.31v23.919h16.713H24.708L24.708,33.592z",
paste:"M25.646,5.637c2.015,0.123,3.586,1.797,3.586,3.841v3.603c0,0-1.168-0.852-1.918-1.356  c-1.036-0.7-2.225-0.727-2.225-0.727l-8.9-0.044c0,0-0.473,0.087-0.65,0.262c-0.175,0.175-0.229,0.658-0.229,0.658v18.65h-3.02  c-2.126,0-3.848-1.725-3.848-3.852V9.478c0-2.03,1.57-3.691,3.559-3.839v2.845h13.642V5.637H25.646z M24.396,7.315V5.676  c0-1.51-1.226-2.006-2.735-2.006h-5.649c-1.511,0-2.734,0.495-2.734,2.006v1.639H24.396z M29.804,14.375  c-1.497-1.453-3.107-2.616-4.432-2.774c-0.072-0.013-0.145-0.017-0.226-0.02H16.44c-0.138,0-0.276,0.055-0.373,0.154  c-0.096,0.099-0.154,0.235-0.154,0.375v22.079c0,0.141,0.054,0.271,0.154,0.373c0.101,0.099,0.232,0.155,0.373,0.155h15.747  c0.139,0,0.271-0.055,0.373-0.155c0.101-0.097,0.155-0.232,0.155-0.373V19.498C32.68,17.792,31.345,15.934,29.804,14.375z   M31.524,33.656H16.838v-21.02h8.184v0.001c0.354-0.022,0.664,0.331,0.9,1.137c0.213,0.767,0.268,1.769,0.268,2.461  c0,0.506-0.024,0.85-0.024,0.85l-0.044,0.56l0.566,0.005c0,0,1.297,0.015,2.568,0.304c1.224,0.264,2.179,0.79,2.271,1.387  c0,0.053,0,0.107,0,0.156v14.159H31.524L31.524,33.656z",
selectAll:"M25.446,15.306l5.957-5.956l-1.072-1.069l-4.885,4.884l-2.931-2.931l-1.067,1.07  L25.446,15.306z M25.446,29.297l5.957-5.955l-1.072-1.068l-4.885,4.884l-2.931-2.932l-1.067,1.071L25.446,29.297z M35.275,34.601  H4.269V3.591h31.007V34.601z M18.26,6.876H8.429v9.833h9.832V6.876z M18.26,20.87H8.429v9.83h9.832V20.87z",selectNone:"M35.272,34.601H4.265V3.591h31.007V34.601z M18.256,6.876h-9.83v9.833h9.83V6.876z   M18.256,20.87h-9.83v9.83h9.83V20.87z",calcPlane:"M8.697,29.839c-3.021-3.018-4.537-6.986-4.534-10.938l0,0  C4.16,14.944,5.676,10.975,8.697,7.961l0,0c3.019-3.02,6.985-4.538,10.939-4.535l0,0c3.953-0.001,7.921,1.516,10.942,4.535l0,0  c3.014,3.016,4.53,6.985,4.53,10.939l0,0c0,3.952-1.517,7.92-4.53,10.938l0,0c-3.018,3.015-6.985,4.531-10.937,4.531l0,0  C15.684,34.37,11.715,32.86,8.697,29.839L8.697,29.839z M10.806,10.072c-2.44,2.44-3.655,5.625-3.655,8.83l0,0  c0,3.2,1.215,6.384,3.655,8.825l0,0c2.444,2.441,5.63,3.653,8.833,3.658l0,0c3.198-0.005,6.384-1.217,8.824-3.658l0,0  c2.44-2.44,3.653-5.627,3.656-8.825l0,0c-0.004-3.201-1.22-6.388-3.656-8.83l0,0c-2.44-2.443-5.63-3.659-8.828-3.659l0,0  C16.435,6.417,13.25,7.63,10.806,10.072L10.806,10.072z M29.757,11.574c-0.176-0.24-0.739-0.892-0.739-0.892  c-0.087,4.633-2.067,8.86-5.412,12.209l0,0c-3.245,3.251-7.956,5.392-12.142,5.452c0,0,0.729,0.589,0.938,0.74  c0.259,0.189,0.933,0.609,0.933,0.609c4.1-0.562,8.266-2.698,11.329-5.746l0,0c3.147-3.149,5.186-7.104,5.69-11.436  C30.357,12.509,29.919,11.797,29.757,11.574z M29.89,15.394c-0.79-0.797-2.079-0.797-2.873,0c-0.794,0.795-0.794,2.081,0,2.874  c0.794,0.794,2.079,0.794,2.873,0C30.684,17.475,30.684,16.189,29.89,15.394z M19.871,25.876c-0.791-0.798-2.08-0.798-2.874,0  c-0.794,0.795-0.794,2.08,0,2.873c0.794,0.795,2.079,0.795,2.874,0C20.664,27.956,20.664,26.671,19.871,25.876z",
calcLine:"M8.697,29.839c-3.021-3.018-4.537-6.986-4.534-10.938l0,0  C4.16,14.944,5.676,10.975,8.697,7.961l0,0c3.019-3.02,6.985-4.538,10.939-4.535l0,0c3.953-0.001,7.921,1.516,10.942,4.535l0,0  c3.014,3.016,4.53,6.985,4.53,10.939l0,0c0,3.952-1.517,7.92-4.53,10.938l0,0c-3.018,3.015-6.985,4.531-10.937,4.531l0,0  C15.684,34.37,11.715,32.86,8.697,29.839L8.697,29.839z M29.757,11.574c-0.176-0.24-0.739-0.892-0.739-0.892  c-0.087,4.633-2.067,8.86-5.412,12.209l0,0c-3.245,3.251-7.956,5.392-12.142,5.452c0,0,0.729,0.589,0.938,0.74  c0.259,0.189,0.933,0.609,0.933,0.609c4.1-0.562,8.266-2.698,11.329-5.746l0,0c3.147-3.149,5.186-7.104,5.69-11.436  C30.357,12.509,29.919,11.797,29.757,11.574z M28.204,18.499c-0.791-0.798-2.079-0.798-2.874,0c-0.793,0.795-0.793,2.079,0,2.872  c0.795,0.795,2.079,0.795,2.874,0C28.998,20.578,28.998,19.294,28.204,18.499z M8.502,24.549c1.562,3.077,4.211,5.222,7.257,6.217  l0,0c3.042,0.994,6.446,0.829,9.524-0.731l0,0c3.08-1.565,5.222-4.217,6.221-7.26l0,0c0.989-3.041,0.827-6.446-0.735-9.523l0,0  c-1.562-3.078-4.213-5.221-7.252-6.217l0,0c-3.044-0.991-6.45-0.825-9.528,0.732l0,0c-3.081,1.561-5.228,4.214-6.221,7.254l0,0  C6.776,18.063,6.94,21.467,8.502,24.549L8.502,24.549z M15.818,7.002c-0.283,0.092-1.078,0.426-1.078,0.426  c4.376,1.522,7.779,4.718,9.924,8.938l0,0c2.082,4.094,2.652,9.237,1.41,13.235c0,0,0.786-0.511,0.994-0.661  c0.261-0.188,0.869-0.697,0.869-0.697c0.74-4.071,0.004-8.695-1.941-12.554l0,0c-2.016-3.97-5.142-7.136-9.102-8.962  C16.893,6.722,16.08,6.917,15.818,7.002z",
faultLab:"M23.023,26.415H4.366V4.623h6.826 M28.939,34.147h6.371V12.355H17.108",contour:"M32.803,7.364  c6.062,3.979,2.653,13.929-3.146,21.717c-6.264,8.411-16.589,8.274-21.716,3.145C2.812,27.099,3.085,19.507,9.951,12.64  C16.817,5.774,24.956,2.216,32.803,7.364z M13.264,14.922c-4.636,4.635-5.512,11.275-1.955,14.831  c3.555,3.559,10.918,3.305,14.832-1.954c5.536-7.438,4.793-13.324,1.238-16.878C23.821,7.364,17.9,10.286,13.264,14.922z   M14.515,18.591c-2.624,2.624-2.953,6.546-0.735,8.763c2.217,2.22,7.044,2.554,8.765-0.733c2.039-3.896,3.144-8.169,0.927-10.387  C21.253,14.017,17.139,15.967,14.515,18.591z"};
VG.Notify=function(a,b,c){this.text=$("<div>").addClass("notifyText").html(a);this.subtext=$("<div>").addClass("notifySubText").html(b);this.notify=$("<div>").addClass("notifyBar").append(this.text).append(this.subtext);c!==void 0&&this.notify.append(c);this.blind=$("<div>").addClass("notifyBlind");this.close=$('<div id="notifyCloseIcon">').addClass("closeIcon icon");this.notify.append(this.close);$("body").append(this.blind).append(this.notify);var d=this;this.notify.ready(function(){d.notify.css("margin-top",
-d.notify.height()/2-20)});new VG.Icon("notifyCloseIcon","cross",30,function(){d.destroy()})};
VG.Notify.prototype={constructor:VG.Notify,destroy:function(){this.blind.remove();this.notify.remove()},subTheme:function(a){for(var b=false,c=["Loading","Success","Warn","Error","Tray"],d=0;d<c.length;d++)if(a==c[d]){b=true;break}if(!b){console.log(c);throw"Notify: subTheme Not supported";}this.notify.addClass("notifyBar-"+a);this.text.addClass("notifyText-"+a);this.subtext.addClass("notifySubText-"+a);return this}};VG.Notify.closeAll=function(){$(".notifyBar").remove();$(".notifyBlind").remove()};
VG.Notify.Error=function(){(new VG.Notify("Error","There was an error, please try again.")).subTheme("Error")};VG.ViewRect=function(a,b){this.nWidth=a;this.nHeight=b;this.lockAspect=true;this.aspect=a/b};
VG.ViewRect.prototype={constructor:VG.ViewRect,getCenter:function(){},getPercent:function(a,b,c,d,e){a=this.getElement(a);b=[(b-a.left)/a.width,(c-a.top)/a.height];return!e&&(b[0]<0||b[1]<0||b[0]>1||b[1]>1)?null:[b,[d/a.width,d/a.height]]},getPixels:function(a,b,c,d,e,f,g){b=[(b-g.left)/g.width,(g.top-c)/g.height];d=[d/g.width,d/g.height];a=this.getElement(a);return{x:a.left+b[0]*a.width,y:a.top+b[1]*a.height,l:a.width*d[0]}},getUnits:function(a,b,c,d,e){a=this.getPercent(a,b,c,d,true);if(a===null)return{};
b=a[0];return{x:e.left+b[0]*e.width,y:e.top-b[1]*e.height,l:a[1][0]*e.width}},getViewWindow:function(a,b,c,d){var e=this.getUnits(a,0,0,0,d),a=this.getUnits(a,b,c,0,d);return{left:e.x,top:e.y,width:a.x-e.x,height:e.y-a.y}},zoom:function(a,b,c,d){var e=b[0],b=b[1];if(c/d<=1)var c=c/(b[0]*2),d=c/this.aspect,f=-c*(e[0]-b[0]);else{d=d/(b[1]*2);c=d*this.aspect;f=-c*(e[0]-b[0])}b=-d*(e[1]-b[1]);this.setElement(a,c,d,f,b);return e},fitInBox:function(a,b,c){if(this.lockAspect)if(b/c>=this.aspect){var d=c*
this.aspect;this.setElement(a,d,c,(b-d)/2,0)}else{d=b/this.aspect;this.setElement(a,b,d,0,(c-d)/2)}else this.setElement(a,b,c,0,0)},getViewArea:function(){var a=this.location.center.x-parseFloat(this.obs.css("left")),b=this.location.center.y-parseFloat(this.obs.css("top"));if(a<0||b<0)return null;var c=this.obs.width(),d=this.obs.height(),a=[a/c,b/d];return a[0]>1||a[1]>1?null:a},setElement:function(a,b,c,d,e){$(a).width(b).height(c).css({left:d,top:e})},getElement:function(a){return{width:$(a).width(),
height:$(a).height(),left:parseFloat($(a).css("left")),top:parseFloat($(a).css("top"))}},copyElement:function(a,b){var c=this.getElement(a);this.setElement(b,c.width,c.height,c.left,c.top)}};
VG.CellList=function(){this.className="CellList";this.panel=$("<div>").addClass(this.className);this.toolbar=$("<div>").addClass(this.className+"ToolBar");this.scroll=$("<div>").addClass(this.className+"Scroll");this.panel.append(this.toolbar);this.panel.append(this.scroll);this.items=[];this.bus=$({});this.multiSelect=true;this.addEvents()};
VG.CellList.prototype={constructor:VG.CellList,addItem:function(a){this.scroll.append(a.panel);a.cellList=this;this.items.push(a)},addEvents:function(){var a=this;this.bus.bind("selectEvent",function(b,c,d){b=c.isSelected;if(!a.multiSelect||a.multiSelect&&!d.shiftKey){for(d=0;d<a.items.length;d++)a.items[d].select(false);c.select(a.multiSelect?b:true)}})}};
VG.CellItem=function(a){this.className="CellItem";this.isSelected=false;this.panel=$("<div>").addClass(this.className);this.cellList=null;var b=this;this.panel.click(function(c){var d=b.select();b.bus("selectEvent",c);a&&a(d)});this.panel.hover(function(){b.hover(true)},function(){b.hover(false)})};
VG.CellItem.prototype={constructor:VG.CellItem,addIcon:function(a,b,c){var d=$("<div>").addClass("icon"),a=new VG.Icon(d.get(0),a,30,b);c!==void 0&&a.addAlt(c);this.panel.append(d)},select:function(a){a=a===void 0?!this.isSelected:a;this.panel.attr("class",this.className+(a?" "+this.className+"-Selected":""));return this.isSelected=a},hover:function(a){this.isSelected||this.panel.attr("class",this.className+(a?" "+this.className+"-Hover":""))},bus:function(a,b){this.cellList!==null&&$(this.cellList.bus).trigger(a,
[this,b])}};VG.Table=function(){};
VG.Table.prototype={constructor:VG.Table,init:function(a){this.id=a;this.container=$(a);this.checkNumbers=[];this.checkNoEdits=[]},resize:function(a,b){this.container.width(a).height(b);if(this.table!==void 0){var c=this.table.getData();this.table.destroy();this.container.css({overflow:"scroll"});this.createTable();this.loadData(c)}},createTable:function(a){this.table!==void 0&&this.table.destroy();var b=this,a=a===void 0?this.opts:a;a.startRows=a.startRows===void 0?0:a.startRows;a.rowHeaders=a.rowHeaders===
void 0?false:a.rowHeaders;a.fillHandle=a.fillHandle===void 0?false:a.fillHandle;a.minSpareRows=a.minSpareRows===void 0?0:a.minSpareRows;a.multiSelect=a.multiSelect===void 0?true:a.multiSelect;a.onChange=a.onChange!==void 0?a.onChange:function(a){console.log(a)};a.onBeforeChange=function(a){for(var d=a.length-1;d>=0;d--){var e;a:{e=a;for(var f=d,g=0;g<b.checkNumbers.length;g++)if(e[f][1]===b.checkNumbers[g].id){if(isNumber(e[f][3])){if(!b.checkNumbers[g].check(parseFloat(e[f][3]))){e.splice(f,1);noty({text:"Input must be "+
b.checkNumbers[g].constraint+".",type:"error",modal:false,timeout:1500,layout:"topRight"});e=true;break a}}else{e.splice(f,1);noty({text:"Input must be a number.",type:"error",modal:false,timeout:1500,layout:"topRight"});e=true;break a}e[f][3]=parseFloat(e[f][3])}e=false}if(!e){a:{e=a;f=d;for(g=0;g<b.checkNoEdits.length;g++)if(e[f][1]===b.checkNoEdits[g].id){e.splice(f,1);e=true;break a}e=false}e||a[d][3]===""&&a.splice(d,1)}}};this.opts=a;this.recordChanges=true;this.container.handsontable(a);this.table=
$(b.id).data("handsontable")},insertData:function(a){if(a!==void 0){var b=this.table.getData();b.push(a);this.table.render();this.table.selectCell(b.length-1,1)}},loadData:function(a){this.recordChanges=false;this.table.loadData(a);this.recordChanges=true},getData:function(){return this.table.getData()}};
VG.SNet=function(){var a=this;this.onClick=function(b,c){(new VG.SNetLine(b,c)).draw(a)};this.onDoubleClick=function(b,c){(new VG.SNetPlane(firstWv(b+90),90-c)).draw(a)};this.netType=1;this.planeFormat=0;this.showNet=true;this.showFineNet=false;this.showAnnotations=true;this.lastAngle=10;this.drawIn3D=false;this.glowElements=[]};
VG.SNet.prototype={constructor:VG.SNet,loadData:function(a){var b=this;try{if(a.version==="VisibleGeology:SNet:1.00"){this.planeFormat=a.planeFormat;this.netType=a.netType;this.showNet=a.showNet;this.showFineNet=a.showFineNet;this.reset();a.data.forEach(function(a){var c=new VG.SNetGroup(a.groupType);c.lineAttr=a.lineAttr;c.pointAttr=a.pointAttr;c.contourAttr=a.contourAttr;c.roseAttr=a.roseAttr;c.name=a.name;c.active=a.active;a.data.forEach(function(a){c.data.push(VG.SNetObject.newObject(a,c))});
c.draw(b)})}else noty({text:"Version not supported.",type:"error",modal:true,layout:"center"})}catch(c){noty({text:"Error loading data, you may need to restart the program.",type:"error",modal:true,layout:"center"});console.log(c)}},init:function(a,b){this.outRadius=b===void 0?100:b;this.radius=this.outRadius-30;this.container=a===void 0||a===null?$("<div>"):$(a);this.reset()},formatStrike:function(a){return this.planeFormat===0?firstWv(a,360):this.planeFormat===1?firstWv(a-90,360):a},unformatStrike:function(a){return this.planeFormat===
0?firstWv(a,360):this.planeFormat===1?firstWv(a+90,360):a},reset:function(){if(this.r!==void 0){this.r.clear();this.r.remove()}this.r=new Raphael(this.container.get(0),this.outRadius*2,this.outRadius*2);this.r.customAttributes.arc=function(a,b,c,d,e){var f=d-c,g=f<0?0:1,h=(90-c)*Math.PI/180,c=(90-d)*Math.PI/180,d=a+e*Math.cos(h),h=b-e*Math.sin(h),a=a+e*Math.cos(c),b=b-e*Math.sin(c);return{path:360==f?[["M",d,h],["A",e,e,0,1,1,d-0.01,h]]:[["M",d,h],["A",e,e,0,+(f>180),g,a,b]]}};this.midpoint=new VG.Vector(this.outRadius,
this.outRadius,0);this.scale=(new VG.Matrix4).scale(new VG.Vector(this.radius,this.radius,this.radius));this.invscale=(new VG.Matrix4).scale(new VG.Vector(1/this.radius,1/this.radius,1/this.radius));this.showAnnotations&&this.drawAnnotations();(this.showNet||this.showFineNet)&&this.drawNet()},numbers:function(){for(var a=this.r.set(),b=new VG.NumberFormat("000"),c=20;c<360;c=c+20)a.push(this.annotate("radtext",b.format(c),[c,1]));b=new VG.NumberFormat("00");for(c=10;c<90;c=c+10)a.push(this.annotate("text",
b.format(c),[90,c]));a.attr({"font-size":9});return a},annotate:function(a,b,c,d){var e=this.midpoint.x,f=this.midpoint.y;if(a=="circle"){c=this.radius*c;a=this.r.path().attr({stroke:"#f00","stroke-width":2,arc:[e,f,0,0,c]});a.animate({arc:[e,f,0,b[1],c]},d,"<>");return a}if(a=="tick"){var c=this.radius*c,g=(90-b)*Math.PI/180,b=e+(c+15)*Math.cos(g),a=f-(c+15)*Math.sin(g),e=e+(c-15)*Math.cos(g),c=f-(c-15)*Math.sin(g),f=this.r.path(["M",b,a,"L",b,a]).attr({stroke:"#f00","stroke-width":2});f.animate({path:["M",
b,a,"L",e,c]},d,"<>");return f}if(a=="radtext"){c[1]=this.radius*c[1];d=(90-c[0])*Math.PI/180;e=e+(c[1]+15)*Math.cos(d);d=f-(c[1]+15)*Math.sin(d);return this.r.text(e,d,b).attr({"font-size":12})}if(a=="text"){d=this.project((new VG.SNetLine(c[0],c[1])).vector());return this.r.text(d.x,d.y,b).attr({"font-size":12})}if(a=="line"){f=this.project((new VG.SNetLine(b[0],b[1])).vector());c=this.project((new VG.SNetLine(c[0],c[1])).vector());b=this.r.path(["M",f.x,f.y,"L",f.x,f.y]).attr({stroke:"#f00","stroke-width":2});
b.animate({path:["M",f.x,f.y,"L",c.x,c.y]},d,"<>");return b}},drawAnnotations:function(){var a={fill:"transparent",stroke:"#000","stroke-width":1};this.circle=this.r.circle(this.midpoint.x,this.midpoint.y,this.radius).attr(a);var b=Math.min(this.radius/20,7.5),c=this.radius-b,d=this.radius+b,e=this.midpoint;this.lineN=this.r.path(["M",e.x,e.y+c,"L",e.x,e.y+d]).attr(a);this.lineS=this.r.path(["M",e.x,e.y-c,"L",e.x,e.y-d]).attr(a);this.lineE=this.r.path(["M",e.x-c,e.y,"L",e.x-d,e.y]).attr(a);this.lineW=
this.r.path(["M",e.x+c,e.y,"L",e.x+d,e.y]).attr(a);this.lineNS=this.r.path(["M",e.x+b,e.y,"L",e.x-b,e.y]).attr(a);this.lineEW=this.r.path(["M",e.x,e.y+b,"L",e.x,e.y-b]).attr(a);this.N=this.r.text(e.x,e.y-d-7,"N").attr({"font-size":12})},svgBlob:function(){var a=new Blob([(new XMLSerializer).serializeToString(this.r.canvas)],{type:"text/css"}),b=document.createElement("a");b.download="stereonet.svg";b.href=window.URL.createObjectURL(a);b.textContent="SVG";return b},drawNet:function(a,b){a=a===void 0?
this.showNet:a;b=b===void 0?this.showFineNet:b;this.showNet=a;this.showFineNet=b;if(this.net!==void 0){this.net.remove();this.net=void 0}if(this.fineNet!==void 0){this.fineNet.remove();this.fineNet=void 0}if(a){this.r.setStart();for(var c=10;c<=90;c=c+10){var d=new VG.SNetPlane(0,c,true);d.showPole=false;d.draw(this);d=new VG.SNetPlane(180,c,true);d.showPole=false;d.draw(this);d=new VG.SNetSCirc(0,0,c);d.showTipsy=false;d.draw(this)}this.net=this.r.setFinish();this.net.attr({stroke:"#ddd","stroke-width":1})}if(b){this.r.setStart();
for(c=0;c<=90;c=c+2)if(c%10!==0){d=new VG.SNetPlane(0,c,true);d.showPole=false;d.draw(this);d=new VG.SNetPlane(180,c,true);d.showPole=false;d.draw(this);d=new VG.SNetSCirc(0,0,c);d.draw(this)}this.fineNet=this.r.setFinish();this.fineNet.attr({stroke:"#eee","stroke-width":1})}this.netToBack()},listenHashChange:function(){var a=this;$(window).on("hashchange",function(){a.reset();a.loadHash()})},loadHash:function(){var a=window.location.href;if(a.indexOf("#")!=-1){var a=a.slice(window.location.href.indexOf("#")+
1),b=[],c=[],d=[],e=[],f=[];a.split(";").forEach(function(a){parts=a.split("=");if(parts.length===2){var a=parts[0].toLowerCase(),g=parts[1].split(",");g.forEach(function(a,b){g[b]=parseFloat(a)});a==="p"?b.push(new VG.SNetPlane(g[0],g[1])):a==="l"?c.push(new VG.SNetLine(g[0],g[1])):a==="r"?d.push(new VG.SNetRake(g[0],g[1],g[2])):a==="sc"?e.push(new VG.SNetSCirc(g[0],g[1],g[2])):a==="f"&&f.push(new VG.SNetFocal(g[0],g[1],g[2]))}});var g=this;groups=[b,c,d,e,f];groups.forEach(function(a){a.forEach(function(a){a.draw(g)})});
return groups}},netToBack:function(){if(this.net!==void 0)try{this.net.toBack()}catch(a){this.net=void 0}if(this.fineNet!==void 0)try{this.fineNet.toBack()}catch(b){this.fineNet=void 0}return this},glow:function(a){var b=this;this.glowElements.forEach(function(a){a.remove()});this.glowElements=[];a.forEach(function(a){a instanceof VG.SNetObject&&b.glowElements.push(a.glow(b))})},to2D:function(a){var b=this;if(this.context!==void 0){var c=function(){b.context.panel.remove();b.context.stop();b.context=
void 0;$(b.r.canvas).show()};if(a)c();else{this.context.cameraControler.turnViewTo2D();setTimeout(c,1100)}}this.drawIn3D=false},to3D:function(){function a(a,c){var d=new THREE.Geometry;d.vertices.push((new THREE.Vector3).copy(a));d.vertices.push((new THREE.Vector3).copy(c));var e=new THREE.LineBasicMaterial({color:3355443,linewidth:2});b.addObject(new THREE.Line(d,e),false)}this.drawIn3D=true;$(this.r.canvas).hide();var b=new VG.ThreePanel(this.outRadius*2,this.outRadius*2);b.zoomEnabled=false;b.cameraControler.renderContinuous=
true;b.cameraControler.setCameraRadius(this.outRadius*2.15);var c=new THREE.SphereGeometry(this.radius+2,36,18);c.vertices.forEach(function(a){if(a.z>0)a.z=-a.z});c.computeCentroids();var d=new THREE.MeshBasicMaterial({color:14540253,wireframe:true}),c=new THREE.Mesh(c,d);b.addObject(c,false);c=new THREE.SphereGeometry(5);d=new THREE.MeshBasicMaterial({color:10030338});c=new THREE.Mesh(c,d);c.position.set(0,this.outRadius-25,0);b.addObject(c,false);var c=Math.min(this.radius/20,7.5),d=this.radius-
c,e=this.radius+c,f=new VG.Vector;a(new VG.Vector(f.x,f.y+d,0),new VG.Vector(f.x,f.y+e,0));a(new VG.Vector(f.x,f.y-d,0),new VG.Vector(f.x,f.y-e,0));a(new VG.Vector(f.x-d,f.y,0),new VG.Vector(f.x-e,f.y,0));a(new VG.Vector(f.x+d,f.y,0),new VG.Vector(f.x+e,f.y,0));a(new VG.Vector(f.x+c,f.y,0),new VG.Vector(f.x-c,f.y,0));a(new VG.Vector(f.x,f.y+c,0),new VG.Vector(f.x,f.y-c,0));b.addObject(new THREE.Line(VG.Geometries.Circle(new VG.Vector(0,0,0.1),this.outRadius-30,72),new THREE.LineBasicMaterial({color:3355443,
linewidth:3})),false);b.start();b.cameraControler.turnViewTo3D();this.container.append(b.panel);this.context=b},interactiveControls:function(){var a=this,b=$("#toolTip"),c=VG.NumberFormat.Dip(),d=VG.NumberFormat.Strike(),e=function(b){b=a.unformatStrike(b);return d.format(b)};this.hoverPlane=new VG.SNetPlane(0,0,true);this.hoverPoint1=new VG.SNetLine(0,0);this.hoverPoint2=new VG.SNetLine(0,0);this.hoverSCirc=new VG.SNetSCirc(0,0,0);this.hoverPlane.pointAttr={fill:"#000000",stroke:"#333","stroke-width":1,
"fill-opacity":1,r:3};this.hoverPoint1.pointAttr=this.hoverPlane.pointAttr;this.hoverPoint2.pointAttr=this.hoverPlane.pointAttr;this.hoverSCirc.lineAttr.fill="#e60";this.hoverSCirc.lineAttr.opacity=0.5;this.hoverPlane.showTipsy=false;this.hoverPoint2.showTipsy=false;this.mousedown=this.hoverPoint1.showTipsy=false;var f=new VG.Timer(function(){a.onClick(a.lastMDpointTNP[0],a.lastMDpointTNP[1])}),g=new VG.Timer(function(){a.onDoubleClick(a.lastMDpointTNP[0],a.lastMDpointTNP[1])});this.container.mousedown(function(c){if(c.offsetX===
void 0){c.offsetX=c.pageX-parseFloat(a.container.css("left"));c.offsetY=c.pageY-parseFloat(a.container.css("top"))}a.glow([]);c.preventDefault();b.show();b.css({top:c.clientY,left:c.clientX});a.lastMDpoint=a.unproject(new VG.Vector(c.offsetX,a.outRadius*2-c.offsetY,0));if(a.lastMDpoint!==null){c=getTrendAndPlungeFromVector(a.lastMDpoint);a.hoverPoint1.trend=c[0];a.hoverPoint1.plunge=c[1];a.hoverPoint1.draw(a);a.lastMDpointTNP=c;a.mousedown=true;if((new Date).getTime()-a.mousedownTime<300){f.cancel();
g.schedule(100)}else f.schedule(300);a.mousedownTime=(new Date).getTime()}});this.container.mouseleave(function(){b.hide();a.hoverPoint1.remove();a.hoverPoint2.remove();a.hoverPlane.remove();a.hoverSCirc.remove()});this.container.mouseup(function(c){c.preventDefault();a.hoverPoint1.remove();a.mousedown=false;b.hide()});this.container.mousemove(function(h){if(h.offsetX===void 0){h.offsetX=h.pageX-parseFloat(a.container.css("left"));h.offsetY=h.pageY-parseFloat(a.container.css("top"))}h.preventDefault();
f.cancel();g.cancel();a.hoverPlane.remove();a.hoverPoint2.remove();a.hoverSCirc.remove();var i=a.unproject(new VG.Vector(h.offsetX,a.outRadius*2-h.offsetY,0));if(i!==null){b.show();b.css({top:h.clientY,left:h.clientX});h=getTrendAndPlungeFromVector(i);if(a.mousedown){var j=(new VG.Vector).cross(i,a.lastMDpoint),j=getStrikeAndDipFromNormal(j),k=(new VG.Vector).copy(a.lastMDpoint).dot(i),k=Math.acos(k)*180/Math.PI;a.hoverPoint2.trend=h[0];a.hoverPoint2.plunge=h[1];a.hoverPoint2.draw(a);a.hoverPlane.strike=
j[0];a.hoverPlane.dip=j[1];a.hoverPlane.draw(a);i=(new VG.Vector).copy(a.lastMDpoint).addSelf(i).multiplyScalar(0.5);i=getTrendAndPlungeFromVector(i);a.hoverSCirc.trend=i[0];a.hoverSCirc.plunge=i[1];a.hoverSCirc.radius=k/2;a.lastAngle=k/2;a.hoverSCirc.draw(a).toBack();b.html("<span style='float:left;width:45px;'>Line 1:</span>"+d.format(a.lastMDpointTNP[0])+" / "+c.format(a.lastMDpointTNP[1])+"<br><span style='float: left;width:45px;'>Line 2:</span>"+d.format(h[0])+" / "+c.format(h[1])+"<br><span style='float: left;width:45px;'>Plane:</span>"+
e(j[0])+" / "+c.format(j[1])+"<br><span style='float: left;width:45px;'>Angle:</span>"+d.format(k))}else{a.hoverPlane.strike=h[0]+90;a.hoverPlane.dip=90-h[1];a.hoverPlane.draw(a).toBack();b.html("<span style='float: left;width:45px;'>Line:</span>"+d.format(h[0])+" / "+c.format(h[1])+"<br><span style='float: left;width:45px;'>Plane:</span>"+e(h[0]+90)+" / "+c.format(90-h[1]))}a.netToBack()}else b.hide()})},project:function(a){a=(new VG.Vector).copy(a);a.z>0&&a.negate();this.netType===0?a.set(a.x/(1-
a.z),a.y/(1-a.z),0):this.netType===1&&a.set(a.x*Math.sqrt(1/(1-a.z)),a.y*Math.sqrt(1/(1-a.z)),0);return a=this.scale.multiplyVector(a).addSelf(this.midpoint)},unproject:function(a){a=(new VG.Vector).copy(a).subSelf(this.midpoint);a=this.invscale.multiplyVector(a);if(a.length()>1)return null;if(a.length()<0.01)return new VG.Vector(0,0,-1);if(this.netType===0)var b=1+Math.pow(a.x,2)+Math.pow(a.y,2),c=-1+Math.pow(a.x,2)+Math.pow(a.y,2),a=new VG.Vector(2*a.x/b,2*a.y/b,c/b);else if(this.netType===1){b=
getBearing(a);c=0;if(b===180||b===0){a=new VG.Vector(a.y,a.x,a.z);b=toRadians(90);c=-b}else b=toRadians(b);a=(Math.PI/4-Math.asin(a.x/Math.sin(b)/Math.sqrt(2)))*2;b=(new VG.Matrix4).setRotationFromEuler(new VG.Vector(0,0,-b-c));a=new VG.Vector(0,Math.cos(a),-Math.sin(a));a=b.multiplyVector(a)}return a},planeFromLines:function(a){for(var b=0,c=0,d=0,e=0,f=0,g=0;g<a.length;g++){var h=a[g];if(h!==null){b=b+h.x*h.x;c=c+h.x*h.y;d=d+h.x*h.z;e=e+h.y*h.y;f=f+h.y*h.z}}a=(c*f-d*e)/(b*e-c*c);b=(c*d-f*b)/(b*
e-c*c);c=1/Math.sqrt(1+a*a+b*b);b=getStrikeAndDipFromNormal(new VG.Vector(a*c,b*c,c));return new VG.SNetPlane(b[0],b[1])}};var props_Point;
VG.SNetManager=function(a){var b=this;b.hasGroup=false;this.snet=new VG.SNet;this.snet.planeFormat=1;this.shownIntro=false;this.snet.init("#holder",min([$(window).width()-300,$(window).height()])/2);this.snet.interactiveControls();this.snet.onClick=function(){};this.snet.onDoubleClick=function(a,c){var d=null;if(b.hasGroup){if(b.table.tableType==="plane")d=new VG.SNetPlane(Math.round(b.snet.unformatStrike(a+90)*10)/10,Math.round((90-c)*10)/10);else if(b.table.tableType==="line")d=new VG.SNetLine(Math.round(a*
10)/10,Math.round(c*10)/10);else if(b.table.tableType==="small circle")d=new VG.SNetSCirc(Math.round(a*10)/10,Math.round(c*10)/10,Math.round(b.snet.lastAngle*10)/10);else if(b.table.tableType==="rake")d=new VG.SNetRake(Math.round(firstWv(b.snet.unformatStrike(a+90),360)*10)/10,Math.round((90-c)*10)/10,90);else if(b.table.tableType==="focal")d=new VG.SNetFocal(Math.round(firstWv(b.snet.unformatStrike(a+90),360)*10)/10,Math.round((90-c)*10)/10,90);else if(b.table.tableType==="rose"||b.table.tableType===
"contour")d=new VG.SNetDataPoint(Math.round(a*10)/10,Math.round(c*10)/10);if(d!==null){d.parent=b.currentGroup;b.table.insertData(d);b.table.draw()}}else{d=new VG.SNetPlane(Math.round(b.snet.unformatStrike(a+90)*10)/10,Math.round((90-c)*10)/10);d=new VG.SNetGroup("plane",[d]);d.draw(b.snet);b.groups.insertData(d)}};this.table=new VG.SNetTable(this.snet,"#table");this.groups=new VG.SNetGroupTable(this.snet,"#groupTable");VG.Bus.bind("SNET-GroupSelected",function(a,c,d){if(d!==void 0){if(c!==null){c.data=
b.table.getData();c.data.pop();c.visible=false}b.changePanels(d.groupType);b.hasGroup=true;b.table.container.show();b.table.loadGroup(d);b.currentGroup=d;b.updateDatGui();d.visible=true}});VG.Bus.bind("SNET-ClearTable",function(){b.table.loadGroup(null)});VG.Bus.bind("SNET-HideTable",function(){b.hasGroup=false;b.table.container.hide()});new VG.Icon("newGroupPlaneIcon","plane",40,function(){b.groups.insertData(new VG.SNetGroup("plane"))},"New Plane Group");new VG.Icon("newGroupLineIcon","line",40,
function(){b.groups.insertData(new VG.SNetGroup("line"))},"New Line Group");new VG.Icon("newGroupSCircIcon","smallCircle",40,function(){b.groups.insertData(new VG.SNetGroup("small circle"))},"New Small Circle Group");new VG.Icon("newGroupRakeIcon","rake",40,function(){b.groups.insertData(new VG.SNetGroup("rake"))},"New Rake Group");new VG.Icon("selectAllIcon","selectAll",40,function(){b.table.setAllActive(true)},"Select All");new VG.Icon("selectNoneIcon","selectNone",40,function(){b.table.setAllActive(false)},
"Select None");new VG.Icon("trashIcon","trash",40,function(){b.deleteSelected()},"Delete Selected");new VG.Icon("calculatorIcon","calculator",40,function(){b.openPanel("calculatePanel")},"Calculate Things");new VG.Icon("contourIcon","contour",40,function(){b.initContour()},"Contour Selected Items");new VG.Icon("roseIcon","roseChart",40,function(){b.initRose()},"Rose Chart Selected Items");new VG.Icon("calcPlaneIcon","calcPlane",40,function(){b.calcPlane()},["Calculate Best-Fitting Plane",{gravity:"e"}]);
new VG.Icon("calcLineIcon","calcLine",40,function(){b.calcLine()},["Calculate Line of Intersection",{gravity:"e"}]);this.resizeTimer=new VG.Timer(function(){b.resize()});$(window).resize(function(){b.resizeTimer.cancel();b.resizeTimer.schedule(500)});b.resizeTimer.schedule(500);this.addDatGui();if(a){var c=a[0].simpleObject().type;this.groups.insertData(new VG.SNetGroup(c,a))}$("#button3D").click(function(){var a=$("#button3D");if(a.html()==="3D"){b.snet.to3D();b.groups.draw();a.html("2D")}else if(a.html()===
"2D"){b.snet.to2D();a.html("3D")}});$("#buttonSVG").mouseenter(function(){var a=$("#buttonSVG");a.html("");var c=b.snet.svgBlob();$(c).css({"font-size":15,color:"black"});a.append(c)});$("#buttonSave").mouseenter(function(){var a=$("#buttonSave");a.html("");var c=b.fileBlob();$(c).css({"font-size":15,color:"black"});a.append(c)});var d=null;$("#holder").bind({drop:function(a){a.stopPropagation();a.preventDefault();if(d!==null){d.close();d=null}for(var a=a.originalEvent.dataTransfer.files,c=0;c<a.length;c++)b.readFile(a[c])},
dragenter:function(a){a.stopPropagation();a.preventDefault();d===null&&(d=noty({text:"<h4>Drop File to Load!</h4>",type:"success",modal:false,layout:"bottom"}))},dragover:function(a){a.stopPropagation();a.preventDefault()}})};
VG.SNetManager.prototype={constructor:VG.SNetManager,showIntro:function(){if(!this.shownIntro){var a=this;setTimeout(function(){noty({text:"<h2>Visible Geology - Stereonet</h2><b>Click and Drag</b> to measure.<br><b>Double Click</b> to add an object.<br><b>Open Controls</b> to be in control!",type:"success",modal:true,layout:"center"});a.shownIntro=true},250)}},resize:function(){var a=$(window).height(),b=$(window).width();this.groups.resize(300,150);VG.Bus.trigger("SNET-GroupSelected",[this.currentGroup,
this.currentGroup]);this.table.resize(300,a-150-82);this.snet.r.remove();var c=min([b-300,a]);this.snet.init("#holder",c/2);if(this.snet.drawIn3D){this.snet.to2D(true);this.snet.to3D()}b-300>a?$("#holder").css({top:0,left:(b-300-c)/2,"z-index":-1}):b-300<a&&$("#holder").css({left:0,top:(a-c)/2,"z-index":-1});this.groups.draw();this.updateDatGui()},closePanels:function(a){["calculatePanel"].forEach(function(b){a!==b&&$("#"+b).animate({right:248},250)})},changePanels:function(a){this.closePanels();
$("#calcPlaneIcon").show();$("#calcLineIcon").show();if(a==="plane")a=64;else{$("#calcLineIcon").hide();a=32}$("#calculatePanel").css({margin:""+Math.round((a+2)/2)+"px 0",height:a})},initContour:function(){for(var a=this.table.getSelected(),b=new VG.SNetGroup("contour"),c=[],d=0;d<a.length;d++)if(a[d]instanceof VG.SNetPlane){var e=firstWv(this.snet.formatStrike(a[d].strike)-90,360);c.push(new VG.SNetDataPoint(e,90-a[d].dip,b))}else c.push(new VG.SNetDataPoint(a[d].trend,a[d].plunge,b));b.data=c;
b.draw(this.snet);this.groups.insertData(b);return this},initRose:function(){for(var a=this.table.getSelected(),b=new VG.SNetGroup("rose"),c=[],d=0;d<a.length;d++)if(a[d]instanceof VG.SNetPlane){var e=firstWv(this.snet.formatStrike(a[d].strike)-90,360);c.push(new VG.SNetDataPoint(e,90-a[d].dip,b))}else c.push(new VG.SNetDataPoint(a[d].trend,a[d].plunge,b));b.data=c;b.draw(this.snet);this.groups.insertData(b);return this},readFile:function(a){var b=this,c=new FileReader;c.onerror=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:noty({text:"File Not Found!",
type:"error",modal:false,layout:"topRight"});break;case a.target.error.NOT_READABLE_ERR:noty({text:"File File is not readable!",type:"error",modal:false,layout:"topRight"});break;case a.target.error.ABORT_ERR:break;default:noty({text:"An error occurred reading this file.",type:"error",modal:false,layout:"topRight"})}};c.onabort=function(){noty({text:"File read cancelled.",type:"information",modal:false,timeout:1500,layout:"topRight"})};c.onload=function(a){try{var c=JSON.parse(a.target.result);b.loadData(c)}catch(f){noty({text:"Error parsing the JSON string.",
type:"error",modal:false,layout:"topRight"})}};c.readAsText(a)},loadData:function(a){var b=this;try{if(a.version==="VisibleGeology:SNet:1.00"){a.data.forEach(function(a){var c=new VG.SNetGroup(a.groupType);c.lineAttr=a.lineAttr;c.pointAttr=a.pointAttr;c.contourAttr=a.contourAttr;c.roseAttr=a.roseAttr;c.name=a.name;c.active=a.active;a.data.forEach(function(a){c.data.push(VG.SNetObject.newObject(a,c))});b.groups.insertData(c)});this.snet.netType=a.netType;this.snet.showNet=a.showNet;this.snet.showFineNet=
a.showFineNet;this.snet.planeFormat=a.planeFormat===void 0?0:a.planeFormat}else noty({text:"Version not supported.",type:"error",modal:true,layout:"center"});this.resize()}catch(c){noty({text:"Error loading data, you may need to restart the program.",type:"error",modal:true,layout:"center"});console.log(c)}},outputData:function(){grpData=[];this.groups.getData().forEach(function(a){grpData.push(a.simpleObject())});return{version:"VisibleGeology:SNet:1.00",netType:this.snet.netType,showNet:this.snet.showNet,
showFineNet:this.snet.showFineNet,planeFormat:this.snet.planeFormat,time:(new Date).getTime(),data:grpData}},fileBlob:function(){var a=new Blob([JSON.stringify(this.outputData())],{type:"text/json"}),b=document.createElement("a");b.download="stereonetData.txt";b.href=window.URL.createObjectURL(a);b.textContent="Save";$(b).click(function(){noty({text:"<h4>Drag file onto the stereonet to load it later.</h4>",type:"success",modal:false,layout:"bottom"})});return b},openPanel:function(a){this.closePanels(a);
$("#"+a).animate({right:299},500)},calcLine:function(){this.table.getSelected().length>2&&this.table.setAllActive(false);$.noty.closeAll();var a=this;notyConfirm("<h3>Calculate Line of Intersection</h3> Select Two Planes, then Press Ok.",function(b){function c(){this.animate({r:this.attr("r")===g?h:g},1E3,"<>",c)}var d=a.table.getSelected();if(d.length!==2)noty({text:"Please Select "+(d.length>2?"Only ":"")+"Two Planes",type:"error",modal:false,timeout:1500,layout:"topRight"});else{a.closePanels();
b.close();var b=(new VG.Plane).fromStrikeAndDip(parseFloat(d[0].strike),parseFloat(d[0].dip)).normal,e=(new VG.Plane).fromStrikeAndDip(parseFloat(d[1].strike),parseFloat(d[1].dip)).normal,b=(new VG.Vector).cross(b,e);b.z>0&&b.negate();b=getTrendAndPlungeFromVector(b);b[0]=a.snet.formatStrike(b[0]);var f=new VG.SNetLine(b[0],b[1]);f.draw(a.snet);var g=35,h=1;f.elements[0].animate({r:g},1E3,"<>",c);noty({text:"<h3>Line Calculated!</h3> Between Planes "+VG.NumberFormat.StrikeDip(d[0].strike,d[0].dip,
1)+" and "+VG.NumberFormat.StrikeDip(d[1].strike,d[1].dip,1)+"<br>The intersection line is: <b>"+VG.NumberFormat.StrikeDip(b[0],b[1],2)+"</b>",type:"success",layout:"bottom",callback:{onClose:function(){f.elements[0].stop();f.remove()}}})}},function(b){b.close();a.closePanels()},{type:"information",modal:false,layout:"bottom"})},calcPlane:function(){$.noty.closeAll();var a=this;notyConfirm("<h3>Calculate Best Fitting Plane</h3> Select Two or more Elements, then Press Ok.",function(b){function c(){m=
!m;this.animate({"stroke-width":m?l:p},1E3,"<>",c)}var d=a.table.getSelected();if(d.length<2)noty({text:"Please select at least two elements",type:"error",modal:false,timeout:1500,layout:"topRight"});else{a.closePanels();b.close();for(var e=b=0,f=0,g=0,h=0,i=0;i<d.length;i++){var j;if(d[i]instanceof VG.SNetPlane){j=(new VG.Plane).fromStrikeAndDip(parseFloat(d[i].strike),parseFloat(d[i].dip)).normal;j.z>0&&j.negate()}else j=getVectorFromTrendAndPlunge(parseFloat(d[i].trend),parseFloat(d[i].plunge));
b=b+j.x*j.x;e=e+j.x*j.y;f=f+j.x*j.z;g=g+j.y*j.y;h=h+j.y*j.z}var i=(e*h-f*g)/(b*g-e*e),b=(e*f-h*b)/(b*g-e*e),e=1/Math.sqrt(1+i*i+b*b),b=getStrikeAndDipFromNormal(new VG.Vector(i*e,b*e,e)),k=new VG.SNetPlane(b[0],b[1]);k.showPole=false;k.draw(a.snet);var l=7,p=0.2,m=true;k.elements[0].animate({"stroke-width":l},1E3,"<>",c);d=d.length==2;noty({text:"<h3>Plane Calculated!</h3> "+(d?"":"<b><i>Warning: Feature in testing, use at own risk.</i></b><br><br>")+"The best fitting plane is: <b>"+VG.NumberFormat.StrikeDip(b[0],
b[1],2)+"</b>",type:d?"success":"warning",layout:"bottom",callback:{onClose:function(){k.elements[0].stop();k.remove()}}})}},function(b){b.close();a.closePanels()},{type:"information",modal:false,layout:"bottom"})},updateDatGui:function(){this.props_SNet.Projection=["Equal Angle","Equal Area"][this.snet.netType];this.props_SNet["Grid Lines"]=["Major Lines","Minor Lines","No Lines"][this.snet.showNet?this.snet.showFineNet?1:0:2];this.props_SNet["Plane Format"]=["Strike (RH Rule)","Dip Direction"][this.snet.planeFormat];
$(this.datGui_CF.domElement).hide();$(this.datGui_RF.domElement).hide();if(this.currentGroup===void 0){$(this.datGui_PF.domElement).hide();$(this.datGui_LF.domElement).hide()}else{var a=this.currentGroup.groupType;a==="small circle"?$(this.datGui_PF.domElement).hide():$(this.datGui_PF.domElement).show();a==="line"||a==="rake"?$(this.datGui_LF.domElement).hide():$(this.datGui_LF.domElement).show();var b=this.currentGroup.pointAttr,c=this.currentGroup.lineAttr;this.props_Point.Stroke=b.stroke;this.props_Point["Stroke Width"]=
b["stroke-width"];this.props_Point.Radius=b.r;this.props_Point["Fill Color"]=b.fill;this.props_Point.Opacity=b["fill-opacity"];this.props_Line.Stroke=c.stroke;this.props_Line["Stroke Width"]=c["stroke-width"];this.props_Line["Fill Color"]=c.fill;this.props_Line.Opacity=c["fill-opacity"];this.props_Line["Line Dash"]=c["stroke-dasharray"];if(a==="contour"){$(this.datGui_CF.domElement).show();b=this.currentGroup.contourAttr;this.props_Contour["Counting Method"]=b.countingMethod;this.props_Contour.Sigma=
b.sigma;this.props_Contour["Grid Size"]=b.gridSize;this.props_Contour.Contours=b.nContours;this.props_Contour["Color Map"]=b.colorMap}if(a==="rose"){$(this.datGui_RF.domElement).show();a=this.currentGroup.roseAttr;this.props_Rose["Number of Bins"]=a.nBins;this.props_Rose.Annotations=a.annotations;this.props_Rose["Full Rose"]=a.fullRose}}},deleteSelected:function(){var a=this,b=this.table.getSelected().length;b===0?noty({text:"No items selected.",layout:"topRight",timeout:1500,type:"error"}):notyConfirm("Are you sure you want to delete the "+
b+" selected items?",function(b){b.close();for(var b=a.table.getData(),d=b.length-1;d>=0;d--)if(b[d]instanceof VG.SNetObject&&b[d].active){b[d].remove();b.splice(d,1)}a.table.loadData(b)})},addDatGui:function(){var a=this,b={Stroke:"#000000","Stroke Width":1,Radius:5,"Fill Color":"#0000ff",Opacity:0.6},c={Stroke:"#000000","Stroke Width":1,"Fill Color":"#0000ff","Line Dash":"",Opacity:0.6},d={Projection:"Equal Area","Grid Lines":"Major Lines","Plane Format":"Dip Direction"},e={"Counting Method":"Exponential Kamb",
Sigma:3,"Grid Size":100,Contours:15,"Color Map":"Jet"},f={"Number of Bins":36,"Full Rose":true,Annotations:true},g=new dat.GUI,h=g.addFolder("Stereonet");h.add(d,"Projection",["Equal Area","Equal Angle"]).listen().onChange(function(b){a.snet.netType=b==="Equal Area"?1:0;a.resize()});h.add(d,"Grid Lines",["Major Lines","Minor Lines","No Lines"]).listen().onChange(function(b){a.snet.drawNet(b!=="No Lines",b==="Minor Lines")});h.add(d,"Plane Format",["Strike (RH Rule)","Dip Direction"]).listen().onChange(function(b){a.snet.planeFormat=
b==="Strike (RH Rule)"?0:b==="Dip Direction"?1:0;a.resize()});var i=g.addFolder("Point Properties");i.addColor(b,"Stroke").listen().onChange(function(b){a.currentGroup.pointAttr.stroke=b;a.currentGroup.draw(a.snet)});i.add(b,"Stroke Width",0,10).listen().onChange(function(b){a.currentGroup.pointAttr["stroke-width"]=b;a.currentGroup.draw(a.snet)});i.add(b,"Radius",0,15).listen().onChange(function(b){a.currentGroup.pointAttr.r=b;a.currentGroup.draw(a.snet)});i.addColor(b,"Fill Color").listen().onChange(function(b){a.currentGroup.pointAttr.fill=
b;a.currentGroup.draw(a.snet)});i.add(b,"Opacity",0,1).listen().onChange(function(b){a.currentGroup.pointAttr["fill-opacity"]=b;a.currentGroup.draw(a.snet)});var j=g.addFolder("Line Properties");j.addColor(c,"Stroke").listen().onChange(function(b){a.currentGroup.lineAttr.stroke=b;a.currentGroup.draw(a.snet)});j.add(c,"Stroke Width",0,10).listen().onChange(function(b){a.currentGroup.lineAttr["stroke-width"]=b;a.currentGroup.draw(a.snet)});j.add(c,"Line Dash",["","-",".","-.","-..",". ","- ","--","- .",
"--.","--.."]).listen().onChange(function(b){a.currentGroup.lineAttr["stroke-dasharray"]=b;a.currentGroup.draw(a.snet)});j.addColor(c,"Fill Color").listen().onChange(function(b){a.currentGroup.lineAttr.fill=b;a.currentGroup.draw(a.snet)});j.add(c,"Opacity",0,1).listen().onChange(function(b){a.currentGroup.lineAttr["fill-opacity"]=b;a.currentGroup.draw(a.snet)});var k=g.addFolder("Contour");k.add(e,"Counting Method",["Kamb","Linear Kamb","Square Kamb","Exponential Kamb"]).listen().onChange(function(b){a.currentGroup.contourAttr.countingMethod=
b;a.currentGroup.redraw(a.snet)});k.add(e,"Color Map",VG.ColorMap.names).listen().onChange(function(b){a.currentGroup.contourAttr.colorMap=b;a.currentGroup.redraw(a.snet)});k.add(e,"Sigma",0.5,4).listen().onChange(function(b){a.currentGroup.contourAttr.sigma=b;a.currentGroup.redraw(a.snet)});k.add(e,"Contours",5,100).listen().onChange(function(b){a.currentGroup.contourAttr.nContours=Math.round(b);a.currentGroup.redraw(a.snet)});k.add(e,"Grid Size",30,500).listen().onChange(function(b){a.currentGroup.contourAttr.gridSize=
Math.round(b);a.currentGroup.redraw(a.snet)});var l=g.addFolder("Rose Chart");l.add(f,"Number of Bins",10,50).listen().onChange(function(b){a.currentGroup.roseAttr.nBins=Math.round(b);a.currentGroup.redraw(a.snet)});l.add(f,"Full Rose").listen().onChange(function(b){a.currentGroup.roseAttr.fullRose=b;a.currentGroup.redraw(a.snet)});l.add(f,"Annotations").listen().onChange(function(b){a.currentGroup.roseAttr.annotations=b;a.currentGroup.redraw(a.snet)});this.datGui_SF=h;this.datGui_PF=i;this.datGui_LF=
j;this.datGui_CF=k;this.datGui_RF=l;this.props_Point=b;this.props_Line=c;this.props_SNet=d;this.props_Contour=e;this.props_Rose=f;$(g.domElement).parent().css({right:300,opacity:1});g.close()}};
VG.SNetTable=function(a,b){function c(a,b,c,d,e,f){if(f==void 0){b.innerHTML="";return b}b.innerHTML=h.format(f);return b}function d(a,b,c,d,e,f){if(f==void 0){b.innerHTML="";return b}b.innerHTML=j.format(f);return b}function e(a,b,c,d,e,f){if(f==void 0){b.innerHTML="";return b}b.innerHTML=i.format(f);return b}function f(a,b,c){var d=g.getData()[c];if(!(d instanceof VG.SNetObject)){b.innerHTML="";return b}b.innerHTML="<a>Delete</a>";$(b).children(0).click(function(){d.remove();g.table.alter("remove_row",
c)});return b}this.snet=a;this.init(b);this.tableType="plane";var g=this;this.checkNumbers=[{id:"strike",check:function(a){return a>=0&&a<=360},constraint:"between 000&deg; and 360&deg;"},{id:"rake",check:function(a){return a>=-180&&a<=360},constraint:"between -180&deg; and 360&deg;"},{id:"trend",check:function(a){return a>=0&&a<=360},constraint:"between 000&deg; and 360&deg;"},{id:"radius",check:function(a){return a>=0&&a<=180},constraint:"between 000&deg; and 180&deg;"},{id:"dip",check:function(a){return a>=
0&&a<=90},constraint:"between 00&deg; and 90&deg;"},{id:"plunge",check:function(a){return a>=0&&a<=90},constraint:"between 00&deg; and 90&deg;"}];var h=new VG.NumberFormat("000.0","&deg;"),i=new VG.NumberFormat("00.0","&deg;"),j=new VG.NumberFormat("+000.0","&deg;");this.planeOpts={colWidths:[25,110,110,46],colHeaders:["","Strike","Dip",""],columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"strike",type:{renderer:c}},{data:"dip",type:{renderer:e}},{data:"deleteIt",type:{renderer:f},readOnly:true}]};
this.lineOpts={colWidths:[25,110,110,46],colHeaders:["","Trend","Plunge",""],columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"trend",type:{renderer:c}},{data:"plunge",type:{renderer:e}},{data:"deleteIt",type:{renderer:f},readOnly:true}]};this.scircOpts={colWidths:[25,73,73,73,47],colHeaders:["","Trend","Plunge","Radius",""],columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"trend",type:{renderer:c}},{data:"plunge",type:{renderer:e}},{data:"radius",type:{renderer:c}},{data:"deleteIt",
type:{renderer:f},readOnly:true}]};this.rakeOpts={colWidths:[25,73,73,73,47],colHeaders:["","Strike","Dip","Rake",""],columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"strike",type:{renderer:c}},{data:"dip",type:{renderer:e}},{data:"rake",type:{renderer:d}},{data:"deleteIt",type:{renderer:f},readOnly:true}]};this.focalOpts={colWidths:[25,73,73,73,47],colHeaders:["","Strike","Dip","Rake",""],columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"strike",type:{renderer:c}},{data:"dip",
type:{renderer:e}},{data:"rake",type:{renderer:d}},{data:"deleteIt",type:{renderer:f},readOnly:true}]};this.createTable({colWidths:this.planeOpts.colWidths,colHeaders:this.planeOpts.colHeaders,columns:this.planeOpts.columns,startRows:1,rowHeaders:false,fillHandle:false,minSpareRows:1,multiSelect:true,onChange:function(a,b){if(a!==null)if(b==="paste")g.draw();else{var c=g.getData();a.forEach(function(a){c[a[0]]=g.wrapData(c[a[0]]);if(c[a[0]]instanceof VG.SNetObject){c[a[0]].draw(g.snet);g.table.render()}})}},
onSelection:function(a,b,c){if(a>c){b=c;c=a;a=b}var b=g.getData(),d=[];for(a;a<=c;a++)b[a]instanceof VG.SNetObject&&b[a].active&&b[a].parentIsActive()&&d.push(b[a]);g.snet.glow(d)}})};VG.SNetTable.prototype=Object.create(VG.Table.prototype);VG.SNetTable.prototype.draw=function(){var a=this.getData(),b=this.snet;this.wrap();a.forEach(function(a,d){d!==a.length-1&&a instanceof VG.SNetObject&&a.draw(b)})};
VG.SNetTable.prototype.getSelected=function(){for(var a=this.getData(),b=[],c=0;c<a.length;c++)a[c]instanceof VG.SNetObject&&a[c].active&&b.push(a[c]);return b};VG.SNetTable.prototype.wrap=function(){var a=this.getData(),b=false,c;for(c=0;c<a.length-1;c++)if(!(a[c]instanceof VG.SNetObject)){a[c]=this.wrapData(a[c]);a[c].parent=a[0].parent;b=true}b&&this.table.render()};
VG.SNetTable.prototype.wrapData=function(a){if(a instanceof VG.SNetObject){a.ensureFloat();return a}if(this.tableType==="plane"){var b=a.strike,c=a.dip;b!==void 0&&c!==void 0&&(a=new VG.SNetPlane(b,c))}else if(this.tableType==="line"){b=a.trend;c=a.plunge;b!==void 0&&c!==void 0&&(a=new VG.SNetLine(b,c))}else if(this.tableType==="contour"||this.tableType==="rose"){b=a.trend;c=a.plunge;b!==void 0&&c!==void 0&&(a=new VG.SNetDataPoint(b,c,this))}else if(this.tableType==="small circle"){var b=a.trend,
c=a.plunge,d=a.radius;b!==void 0&&c!==void 0&&d!==void 0&&(a=new VG.SNetSCirc(b,c,d))}else if(this.tableType==="rake"){b=a.strike;c=a.dip;d=a.rake;b!==void 0&&c!==void 0&&d!==void 0&&(a=new VG.SNetRake(b,c,d))}else if(this.tableType==="focal"){b=a.strike;c=a.dip;d=a.rake;b!==void 0&&c!==void 0&&d!==void 0&&(a=new VG.SNetFocal(b,c,d))}a.parent=this.currentParent;return a};
VG.SNetTable.prototype.insertData=function(a){if(a!==void 0){var b=this.table.getData();b[b.length-1]=a;b.push({});this.table.render();this.table.selectCell(b.length-2,1)}};VG.SNetTable.prototype.loadGroup=function(a){this.recordChanges=false;if(a===null){this.currentParent=null;this.switchType();this.table.loadData([])}else{this.currentParent=a;this.switchType(a.groupType);this.table.loadData(a.data)}this.recordChanges=true};
VG.SNetTable.prototype.switchType=function(a){a===void 0&&(a="plane");var a=a.toLowerCase(),b,c=["Strike","Dip Direction"][this.snet.planeFormat];switch(a){case "plane":b=this.planeOpts;b.colHeaders[1]=c;break;case "line":b=this.lineOpts;break;case "contour":b=this.lineOpts;break;case "rose":b=this.lineOpts;break;case "small circle":b=this.scircOpts;break;case "rake":b=this.rakeOpts;b.colHeaders[1]=c;break;case "focal":b=this.focalOpts;b.colHeaders[1]=c;break;default:console.error("Undefined SNet type.")}this.opts.colWidths=
b.colWidths;this.opts.columns=b.columns;this.opts.colHeaders=b.colHeaders;this.tableType=a;this.createTable()};VG.SNetTable.prototype.setAllActive=function(a){this.getData().forEach(function(b){if(b instanceof VG.SNetObject)(b.active=a)?b.show():b.hide()});this.table.render()};
VG.SNetGroupTable=function(a,b){this.snet=a;this.init(b);var c=this;this.checkNumbers=[];var d={startRows:0,colWidths:[25,25,194,46],colHeaders:["","n","Name",""],rowHeaders:false,fillHandle:false,minSpareRows:0,multiSelect:false,columns:[{data:"active",type:Handsontable.CheckboxCell},{data:"n",readOnly:true},{data:"name"},{data:"deleteIt",type:{renderer:function(a,b,d){var h=c.getData(),i=h[d];b.innerHTML="<a>Delete</a>";$(b).children(0).click(function(){i.remove();c.newGroup===i&&VG.Bus.trigger("SNET-ClearTable");
c.table.alter("remove_row",d);c.getData().length===0?VG.Bus.trigger("SNET-HideTable"):c.table.selectCell(h.length-1,2)});return b}},readOnly:true}],onChange:function(a){a===null||a.length===0||a[0][1]==="active"&&c.changeActive()},onSelection:function(a,b){var d=c.getData();c.oldGroup=c.newGroup;c.newGroup=d[a];c.oldGroup!==c.newGroup&&VG.Bus.trigger("SNET-GroupSelected",[c.oldGroup,c.newGroup]);if(b<3){c.count();c.table.render()}}};this.newGroup=this.oldGroup=null;this.createTable(d)};
VG.SNetGroupTable.prototype=Object.create(VG.Table.prototype);VG.SNetGroupTable.prototype.draw=function(){var a=this.snet;this.getData().forEach(function(b){b.draw(a);b.active||b.hide()})};VG.SNetGroupTable.prototype.changeActive=function(){var a=this.snet;this.getData().forEach(function(b){b.active?b.show(a):b.hide()})};VG.SNetGroupTable.prototype.count=function(){this.getData().forEach(function(a){a.count()});this.table.render()};
VG.SNetContour=function(){function a(a,b){var c=a.length,d=2*(1+c/Math.pow(b||3,2)),e=sum(setAll(a,function(a){return Math.exp(d*(a-1))}));units=Math.sqrt(c*(d/2-1)/Math.pow(d,2));return(e-0.5)/units}function b(a,b){var c=a.length,e=d(c,b||3),f=2/(1-e),a=a.filter(function(a){return a>=e});return(sum(setAll(a,function(a){return f*(a-e)}))-0.5)/Math.sqrt(c*e*(1-e))}function c(a,b){var c=a.length,e=d(c,b||3),f=3/Math.pow(1-e,2),a=a.filter(function(a){return a>=e}),a=a.map(function(a){return f*Math.pow(a-
e,2)});return(sum(a)-0.5)/Math.sqrt(c*e*(1-e))}function d(a,b){return 1-Math.pow(b,2)/(a+Math.pow(b,2))}function e(a,b){var c=a.length,e=d(c,b||3),a=a.filter(function(a){return a>=e});return(sum(a)-0.5)/Math.sqrt(c*e*(1-e))}function f(a){var b=a.length,a=a.map(function(a){return 1-a}),a=a.filter(function(a){return a<=0.01});return(a.length-0.5)/(b*0.01)}function g(a,b){var c=Array(a.length),d;for(d=0;d<a.length;d++){var e=Math.cos(b[d])*Math.cos(a[d]),f=Math.cos(b[d])*Math.sin(a[d]),g=Math.sin(b[d]);
c[d]=new VG.Vector(f,g,e)}return c}function h(a,b,c,d,e,f){var h=Math.PI/2+0.1,i=-h,v=linspace(-h,h,f),w=linspace(i,h,f),z=g(b,c),b=new VG.Matrix(void 0,[f,f]);b.setAll(function(a,b,c){var f=g([v[c[0]]],[w[c[1]]])[0],a=setAll(z,function(a){return Math.abs(a.dot(f))}),a=d(a,e);return a<0?0:a});for(c=0;c<v.length;c++){v[c]=v[c]+Math.PI/f;w[c]=w[c]+Math.PI/f}a.lon=v;a.lat=w;a.dataMat=b;a.data=b.toNestedArray()}var i=function(d,g,i,p){g=g||"Exponential Kamb";i=i||1;p=p||100;vs=[];for(var m=0;m<d.length;m++)if(d[m].active){var r=
getVectorFromTrendAndPlunge(d[m].trend,d[m].plunge);vs.push(r)}var d=vs,m=Array(d.length),r=Array(d.length),q;for(q=0;q<d.length;q++){var t=d[q],v=t.z,w=t.x;r[q]=Math.asin(t.y/t.length());m[q]=Math.atan2(w,v)}func={"Linear Kamb":b,"Square Kamb":c,Schmidt:f,Kamb:e,"Exponential Kamb":a}[g];h(this,m,r,func,i,p);this.colorMap=VG.ColorMap.Jet();this.nContours=15};i.prototype={constructor:VG.SNetContour,draw:function(a){var b=new Conrec,c=this.dataMat.max();b.contour(this.data,this.lat,this.lon,linspace(0,
c,this.nContours).slice(1));var b=b.contourList(),d=new VG.ColorBar(this.colorMap,0,c),c=function(b){for(var c=[],e=0,f;e<b.length;e++){var h=g([b[e].x],[b[e].y])[0];h.y=h.y*-1;var i=a.project(h);h.z>=0&&c.push([e===0||i.clone().subSelf(f).length()>a.radius?"M":"L",i.x,i.y]);f=i.clone()}b=d.getHex(b.level);return a.r.path(c).attr({stroke:b,"fill-opacity":0.3,fill:b})},e,f=a.r.set();for(e=0;e<b.length;e++)f.push(c(b[e]));f.toBack();a.netToBack();return f}};i.TT=[19.6,36.1,69.4,60.5,51.5,51.5,58.7,
32.3,344.7,21.1,48.3,109.9,117.1,109.6,119.1,113.3,114.6,141.7,235.1,14.2,40.5,66.7,85.3,76.1,96.1];i.TP=[79.6,71,73.8,78.4,73.5,73.5,62.4,52.1,38.7,26.9,27.6,23.6,24.1,15.9,15.1,19.3,13,22.4,21.9,74,76.2,63.8,54.8,68,71.5];return i}();
VG.SNetObject=function(){this.active=true;this.pointAttr={fill:"#0000ff",stroke:"#333","stroke-width":1,"fill-opacity":0.6,r:5};this.lineAttr={fill:"none",stroke:"#333","stroke-width":1,"fill-opacity":1,"stroke-dasharray":""};this.showTipsy=true;this.parent=null;this.elements=[]};
VG.SNetObject.newObject=function(a,b){var c;a.type==="plane"?c=new VG.SNetPlane(a.strike,a.dip):a.type==="line"?c=new VG.SNetLine(a.trend,a.plunge):a.type==="small circle"?c=new VG.SNetSCirc(a.trend,a.plunge,a.radius):a.type==="rake"?c=new VG.SNetRake(a.strike,a.dip,a.rake):a.type==="focal"?c=new VG.SNetFocal(a.strike,a.dip,a.rake):a.type==="datapoint"&&(c=new VG.SNetDataPoint(a.trend,a.plunge,b));c.active=a.active;return c};
VG.SNetObject.prototype={constructor:VG.SNetObject,drawLine:function(a,b){var c=[],d;a.drawIn3D&&(d=new THREE.Geometry);for(var e=1;e<=b.sizeDim(1);e++){var f=new VG.Vector(b.getIJ([e,1,1]),b.getIJ([e,1,2]),b.getIJ([e,1,3])),g=a.project(f);c.push([e===1?"M":"L",g.x,g.y]);if(a.drawIn3D){f=a.scale.multiplyVector(f);f.y=f.y*-1;d.vertices.push(f)}}e=a.r.path(c).attr(this.parent===null?this.lineAttr:this.parent.lineAttr).toBack();e.elementType="r";this.elements.push(e);a.netToBack();if(a.drawIn3D){c=this.parent===
null?this.lineAttr:this.parent.lineAttr;if(c["stroke-width"]>0){var e=new THREE.LineBasicMaterial({color:parseInt("0x"+c.stroke.slice(1,7)),linewidth:c["stroke-width"]}),h=new THREE.Line(d,e);h.elementType="t";a.context.addObject(h,false);h.remove=function(){a.drawIn3D&&a.context.removeObject(h,false)};this.elements.push(h)}if(c["fill-opacity"]>0){d=new VG.Matrix(void 0,[b.sizeDim(1),2]);f=new VG.Matrix(void 0,[b.sizeDim(1),2]);g=new VG.Matrix(void 0,[b.sizeDim(1),2]);for(e=1;e<=b.sizeDim(1);e++){d.setIJ([e,
1],0);d.setIJ([e,2],b.getIJ([e,1,1]));f.setIJ([e,1],0);f.setIJ([e,2],-b.getIJ([e,1,2]));g.setIJ([e,1],0);g.setIJ([e,2],b.getIJ([e,1,3]))}e=VG.Geometries.Surface4(null,{XData:d,YData:f,ZData:g},function(b){return a.scale.multiplyVector(b)});d=new THREE.MeshBasicMaterial({color:parseInt("0x"+c.fill.slice(1,7))});var i=new THREE.Mesh(e,d);i.elementType="t";i.doubleSided=true;a.context.addObject(i,false);i.remove=function(){a.drawIn3D&&a.context.removeObject(i,false)};this.elements.push(i)}}(!this.active||
!this.parentIsActive())&&this.hide()},drawPoint:function(a,b){b.z>0&&(b=b.clone().negate());var c=a.project(b.clone()),c=a.r.circle(c.x,c.y,5).attr(this.parent===null?this.pointAttr:this.parent.pointAttr);c.elementType="r";this.elements.push(c);if(this.showTipsy){var d=null,e=new VG.NumberFormat("00"),f=new VG.NumberFormat("000");this instanceof VG.SNetPlane?d="Plane: "+f.format(this.strike)+"/"+e.format(this.dip):this instanceof VG.SNetLine?d="Line: "+f.format(this.trend)+"/"+e.format(this.plunge):
this instanceof VG.SNetRake&&(d="Rake: "+f.format(this.strike)+"/"+e.format(this.dip)+", "+f.format(this.rake));d!==null&&$(c.node).attr({title:d}).tipsy({gravity:"se",delayIn:500,delayOut:1E3,fade:true})}if(a.drawIn3D){d=this.parent===null?this.pointAttr:this.parent.pointAttr;if(d.r>0){c=new THREE.Geometry;c.vertices.push(new THREE.Vector3);e=(new THREE.Vector3).copy(a.scale.multiplyVector(b));e.y=e.y*-1;c.vertices.push(e);var d=new THREE.LineBasicMaterial({color:parseInt("0x"+d.fill.slice(1,7)),
linewidth:d.r}),g=new THREE.Line(c,d);g.elementType="t";a.context.addObject(g,false);g.remove=function(){a.drawIn3D&&a.context.removeObject(g,false)};this.elements.push(g)}}(!this.active||!this.parentIsActive())&&this.hide()},hide:function(){this.elements.forEach(function(a){if(a.elementType==="r")a.hide();else if(a.elementType==="t")a.visible=false})},show:function(){this.elements.forEach(function(a){if(a.elementType==="r")a.show();else if(a.elementType==="t")a.visible=true})},stop:function(){this.elements.forEach(function(a){a.elementType===
"r"&&a.stop()})},toBack:function(){this.elements.forEach(function(a){a.elementType==="r"&&a.toBack()})},toFront:function(){this.elements.forEach(function(a){a.elementType==="r"&&a.toFront()})},remove:function(){this.elements.forEach(function(a){a.remove()});this.elements=[]},glow:function(a){var b=a.r.set();this.elements.forEach(function(a){a.elementType==="r"&&b.push(a.glow({width:5,color:"blue",opacity:0.3}))});return b},parentIsActive:function(){return this.parent===null?true:this.parent.active},
ensureFloat:function(){if(this.strike!==void 0)this.strike=parseFloat(this.strike);if(this.dip!==void 0)this.dip=parseFloat(this.dip);if(this.trend!==void 0)this.trend=parseFloat(this.trend);if(this.plunge!==void 0)this.plunge=parseFloat(this.plunge);if(this.radius!==void 0)this.radius=parseFloat(this.radius)}};
VG.SNetGroup=function(a,b){var c=this;this.groupType=a;this.active=true;this.visible=false;this.data=b===void 0?[]:b;var d=Raphael.getColor();if(this.groupType==="contour"){this.contourAttr={countingMethod:"Exponential Kamb",colorMap:"Autumn",sigma:1,gridSize:100,nContours:15};this.lineAttr={fill:"#FFF",stroke:"#FFF","stroke-width":1,"fill-opacity":0,"stroke-dasharray":""};this.pointAttr={fill:"#333",stroke:"#333","stroke-width":1,"fill-opacity":1,r:2}}else if(this.groupType==="rose"){this.roseAttr=
{annotations:true,nBins:20,fullRose:true};this.lineAttr={fill:d,stroke:"#333","stroke-width":1,"fill-opacity":0.5,"stroke-dasharray":""};this.pointAttr={fill:"#333",stroke:"#333","stroke-width":1,"fill-opacity":1,r:2}}else{this.lineAttr={fill:d,stroke:"#333","stroke-width":1,"fill-opacity":this.groupType==="focal"?0.3:0,"stroke-dasharray":""};this.pointAttr={fill:d,stroke:"#333","stroke-width":1,"fill-opacity":0.6,r:5}}this.showTipsy=true;this.name=a[0].toUpperCase()+a.slice(1,a.length)+"s";this.redrawTimer=
new VG.Timer(function(){c._redraw()});this.elements=[]};
VG.SNetGroup.prototype={constructor:VG.SNetGroup,draw:function(a){var b=this;this.count();this.remove();this.active&&this.data.forEach(function(c){if(c instanceof VG.SNetObject){c.parent=b;c.draw(a);c.active||c.hide()}})},redraw:function(a){this.currentSNet=a;this.redrawTimer.cancel();this.redrawTimer.schedule(25)},_redraw:function(){if(this.active)if(this.groupType==="contour"){var a=this.contourAttr,b=new VG.SNetContour(this.data,a.countingMethod,a.sigma,a.gridSize);b.colorMap=VG.ColorMap[a.colorMap]();
b.nContours=a.nContours;a=b.draw(this.currentSNet);this.lineAttr.fill="#fff";this.lineAttr.stroke="#fff";a.elementType="r";a.attr({"stroke-width":this.lineAttr["stroke-width"],"fill-opacity":this.lineAttr["fill-opacity"],"stroke-dasharray":this.lineAttr["stroke-dasharray"]});this.elements.forEach(function(a){a.remove()});this.elements=[];this.elements.push(a)}else if(this.groupType==="rose"){a=this.roseAttr;a.nBins=Math.round(a.nBins);for(var b=this.currentSNet.r,c=this.currentSNet.midpoint.x,d=this.currentSNet.midpoint.y,
e=this.currentSNet.radius,f=Raphael.getColor(),g=a.fullRose,h=g?360/a.nBins:180/a.nBins,i=[],j=0;j<this.data.length;j++)this.data[j].active&&i.push(this.data[j].trend);b=new VG.RoseChart(b,c,d,e,i,f,h,g);b.chart.elementType="r";b.petals.elementType="r";b.petals.attr({fill:this.lineAttr.fill,stroke:this.lineAttr.stroke,"stroke-width":this.lineAttr["stroke-width"],"fill-opacity":this.lineAttr["fill-opacity"],"stroke-dasharray":this.lineAttr["stroke-dasharray"]});b.chart.toBack();this.currentSNet.netToBack();
this.elements.forEach(function(a){a.remove()});this.elements=[];a.annotations?this.elements.push(b.chart):b.chart.remove();this.elements.push(b.petals)}},count:function(){var a=this;this.n=0;this.data.forEach(function(b){if(b instanceof VG.SNetObject)a.n=a.n+1})},hide:function(){var a=this;this.data.forEach(function(b){if(b instanceof VG.SNetObject){b.parent=a;b.hide()}});this.elements.forEach(function(a){if(a.elementType==="r")a.hide();else if(a.elementType==="t")a.visible=false})},show:function(a){var b=
this;this.data.forEach(function(c){if(c instanceof VG.SNetObject&&c.active){c.parent=b;c.elements.length===0&&a!==void 0&&c.draw(a);c.show()}});this.elements.forEach(function(a){if(a.elementType==="r")a.show();else if(a.elementType==="t")a.visible=true})},remove:function(){this.data.forEach(function(a){a instanceof VG.SNetObject&&a.remove()});this.elements.forEach(function(a){a.remove()});this.elements=[]},simpleObject:function(){groupData=[];this.data.forEach(function(a){a instanceof VG.SNetObject&&
groupData.push(a.simpleObject())});var a={type:"group",name:this.name,groupType:this.groupType,pointAttr:this.pointAttr,lineAttr:this.lineAttr,active:this.active,data:groupData};if(this.groupType==="contour")a.contourAttr=this.contourAttr;if(this.groupType==="rose")a.roseAttr=this.roseAttr;return a}};VG.SNetPlane=function(a,b,c){VG.SNetObject.call(this);this.strike=parseFloat(a);this.dip=parseFloat(b);this.skip=6;this.showPole=this.showPlane=true;this.override=c===void 0?false:c};
VG.SNetPlane.prototype=Object.create(VG.SNetObject.prototype);
VG.SNetPlane.prototype.drawArc=function(a,b){var c=this.override?this.strike:a.formatStrike(this.strike);if(c===0){var c=(new VG.Matrix4).setRotationFromEuler(new VG.Vector(0,toRadians(this.dip),toRadians(c)),"XZY"),d=a.project(c.multiplyVector(new VG.Vector(0,1,0))),e=a.project(c.multiplyVector(new VG.Vector(1,0,0))),f=a.project(c.multiplyVector(new VG.Vector(0,-1,0))),c=radiusFrom3Points(d,e,f),g=centerFrom3Points(d,e,f),e=firstWv(180-getBearing(f.clone().subSelf(g)),360),d=firstWv(180-getBearing(d.clone().subSelf(g)),
360),f=g.x,g=g.y,h=a.r.path().attr({arc:[f,g,e,e,c]}).attr(this.lineAttr);h.animate({arc:[f,g,e,d,c]},b,"<>");return h}};
VG.SNetPlane.prototype.draw=function(a){this.remove();var b=this.override?this.strike:a.formatStrike(this.strike);if(this.showPole||this.showPlane){for(var c=(new VG.Matrix4).setRotationFromEuler(new VG.Vector(0,toRadians(this.dip),toRadians(b)),"XZY"),d=new VG.Matrix(null,[180/this.skip+1,1,3]),e=1,f=0;f<=180;f=f+this.skip){d.setIJ([e,1,1],Math.sin(f*Math.PI/180));d.setIJ([e,1,2],Math.cos(f*Math.PI/180));e++}this.showPlane&&this.drawLine(a,c.multiplyMatrix(d));if(this.showPole){b=(new VG.Matrix4).rotateZ(toRadians(b-
90-180));c=new VG.Vector(0,Math.cos(toRadians(90-this.dip)),-Math.sin(toRadians(90-this.dip)));this.drawPoint(a,b.multiplyVector(c))}return this}};VG.SNetPlane.prototype.intersect=function(a){var b=(new VG.Plane).fromStrikeAndDip(this.strike,this.dip).normal,a=(new VG.Plane).fromStrikeAndDip(a.strike,a.dip).normal,b=(new VG.Vector).cross(b,a);b.z>0&&b.negate();b=getTrendAndPlungeFromVector(b);b[0]=self.snet.formatStrike(b[0]);return new VG.SNetLine(b[0],b[1])};
VG.SNetPlane.prototype.simpleObject=function(){return{type:"plane",active:this.active,strike:this.strike,dip:this.dip}};VG.SNetLine=function(a,b){VG.SNetObject.call(this);this.trend=parseFloat(a);this.plunge=parseFloat(b)};VG.SNetLine.prototype=Object.create(VG.SNetObject.prototype);VG.SNetLine.prototype.vector=function(){var a=(new VG.Matrix4).rotateZ(toRadians(this.trend-180)),b=new VG.Vector(0,Math.cos(toRadians(this.plunge)),-Math.sin(toRadians(this.plunge)));return a.multiplyVector(b)};
VG.SNetLine.prototype.pulse=function(){function a(){this.animate({r:this.attr("r")===b?c:b},1E3,"<>",a)}var b=35,c=1;this.elements[0].animate({r:b},1E3,"<>",a)};VG.SNetLine.prototype.draw=function(a){this.remove();return this.drawPoint(a,this.vector())};VG.SNetLine.prototype.simpleObject=function(){return{type:"line",active:this.active,trend:this.trend,plunge:this.plunge}};
VG.SNetRake=function(a,b,c){VG.SNetObject.call(this);this.strike=parseFloat(a);this.dip=parseFloat(b);this.rake=parseFloat(c);a=getTrendAndPlungeFromVector(getRakeVector(a,b,c));this.trend=a[0];this.plunge=a[1]};VG.SNetRake.prototype=Object.create(VG.SNetObject.prototype);
VG.SNetRake.prototype.draw=function(a){this.remove();var b=this.override?this.strike:a.formatStrike(this.strike),b=getTrendAndPlungeFromVector(getRakeVector(b,this.dip,this.rake));this.trend=b[0];this.plunge=b[1];var b=(new VG.Matrix4).rotateZ(toRadians(this.trend-180)),c=new VG.Vector(0,Math.cos(toRadians(this.plunge)),-Math.sin(toRadians(this.plunge)));return this.drawPoint(a,b.multiplyVector(c))};
VG.SNetRake.prototype.simpleObject=function(){return{type:"rake",active:this.active,strike:this.strike,dip:this.dip,rake:this.rake}};VG.SNetSCirc=function(a,b,c){VG.SNetObject.call(this);this.trend=parseFloat(a);this.plunge=parseFloat(b);this.radius=parseFloat(c);this.skip=1};VG.SNetSCirc.prototype=Object.create(VG.SNetObject.prototype);
VG.SNetSCirc.prototype.draw=function(a,b){if(b===void 0){this.remove();this.draw(a,true);this.draw(a,false);return this}for(var c=(new VG.Matrix4).rotateZ(-toRadians(90-this.radius)),d=(new VG.Matrix4).rotateZ(toRadians(this.trend)),e=(new VG.Matrix4).rotateX(-toRadians(this.plunge)),f=c.multiplyVector(new VG.Vector(1,0,0)),c=[],g=b?90:0;g<=(b?450:360);g=g+this.skip){var h=(new VG.Matrix4).rotateY(toRadians(g)),h=d.multiplyVector(e.multiplyVector(h.multiplyVector((new VG.Vector).copy(f))));if(b&&
h.z>=-0.01){h.negate();h.z=h.z<=0?h.z:0;c.push(new VG.Vector(-h.x,-h.y,h.z))}else!b&&h.z<=0&&c.push(new VG.Vector(-h.x,-h.y,h.z))}if(c.length<2)return null;d=(new VG.Vector).copy(c[c.length-1]).dot(c[0]);e=Math.acos(d)*180/Math.PI;if(e>4&&(this.lineAttr.fill!=="none"||this.parent!==null&&this.parent.lineAttr.fill!=="none")){d=c[c.length-1];f=c[0];e=Math.round(e);f=(new VG.Vector).sub(f.clone(),d.clone()).multiplyScalar(1/e);for(g=1;g<=e;g++)c.push((new VG.Vector).copy(d).addSelf(f.clone().multiplyScalar(g)).normalize())}c=
(new VG.Matrix).fromVectorArray(c);return this.drawLine(a,c)};VG.SNetSCirc.prototype.simpleObject=function(){return{type:"small circle",active:this.active,trend:this.trend,plunge:this.plunge,radius:this.radius}};VG.SNetFocal=function(a,b,c){VG.SNetObject.call(this);this.strike=parseFloat(a);this.dip=parseFloat(b);this.rake=parseFloat(c);this.skip=5};VG.SNetFocal.prototype=Object.create(VG.SNetObject.prototype);
VG.SNetFocal.prototype.draw=function(a){this.remove();var b=this.override?this.strike:a.formatStrike(this.strike),c=this.getVectors(b,this.dip),b=(new VG.Vector).cross((new VG.Plane).fromStrikeAndDip(b,this.dip).normal,getRakeVector(b,this.dip,this.rake+0.0010)),b=getStrikeAndDipFromNormal(b),b=this.getVectors(b[0],b[1]),d=function(a,b,c,d){for(var b=(new VG.Vector).sub(b.clone(),a.clone()).multiplyScalar(1/d),e=1;e<=d;e++)c.push((new VG.Vector).copy(a).addSelf(b.clone().multiplyScalar(e)).normalize())};
if(this.rake>0){d(c[c.length-1],b[b.length-1],c,200);for(var e=b.length-1;e>=0;e--)c.push(b[e]);d(b[0],c[0],c,200)}else{d(c[c.length-1],b[0],c,200);for(e=0;e<b.length;e++)c.push(b[e]);d(b[b.length-1],c[0],c,200)}c=(new VG.Matrix).fromVectorArray(c);return this.drawLine(a,c)};
VG.SNetFocal.prototype.getVectors=function(a,b){for(var c=(new VG.Matrix4).setRotationFromEuler(new VG.Vector(0,toRadians(b),toRadians(a)),"XZY"),d=[],e=0;e<=180;e=e+this.skip)d.push(c.multiplyVector(new VG.Vector(Math.sin(toRadians(e)),Math.cos(toRadians(e)),0)));return d};VG.SNetFocal.prototype.simpleObject=function(){return{type:"focal",active:this.active,strike:this.strike,dip:this.dip,rake:this.rake}};
VG.SNetDataPoint=function(a,b,c){VG.SNetObject.call(this);this.parent=c;this.trend=parseFloat(a);this.plunge=parseFloat(b)};VG.SNetDataPoint.prototype=Object.create(VG.SNetLine.prototype);VG.SNetDataPoint.prototype.draw=function(a){this.remove();this.lastSNet=a;this.parent.redraw(a);return this.drawPoint(a,this.vector())};VG.SNetDataPoint.prototype.remove=function(){this.elements.forEach(function(a){a.remove()});this.parent.redraw(this.lastSNet);this.elements=[]};
VG.SNetDataPoint.prototype.simpleObject=function(){return{type:"datapoint",active:this.active,trend:this.trend,plunge:this.plunge}};VG.RoseChart=function(a,b,c,d,e,f,g,h){this.paper=a;this.cx=b;this.cy=c;this.r=d;this.trends=e;this.color=f;this.skip=g;this.fullRose=h;this.chart=null;this.redraw()};
VG.RoseChart.prototype={constructor:VG.RoseChart,remove:function(){this.chart.remove()},statistics:function(){for(var a=this.trends,b=Math.PI/180,c=a.length,d=0,e=0,f=0;f<a.length;f++)var g=a[f],d=d+Math.cos(g*b),e=e+Math.sin(g*b);var a=Math.sqrt(d*d+e*e)/c,f=1-a,d=Math.atan2(d,e),e=d/b,e=0<=e&&e<90?-(e-90):90<=e&&e<=180?540+(-e-90):-e+90,g=true,h,i,j,k,l,p;try{h=a<0.53?2*a+Math.pow(a,3)+5*Math.pow(a,5)/6:0.53<=a&&a<=0.85?-0.4+1.39*a+0.43/f:1/(Math.pow(a,3)-4*Math.pow(a,2)+3*a);i=h<2?Math.max(h-2*
Math.pow(c*h,-1),0):Math.pow(c-1,3)*h/(Math.pow(c,3)+c);j=1/Math.sqrt(c*a*i);k=(d+Math.asin(1.9604*j))/b;l=(d-Math.asin(1.9604*j))/b;p=Math.asin(1.9604*j)/b}catch(m){g=false}isNaN(p)&&(g=false);return g?{plot:true,percent:p,up:k,dw:l,thetaBar:d,ThetaBarDeg:e}:{plot:false,ThetaBarDeg:e}},redraw:function(){var a=this.cx,b=this.cy,c=this.r,d=this.trends,e=this.color,f=this.skip,g=this.fullRose;if(!g)for(var h=0;h<d.length;h++)90<d[h]&&d[h]<=180?d[h]=d[h]+180:180<=d[h]&&d[h]<=270&&(d[h]=d[h]-180);var h=
this.paper,i=Math.PI/180;this.chart!==null&&this.chart.remove();for(var j=h.set(),k=h.set(),l=[],p=0,m=f;m<=360;m=m+f){for(var r=l[p]=0;r<d.length;r++){var q=d[r];q>m-f&&q<=m&&(l[p]=l[p]+1)}p=p+1}for(var f=90,t=p=0,m=0,r=l.length;m<r;m++){p=p+l[m];t=l[m]>t?l[m]:t}for(var t=t/p,q=Math.ceil(t*100/10)*10/100,v=c/30,m=0,w=g?16:8;m<w;m=m+1){var z=g?Math.PI*2/w*m:-Math.PI/w*m,x=a+c*Math.cos(z),A=b+c*Math.sin(z),F=a+(c-v)*Math.cos(z),C=b+(c-v)*Math.sin(z);Math.cos(z);Math.sin(z);j.push(h.path(["M",a,b,"L",
x,A,"Z"]).attr({stroke:"#EEE","stroke-width":1}))}x={stroke:"#EEE","stroke-width":1};for(m=3;m>0;m--)g?j.push(h.circle(a,b,c/4*m).attr(x)):j.push(h.path(["M",a+c-c/4*m,b,"A",c/4*m,c/4*m,0,0,0,a-c+c/4*m,b]).attr(x));j.push(h.text(a-c+12,b-8,q*100+"%").attr({"font-size":10}));j.push(h.text(a+c-12,b-8,q*100+"%").attr({"font-size":10}));m=this.statistics();if(m.plot){var v=a+c*1.05*Math.cos(-m.thetaBar),w=b+c*1.05*Math.sin(-m.thetaBar),z=a+(c+(1.05-1)*c*2)*Math.cos(-m.thetaBar),D=b+(c+(1.05-1)*c*2)*Math.sin(-m.thetaBar),
F=a+c*1.05*Math.cos(-m.up*i),x=a+c*1.05*Math.cos(-m.dw*i),C=b+c*1.05*Math.sin(-m.up*i),A=b+c*1.05*Math.sin(-m.dw*i);j.push(h.path(["M",x,A,"A",c*1.05,c*1.05,0,+(m.dw-m.up>180),0,F,C]).attr({stroke:"#000","stroke-width":1.5}));j.push(h.path(["M",v,w,"L",z,D]).attr({stroke:"#000","stroke-width":2}))}x="Mean Direction: "+Math.round(m.ThetaBarDeg*10)/10+"\u00b0\n";m.plot&&(x=x+("95% Confidence: \u00b1"+Math.round(m.percent*10)/10+"\u00b0\n"));x=x+("n = "+d.length+"\nmax = "+Math.round(t*1E4)/100+"%");
j.push(h.text(a-c*1,b-c,x).attr({"font-size":12,"text-anchor":"start"}));m={stroke:"#000","stroke-width":1.5,fill:"none"};g?j.push(h.circle(a,b,c).attr(m)):j.push(h.path(["M",a+c,b,"A",c,c,0,0,0,a-c,b,"Z"]).attr(m));for(m=0;m<r;m++){g=-360/l.length;d=void 0;d=l[m]/p/q*c;t=f+g;x=f;A={fill:e,stroke:"#000","stroke-width":1};F=a+d*Math.cos(-t*i);C=a+d*Math.cos(-x*i);v=b+d*Math.sin(-t*i);w=b+d*Math.sin(-x*i);d=h.path(["M",a,b,"L",F,v,"A",d,d,0,+(x-t>180),0,C,w,"z"]).attr(A);f=f+g;k.push(d)}this.chart=
j;this.petals=k},download:function(){window.URL=window.webkitURL||window.URL;var a=$("<div>").append($(this.paper.canvas).clone()).html(),a=new Blob([a],{type:"text/plain"}),b=document.createElement("a");b.href=window.URL.createObjectURL(a);b.download="RoseDiagram.svg";b.textContent="Download Rose Diagram!";new VG.Notify("Download",b)}};
Raphael.fn.histogram=function(a,b,c,d,e,f,g){function h(c){var e=a+z*c,g=p[c]/v/w*d,h=b+d-g,m=j.rect(e,h,z,g).attr({stroke:i,"stroke-width":1,fill:f});m.transform("s1 0.1 "+a+" "+b);g=Raphael.animation({transform:"s1 1 "+a+" "+b},2E3,"bounce");m.animate(g.delay(Math.random()*500));var q=j.path("M12.5-13.5c0,1.657-1.343,3-3,3H4.75L0-0.5l-4.75-10H-9.5c-1.657,0-3-1.343-3-3v-19  c0-1.657,1.343-3,3-3h19c1.657,0,3,1.343,3,3V-13.5z").transform("t"+(e+z/2)+","+h).attr({stroke:"none",fill:"#555",opacity:0}),
r=j.text(e+z/2,h-22,""+p[c]).attr({fill:"#fff","font-size":13,opacity:0});m.mouseover(function(){m.toFront().stop().animate({stroke:"#000","stroke-width":2},l);m.transform("s1 1 "+a+" "+b);q.toFront().stop().animate({opacity:1},l/2);r.toFront().stop().animate({opacity:1},l/2)}).mouseout(function(){m.stop().animate({stroke:i,"stroke-width":1},l);m.transform("s1 1 "+a+" "+b);q.stop().animate({opacity:0},l/2);r.stop().animate({opacity:0},l/2)});c=j.set();c.push(m);c.push(q);c.push(r);k.push(c)}for(var i=
"#000",j=this,k=this.set(),l=200,p=[],m=0,r=g;r<=360;r=r+g){for(var q=p[m]=0;q<e.length;q++){var t=e[q];t>r-g&&t<=r&&(p[m]=p[m]+1)}m=m+1}for(var v=0,r=e=0,g=p.length;r<g;r++){v=v+p[r];e=p[r]>e?p[r]:e}for(var w=Math.ceil(e/v*100/10)*10/100,z=c/p.length,r=0;r<p.length;r++)h(r);for(var e=d*0.02,t=b+d,x=t-e,A=t+e*1.5,g={stroke:"#000","stroke-width":2},r=0,m=4;r<=m;r++){var F=a+c/m*r,q=Math.round(360/m*r)+"\u00b0";k.push(j.path(["M",F,t,"L",F,x]).attr(g));k.push(j.path(["M",F,b+e,"L",F,b]).attr(g));k.push(j.text(F,
A,q).attr({"font-size":12}))}k.push(j.text(a+c/2,A+e*2.7,"Orientation").attr({"font-size":14}));e=c*0.02;r=0;for(m=4;r<=m;r++){t=b+d/m*r;q=Math.round(w*100/m*(m-r))+"%";k.push(j.path(["M",a,t,"L",a+e,t]).attr(g));k.push(j.path(["M",a+c,t,"L",a+c-e,t]).attr(g));k.push(j.text(a-e*0.5,t,q).attr({"font-size":12,"text-anchor":"end"}))}k.push(j.text(a/3,b+d/2,"Frequency (%)").attr({"font-size":14}).transform("r270"));k.push(j.rect(a,b,c,d).attr({stroke:"#000","stroke-width":1.5,fill:"none"}));return k};
var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return false}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,ismac:-1!=window.navigator.userAgent.toLowerCase().indexOf("mac"),isIE:-1!=window.navigator.userAgent.toLowerCase().indexOf("msie"),getWebGLErrorMessage:function(){var a=document.createElement("div");
a.id="webgl-error-message";a.style.fontFamily="monospace";a.style.fontSize="13px";a.style.fontWeight="normal";a.style.textAlign="center";a.style.background="#fff";a.style.color="#000";a.style.padding="1.5em";a.style.width="400px";a.style.margin="5em auto 0";if(!this.webgl)a.innerHTML=window.WebGLRenderingContext?'Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />\nFind out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.':
'Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>\nFind out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.';return a},addGetWebGLMessage:function(a){var b,c,a=a||{};b=a.parent!==void 0?a.parent:document.body;a=a.id!==void 0?a.id:"oldie";c=Detector.getWebGLErrorMessage();c.id=a;b.appendChild(c)}};
VG.ThreePanel=function(a,b){var c=this,d=false;a===void 0&&(d=true);a=a!==void 0?a:$(window).width();b=b!==void 0?b:$(window).height();this.panel=$("<div>").addClass("ThreePanel").attr({tabindex:0});this.cameraControler=new VG.CameraControler(a,b);this.cameraControler.aspectRatio=a/b;try{this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:true});this.renderType="webgl"}catch(e){try{this.renderer=new THREE.CanvasRenderer;this.renderType="canvas"}catch(f){this.error=true;return}}this.error=
false;this.setSize(a,b);this.resizeTimer=new VG.Timer(function(){c.setSize()});d&&$(window).resize(function(){c.resizeTimer.cancel();c.resizeTimer.schedule(500)});this.scene=new THREE.Scene;this.camera=new THREE.CombinedCamera(this.width,this.height,50,0.1,1E6,-2E3,1E5);this.scene.add(this.camera);$(this.panel).append($(this.renderer.domElement).width(a).height(b).addClass("threeCanvas"));this.startHandlers=[];this.endHandlers=[];this.moveHandlers=[];this.hoverHandlers=[];this.scrollHandlers=[];this.preRenderHandlers=
[];this.keyHandlers=[];this.escHandlers=[];this.defaultKeys=this.zoomEnabled=true;$(this.panel).bind({mousedown:function(a){c.mousedown(a)},mouseleave:function(a){c.mouseup(a)},mouseup:function(a){c.mouseup(a)},mousemove:function(a){c.mousemove(a)}});this.panel.get(0).onmousewheel=function(a){c.scroll(a)};this.panel.keydown(function(a){c.keydown(a)});this.threeDivs=[]};
VG.ThreePanel.prototype={constructor:VG.ThreePanel,setSize:function(a,b){this.width=a!==void 0?a:$(window).width();this.height=b!==void 0?b:$(window).height();this.renderer.setSize(this.width,this.height);$(this.panel).width(this.width).height(this.height);$(this.renderer.domElement).width(this.width).height(this.height);this.cameraControler.aspectRatio=this.width/this.height;if(this.doAnimate){if(this.camera instanceof THREE.OrthographicCamera){this.camera.left=-this.cameraControler.getWidth()/2;
this.camera.right=+this.cameraControler.getWidth()/2;this.camera.bottom=-this.cameraControler.getHeight()/2;this.camera.top=+this.cameraControler.getHeight()/2}else this.camera.setSize(this.width,this.height);this.camera.updateProjectionMatrix();this.cameraControler.fakeChanged()}},start:function(){this.doAnimate=true;this.cameraControler.fakeChanged();this.renderer.render(this.scene,this.camera);var a=this;this.timer=setInterval(function(){a.animate()},1E3/60)},stop:function(){this.doAnimate=false;
clearInterval(this.timer)},animate:function(){if(this.doAnimate){if(this.camera instanceof THREE.OrthographicCamera){this.camera.left=-this.cameraControler.getWidth()/2;this.camera.right=+this.cameraControler.getWidth()/2;this.camera.bottom=-this.cameraControler.getHeight()/2;this.camera.top=+this.cameraControler.getHeight()/2}else this.camera.setSize(this.width,this.height);var a=this.cameraControler.getPositionAndUpDirection();this.camera.position.copy(a[0]);this.camera.lookAt(this.cameraControler.getCameraTarget());
this.camera.up.copy(a[1]);this.camera.updateProjectionMatrix();for(a=0;a<this.preRenderHandlers.length;a++)this.preRenderHandlers[a](this.cameraControler);for(a=0;a<this.threeDivs.length;a++)this.threeDivs[a].updatePosition();this.cameraControler.renderNow()&&this.render()}},animateObject:function(a,b,c){var c=c===void 0?200:c,d=0,e,f=this.cameraControler,g=(b.x-a.position.x)/c,h=(b.y-a.position.y)/c,i=(b.z-a.position.z)/c;return e=setInterval(function(){if(d>c){clearInterval(e);f.renderContinuous=
false}else{f.renderContinuous=true;a.position.set(a.position.x+g,a.position.y+h,a.position.z+i);d=d+1}},1E3/60)},changeCamera:function(a){this.scene.remove(this.camera);this.camera=a;this.scene.add(this.camera)},preEvent:function(a){a.preventDefault();a.stopPropagation();$(this.panel).focus()},mousedown:function(a){this.preEvent(a);this.mouseDown=true;this.mouseDownX=a.pageX;this.mouseDownY=a.pageY;for(var b=0;b<this.startHandlers.length;b++)this.startHandlers[b](a)},mouseup:function(a){this.preEvent(a);
this.mouseDown=false;for(var b=0;b<this.endHandlers.length;b++)this.endHandlers[b](a)},mousemove:function(a){this.preEvent(a);this.intersects=null;var b=a.pageX,c=a.pageY,d=b-this.mouseDownX,e=c-this.mouseDownY;this.mouseDownX=b;this.mouseDownY=c;if(this.mouseDown){if(this.moveHandlers.length>0)for(var f=this.cameraControler.getReverseRotationMatrix().multiplyVector3(new THREE.Vector3(d,-e,0)),b=0;b<this.moveHandlers.length;b++)if(c=this.moveHandlers[b](f,a))$(this.panel).css({cursor:""});else{$(this.panel).css({cursor:"crosshair"});
this.cameraControler.fakeChanged();return}this.cameraControler.incrementRotationX(e);this.cameraControler.incrementRotationZ(d)}else{d=true;for(b=0;b<this.hoverHandlers.length;b++)(c=this.hoverHandlers[b](a))||(d=false);d?$(this.panel).css({cursor:""}):$(this.panel).css({cursor:"crosshair"})}},keydown:function(a){for(var b=0;b<this.keyHandlers.length;b++){var c=this.keyHandlers[b](a);if(!c){this.cameraControler.fakeChanged();return}}if(this.defaultKeys){b=this.cameraControler;switch(a.keyCode){case 82:b.turnViewTo2D();
break;case 51:b.turnViewTo3D();break;case 37:b.turnViewTo(NaN,NaN,b.rotationZ-20);break;case 38:b.turnViewTo(b.rotationX-20,NaN,NaN);break;case 39:b.turnViewTo(NaN,NaN,b.rotationZ+20);break;case 40:b.turnViewTo(b.rotationX+20,NaN,NaN);break;case 27:for(b=0;b<this.escHandlers.length;b++){c=this.escHandlers[b](a);if(!c)break}}}},scroll:function(a){if(this.zoomEnabled||this.scrollHandlers.length!==0){this.preEvent(a);for(var a=-a.wheelDeltaY,b=0;b<this.scrollHandlers.length;b++)if(!this.scrollHandlers[b](a)){this.cameraControler.fakeChanged();
return}this.zoomEnabled&&this.cameraControler.doZoom(a)}},setFocus:function(a){a?this.panel.focus():this.panel.blur()},addObject:function(a,b){this.scene.add(a);b&&this.cameraControler.fakeChanged()},removeObject:function(a,b){this.scene.remove(a);b&&this.cameraControler.fakeChanged()},render:function(){this.renderer.render(this.scene,this.camera)},registerThreeDiv:function(a){this.threeDivs.push(a);this.panel.append(a.div)},getFirstPointIntersects:function(){var a=this.getIntersects();return a.length>
0?a[0].point:null},getIntersects:function(){this.intersects==null&&this.intersectScene();return this.intersects},intersectScene:function(){var a=new THREE.Projector,b=this.panel.offset().left,c=this.panel.offset().top,b=new THREE.Vector3((this.mouseDownX-b-1)/this.width*2-1,-((this.mouseDownY-c+1)/this.height)*2+1,0.5);a.unprojectVector(b,this.camera);a=new THREE.Ray(this.camera.position,b.subSelf(this.camera.position).normalize());b=[];for(c=1;c<this.scene.children.length;c++){for(var d=this.scene.children[c],
e=a.intersectObject(d),f=0;f<e.length;f++)b.push(e[f]);d=d.children;for(e=0;e<d.length;e++)for(var g=a.intersectObject(d[e]),f=0;f<g.length;f++)b.push(g[f])}b.length>0&&b.sort(function(a,b){return a.distance-b.distance});return this.intersects=b},getImage:function(){return this.renderer.domElement.toDataURL()}};
VG.ThreeDiv=function(a,b,c){this.camera=a.camera;this.container=$(a.renderer.domElement);this.position=c;this.cameraControler=a.cameraControler;this.div=$("<div>");this.div.css("position","absolute");this.div.attr("class","threeTextDiv");this.div.append(b);this.visible=true;a.registerThreeDiv(this)};
VG.ThreeDiv.prototype={constructor:VG.ThreeDiv,updatePosition:function(){if(this.visible){var a=this.position.clone(),b=new THREE.Matrix4;b.multiply(this.camera.projectionMatrix,this.camera.matrixWorldInverse);b.multiplyVector3(a);b=(a.x+1)*this.container.width()/2+this.container.offset().left;a=(-a.y+1)*this.container.height()/2+this.container.offset().top-this.div.height()/2;b=b-this.div.width()/2;this.div.css({top:a,left:b});this.div.show()}else this.div.hide()},setPosition:function(a){this.position=
a.clone()}};
VG.Geometries={Surface4:function(a,b,c){var d=b.XData,e=b.YData,f=b.ZData,g=b.CData,h=false,i=false;d.sizeDim(1)===1&&(h=true);e.sizeDim(2)===1&&(i=true);for(var j=0,k=0,l=0,p=new THREE.Geometry,m=p.vertices,r=p.faces,q=1;q<=f.sizeDim(2);q++)for(var t=1;t<=f.sizeDim(1);t++){var v=new THREE.Vector3;v.set(d.getIJ([h?1:t,q]),e.getIJ([t,i?1:q]),f.getIJ([t,q]));c!==void 0&&(v=c(v));m.push(v);j++;if(q<f.sizeDim(2)&&t<f.sizeDim(1)){if(b.FaceColor!=void 0&&b.FaceColor!=null&&b.FaceColor.equals("interp")){v=[];
v.push(new THREE.Color(a.getHex(g.getIJ([t+1,q]))));v.push(new THREE.Color(a.getHex(g.getIJ([t,q]))));v.push(new THREE.Color(a.getHex(g.getIJ([t,q+1]))));v.push(new THREE.Color(a.getHex(g.getIJ([t+1,q+1]))));r.push(new THREE.Face4(l+1,l,l+f.sizeDim(1),l+f.sizeDim(1)+1,null,v))}else if(g!=null){v=(g.getIJ([t,q])+g.getIJ([t,q+1])+g.getIJ([t+1,q])+g.getIJ([t+1,q+1]))/4;v=new THREE.Color(a.getHex(v));r.push(THREE.Face4(l+1,l,l+f.sizeDim(1),l+f.sizeDim(1)+1,null,v))}else r.push(new THREE.Face4(l+1,l,l+
f.sizeDim(1),l+f.sizeDim(1)+1));k++}l=l+1}p.computeCentroids();p.computeFaceNormals();p.computeVertexNormals();return p},Circle:function(a,b,c){for(var d=new THREE.Geometry,e=d.vertices,c=Math.PI*2/c,f=Math.PI*2;f>=-1.0E-5;f=f-c){var g=new THREE.Vector3(b*Math.cos(f),b*Math.sin(f),0);g.addSelf(a);e.push(g)}e.push(e[0].clone());return d},Cylinder:function(a,b,c,d,e,f){var g=Math.PI*2/e,h,i;h=new VG.Matrix(null,[b.length,e+1]);i=new VG.Matrix(null,[b.length,e+1]);for(var e=new VG.Matrix(null,[b.length,
e+1]),j=0,k=Math.PI*2;k>=-1.0E-5;k=k-g){for(var l=0;l<b.length;l++){var p=new THREE.Vector3(b[l]*Math.cos(k),b[l]*Math.sin(k),c[l]),p=d.multiplyVector3(p);p.addSelf(a);h.setIJ([l+1,j+1],p.x);i.setIJ([l+1,j+1],p.y);e.setIJ([l+1,j+1],p.z)}j++}return VG.Geometries.Surface4(null,{XData:h,YData:i,ZData:e},f)},Arrow:function(a,b,c){var d=b.clone().subSelf(a),e=d.length();d.normalize();a.clone();var f=getBearing(d),b=new THREE.Matrix4;b.setRotationFromEuler(new THREE.Vector3(-Math.PI/2+Math.asin(d.z),0,
-toRadians(f)),"ZYX");d=c*3;c=[0,c,c,d,0];e=[0,0,e-d,e-d,e];return VG.Geometries.Cylinder(new VG.Vector,c,e,b,10,function(b){return b.addSelf(a)})},NorthArrow:function(a,b){var c=[0,a,0],d=[-1.5*a,0,4*a],e=new THREE.Matrix4;e.setRotationFromEuler(new THREE.Vector3(-Math.PI/2,0,0),"XYZ");c=VG.Geometries.Cylinder(new THREE.Vector3,c,d,e,10);c=new THREE.Mesh(c,new THREE.MeshBasicMaterial({color:3342336}));c.position.copy(b);return c},Plane:function(a,b,c,d,e,f){for(var g=0,h=0,i=0,j=new THREE.Geometry,
k=j.vertices,l=j.faces,p=b.length(),m=c.length(),r=0;r<=e;r++)for(var q=0;q<=d;q++){var t=(new THREE.Vector3).copy(a).addSelf(b.clone().setLength(q/d*p)).addSelf(c.clone().setLength(r/e*m));f!==void 0&&(t=f(t));k.push(t);g++;if(r<e&&q<d){l.push(new THREE.Face4(i+1,i,i+d+1,i+d+2));h++}i=i+1}j.computeCentroids();j.computeFaceNormals();j.computeVertexNormals();return j}};
VG.CameraControler=function(a,b){this.defaultZoomIncrement=0.02;this.minZoom=0.75;this.maxZoom=4E3;this.width=a!==void 0?a:500;this.height=b!==void 0?b:500;this.zoom=this.aspectRatio=1;this.rotationZ=this.rotationY=this.rotationX=0;this.cameraRadius=100;this.upDirection=new THREE.Vector3(0,1,0);this.cameraTarget=new THREE.Vector3(0,0,0);this.restrictRotation=true;this.changed=this.isTurning=this.renderContinuous=false;this.frameCnt=0};
VG.CameraControler.prototype={constructor:VG.CameraControler,setSize:function(a){this.height=a;this.width=a*this.aspectRatio;return this},getHeight:function(){return this.height/this.zoom},getWidth:function(){return this.width/this.zoom},getCameraRadius:function(){return Math.max(this.cameraRadius-this.zoom,0)},setCameraRadius:function(a){this.cameraRadius=a;this.defaultZoomIncrement=this.cameraRadius/50;return this},setCameraTarget:function(a,b,c){this.changed=true;a instanceof VG.Vector||a instanceof
THREE.Vector3?this.cameraTarget.copy(a):this.cameraTarget.set(a,b,c);return this},getCameraTarget:function(){return this.cameraTarget.clone()},turnViewTo2D:function(a){return this.turnViewTo(0,0,0,a)},turnViewTo3D:function(a){return this.turnViewTo(-70,0,50,a)},turnViewTo:function(a,b,c,d){var d=d===void 0?60:d,e=isNaN(a)?0:(a-this.rotationX)/d,f=isNaN(b)?0:(b-this.rotationY)/d,g=isNaN(c)?0:(c-this.rotationZ)/d,h=0,i,j=this;i=setInterval(function(){if(h>d||abs(e)>0&&j.restrictRotation&&clamp(j.rotationX+
e,-180,0)===j.rotationX){clearInterval(i);j.isTurning=false}else{j.isTurning=true;j.setRotationX(j.restrictRotation?clamp(j.rotationX+e,-180,0):j.rotationX+e);j.setRotationY(j.rotationY+f);j.setRotationZ(j.rotationZ+g);h=h+1}},1E3/60);this.isTurning=true;return i},setRotations:function(a,b,c){this.changed=true;if(a instanceof VG.Vector||a instanceof THREE.Vector3){this.setRotationX(a.x);this.setRotationY(a.y);this.setRotationZ(a.z)}else{this.setRotationX(a);this.setRotationY(b);this.setRotationZ(c)}return this},
incrementRotationX:function(a){this.changed=true;this.rotationX=this.rotationX+a;if(this.restrictRotation)this.rotationX=clamp(this.rotationX,-180,0);return this},incrementRotationY:function(a){this.changed=true;this.rotationY=this.rotationY+a;return this},incrementRotationZ:function(a){this.changed=true;this.rotationZ=this.rotationZ+a;return this},setRotationX:function(a){this.changed=true;this.rotationX=a;return this},setRotationY:function(a){this.changed=true;this.rotationY=a;return this},setRotationZ:function(a){this.changed=
true;this.rotationZ=a;return this},getPositionAndUpDirection:function(){var a=this.getReverseRotationMatrix(),b=a.multiplyVector3(new THREE.Vector3(0,0,this.getCameraRadius()));b.addSelf(this.getCameraTarget());a=a.multiplyVector3(this.upDirection.clone());a.normalize();return[b,a]},doZoom:function(a){this.changed=true;a=a*this.defaultZoomIncrement;this.zoom=Math.max(this.minZoom,Math.min(this.cameraRadius*0.95,this.zoom-a));return this},getRadiantRotationX:function(){return toRadians(this.rotationX)},
getRadiantRotationY:function(){return toRadians(this.rotationY)},getRadiantRotationZ:function(){return toRadians(this.rotationZ)},getRotationVector:function(){return new THREE.Vector3(toRadians(this.rotationX),toRadians(this.rotationY),toRadians(this.rotationZ))},getReverseRotationMatrix:function(){var a=new THREE.Matrix4;a.setRotationFromEuler(this.getReverseRotationVector(),"ZYX");return a},getReverseRotationVector:function(){return new THREE.Vector3(-toRadians(this.rotationX),-toRadians(this.rotationY),
-toRadians(this.rotationZ))},is2D:function(){return this.rotationX===0||this.rotationX===-180},fakeChanged:function(){this.changed=true;this.frameCnt=0;return this},renderNow:function(){var a=this.changed||this.renderContinuous||this.isTurning;if(this.frameCnt>5)this.changed=false;this.frameCnt++;return a}};
VG.Axes=function(a,b){this.context=a;this.info=b;var c=this;a.preRenderHandlers.push(function(a){c.calculateAxesView(a)});if(b!=null){this.xrange=b.XLim.get(2)-b.XLim.get(1);this.yrange=b.YLim.get(2)-b.YLim.get(1);this.zrange=b.ZLim.get(2)-b.ZLim.get(1);a.cameraControler.setSize(max([this.xrange,this.yrange,this.zrange])*1.5);a.cameraControler.setCameraTarget(b.CameraTarget.get(1),b.CameraTarget.get(2),b.CameraTarget.get(3));var d=a.cameraControler.getCameraTarget().subSelf(new THREE.Vector3(b.CameraPosition.get(1),
b.CameraPosition.get(2),b.CameraPosition.get(3))).length();a.cameraControler.setCameraRadius(d);a.cameraControler.setRotationZ(-b.View.get(1));a.cameraControler.setRotationX(b.View.get(2)-90);this.box=new THREE.Mesh(new THREE.CubeGeometry(this.xrange,this.yrange,this.zrange),new THREE.MeshBasicMaterial({color:0,wireframe:true}));this.box.visible=b.Box=="on";this.box.position.copy(a.cameraControler.getCameraTarget());a.addObject(this.box,false);d=b.Box=="on"?this.xrange/350:0;this.background=new THREE.Mesh(new THREE.CubeGeometry(this.xrange+
d,this.yrange+d,this.zrange+d),new THREE.MeshBasicMaterial({color:b.Color!=null?b.Color:16777215}));this.background.visible=b.Color!=null;this.background.position.copy(a.cameraControler.getCameraTarget());this.background.flipSided=true;a.addObject(this.background,false);var e,f,g=new THREE.Vector3,h=new THREE.Vector3,i,j;this.XAxis=[];this.YAxis=[];this.ZAxis=[];this.XAxisText=[];this.YAxisText=[];this.ZAxisText=[];d=b.XColor;e=b.XTick;i=b.XTickLabel.split("\n");f=new THREE.Vector3(1,0,0);j=(this.xrange+
this.yrange+this.zrange)/3*b.TickLength.get(2);h=h.clone();h.set(0,b.YLim.get(1),b.ZLim.get(1));g=g.clone();g.set(0,-j,0);this.XAxis.push(this.createAxes(d,e,i,f,g,h,this.XAxisText));h=h.clone();h.set(0,b.YLim.get(2),b.ZLim.get(1));g=g.clone();g.set(0,j,0);this.XAxis.push(this.createAxes(d,e,i,f,g,h,this.XAxisText));h=h.clone();h.set(0,b.YLim.get(1),b.ZLim.get(2));g=g.clone();g.set(0,-j,0);this.XAxis.push(this.createAxes(d,e,i,f,g,h,this.XAxisText));h=h.clone();h.set(0,b.YLim.get(2),b.ZLim.get(2));
g=g.clone();g.set(0,j,0);this.XAxis.push(this.createAxes(d,e,i,f,g,h,this.XAxisText));d=b.YColor;e=b.YTick;i=b.YTickLabel.split("\n");f=new THREE.Vector3(0,1,0);h=h.clone();h.set(b.XLim.get(1),0,b.ZLim.get(1));g=g.clone();g.set(-j,0,0);this.YAxis.push(this.createAxes(d,e,i,f,g,h,this.YAxisText));h=h.clone();h.set(b.XLim.get(2),0,b.ZLim.get(1));g=g.clone();g.set(j,0,0);this.YAxis.push(this.createAxes(d,e,i,f,g,h,this.YAxisText));h=h.clone();h.set(b.XLim.get(1),0,b.ZLim.get(2));g=g.clone();g.set(-j,
0,0);this.YAxis.push(this.createAxes(d,e,i,f,g,h,this.YAxisText));h=h.clone();h.set(b.XLim.get(2),0,b.ZLim.get(2));g=g.clone();g.set(j,0,0);this.YAxis.push(this.createAxes(d,e,i,f,g,h,this.YAxisText));d=b.ZColor;e=b.ZTick;i=b.ZTickLabel.split("\n");f=new THREE.Vector3(0,0,1);h=h.clone();h.set(b.XLim.get(1),b.YLim.get(1),0);g=g.clone();g.set(-1,0,0);g.normalize().multiplyScalar(j);this.ZAxis.push(this.createAxes(d,e,i,f,g,h,this.ZAxisText));h=h.clone();h.set(b.XLim.get(2),b.YLim.get(1),0);g=g.clone();
g.set(0,-1,0);g.normalize().multiplyScalar(j);this.ZAxis.push(this.createAxes(d,e,i,f,g,h,this.ZAxisText));h=h.clone();h.set(b.XLim.get(1),b.YLim.get(2),0);g=g.clone();g.set(0,1,0);g.normalize().multiplyScalar(j);this.ZAxis.push(this.createAxes(d,e,i,f,g,h,this.ZAxisText));h=h.clone();h.set(b.XLim.get(2),b.YLim.get(2),0);g=g.clone();g.set(1,0,0);g.normalize().multiplyScalar(j);this.ZAxis.push(this.createAxes(d,e,i,f,g,h,this.ZAxisText))}};
VG.Axes.prototype={constructor:VG.Axes,createAxes:function(a,b,c,d,e,f,g){if(b!=null){for(var h=new THREE.Object3D,i=[],j=1;j<=b.numel();j++){var k=new THREE.Geometry,l=k.vertices,p=d.clone().multiplyScalar(b.get(j)).addSelf(f);l.push(p);l.push(p.clone().addSelf(e));k=new THREE.Line(k,new THREE.LineBasicMaterial({color:a}));h.add(k);p=new VG.ThreeDiv(this.context,c[j-1],p.clone().addSelf(e).addSelf(e));i.push(p)}this.context.addObject(h,false);g.push(i);return h}return null},calculateAxesView:function(a){var b=
Math.acos(Math.cos(a.getRadiantRotationZ()))*180/Math.PI,c=Math.acos(Math.cos(a.getRadiantRotationX()))*180/Math.PI,d=a.is2D(),e,f,g,h,i=b<=90||b>=270;e=c<=90?i?true:false:false;f=c<=90?i?false:true:false;h=c>90?i?true:false:false;g=c>90?i?false:true:false;b=[e,f,h,g];e=[e,f,h,g];this.switchAxes(this.XAxis,this.XAxisText,b,e);a=Math.asin(Math.sin(a.getRadiantRotationZ()))*180/Math.PI>=0;e=c<=90?a?true:false:false;f=c<=90?a?false:true:false;h=c>90?a?true:false:false;g=c>90?a?false:true:false;b=[e,
f,h,g];e=[e,f,h,g];this.switchAxes(this.YAxis,this.YAxisText,b,e);e=d?false:!a&&i?true:false;f=d?false:!a&&!i?true:false;g=d?false:a&&!i?true:false;h=d?false:a&&i?true:false;b=[e,f,h,g];e=[e,f,h,g];this.switchAxes(this.ZAxis,this.ZAxisText,b,e);c=this.info.Visible=="on";this.background.visible=c&&this.info.Color!=null;this.box.visible=c&&(d||this.info.Box=="on")},switchAxes:function(a,b,c,d){for(var e=this.info.Visible=="on",f=0;f<c.length;f++)for(var g=a[f].children,h=0;h<g.length;h++)g[h].visible=
e&&c[f];for(f=0;f<d.length;f++){g=b[f];for(h=0;h<g.length;h++)g[h].visible=e&&d[f]}}};VG.AxesObjectInfo=function(){};
VG.AxesObjectInfo.prototype={constructor:VG.AxesObjectInfo,fromMeshData:function(a){this.XLim=new VG.Matrix([0,a.size[0]],[1,2]);this.YLim=new VG.Matrix([0,a.size[1]],[1,2]);this.ZLim=new VG.Matrix([0,a.size[2]],[1,2]);this.CameraTarget=new VG.Matrix([a.size[0]/2,a.size[1]/2,a.size[2]/2],[1,3]);var b=max(a.size);this.CameraPosition=new VG.Matrix([this.CameraTarget.get(1),this.CameraTarget.get(2),this.CameraTarget.get(3)+b*2],[1,3]);this.View=new VG.Matrix([0,0],[1,2]);this.Visible=this.Box="on";this.ZColor=
this.YColor=this.XColor=0;var b=this.XLim.get(2),c=this.YLim.get(2),d=this.ZLim.get(2);this.XTick=new VG.Matrix([0,b*0.25,b*0.5,b*0.75,b],[1,5]);this.YTick=new VG.Matrix([0,c*0.25,c*0.5,c*0.75,c],[1,5]);this.ZTick=new VG.Matrix([0,d*0.25,d*0.5,d*0.75,d],[1,5]);var e=function(a){a=Math.round(a*10)/10;return""+a};this.XTickLabel=e(b*0+a.top[0])+"\n"+e(b*0.25+a.top[0])+"\n"+e(b*0.5+a.top[0])+"\n"+e(b*0.75+a.top[0])+"\n"+e(b*1+a.top[0]);this.YTickLabel=e(c*0+a.top[1])+"\n"+e(c*0.25+a.top[1])+"\n"+e(c*
0.5+a.top[1])+"\n"+e(c*0.75+a.top[1])+"\n"+e(c*1+a.top[1]);this.ZTickLabel=e(d*1+a.top[2])+"\n"+e(d*0.75+a.top[2])+"\n"+e(d*0.5+a.top[2])+"\n"+e(d*0.25+a.top[2])+"\n"+e(d*0+a.top[2]);this.TickLength=new VG.Matrix([0.01,0.03],[1,2]);return this}};
